{"version":3,"mappings":"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","names":["CommonApiService","planId","response","errorText","rawText","data","error","formData","errorData","contentType","__publicField","useMessageFormatting","text","timestamp","diff","message","computed","bytes","k","sizes","i","maxLength","html","formatTimestamp","formatFileSize","_createElementBlock","_createElementVNode","_hoisted_2","_hoisted_3","_openBlock","_hoisted_4","_Fragment","attachment","index","_createVNode","_unref","Icon","_hoisted_5","_toDisplayString","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","props","__props","emit","__emit","t","useI18n","getNestingClass","getSubPlanStatusClass","_a","agent","_b","getSubPlanStatusText","getSubPlanStatusIcon","getSubPlanProgress","completedCount","getSubPlanCompletedCount","getAgentPreviewStatusClass","status","getAgentPreviewStatusIcon","getAgentStatusText","hasNestedSubPlans","step","getNestedSubPlans","handleSubPlanClick","handleSubPlanAgentClick","agentIndex","stepId","handleThinkActStepClick","_stepIndex","handleNestedSubPlanSelected","subPlanIndex","subPlan","handleNestedStepSelected","_normalizeClass","_hoisted_1","$t","nestingLevel","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","$event","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_renderList","maxVisibleSteps","stepIndex","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_40","_hoisted_41","nestedStep","nestedStepIndex","_createBlock","_component_RecursiveSubPlan","maxNestingDepth","_hoisted_42","_hoisted_43","_hoisted_44","_hoisted_45","directSubPlan","directIndex","agentExecutionSequence","handleAgentClick","agentExecution","getPlanStatusClass","getPlanStatusText","getAgentStatusClass","getAgentStatusIcon","handleStepSelected","formatToolParameters","parameters","parsed","planExecution","_hoisted_17","RecursiveSubPlan","shouldShowThinking","_d","_c","handleAgentSelected","handleSubPlanSelected","handleUserInputSubmit","inputData","thinking","thinkingDetails","ExecutionDetails","stepActions","genericInput","hasContent","formInputsStore","reactive","ref","isInitialized","initializationTimeout","initializeFormInputs","formInputs","input","onMounted","watch","value","numIndex","label","getOptionsArray","options","opt","isRequired","required","onUnmounted","userInputWaitState","inputIndex","_vModelText","option","_vModelSelect","_vModelCheckbox","_vModelRadio","formatResponseText","copyToClipboard","plainText","handleRegenerate","handleRetry","handleUserInputSubmitted","UserInputForm","_mergeProps","content","isStreaming","handleCopy","ThinkingSection","ResponseSection","getMessageClasses","messageClasses","messageId","UserMessage","AssistantMessage","convertPlanExecutionRecord","record","converted","convertAgentExecutionRecord","convertMessageToCompatible","useChatMessages","messages","isLoading","streamingMessageId","activeMessageId","lastMessage","hasMessages","addMessage","type","updateMessage","id","updates","m","removeMessage","clearMessages","startStreaming","stopStreaming","setActiveMessage","appendToMessage","field","updateMessageThinkingDetails","updateMessageThinking","updateMessagePlanExecution","findMessage","getMessageIndex","readonly","useScrollBehavior","containerRef","showScrollToBottom","isAutoScrollEnabled","scrollThreshold","scrollToBottom","smooth","nextTick","isNearBottom","scrollTop","scrollHeight","clientHeight","checkScrollPosition","nearBottom","handleScroll","autoScrollToBottom","forceScrollToBottom","scrollToMessage","messageElement","getScrollInfo","isAtTop","isAtBottom","scrollPercentage","addScrollListener","removeScrollListener","initializeScrollBehavior","cleanupScrollBehavior","_PlanExecutionManager","rootPlanId","uiState","deleted","planCacheSize","uiStateCacheSize","callbacks","query","errorPlanId","cachedRecord","uiStatePlanId","DirectApiService","useTaskStore","details","taskStore","PlanActApiService","PlanExecutionManager","planExecutionManager","messagesRef","pollingInterval","isMessageStreaming","compatibleMessages","handleMessageContainerClick","event","target","handleCopyMessage","handleRegenerateMessage","handleRetryMessage","handlePlanUpdate","planDetails","messageIndex","finalResponse","handlePlanCompleted","summary","handleDialogRoundStart","handlePlanError","__expose","ChatMessage","_Transition","CoordinatorToolApiService","planTemplateId","result","parseError","planTitle","planDescription","tool","requestData","errorMessage","FileUploadApiService","files","file","uploadKey","fileName","fileInputRef","uploadedFiles","isUploading","resetSession","newFiles","handleFileUpload","handleFileChange","fileArray","f","uploadFiles","removeFile","fileToRemove","acceptedFileTypes","MemoryStore","memoryId","memoryStore","isTaskRunning","inputRef","fileUploadRef","currentInput","defaultPlaceholder","currentPlaceholder","selectedOption","innerToolOptions","isLoadingTools","loadInnerTools","allTools","filteredTools","inputSchema","param","e","savedTool","selectionOptions","newValue","handleFilesUploaded","key","handleFilesRemoved","handleUploadKeyChanged","handleUploadStarted","handleUploadCompleted","handleUploadError","isDisabled","adjustInputHeight","handleKeydown","handleSend","finalInput","selectedTool","clearInput","handlePlanModeClick","handleStop","updateState","enabled","placeholder","setInputValue","getQuery","FileUploadComponent","_createTextVNode","MemoryApiService","conversationId","memoryName","showTitleEdit","searchQuery","filteredMessages","showNameModal","currentEditMessageId","nameInput","showDeleteModal","currentDeleteId","expandedMap","handleEscKey","closeDeleteModal","closeNameModal","loadMessages","mes","mesMsg","handleSearch","selectMemory","timestampNum","matchesName","matchesId","matchesContent","bubble","showNameEditModal","currentName","saveName","newName","msg","currentMessage","returnMemory","toggleMessage","filteredIndex","showDeleteConfirm","confirmDelete","_Teleport","_cache","_withModifiers","idx","_hoisted_33","_hoisted_46","API_BASE_URL","fetchAgentExecutionDetail","refreshAgentExecutionDetail","FileBrowserApiService","apiResponse","filePath","blob","url","a","mimeType","textMimeTypes","textExtensions","lowerFileName","ext","node","isExpanded","showActions","showContextMenu","contextMenuStyle","toggleExpanded","handleClick","handleFileSelect","hideContextMenu","handleDownload","handleRightClick","copyPath","err","getNodeIcon","level","$emit","child","_component_FileTreeNode","loading","fileTree","selectedFile","fileContent","loadingContent","contentError","autoRefreshTimer","isTextFile","isPlanDirectoryNotFound","clearAutoRefresh","startAutoRefresh","refreshFileTree","handleFileSelected","handleDownloadFile","closeFileViewer","getFileIcon","newPlanId","FileTreeNode","scrollContainer","selectedStep","activeTab","lastExecutedPlanId","hasExecutedAnyPlan","showScrollToBottomButton","shouldAutoScrollToBottom","stepStatusText","fileBrowserPlanId","shouldShowNoTaskMessage","agentExecutionDetail","stepData","checkScrollState","autoScrollToBottomIfNeeded","refreshCurrentStep","newStepId","setScrollContainer","element","hasScrollableContent","formatJson","jsonData","jsonObj","cleanup","initScrollListener","setupScrollListener","oldPlanId","tas","actToolInfo","_hoisted_47","_hoisted_48","_hoisted_49","_hoisted_50","_hoisted_51","_hoisted_52","_hoisted_53","_hoisted_54","_hoisted_55","_hoisted_56","_hoisted_57","_hoisted_58","_hoisted_59","_hoisted_60","_hoisted_61","_hoisted_62","_hoisted_63","_hoisted_64","_hoisted_66","FileBrowser","_hoisted_67","_hoisted_68","_hoisted_69","PlanParameterApiService","showModal","success","publishing","deleting","currentTool","isSaved","publishAsHttpService","publishAsInternalToolcall","parameterRequirements","isLoadingParameters","showGroupSuggestions","availableServiceGroups","isLoadingGroups","filteredServiceGroups","trimmedGroup","group","modalTitle","isUpdate","initializeFormData","newDescription","trimmedDescription","loadAvailableServiceGroups","tools","ToolApiService","groupsSet","handleServiceGroupInput","handleServiceGroupBlur","selectServiceGroup","loadParameterRequirements","requirements","showMessage","validateForm","handlePublish","existingTool","enabledServices","serviceUrls","handleDelete","watchModal","loadCoordinatorToolData","baseUrl","newId","oldId","newVisible","Modal","executionParams","parameterValues","parameterErrors","isValidationError","isExecutingPlan","apiTabs","isAnyServiceEnabled","buttonText","canExecute","handleExecutePlan","validateParameters","replacementParams","payload","handlePublishMcpService","clearExecutionParams","newValues","updateExecutionParamsFromParameters","updateParameterValue","paramName","hasErrors","showPublishButton","currentPlanTemplateId","toolInfo","tab","useJsonEditor","showJsonPreview","displayData","parseJsonToVisual","jsonContent","convertVisualToJson","formattedJsonOutput","newContent","oldContent","jsonOutput","newStep","addStep","removeStep","moveStepUp","moveStepDown","handleRollback","handleRestore","handleSave","toggleJsonPreview","closeJsonPreview","autoResizeTextarea","textarea","lineHeight","lines","minRows","maxRows","targetRows","newHeight","args","canRollback","canRestore","isGenerating","isExecuting","bind","fn","thisArg","toString","getPrototypeOf","iterator","toStringTag","kindOf","cache","thing","str","kindOfTest","typeOfTest","isArray","isUndefined","isBuffer","val","isFunction","isArrayBuffer","isArrayBufferView","isString","isNumber","isObject","isBoolean","isPlainObject","prototype","isDate","isFile","isBlob","isFileList","isStream","isFormData","kind","isURLSearchParams","isReadableStream","isRequest","isResponse","isHeaders","trim","forEach","obj","allOwnKeys","l","keys","len","findKey","_key","_global","isContextDefined","context","merge","caseless","assignValue","targetKey","extend","b","stripBOM","inherits","constructor","superConstructor","descriptors","toFlatObject","sourceObj","destObj","filter","propFilter","prop","merged","endsWith","searchString","position","lastIndex","toArray","arr","isTypedArray","TypedArray","forEachEntry","_iterator","pair","matchAll","regExp","matches","isHTMLForm","toCamelCase","p1","p2","hasOwnProperty","isRegExp","reduceDescriptors","reducer","reducedDescriptors","descriptor","name","ret","freezeMethods","toObjectSet","arrayOrString","delimiter","define","noop","toFiniteNumber","defaultValue","isSpecCompliantForm","toJSONObject","stack","visit","source","reducedValue","isAsyncFn","isThenable","_setImmediate","setImmediateSupported","postMessageSupported","token","cb","asap","isIterable","utils$1","AxiosError","code","config","request","utils","customProps","axiosError","httpAdapter","isVisitable","removeBrackets","renderKey","path","dots","isFlatArray","predicates","toFormData","metaTokens","visitor","defaultVisitor","indexes","useBlob","convertValue","el","exposedHelpers","build","encode","charMap","match","AxiosURLSearchParams","params","encoder","_encode","buildURL","serializeFn","serializedParams","hashmarkIndex","InterceptorManager","fulfilled","rejected","h","transitionalDefaults","URLSearchParams$1","FormData$1","Blob$1","platform$1","URLSearchParams","FormData","Blob","hasBrowserEnv","_navigator","hasStandardBrowserEnv","hasStandardBrowserWebWorkerEnv","origin","platform","toURLEncodedForm","helpers","parsePropPath","arrayToObject","formDataToJSON","buildPath","isNumericKey","isLast","stringifySafely","rawValue","parser","defaults","headers","hasJSONContentType","isObjectPayload","_FormData","transitional","forcedJSONParsing","JSONRequested","strictJSONParsing","method","ignoreDuplicateOf","parseHeaders","rawHeaders","line","$internals","normalizeHeader","header","normalizeValue","parseTokens","tokens","tokensRE","isValidHeaderName","matchHeaderValue","isHeaderNameFilter","formatHeader","w","char","buildAccessors","accessorName","methodName","arg1","arg2","arg3","AxiosHeaders$1","valueOrRewrite","rewrite","self","setHeader","_value","_header","_rewrite","lHeader","setHeaders","dest","entry","matcher","deleteHeader","format","normalized","targets","asStrings","first","accessors","defineAccessor","AxiosHeaders","mapped","headerValue","transformData","fns","isCancel","CanceledError","settle","resolve","reject","validateStatus","parseProtocol","speedometer","samplesCount","min","timestamps","head","tail","firstSampleTS","chunkLength","now","startedAt","bytesCount","passed","throttle","freq","threshold","lastArgs","timer","invoke","progressEventReducer","listener","isDownloadStream","bytesNotified","_speedometer","loaded","total","progressBytes","rate","inRange","progressEventDecorator","throttled","lengthComputable","asyncDecorator","isURLSameOrigin","isMSIE","cookies","expires","domain","secure","cookie","isAbsoluteURL","combineURLs","baseURL","relativeURL","buildFullPath","requestedURL","allowAbsoluteUrls","isRelativeUrl","headersToObject","mergeConfig","config1","config2","getMergedValue","mergeDeepProperties","valueFromConfig2","defaultToConfig2","mergeDirectKeys","mergeMap","configValue","resolveConfig","newConfig","withXSRFToken","xsrfHeaderName","xsrfCookieName","auth","xsrfValue","isXHRAdapterSupported","xhrAdapter","_config","requestHeaders","responseType","onUploadProgress","onDownloadProgress","onCanceled","uploadThrottled","downloadThrottled","flushUpload","flushDownload","done","onloadend","responseHeaders","timeoutErrorMessage","cancel","protocol","composeSignals","signals","timeout","length","controller","aborted","onabort","reason","unsubscribe","signal","streamChunk","chunk","chunkSize","pos","end","readBytes","iterable","readStream","stream","reader","trackStream","onProgress","onFinish","_onFinish","loadedBytes","isFetchSupported","isReadableStreamSupported","encodeText","test","supportsRequestStream","duplexAccessed","hasContentType","DEFAULT_CHUNK_SIZE","supportsResponseStream","resolvers","res","_","getBodyLength","body","resolveBodyLength","fetchAdapter","cancelToken","withCredentials","fetchOptions","composedSignal","requestContentLength","_request","contentTypeHeader","flush","isCredentialsSupported","isStreamResponse","responseContentLength","responseData","knownAdapters","renderReason","isResolvedHandle","adapter","adapters","nameOrAdapter","rejectedReasons","reasons","state","s","throwIfCancellationRequested","dispatchRequest","VERSION","validators","deprecatedWarnings","validator","version","formatMessage","desc","opts","correctSpelling","assertOptions","schema","allowUnknown","Axios$1","instanceConfig","configOrUrl","dummy","paramsSerializer","contextHeaders","requestInterceptorChain","synchronousRequestInterceptors","interceptor","responseInterceptorChain","promise","chain","onFulfilled","onRejected","fullPath","Axios","generateHTTPMethod","isForm","CancelToken$1","CancelToken","executor","resolvePromise","onfulfilled","_resolve","abort","c","spread","callback","isAxiosError","HttpStatusCode","createInstance","defaultConfig","instance","axios","promises","all","Cancel","formToJSON","getAdapter","ConfigApiService","filteredSelectedToolIds","toolId","newFilteredTools","selectedLength","getToolDisplayNameWithGroup","getToolDescription","title","showAddButton","addButtonText","useGridLayout","emptyText","visible","sortBy","collapsedGroups","selectedTools","updateGroupCheckboxState","groupName","checkbox","isGroupPartiallySelected","newIds","filtered","aSelected","bSelected","groupA","groupB","groupedTools","groups","totalTools","isToolSelected","toolKey","toggleToolSelection","isChecked","getSelectedToolsInGroup","isGroupFullySelected","selectedCount","toggleGroupSelection","toolKeys","newSelected","toggleGroupCollapse","handleConfirm","handleCancel","groupNames","compatibleProps","planTypeError","titleError","availableModels","isLoadingModels","modelsLoadError","modelSearchFilters","openDropdownSteps","highlightedIndices","getSearchFilter","setSearchFilter","getFilteredModelsForStep","searchTerm","model","getModelDisplayValue","getModelPlaceholder","isModelDropdownOpenForStep","openModelDropdown","closeModelDropdown","toggleModelDropdown","selectModelForStep","modelName","handleModelSearchInput","getHighlightedIndex","setHighlightedIndex","selectFirstFilteredModel","highlightedIndex","navigateModelDown","totalItems","currentIndex","newIndex","navigateModelUp","handleClickOutside","newSteps","showToolModal","currentStepIndex","loadAvailableModels","showToolSelectionModal","sidebarStore","handleToolSelectionConfirm","selectedToolIds","handleToolsFiltered","handleCopyPlan","initializeParsedData","newData","formatTableHeader","terminateColumns","columns","col","_withKeys","AssignedTools","ToolSelectionModal","toast","useToast","sidebarWidth","isResizing","startX","startWidth","executionControllerRef","currentToolInfo","templateToolInfo","publishMcpModalRef","coordinatorToolConfig","loadCoordinatorToolConfig","handleSaveTemplate","saveResult","refreshParameterRequirements","planData","finalPlanData","finalPayload","showPublishMcpModal","showCopyPlanModal","newPlanTitle","isCopyingPlan","handleMcpServicePublished","loadAllTemplateToolInfo","handleClearExecutionParams","handleUpdateExecutionParams","closeCopyPlanModal","confirmCopyPlan","newPlan","__vitePreload","loadToolInfo","toolData","getRelativeTimeString","date","diffMs","diffMinutes","diffHours","diffDays","getTaskPreviewText","template","startResize","handleMouseMove","handleMouseUp","containerWidth","deltaPercent","newWidth","resetSidebarWidth","newPlanTemplateId","savedWidth","JsonEditorV2","JsonEditor","ExecutionController","PublishServiceModal","route","useRoute","router","useRouter","useMessage","prompt","inputOnlyContent","rightPanelRef","chatRef","sidebarRef","currentRootPlanId","leftPanelWidth","startLeftWidth","computedLeftPanelWidth","maxAvailableWidth","shouldProcessEventForCurrentPlan","freshDetails","handleInputClear","handleInputUpdateState","taskContent","handleChatSendMessage","taskToInput","handlePlanExecutionRequested","newTask","newPrompt","oldPrompt","newTaskToInput","resetPanelSize","allowSpecialIds","assistantMessage","userMessage","queryAny","_e","_f","_g","_h","_i","handleSendMessage","handleInputFocus","handleSubPlanStepSelected","parentPlanId","subPlanId","subStepIndex","handlePlanModeClicked","goBack","handleConfig","userMessageAdded","messageError","errorHandlingError","memorySelected","newChat","Sidebar","LanguageSwitcher","ChatContainer","InputArea","$i18n","RightPanel","Memory"],"ignoreList":[31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80],"sources":["../../src/api/common-api-service.ts","../../src/components/chat/composables/useMessageFormatting.ts","../../src/components/chat/UserMessage.vue","../../src/components/chat/RecursiveSubPlan.vue","../../src/components/chat/ExecutionDetails.vue","../../src/components/chat/ThinkingSection.vue","../../src/components/chat/UserInputForm.vue","../../src/components/chat/ResponseSection.vue","../../src/components/chat/AssistantMessage.vue","../../src/components/chat/ChatMessage.vue","../../src/components/chat/composables/useChatMessages.ts","../../src/components/chat/composables/useScrollBehavior.ts","../../src/utils/plan-execution-manager.ts","../../src/components/chat/ChatContainer.vue","../../src/api/coordinator-tool-api-service.ts","../../src/api/file-upload-api-service.ts","../../src/components/file-upload/FileUploadComponent.vue","../../src/stores/memory.ts","../../src/components/input/InputArea.vue","../../src/api/memory-api-service.ts","../../src/components/memory/Memory.vue","../../src/api/agent-execution.ts","../../src/api/file-browser-api-service.ts","../../src/components/file-browser/FileTreeNode.vue","../../src/components/file-browser/index.vue","../../src/components/right-panel/RightPanel.vue","../../src/api/plan-parameter-api-service.ts","../../src/components/publish-service-modal/PublishServiceModal.vue","../../src/components/sidebar/ExecutionController.vue","../../src/components/sidebar/json-editor-logic.ts","../../src/components/sidebar/JsonEditor.vue","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/bind.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/utils.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/core/AxiosError.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/null.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/toFormData.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/AxiosURLSearchParams.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/buildURL.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/core/InterceptorManager.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/defaults/transitional.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/platform/browser/classes/URLSearchParams.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/platform/browser/classes/FormData.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/platform/browser/classes/Blob.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/platform/browser/index.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/platform/common/utils.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/platform/index.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/toURLEncodedForm.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/formDataToJSON.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/defaults/index.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/parseHeaders.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/core/AxiosHeaders.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/core/transformData.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/cancel/isCancel.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/cancel/CanceledError.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/core/settle.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/parseProtocol.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/speedometer.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/throttle.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/progressEventReducer.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/isURLSameOrigin.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/cookies.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/isAbsoluteURL.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/combineURLs.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/core/buildFullPath.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/core/mergeConfig.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/resolveConfig.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/adapters/xhr.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/composeSignals.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/trackStream.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/adapters/fetch.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/adapters/adapters.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/core/dispatchRequest.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/env/data.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/validator.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/core/Axios.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/cancel/CancelToken.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/spread.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/isAxiosError.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/helpers/HttpStatusCode.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/lib/axios.js","../../node_modules/.pnpm/axios@1.9.0_debug@4.4.1/node_modules/axios/index.js","../../src/api/config-api-service.ts","../../src/components/shared/AssignedTools.vue","../../src/components/tool-selection-modal/ToolSelectionModal.vue","../../src/components/sidebar/JsonEditorV2.vue","../../src/components/sidebar/Sidebar.vue","../../src/views/direct/index.vue"],"sourcesContent":["/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Common request methods (TypeScript version, suitable for Vue projects)\n\nimport type { PlanExecutionRecordResponse } from '@/types/plan-execution-record'\n\nexport class CommonApiService {\n  private static readonly BASE_URL = '/api/executor'\n\n  // Get detailed execution records\n  public static async getDetails(planId: string): Promise<PlanExecutionRecordResponse> {\n    try {\n      const response = await fetch(`${this.BASE_URL}/details/${planId}`)\n      if (response.status === 404) {\n        // 404 returns null\n        return null\n      }\n      if (!response.ok) {\n        const errorText = await response.text()\n        throw new Error(`Failed to get detailed information: ${response.status} - ${errorText}`)\n      }\n      const rawText = await response.text()\n      const data = JSON.parse(rawText)\n\n      // Type validation - ensure the response contains required currentPlanId\n      if (data && typeof data === 'object' && !data.currentPlanId) {\n        // If currentPlanId is missing from response, add it from the parameter\n        data.currentPlanId = planId\n      }\n\n      return data\n    } catch (error: any) {\n      // Log error but don't throw exception\n      console.error('[CommonApiService] Failed to get plan details:', error)\n      // Don't return failed status for network errors - let polling continue\n      // Only return null to indicate no data available\n      return null\n    }\n  }\n\n  // Submit user form input\n  public static async submitFormInput(planId: string, formData: any): Promise<any> {\n    const response = await fetch(`${this.BASE_URL}/submit-input/${planId}`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(formData),\n    })\n    if (!response.ok) {\n      let errorData\n      try {\n        errorData = await response.json()\n      } catch {\n        errorData = { message: `Failed to submit form input: ${response.status}` }\n      }\n      throw new Error(errorData.message || `Failed to submit form input: ${response.status}`)\n    }\n    const contentType = response.headers.get('content-type')\n    if (contentType && contentType.indexOf('application/json') !== -1) {\n      return await response.json()\n    }\n    return { success: true }\n  }\n\n  /**\n   * Get all Prompt list\n   */\n  static async getAllPrompts(): Promise<any[]> {\n    try {\n      const response = await fetch(this.BASE_URL)\n      const result = await this.handleResponse(response)\n      return await result.json()\n    } catch (error) {\n      console.error('Failed to get Prompt list:', error)\n      throw error\n    }\n  }\n\n  private static async handleResponse(response: Response) {\n    if (!response.ok) {\n      try {\n        const errorData = await response.json()\n        throw new Error(errorData.message || `API request failed: ${response.status}`)\n      } catch {\n        throw new Error(`API request failed: ${response.status} ${response.statusText}`)\n      }\n    }\n    return response\n  }\n}\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { computed } from 'vue'\nimport type { ChatMessage } from './useChatMessages'\n\n/**\n * Message formatting utilities\n */\nexport function useMessageFormatting() {\n  \n  /**\n   * Format response text with markdown and code highlighting\n   */\n  const formatResponseText = (text: string): string => {\n    if (!text) return ''\n    \n    return text\n      .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\n      .replace(/\\*(.*?)\\*/g, '<em>$1</em>')\n      .replace(/`([^`]+)`/g, '<code>$1</code>')\n      .replace(/\\n/g, '<br>')\n      .replace(/```([\\s\\S]*?)```/g, '<pre><code>$1</code></pre>')\n  }\n\n  /**\n   * Format timestamp for display\n   */\n  const formatTimestamp = (timestamp: Date): string => {\n    const now = new Date()\n    const diff = now.getTime() - timestamp.getTime()\n    \n    // Less than 1 minute\n    if (diff < 60000) {\n      return 'Just now'\n    }\n    \n    // Less than 1 hour\n    if (diff < 3600000) {\n      const minutes = Math.floor(diff / 60000)\n      return `${minutes} minutes ago`\n    }\n    \n    // Less than 1 day\n    if (diff < 86400000) {\n      const hours = Math.floor(diff / 3600000)\n      return `${hours} hours ago`\n    }\n    \n    // More than 1 day\n    return timestamp.toLocaleDateString('zh-CN', {\n      month: 'short',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    })\n  }\n\n  /**\n   * Get message CSS classes\n   */\n  const getMessageClasses = (message: ChatMessage) => {\n    return computed(() => ({\n      user: message.type === 'user',\n      assistant: message.type === 'assistant',\n      streaming: message.isStreaming,\n      'has-error': !!message.error,\n      'has-thinking': !!message.thinking,\n      'has-execution': !!message.planExecution\n    }))\n  }\n\n  /**\n   * Format file size for attachments\n   */\n  const formatFileSize = (bytes: number): string => {\n    if (bytes === 0) return '0 B'\n    \n    const k = 1024\n    const sizes = ['B', 'KB', 'MB', 'GB']\n    const i = Math.floor(Math.log(bytes) / Math.log(k))\n    \n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]\n  }\n\n  /**\n   * Truncate long text with ellipsis\n   */\n  const truncateText = (text: string, maxLength: number = 100): string => {\n    if (!text || text.length <= maxLength) return text\n    return text.substring(0, maxLength) + '...'\n  }\n\n  /**\n   * Extract plain text from HTML\n   */\n  const stripHtml = (html: string): string => {\n    return html.replace(/<[^>]*>/g, '')\n  }\n\n  /**\n   * Check if message has content to display\n   */\n  const hasDisplayableContent = (message: ChatMessage): boolean => {\n    return !!(\n      message.content ||\n      (message.thinking ?? false) ||\n      (message.planExecution ?? false) ||\n      message.error\n    )\n  }\n\n  /**\n   * Get message status text\n   */\n  const getMessageStatus = (message: ChatMessage): string => {\n    if (message.error) return 'Send failed'\n    if (message.isStreaming) return 'Typing...'\n    if (message.type === 'assistant' && !message.content && !message.thinking) return 'Waiting for response'\n    return ''\n  }\n\n  return {\n    formatResponseText,\n    formatTimestamp,\n    getMessageClasses,\n    formatFileSize,\n    truncateText,\n    stripHtml,\n    hasDisplayableContent,\n    getMessageStatus\n  }\n}\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"user-message\" :data-message-id=\"message.id\">\n    <div class=\"user-content\">\n      <div class=\"message-text\">\n        {{ message.content }}\n      </div>\n      \n      <!-- Attachments if any -->\n      <div v-if=\"message.attachments?.length\" class=\"attachments\">\n        <div\n          v-for=\"(attachment, index) in message.attachments\"\n          :key=\"index\"\n          class=\"attachment-item\"\n        >\n          <Icon icon=\"carbon:document\" class=\"attachment-icon\" />\n          <span class=\"attachment-name\">{{ attachment.name }}</span>\n          <span class=\"attachment-size\">{{ formatFileSize(attachment.size) }}</span>\n        </div>\n      </div>\n      \n      <!-- Timestamp -->\n      <div class=\"message-timestamp\">\n        {{ formatTimestamp(message.timestamp) }}\n      </div>\n    </div>\n    \n    <!-- Message status indicator -->\n    <div v-if=\"message.error\" class=\"message-status error\">\n      <Icon icon=\"carbon:warning\" class=\"status-icon\" />\n      <span class=\"status-text\">{{ message.error }}</span>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { Icon } from '@iconify/vue'\nimport { useMessageFormatting } from './composables/useMessageFormatting'\nimport type { ChatMessage } from './composables/useChatMessages'\n\ninterface Props {\n  message: ChatMessage\n}\n\ndefineProps<Props>()\n\nconst { formatTimestamp, formatFileSize } = useMessageFormatting()\n</script>\n\n<style lang=\"less\" scoped>\n.user-message {\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n  margin-bottom: 16px;\n  \n  .user-content {\n    max-width: 70%;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: #ffffff;\n    padding: 12px 16px;\n    border-radius: 18px 18px 4px 18px;\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n    position: relative;\n    \n    .message-text {\n      word-wrap: break-word;\n      white-space: pre-wrap;\n      line-height: 1.5;\n      font-size: 14px;\n    }\n    \n    .attachments {\n      margin-top: 8px;\n      \n      .attachment-item {\n        display: flex;\n        align-items: center;\n        gap: 6px;\n        padding: 6px 8px;\n        background: rgba(255, 255, 255, 0.1);\n        border-radius: 8px;\n        margin-bottom: 4px;\n        font-size: 12px;\n        \n        &:last-child {\n          margin-bottom: 0;\n        }\n        \n        .attachment-icon {\n          font-size: 14px;\n          color: rgba(255, 255, 255, 0.8);\n        }\n        \n        .attachment-name {\n          flex: 1;\n          color: #ffffff;\n        }\n        \n        .attachment-size {\n          color: rgba(255, 255, 255, 0.7);\n          font-size: 11px;\n        }\n      }\n    }\n    \n    .message-timestamp {\n      margin-top: 6px;\n      font-size: 11px;\n      color: rgba(255, 255, 255, 0.7);\n      text-align: right;\n    }\n  }\n  \n  .message-status {\n    margin-top: 4px;\n    display: flex;\n    align-items: center;\n    gap: 4px;\n    font-size: 12px;\n    \n    &.error {\n      color: #ff6b6b;\n      \n      .status-icon {\n        font-size: 14px;\n      }\n    }\n  }\n}\n\n@media (max-width: 768px) {\n  .user-message {\n    .user-content {\n      max-width: 85%;\n      padding: 10px 14px;\n      border-radius: 16px 16px 4px 16px;\n      \n      .message-text {\n        font-size: 13px;\n      }\n    }\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"recursive-sub-plan\" :class=\"getNestingClass()\">\n    <!-- Sub-plan header -->\n    <div class=\"sub-plan-header\" @click=\"handleSubPlanClick\">\n      <div class=\"sub-plan-info\">\n        <Icon :icon=\"getSubPlanStatusIcon()\" class=\"sub-plan-status-icon\" />\n        <div class=\"sub-plan-details\">\n          <div class=\"sub-plan-title\">\n            {{ subPlan.title || $t('chat.subPlan') }} #{{ subPlanIndex + 1 }}\n            <span v-if=\"(nestingLevel ?? 0) > 0\" class=\"nesting-level\">(L{{ (nestingLevel ?? 0) + 1 }})</span>\n          </div>\n          <div class=\"sub-plan-id\">{{ subPlan.currentPlanId }}</div>\n        </div>\n      </div>\n      <div class=\"sub-plan-meta\">\n        <div class=\"sub-plan-status-badge\" :class=\"getSubPlanStatusClass()\">\n          {{ getSubPlanStatusText() }}\n        </div>\n        <div v-if=\"subPlan.parentActToolCall\" class=\"trigger-tool\">\n          <Icon icon=\"carbon:function\" class=\"trigger-icon\" />\n          <span class=\"trigger-text\">{{ subPlan.parentActToolCall.name }}</span>\n        </div>\n      </div>\n    </div>\n\n    <!-- Sub-plan progress -->\n    <div v-if=\"subPlan.agentExecutionSequence?.length\" class=\"sub-plan-progress\">\n      <div class=\"progress-info\">\n        <span class=\"progress-text\">\n          {{ $t('chat.progress') }}: {{ getSubPlanCompletedCount() }} / {{ subPlan.agentExecutionSequence.length }}\n        </span>\n        <div class=\"progress-bar\">\n          <div \n            class=\"progress-fill\" \n            :style=\"{ width: getSubPlanProgress() + '%' }\"\n          ></div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Sub-plan agent execution steps -->\n    <div v-if=\"subPlan.agentExecutionSequence?.length\" class=\"sub-plan-agents-steps\">\n      <div class=\"agents-steps-header\">\n        <span class=\"agents-label\">{{ $t('chat.agentExecutions') }}:</span>\n      </div>\n      <div class=\"agents-steps-list\">\n        <div\n          v-for=\"(agent, agentIndex) in subPlan.agentExecutionSequence\"\n          :key=\"agent.id || agentIndex\"\n          class=\"agent-step-item\"\n          :class=\"getAgentPreviewStatusClass(agent.status)\"\n          @click=\"handleSubPlanAgentClick(agentIndex, agent)\"\n        >\n          <div class=\"agent-step-header\">\n            <Icon :icon=\"getAgentPreviewStatusIcon(agent.status)\" class=\"agent-icon\" />\n            <span class=\"agent-name\">{{ agent.agentName || $t('chat.unknownAgent') }}</span>\n            <div class=\"agent-status-badge\" :class=\"getAgentPreviewStatusClass(agent.status)\">\n              {{ getAgentStatusText(agent.status) }}\n            </div>\n          </div>\n          \n          <!-- Agent execution info for sub-plan agents -->\n          <div class=\"sub-agent-execution-info\">\n            <!-- Agent result -->\n            <div v-if=\"agent.result\" class=\"agent-result\">\n              <div class=\"result-header\">\n                <Icon icon=\"carbon:checkmark\" class=\"result-icon\" />\n                <span class=\"result-label\">{{ $t('chat.agentResult') }}:</span>\n              </div>\n              <pre class=\"result-content\">{{ agent.result }}</pre>\n            </div>\n\n            <!-- Error message -->\n            <div v-if=\"agent.errorMessage\" class=\"agent-error\">\n              <div class=\"error-header\">\n                <Icon icon=\"carbon:warning\" class=\"error-icon\" />\n                <span class=\"error-label\">{{ $t('chat.errorMessage') }}:</span>\n              </div>\n              <pre class=\"error-content\">{{ agent.errorMessage }}</pre>\n            </div>\n\n            <!-- Think-act steps with nested sub-plans -->\n            <div v-if=\"agent.thinkActSteps?.length\" class=\"think-act-preview\">\n              <div class=\"think-act-header\">\n                <Icon icon=\"carbon:thinking\" class=\"think-act-icon\" />\n                <span class=\"think-act-label\">{{ $t('chat.thinkActSteps') }} ({{ agent.thinkActSteps.length }})</span>\n              </div>\n              <div class=\"think-act-steps-preview\">\n                <div\n                  v-for=\"(step, stepIndex) in agent.thinkActSteps.slice(0, maxVisibleSteps ?? 2)\"\n                  :key=\"step.id || stepIndex\"\n                  class=\"think-act-step-preview\"\n                  @click.stop=\"handleThinkActStepClick(agentIndex, stepIndex, agent)\"\n                >\n                  <span class=\"step-number\">#{{ stepIndex + 1 }}</span>\n                  <span class=\"step-description\">{{ step.actionDescription || $t('chat.thinking') }}</span>\n                  <Icon icon=\"carbon:arrow-right\" class=\"step-arrow\" />\n                </div>\n                <div v-if=\"agent.thinkActSteps.length > (maxVisibleSteps ?? 2)\" class=\"more-steps\">\n                  <span class=\"more-steps-text\">\n                    {{ $t('chat.andMoreSteps', { count: agent.thinkActSteps.length - (maxVisibleSteps ?? 2) }) }}\n                  </span>\n                </div>\n              </div>\n            </div>\n\n            <!-- Nested sub-plans from think-act steps -->\n            <div v-if=\"hasNestedSubPlans(agent)\" class=\"nested-sub-plans\">\n              <div class=\"nested-sub-plans-header\">\n                <Icon icon=\"carbon:tree-view-alt\" class=\"nested-icon\" />\n                <span class=\"nested-label\">{{ $t('chat.nestedSubPlans') }}</span>\n              </div>\n              <div class=\"nested-sub-plans-list\">\n                <RecursiveSubPlan\n                  v-for=\"(nestedStep, nestedStepIndex) in getNestedSubPlans(agent)\"\n                  :key=\"nestedStep.id || nestedStepIndex\"\n                  :sub-plan=\"nestedStep.subPlanExecutionRecord!\"\n                  :sub-plan-index=\"nestedStepIndex\"\n                  :nesting-level=\"(nestingLevel ?? 0) + 1\"\n                  :max-nesting-depth=\"maxNestingDepth ?? 3\"\n                  :max-visible-steps=\"maxVisibleSteps ?? 2\"\n                  @sub-plan-selected=\"handleNestedSubPlanSelected\"\n                  @step-selected=\"handleNestedStepSelected\"\n                />\n              </div>\n            </div>\n\n            <!-- Direct sub-plans from agent -->\n            <div v-if=\"agent.subPlanExecutionRecords?.length\" class=\"direct-sub-plans\">\n              <div class=\"direct-sub-plans-header\">\n                <Icon icon=\"carbon:tree-view\" class=\"direct-icon\" />\n                <span class=\"direct-label\">{{ $t('chat.directSubPlans') }}</span>\n              </div>\n              <div class=\"direct-sub-plans-list\">\n                <RecursiveSubPlan\n                  v-for=\"(directSubPlan, directIndex) in agent.subPlanExecutionRecords\"\n                  :key=\"directSubPlan.currentPlanId || directIndex\"\n                  :sub-plan=\"directSubPlan\"\n                  :sub-plan-index=\"directIndex\"\n                  :nesting-level=\"(nestingLevel ?? 0) + 1\"\n                  :max-nesting-depth=\"maxNestingDepth ?? 3\"\n                  :max-visible-steps=\"maxVisibleSteps ?? 2\"\n                  @sub-plan-selected=\"handleNestedSubPlanSelected\"\n                  @step-selected=\"handleNestedStepSelected\"\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { Icon } from '@iconify/vue'\nimport type { PlanExecutionRecord, AgentExecutionRecord, ExecutionStatus, ThinkActRecord } from '@/types/plan-execution-record'\n\ninterface Props {\n  subPlan: PlanExecutionRecord\n  subPlanIndex: number\n  nestingLevel?: number\n  maxNestingDepth?: number\n  maxVisibleSteps?: number\n}\n\ninterface Emits {\n  (e: 'sub-plan-selected', agentIndex: number, subPlanIndex: number, subPlan: PlanExecutionRecord): void\n  (e: 'step-selected', stepId: string): void\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  nestingLevel: 0,\n  maxNestingDepth: 3,\n  maxVisibleSteps: 2\n})\n\nconst emit = defineEmits<Emits>()\n\n// Initialize i18n\nconst { t } = useI18n()\n\n// Helper functions\nconst getNestingClass = (): string => {\n  return `nesting-level-${props.nestingLevel}`\n}\n\n// Sub-plan status methods\nconst getSubPlanStatusClass = (): string => {\n  if (props.subPlan.completed) {\n    return 'completed'\n  }\n  \n  const hasRunningAgent = props.subPlan.agentExecutionSequence?.some(agent => agent.status === 'RUNNING')\n  if (hasRunningAgent) {\n    return 'running'\n  }\n  \n  const hasFinishedAgent = props.subPlan.agentExecutionSequence?.some(agent => agent.status === 'FINISHED')\n  if (hasFinishedAgent) {\n    return 'in-progress'\n  }\n  \n  return 'pending'\n}\n\nconst getSubPlanStatusText = (): string => {\n  const statusClass = getSubPlanStatusClass()\n  switch (statusClass) {\n    case 'completed':\n      return t('chat.status.completed')\n    case 'running':\n      return t('chat.status.executing')\n    case 'in-progress':\n      return t('chat.status.inProgress')\n    case 'pending':\n      return t('chat.status.pending')\n    default:\n      return t('chat.status.unknown')\n  }\n}\n\nconst getSubPlanStatusIcon = (): string => {\n  const statusClass = getSubPlanStatusClass()\n  switch (statusClass) {\n    case 'completed':\n      return 'carbon:checkmark'\n    case 'running':\n      return 'carbon:play'\n    case 'in-progress':\n      return 'carbon:in-progress'\n    case 'pending':\n    default:\n      return 'carbon:dot-mark'\n  }\n}\n\nconst getSubPlanProgress = (): number => {\n  if (!props.subPlan.agentExecutionSequence?.length) return 0\n  if (props.subPlan.completed) return 100\n  \n  const completedCount = getSubPlanCompletedCount()\n  return Math.min(100, (completedCount / props.subPlan.agentExecutionSequence.length) * 100)\n}\n\nconst getSubPlanCompletedCount = (): number => {\n  if (!props.subPlan.agentExecutionSequence?.length) return 0\n  return props.subPlan.agentExecutionSequence.filter(agent => agent.status === 'FINISHED').length\n}\n\n// Agent preview status methods\nconst getAgentPreviewStatusClass = (status?: ExecutionStatus): string => {\n  switch (status) {\n    case 'FINISHED':\n      return 'completed'\n    case 'RUNNING':\n      return 'running'\n    case 'IDLE':\n    default:\n      return 'pending'\n  }\n}\n\nconst getAgentPreviewStatusIcon = (status?: ExecutionStatus): string => {\n  switch (status) {\n    case 'FINISHED':\n      return 'carbon:checkmark'\n    case 'RUNNING':\n      return 'carbon:play'\n    case 'IDLE':\n    default:\n      return 'carbon:dot-mark'\n  }\n}\n\nconst getAgentStatusText = (status?: ExecutionStatus): string => {\n  switch (status) {\n    case 'RUNNING':\n      return t('chat.status.executing')\n    case 'FINISHED':\n      return t('chat.status.completed')\n    case 'IDLE':\n    default:\n      return t('chat.status.pending')\n  }\n}\n\n// Nested sub-plans detection\nconst hasNestedSubPlans = (agent: AgentExecutionRecord): boolean => {\n  return agent.thinkActSteps?.some(step => step.subPlanExecutionRecord) ?? false\n}\n\nconst getNestedSubPlans = (agent: AgentExecutionRecord): ThinkActRecord[] => {\n  return agent.thinkActSteps?.filter(step => step.subPlanExecutionRecord) ?? []\n}\n\n// Event handlers\nconst handleSubPlanClick = () => {\n  emit('sub-plan-selected', -1, props.subPlanIndex, props.subPlan)\n}\n\nconst handleSubPlanAgentClick = (agentIndex: number, agent: AgentExecutionRecord) => {\n  const stepId = agent.stepId ?? `subplan-${props.subPlanIndex}-agent-${agentIndex}`\n  emit('step-selected', stepId)\n}\n\nconst handleThinkActStepClick = (agentIndex: number, _stepIndex: number, agent: AgentExecutionRecord) => {\n  const stepId = agent.stepId ?? `subplan-${props.subPlanIndex}-agent-${agentIndex}`\n  emit('step-selected', stepId)\n}\n\nconst handleNestedSubPlanSelected = (agentIndex: number, subPlanIndex: number, subPlan: PlanExecutionRecord) => {\n  emit('sub-plan-selected', agentIndex, subPlanIndex, subPlan)\n}\n\nconst handleNestedStepSelected = (stepId: string) => {\n  emit('step-selected', stepId)\n}\n</script>\n\n<style lang=\"less\" scoped>\n.recursive-sub-plan {\n  background: rgba(102, 126, 234, 0.05);\n  border: 1px solid rgba(102, 126, 234, 0.1);\n  border-radius: 6px;\n  padding: 12px;\n  margin-bottom: 8px;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: rgba(102, 126, 234, 0.1);\n    border-color: rgba(102, 126, 234, 0.2);\n  }\n\n  &.running {\n    border-color: rgba(102, 126, 234, 0.3);\n    background: rgba(102, 126, 234, 0.08);\n    box-shadow: 0 0 8px rgba(102, 126, 234, 0.15);\n  }\n\n  &.completed {\n    border-color: rgba(34, 197, 94, 0.3);\n    background: rgba(34, 197, 94, 0.05);\n  }\n\n  &.pending {\n    opacity: 0.7;\n  }\n\n  // Nesting level styles\n  &.nesting-level-1 {\n    margin-left: 16px;\n    border-left: 3px solid rgba(102, 126, 234, 0.3);\n  }\n\n  &.nesting-level-2 {\n    margin-left: 32px;\n    border-left: 3px solid rgba(251, 191, 36, 0.3);\n  }\n\n  &.nesting-level-3 {\n    margin-left: 48px;\n    border-left: 3px solid rgba(34, 197, 94, 0.3);\n  }\n\n  .sub-plan-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 8px;\n    cursor: pointer;\n\n    .sub-plan-info {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      flex: 1;\n\n      .sub-plan-status-icon {\n        font-size: 16px;\n\n        &.completed {\n          color: #22c55e;\n        }\n\n        &.running {\n          color: #667eea;\n        }\n\n        &.in-progress {\n          color: #fbbf24;\n        }\n\n        &.pending {\n          color: #9ca3af;\n        }\n      }\n\n      .sub-plan-details {\n        .sub-plan-title {\n          font-weight: 600;\n          color: #ffffff;\n          font-size: 13px;\n          margin-bottom: 2px;\n          display: flex;\n          align-items: center;\n          gap: 6px;\n\n          .nesting-level {\n            color: #888888;\n            font-size: 10px;\n            font-weight: 400;\n            background: rgba(136, 136, 136, 0.2);\n            padding: 1px 4px;\n            border-radius: 3px;\n          }\n        }\n\n        .sub-plan-id {\n          color: #aaaaaa;\n          font-size: 11px;\n          font-family: monospace;\n        }\n      }\n    }\n\n    .sub-plan-meta {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n\n      .trigger-tool {\n        display: flex;\n        align-items: center;\n        gap: 4px;\n        padding: 2px 6px;\n        background: rgba(102, 126, 234, 0.1);\n        border-radius: 4px;\n        font-size: 10px;\n\n        .trigger-icon {\n          font-size: 10px;\n          color: #667eea;\n        }\n\n        .trigger-text {\n          color: #cccccc;\n          font-weight: 500;\n        }\n      }\n    }\n\n    .sub-plan-status-badge {\n      padding: 2px 6px;\n      border-radius: 8px;\n      font-size: 10px;\n      font-weight: 500;\n\n      &.completed {\n        background: rgba(34, 197, 94, 0.2);\n        color: #22c55e;\n      }\n\n      &.running {\n        background: rgba(102, 126, 234, 0.2);\n        color: #667eea;\n      }\n\n      &.in-progress {\n        background: rgba(251, 191, 36, 0.2);\n        color: #fbbf24;\n      }\n\n      &.pending {\n        background: rgba(156, 163, 175, 0.2);\n        color: #9ca3af;\n      }\n    }\n  }\n\n  .sub-plan-progress {\n    margin-bottom: 8px;\n\n    .progress-info {\n      .progress-text {\n        color: #aaaaaa;\n        font-size: 10px;\n        margin-bottom: 4px;\n      }\n\n      .progress-bar {\n        background: rgba(0, 0, 0, 0.2);\n        border-radius: 4px;\n        height: 4px;\n        overflow: hidden;\n\n        .progress-fill {\n          height: 100%;\n          background: linear-gradient(90deg, #667eea, #764ba2);\n          transition: width 0.3s ease;\n          border-radius: 4px;\n        }\n      }\n    }\n  }\n\n  .sub-plan-agents-steps {\n    .agents-steps-header {\n      color: #aaaaaa;\n      font-size: 11px;\n      margin-bottom: 6px;\n      font-weight: 500;\n    }\n\n    .agents-steps-list {\n      display: flex;\n      flex-direction: column;\n      gap: 8px;\n\n      .agent-step-item {\n        border: 1px solid rgba(255, 255, 255, 0.1);\n        border-radius: 6px;\n        padding: 8px;\n        background: rgba(0, 0, 0, 0.05);\n        cursor: pointer;\n        transition: all 0.2s;\n\n        &:hover {\n          background: rgba(0, 0, 0, 0.1);\n          border-color: rgba(255, 255, 255, 0.2);\n        }\n\n        &.completed {\n          border-color: rgba(34, 197, 94, 0.3);\n          background: rgba(34, 197, 94, 0.05);\n        }\n\n        &.running {\n          border-color: rgba(102, 126, 234, 0.3);\n          background: rgba(102, 126, 234, 0.08);\n        }\n\n        &.pending {\n          opacity: 0.7;\n        }\n\n        .agent-step-header {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          margin-bottom: 8px;\n\n          .agent-icon {\n            font-size: 14px;\n\n            &.completed {\n              color: #22c55e;\n            }\n\n            &.running {\n              color: #667eea;\n            }\n\n            &.pending {\n              color: #9ca3af;\n            }\n          }\n\n          .agent-name {\n            color: #ffffff;\n            font-size: 13px;\n            font-weight: 500;\n            flex: 1;\n          }\n\n          .agent-status-badge {\n            padding: 2px 6px;\n            border-radius: 3px;\n            font-size: 10px;\n            font-weight: 500;\n\n            &.completed {\n              background: rgba(34, 197, 94, 0.2);\n              color: #22c55e;\n            }\n\n            &.running {\n              background: rgba(102, 126, 234, 0.2);\n              color: #667eea;\n            }\n\n            &.pending {\n              background: rgba(156, 163, 175, 0.2);\n              color: #9ca3af;\n            }\n          }\n        }\n\n        .sub-agent-execution-info {\n          margin-left: 22px;\n\n          .agent-result, .agent-error {\n            margin-bottom: 8px;\n\n            &:last-child {\n              margin-bottom: 0;\n            }\n\n            .result-header, .error-header {\n              display: flex;\n              align-items: center;\n              gap: 4px;\n              margin-bottom: 4px;\n\n              .result-icon, .error-icon {\n                font-size: 12px;\n              }\n\n              .result-icon {\n                color: #22c55e;\n              }\n\n              .error-icon {\n                color: #ef4444;\n              }\n\n              .result-label, .error-label {\n                color: #ffffff;\n                font-size: 11px;\n                font-weight: 500;\n              }\n            }\n\n            .result-content, .error-content {\n              margin: 0;\n              padding: 6px;\n              background: rgba(0, 0, 0, 0.2);\n              border-radius: 3px;\n              font-family: monospace;\n              font-size: 10px;\n              white-space: pre-wrap;\n              max-height: 80px;\n              overflow-y: auto;\n              color: #cccccc;\n              line-height: 1.3;\n            }\n          }\n\n          .think-act-preview {\n            margin-top: 8px;\n\n            .think-act-header {\n              display: flex;\n              align-items: center;\n              gap: 4px;\n              margin-bottom: 6px;\n\n              .think-act-icon {\n                font-size: 12px;\n                color: #667eea;\n              }\n\n              .think-act-label {\n                color: #aaaaaa;\n                font-size: 11px;\n                font-weight: 500;\n              }\n            }\n\n            .think-act-steps-preview {\n              display: flex;\n              flex-direction: column;\n              gap: 3px;\n\n              .think-act-step-preview {\n                display: flex;\n                align-items: center;\n                gap: 6px;\n                padding: 4px 6px;\n                background: rgba(0, 0, 0, 0.1);\n                border-radius: 3px;\n                cursor: pointer;\n                transition: all 0.2s;\n                font-size: 10px;\n\n                &:hover {\n                  background: rgba(0, 0, 0, 0.2);\n                }\n\n                .step-number {\n                  color: #667eea;\n                  font-weight: 500;\n                  min-width: 20px;\n                }\n\n                .step-description {\n                  color: #cccccc;\n                  flex: 1;\n                  white-space: nowrap;\n                  overflow: hidden;\n                  text-overflow: ellipsis;\n                }\n\n                .step-arrow {\n                  font-size: 10px;\n                  color: #888888;\n                }\n              }\n\n              .more-steps {\n                padding: 2px 6px;\n                color: #888888;\n                font-size: 9px;\n                font-style: italic;\n              }\n            }\n          }\n\n          .nested-sub-plans, .direct-sub-plans {\n            margin-top: 12px;\n\n            .nested-sub-plans-header, .direct-sub-plans-header {\n              display: flex;\n              align-items: center;\n              gap: 6px;\n              margin-bottom: 8px;\n\n              .nested-icon, .direct-icon {\n                font-size: 12px;\n                color: #fbbf24;\n              }\n\n              .nested-label, .direct-label {\n                color: #aaaaaa;\n                font-size: 11px;\n                font-weight: 500;\n              }\n            }\n\n            .nested-sub-plans-list, .direct-sub-plans-list {\n              display: flex;\n              flex-direction: column;\n              gap: 6px;\n            }\n          }\n        }\n      }\n    }\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"execution-details\">\n    <!-- Plan overview -->\n    <div class=\"plan-overview\" v-if=\"planExecution\">\n      <div class=\"plan-header\">\n        <h3 class=\"plan-title\">{{ planExecution.title || $t('chat.planExecution') }}</h3>\n        <div class=\"plan-status-badge\" :class=\"getPlanStatusClass()\">\n          {{ getPlanStatusText() }}\n        </div>\n      </div>\n      \n      <!-- Parent tool call information for sub-plans -->\n      <div v-if=\"planExecution.parentActToolCall\" class=\"parent-tool-call\">\n        <div class=\"parent-tool-header\">\n          <Icon icon=\"carbon:flow\" class=\"tool-icon\" />\n          <span class=\"tool-label\">{{ $t('chat.triggeredByTool') }}:</span>\n          <span class=\"tool-name\">{{ planExecution.parentActToolCall.name }}</span>\n        </div>\n        <div v-if=\"planExecution.parentActToolCall.parameters\" class=\"tool-parameters\">\n          <span class=\"param-label\">{{ $t('common.parameters') }}:</span>\n          <pre class=\"param-content\">{{ formatToolParameters(planExecution.parentActToolCall.parameters) }}</pre>\n        </div>\n      </div>\n    </div>\n\n    <!-- Agent execution sequence -->\n    <div class=\"agent-execution-container\" v-if=\"(planExecution?.agentExecutionSequence?.length ?? 0) > 0\">\n      <h4 class=\"section-title\">{{ $t('chat.agentExecutionSequence') }}</h4>\n      \n      <div\n        v-for=\"(agentExecution, agentIndex) in planExecution?.agentExecutionSequence\"\n        :key=\"agentExecution.id || agentIndex\"\n        class=\"agent-execution-item\"\n        :class=\"getAgentStatusClass(agentExecution.status)\"\n      >\n        <!-- Agent execution header -->\n        <div class=\"agent-header\" @click=\"handleAgentClick(agentExecution)\">\n          <div class=\"agent-info\">\n            <Icon :icon=\"getAgentStatusIcon(agentExecution.status)\" class=\"agent-status-icon\" />\n            <div class=\"agent-details\">\n              <div class=\"agent-name\">{{ agentExecution.agentName || $t('chat.unknownAgent') }}</div>\n              <pre class=\"request-content\">{{ agentExecution.agentRequest }}</pre>\n            </div>\n          </div>\n          <div class=\"agent-controls\">\n            <div class=\"agent-status-badge\" :class=\"getAgentStatusClass(agentExecution.status)\">\n              {{ getAgentStatusText(agentExecution.status) }}\n            </div>\n            <Icon icon=\"carbon:arrow-right\" class=\"step-select-icon\" />\n          </div>\n        </div>\n\n        <!-- Agent execution info -->\n        <div class=\"agent-execution-info\">\n          <!-- Agent result -->\n          <div v-if=\"agentExecution.result\" class=\"agent-result\">\n            <div class=\"result-header\">\n              <Icon icon=\"carbon:checkmark\" class=\"result-icon\" />\n              <span class=\"result-label\">{{ $t('chat.agentResult') }}:</span>\n            </div>\n            <pre class=\"result-content\">{{ agentExecution.result }}</pre>\n          </div>\n\n          <!-- Error message -->\n          <div v-if=\"agentExecution.errorMessage\" class=\"agent-error\">\n            <div class=\"error-header\">\n              <Icon icon=\"carbon:warning\" class=\"error-icon\" />\n              <span class=\"error-label\">{{ $t('chat.errorMessage') }}:</span>\n            </div>\n            <pre class=\"error-content\">{{ agentExecution.errorMessage }}</pre>\n          </div>\n        </div>\n\n        <!-- Sub-plan executions with nested support -->\n        <div v-if=\"agentExecution.subPlanExecutionRecords?.length\" class=\"sub-plans-container\">\n          <div class=\"sub-plans-header\">\n            <Icon icon=\"carbon:tree-view\" class=\"sub-plans-icon\" />\n            <span class=\"sub-plans-title\">\n              {{ $t('chat.subPlanExecutions') }} ({{ agentExecution.subPlanExecutionRecords.length }})\n            </span>\n          </div>\n          \n          <div class=\"sub-plans-list\">\n            <RecursiveSubPlan\n              v-for=\"(subPlan, subPlanIndex) in agentExecution.subPlanExecutionRecords\"\n              :key=\"subPlan.currentPlanId || subPlanIndex\"\n              :sub-plan=\"subPlan\"\n              :sub-plan-index=\"subPlanIndex\"\n              :nesting-level=\"0\"\n              :max-nesting-depth=\"3\"\n              :max-visible-steps=\"2\"\n              @sub-plan-selected=\"handleSubPlanClick\"\n              @step-selected=\"handleStepSelected\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n\n  </div>\n</template>\n  \n<script setup lang=\"ts\">\nimport { computed } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { Icon } from '@iconify/vue'\nimport type { PlanExecutionRecord, AgentExecutionRecord, ExecutionStatus } from '@/types/plan-execution-record'\nimport type { CompatiblePlanExecutionRecord } from './composables/useChatMessages'\nimport RecursiveSubPlan from './RecursiveSubPlan.vue'\n\ninterface Props {\n  planExecution: CompatiblePlanExecutionRecord\n}\n\ninterface Emits {\n  (e: 'sub-plan-selected', agentIndex: number, subPlanIndex: number, subPlan: PlanExecutionRecord): void\n  (e: 'step-selected', stepId: string): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n\n// Initialize i18n\nconst { t } = useI18n()\n\n// Computed properties\nconst agentExecutionSequence = computed(() => props.planExecution.agentExecutionSequence ?? [])\n\n// Agent click handler\nconst handleAgentClick = (agentExecution: AgentExecutionRecord) => {\n  if (agentExecution.stepId) {\n    emit('step-selected', agentExecution.stepId)\n  } else {\n    console.warn('[ExecutionDetails] Agent execution has no stepId:', agentExecution)\n  }\n}\n\n// Plan status methods\nconst getPlanStatusClass = (): string => {\n  if (props.planExecution.completed) {\n    return 'completed'\n  }\n  \n  const hasRunningAgent = agentExecutionSequence.value.some(agent => agent.status === 'RUNNING')\n  if (hasRunningAgent) {\n    return 'running'\n  }\n  \n  const hasFinishedAgent = agentExecutionSequence.value.some(agent => agent.status === 'FINISHED')\n  if (hasFinishedAgent) {\n    return 'in-progress'\n  }\n  \n  return 'pending'\n}\n\nconst getPlanStatusText = (): string => {\n  const statusClass = getPlanStatusClass()\n  switch (statusClass) {\n    case 'completed':\n      return t('chat.status.completed')\n    case 'running':\n      return t('chat.status.executing')\n    case 'in-progress':\n      return t('chat.status.inProgress')\n    case 'pending':\n      return t('chat.status.pending')\n    default:\n      return t('chat.status.unknown')\n  }\n}\n\n// Agent status methods\nconst getAgentStatusClass = (status?: ExecutionStatus): string => {\n  switch (status) {\n    case 'RUNNING':\n      return 'running'\n    case 'FINISHED':\n      return 'completed'\n    case 'IDLE':\n    default:\n      return 'pending'\n  }\n}\n\nconst getAgentStatusText = (status?: ExecutionStatus): string => {\n  switch (status) {\n    case 'RUNNING':\n      return t('chat.status.executing')\n    case 'FINISHED':\n      return t('chat.status.completed')\n    case 'IDLE':\n    default:\n      return t('chat.status.pending')\n  }\n}\n\nconst getAgentStatusIcon = (status?: ExecutionStatus): string => {\n  switch (status) {\n    case 'RUNNING':\n      return 'carbon:play'\n    case 'FINISHED':\n      return 'carbon:checkmark'\n    case 'IDLE':\n    default:\n      return 'carbon:dot-mark'\n  }\n}\n\n// Note: Sub-plan status methods are now handled by RecursiveSubPlan component\n\n// Note: Agent preview status methods are now handled by RecursiveSubPlan component\n\n// Event handlers\nconst handleSubPlanClick = (agentIndex: number, subPlanIndex: number, subPlan: PlanExecutionRecord) => {\n  emit('sub-plan-selected', agentIndex, subPlanIndex, subPlan)\n}\n\nconst handleStepSelected = (stepId: string) => {\n  emit('step-selected', stepId)\n}\n\n// Note: Sub-plan agent and think-act step handling is now done by RecursiveSubPlan component\n\n\n// Helper methods\n\nconst formatToolParameters = (parameters?: string): string => {\n  if (!parameters) return ''\n  \n  try {\n    const parsed = JSON.parse(parameters)\n    return JSON.stringify(parsed, null, 2)\n  } catch {\n    return parameters\n  }\n}\n\n\n\n</script>\n\n<style lang=\"less\" scoped>.execution-details {\n  // Plan overview\n  .plan-overview {\n    margin-bottom: 20px;\n    \n    .plan-header {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      margin-bottom: 12px;\n      \n      .plan-title {\n        margin: 0;\n        font-size: 16px;\n        font-weight: 600;\n        color: #ffffff;\n      }\n      \n      .plan-status-badge {\n        padding: 4px 12px;\n        border-radius: 12px;\n        font-size: 12px;\n        font-weight: 500;\n        \n        &.completed {\n          background: rgba(34, 197, 94, 0.2);\n          color: #22c55e;\n        }\n        \n        &.running {\n          background: rgba(102, 126, 234, 0.2);\n          color: #667eea;\n        }\n        \n        &.in-progress {\n          background: rgba(251, 191, 36, 0.2);\n          color: #fbbf24;\n        }\n        \n        &.pending {\n          background: rgba(156, 163, 175, 0.2);\n          color: #9ca3af;\n        }\n      }\n    }\n    \n    .parent-tool-call {\n      background: rgba(102, 126, 234, 0.1);\n      border: 1px solid rgba(102, 126, 234, 0.2);\n      border-radius: 8px;\n      padding: 12px;\n      \n      .parent-tool-header {\n        display: flex;\n        align-items: center;\n        gap: 8px;\n        margin-bottom: 8px;\n        \n        .tool-icon {\n          font-size: 16px;\n          color: #667eea;\n        }\n        \n        .tool-label {\n          color: #aaaaaa;\n          font-size: 13px;\n        }\n        \n        .tool-name {\n          color: #ffffff;\n          font-weight: 600;\n          font-size: 14px;\n        }\n      }\n      \n      .tool-parameters {\n        .param-label {\n          color: #aaaaaa;\n          font-size: 12px;\n          margin-bottom: 4px;\n          display: block;\n        }\n        \n        .param-content {\n          margin: 0;\n          padding: 8px;\n          background: rgba(0, 0, 0, 0.2);\n          border-radius: 4px;\n          font-family: monospace;\n          font-size: 11px;\n          color: #cccccc;\n          white-space: pre-wrap;\n          max-height: 120px;\n          overflow-y: auto;\n        }\n      }\n    }\n  }\n\n  // Agent execution container\n  .agent-execution-container {\n    .section-title {\n      margin: 0 0 16px 0;\n      font-size: 14px;\n      font-weight: 600;\n      color: #ffffff;\n      padding-bottom: 8px;\n      border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n    }\n    \n    .agent-execution-item {\n      margin-bottom: 16px;\n      border: 1px solid rgba(255, 255, 255, 0.1);\n      border-radius: 8px;\n      overflow: hidden;\n      transition: all 0.2s ease;\n      \n      &:last-child {\n        margin-bottom: 0;\n      }\n      \n      &.running {\n        border-color: rgba(102, 126, 234, 0.4);\n        box-shadow: 0 0 8px rgba(102, 126, 234, 0.2);\n      }\n      \n      &.completed {\n        border-color: rgba(34, 197, 94, 0.3);\n      }\n      \n      &.pending {\n        opacity: 0.8;\n      }\n      \n      .agent-header {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        padding: 12px 16px;\n        background: rgba(255, 255, 255, 0.02);\n        cursor: pointer;\n        transition: background 0.2s ease;\n        \n        &:hover {\n          background: rgba(255, 255, 255, 0.05);\n        }\n        \n        .agent-info {\n          display: flex;\n          align-items: center;\n          gap: 12px;\n          flex: 1;\n          \n          .agent-status-icon {\n            font-size: 18px;\n            \n            &.running {\n              color: #667eea;\n            }\n            \n            &.completed {\n              color: #22c55e;\n            }\n            \n            &.pending {\n              color: #9ca3af;\n            }\n          }\n          \n          .agent-details {\n            .agent-name {\n              font-weight: 600;\n              color: #ffffff;\n              font-size: 14px;\n              margin-bottom: 2px;\n            }\n            \n\n            \n            .request-content {\n              margin: 4px 0 0 0;\n              padding: 8px;\n              background: rgba(0, 0, 0, 0.2);\n              border-radius: 4px;\n              font-family: monospace;\n              font-size: 14px;\n              color: #cccccc;\n              white-space: pre-wrap;\n              word-wrap: break-word;\n              word-break: break-word;\n              overflow-wrap: break-word;\n              max-height: 120px;\n              overflow-y: auto;\n              line-height: 1.4;\n            }\n          }\n        }\n        \n        .agent-controls {\n          display: flex;\n          align-items: center;\n          gap: 12px;\n          \n          .agent-status-badge {\n            padding: 3px 8px;\n            border-radius: 10px;\n            font-size: 11px;\n            font-weight: 500;\n            \n            &.running {\n              background: rgba(102, 126, 234, 0.2);\n              color: #667eea;\n            }\n            \n            &.completed {\n              background: rgba(34, 197, 94, 0.2);\n              color: #22c55e;\n            }\n            \n            &.pending {\n              background: rgba(156, 163, 175, 0.2);\n              color: #9ca3af;\n            }\n          }\n          \n          .step-select-icon {\n            font-size: 16px;\n            color: #667eea;\n            transition: transform 0.2s ease;\n          }\n        }\n      }\n      \n      .agent-execution-info {\n        padding: 16px;\n        background: rgba(0, 0, 0, 0.1);\n        border-top: 1px solid rgba(255, 255, 255, 0.05);\n        margin-bottom: 16px;\n        \n        .agent-result, .agent-error {\n          margin-bottom: 12px;\n          \n          &:last-child {\n            margin-bottom: 0;\n          }\n          \n          .result-header, .error-header {\n            display: flex;\n            align-items: center;\n            gap: 6px;\n            margin-bottom: 6px;\n            \n            .result-icon, .error-icon {\n              font-size: 14px;\n            }\n            \n            .result-icon {\n              color: #22c55e;\n            }\n            \n            .error-icon {\n              color: #ef4444;\n            }\n            \n            .result-label, .error-label {\n              color: #ffffff;\n              font-size: 13px;\n              font-weight: 500;\n            }\n          }\n          \n          .result-content, .error-content {\n            margin: 0;\n            padding: 8px;\n            background: rgba(0, 0, 0, 0.2);\n            border-radius: 4px;\n            font-family: monospace;\n            font-size: 12px;\n            white-space: pre-wrap;\n            max-height: 150px;\n            overflow-y: auto;\n            color: #cccccc;\n          }\n          \n          .error-content {\n            color: #ff9999;\n            border: 1px solid rgba(239, 68, 68, 0.2);\n          }\n        }\n      }\n      \n      .sub-plans-container {\n        padding: 16px;\n        background: rgba(0, 0, 0, 0.1);\n        border-top: 1px solid rgba(255, 255, 255, 0.05);\n        \n        .sub-plans-header {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          margin-bottom: 12px;\n          \n          .sub-plans-icon {\n            font-size: 16px;\n            color: #667eea;\n          }\n          \n          .sub-plans-title {\n            color: #ffffff;\n            font-weight: 600;\n            font-size: 14px;\n          }\n        }\n        \n        .sub-plans-list {\n          display: flex;\n          flex-direction: column;\n          gap: 12px;\n          \n          .sub-plan-item {\n            background: rgba(102, 126, 234, 0.05);\n            border: 1px solid rgba(102, 126, 234, 0.1);\n            border-radius: 6px;\n            padding: 12px;\n            cursor: pointer;\n            transition: all 0.2s ease;\n            \n            &:hover {\n              background: rgba(102, 126, 234, 0.1);\n              border-color: rgba(102, 126, 234, 0.2);\n            }\n            \n            &.running {\n              border-color: rgba(102, 126, 234, 0.3);\n              background: rgba(102, 126, 234, 0.08);\n              box-shadow: 0 0 8px rgba(102, 126, 234, 0.15);\n            }\n            \n            &.completed {\n              border-color: rgba(34, 197, 94, 0.3);\n              background: rgba(34, 197, 94, 0.05);\n            }\n            \n            &.pending {\n              opacity: 0.7;\n            }\n            \n            .sub-plan-header {\n              display: flex;\n              align-items: center;\n              justify-content: space-between;\n              margin-bottom: 8px;\n              \n              .sub-plan-info {\n                display: flex;\n                align-items: center;\n                gap: 8px;\n                flex: 1;\n                \n                .sub-plan-status-icon {\n                  font-size: 16px;\n                  \n                  &.completed {\n                    color: #22c55e;\n                  }\n                  \n                  &.running {\n                    color: #667eea;\n                  }\n                  \n                  &.in-progress {\n                    color: #fbbf24;\n                  }\n                  \n                  &.pending {\n                    color: #9ca3af;\n                  }\n                }\n                \n                .sub-plan-details {\n                  .sub-plan-title {\n                    font-weight: 600;\n                    color: #ffffff;\n                    font-size: 13px;\n                    margin-bottom: 2px;\n                  }\n                  \n                  .sub-plan-id {\n                    color: #aaaaaa;\n                    font-size: 11px;\n                    font-family: monospace;\n                  }\n                }\n              }\n              \n              .sub-plan-meta {\n                display: flex;\n                align-items: center;\n                gap: 8px;\n                \n                .trigger-tool {\n                  display: flex;\n                  align-items: center;\n                  gap: 4px;\n                  padding: 2px 6px;\n                  background: rgba(102, 126, 234, 0.1);\n                  border-radius: 4px;\n                  font-size: 10px;\n                  \n                  .trigger-icon {\n                    font-size: 10px;\n                    color: #667eea;\n                  }\n                  \n                  .trigger-text {\n                    color: #cccccc;\n                    font-weight: 500;\n                  }\n                }\n              }\n              \n              .sub-plan-status-badge {\n                padding: 2px 6px;\n                border-radius: 8px;\n                font-size: 10px;\n                font-weight: 500;\n                \n                &.completed {\n                  background: rgba(34, 197, 94, 0.2);\n                  color: #22c55e;\n                }\n                \n                &.running {\n                  background: rgba(102, 126, 234, 0.2);\n                  color: #667eea;\n                }\n                \n                &.in-progress {\n                  background: rgba(251, 191, 36, 0.2);\n                  color: #fbbf24;\n                }\n                \n                &.pending {\n                  background: rgba(156, 163, 175, 0.2);\n                  color: #9ca3af;\n                }\n              }\n            }\n            \n            .sub-plan-progress {\n              margin-bottom: 8px;\n              \n              .progress-info {\n                .progress-text {\n                  color: #aaaaaa;\n                  font-size: 10px;\n                  margin-bottom: 4px;\n                }\n                \n                .progress-bar {\n                  background: rgba(0, 0, 0, 0.2);\n                  border-radius: 4px;\n                  height: 4px;\n                  overflow: hidden;\n                  \n                  .progress-fill {\n                    height: 100%;\n                    background: linear-gradient(90deg, #667eea, #764ba2);\n                    transition: width 0.3s ease;\n                    border-radius: 4px;\n                  }\n                }\n              }\n            }\n            \n            .sub-plan-agents-steps {\n              .agents-steps-header {\n                color: #aaaaaa;\n                font-size: 11px;\n                margin-bottom: 6px;\n                font-weight: 500;\n              }\n              \n              .agents-steps-list {\n                display: flex;\n                flex-direction: column;\n                gap: 8px;\n                \n                .agent-step-item {\n                  border: 1px solid rgba(255, 255, 255, 0.1);\n                  border-radius: 6px;\n                  padding: 8px;\n                  background: rgba(0, 0, 0, 0.05);\n                  cursor: pointer;\n                  transition: all 0.2s;\n                  \n                  &:hover {\n                    background: rgba(0, 0, 0, 0.1);\n                    border-color: rgba(255, 255, 255, 0.2);\n                  }\n                  \n                  &.completed {\n                    border-color: rgba(34, 197, 94, 0.3);\n                    background: rgba(34, 197, 94, 0.05);\n                  }\n                  \n                  &.running {\n                    border-color: rgba(102, 126, 234, 0.3);\n                    background: rgba(102, 126, 234, 0.08);\n                  }\n                  \n                  &.pending {\n                    opacity: 0.7;\n                  }\n                  \n                  .agent-step-header {\n                    display: flex;\n                    align-items: center;\n                    gap: 8px;\n                    margin-bottom: 8px;\n                    \n                    .agent-icon {\n                      font-size: 14px;\n                      \n                      &.completed {\n                        color: #22c55e;\n                      }\n                      \n                      &.running {\n                        color: #667eea;\n                      }\n                      \n                      &.pending {\n                        color: #9ca3af;\n                      }\n                    }\n                    \n                    .agent-name {\n                      color: #ffffff;\n                      font-size: 13px;\n                      font-weight: 500;\n                      flex: 1;\n                    }\n                    \n                    .agent-status-badge {\n                      padding: 2px 6px;\n                      border-radius: 3px;\n                      font-size: 10px;\n                      font-weight: 500;\n                      \n                      &.completed {\n                        background: rgba(34, 197, 94, 0.2);\n                        color: #22c55e;\n                      }\n                      \n                      &.running {\n                        background: rgba(102, 126, 234, 0.2);\n                        color: #667eea;\n                      }\n                      \n                      &.pending {\n                        background: rgba(156, 163, 175, 0.2);\n                        color: #9ca3af;\n                      }\n                    }\n                  }\n                  \n                  .sub-agent-execution-info {\n                    margin-left: 22px;\n                    \n                    .agent-result, .agent-error {\n                      margin-bottom: 8px;\n                      \n                      &:last-child {\n                        margin-bottom: 0;\n                      }\n                      \n                      .result-header, .error-header {\n                        display: flex;\n                        align-items: center;\n                        gap: 4px;\n                        margin-bottom: 4px;\n                        \n                        .result-icon, .error-icon {\n                          font-size: 12px;\n                        }\n                        \n                        .result-icon {\n                          color: #22c55e;\n                        }\n                        \n                        .error-icon {\n                          color: #ef4444;\n                        }\n                        \n                        .result-label, .error-label {\n                          color: #ffffff;\n                          font-size: 11px;\n                          font-weight: 500;\n                        }\n                      }\n                      \n                      .result-content, .error-content {\n                        margin: 0;\n                        padding: 6px;\n                        background: rgba(0, 0, 0, 0.2);\n                        border-radius: 3px;\n                        font-family: monospace;\n                        font-size: 10px;\n                        white-space: pre-wrap;\n                        max-height: 80px;\n                        overflow-y: auto;\n                        color: #cccccc;\n                        line-height: 1.3;\n                      }\n                    }\n                    \n                    .think-act-preview {\n                      margin-top: 8px;\n                      \n                      .think-act-header {\n                        display: flex;\n                        align-items: center;\n                        gap: 4px;\n                        margin-bottom: 6px;\n                        \n                        .think-act-icon {\n                          font-size: 12px;\n                          color: #667eea;\n                        }\n                        \n                        .think-act-label {\n                          color: #aaaaaa;\n                          font-size: 11px;\n                          font-weight: 500;\n                        }\n                      }\n                      \n                      .think-act-steps-preview {\n                        display: flex;\n                        flex-direction: column;\n                        gap: 3px;\n                        \n                        .think-act-step-preview {\n                          display: flex;\n                          align-items: center;\n                          gap: 6px;\n                          padding: 4px 6px;\n                          background: rgba(0, 0, 0, 0.1);\n                          border-radius: 3px;\n                          cursor: pointer;\n                          transition: all 0.2s;\n                          font-size: 10px;\n                          \n                          &:hover {\n                            background: rgba(0, 0, 0, 0.2);\n                          }\n                          \n                          .step-number {\n                            color: #667eea;\n                            font-weight: 500;\n                            min-width: 20px;\n                          }\n                          \n                          .step-description {\n                            color: #cccccc;\n                            flex: 1;\n                            white-space: nowrap;\n                            overflow: hidden;\n                            text-overflow: ellipsis;\n                          }\n                          \n                          .step-arrow {\n                            font-size: 10px;\n                            color: #888888;\n                          }\n                        }\n                        \n                        .more-steps {\n                          padding: 2px 6px;\n                          color: #888888;\n                          font-size: 9px;\n                          font-style: italic;\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n\n}\n</style>\n\n\n\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"thinking-section\" v-if=\"shouldShowThinking\">\n    <div class=\"thinking-header\">\n      <div class=\"thinking-avatar\">\n        <Icon icon=\"carbon:thinking\" class=\"thinking-icon\" />\n      </div>\n      <div class=\"thinking-label\">{{ $t('chat.thinkingLabel') }}</div>\n    </div>\n\n    <div class=\"thinking-content\">\n      <!-- Basic thinking state -->\n      <div v-if=\"thinking\" class=\"thinking\">\n        <Icon icon=\"carbon:thinking\" class=\"thinking-icon\" />\n        <span>{{ thinking }}</span>\n      </div>\n\n      <!-- Execution Details Component -->\n      <ExecutionDetails\n        v-if=\"thinkingDetails || planExecution\"\n        :plan-execution=\"(thinkingDetails || planExecution)!\"\n        :step-actions=\"stepActions || []\"\n        :generic-input=\"genericInput || ''\"\n        @agent-selected=\"handleAgentSelected\"\n        @sub-plan-selected=\"handleSubPlanSelected\"\n        @user-input-submitted=\"handleUserInputSubmit\"\n        @step-selected=\"handleStepSelected\"\n      />\n\n      <!-- Display the default processing state only when there is no final content -->\n      <div\n        v-else-if=\"!hasContent && thinking\"\n        class=\"default-processing\"\n      >\n        <div class=\"processing-indicator\">\n          <div class=\"thinking-dots\">\n            <span></span>\n            <span></span>\n            <span></span>\n          </div>\n          <span>{{ thinking || $t('chat.thinkingProcessing') }}</span>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed } from 'vue'\nimport { Icon } from '@iconify/vue'\nimport ExecutionDetails from './ExecutionDetails.vue'\nimport type { PlanExecutionRecord, AgentExecutionRecord } from '@/types/plan-execution-record'\nimport type { CompatiblePlanExecutionRecord } from './composables/useChatMessages'\n\ninterface Props {\n  thinking?: string\n  thinkingDetails?: CompatiblePlanExecutionRecord\n  planExecution?: CompatiblePlanExecutionRecord\n  stepActions?: any[]\n  genericInput?: string\n  hasContent?: boolean\n}\n\ninterface Emits {\n  (e: 'agent-selected', agentIndex: number, agent: AgentExecutionRecord): void\n  (e: 'sub-plan-selected', agentIndex: number, subPlanIndex: number, subPlan: PlanExecutionRecord): void\n  (e: 'user-input-submitted', inputData: any): void\n  (e: 'step-selected', stepId: string): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n\n// Computed properties\nconst shouldShowThinking = computed(() => {\n  return (props.thinking ?? false) || \n         (props.thinkingDetails?.agentExecutionSequence?.length ?? 0) > 0 ||\n         (props.planExecution?.agentExecutionSequence?.length ?? 0) > 0\n})\n\n// Event handlers\nconst handleAgentSelected = (agentIndex: number, agent: AgentExecutionRecord) => {\n  emit('agent-selected', agentIndex, agent)\n}\n\nconst handleSubPlanSelected = (agentIndex: number, subPlanIndex: number, subPlan: PlanExecutionRecord) => {\n  emit('sub-plan-selected', agentIndex, subPlanIndex, subPlan)\n}\n\nconst handleUserInputSubmit = (inputData: any) => {\n  emit('user-input-submitted', inputData)\n}\n\nconst handleStepSelected = (stepId: string) => {\n  emit('step-selected', stepId)\n}\n</script>\n\n<style lang=\"less\" scoped>\n.thinking-section {\n  margin-bottom: 16px;\n  border: 1px solid rgba(102, 126, 234, 0.2);\n  border-radius: 12px;\n  background: rgba(102, 126, 234, 0.05);\n  overflow: hidden;\n  \n  .thinking-header {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding: 12px 16px;\n    background: rgba(102, 126, 234, 0.1);\n    border-bottom: 1px solid rgba(102, 126, 234, 0.15);\n    \n    .thinking-avatar {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      width: 32px;\n      height: 32px;\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      border-radius: 50%;\n      \n      .thinking-icon {\n        font-size: 16px;\n        color: #ffffff;\n      }\n    }\n    \n    .thinking-label {\n      font-weight: 600;\n      color: #ffffff;\n      font-size: 14px;\n    }\n  }\n  \n  .thinking-content {\n    padding: 16px;\n    \n    .thinking {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      margin-bottom: 12px;\n      padding: 8px 12px;\n      background: rgba(102, 126, 234, 0.1);\n      border-radius: 8px;\n      font-size: 13px;\n      color: #ffffff;\n      \n      .thinking-icon {\n        font-size: 14px;\n        color: #667eea;\n        flex-shrink: 0;\n      }\n      \n      span {\n        line-height: 1.4;\n      }\n    }\n    \n    .default-processing {\n      .processing-indicator {\n        display: flex;\n        align-items: center;\n        gap: 12px;\n        padding: 16px;\n        color: #aaaaaa;\n        font-size: 14px;\n        \n        .thinking-dots {\n          display: flex;\n          gap: 4px;\n          \n          span {\n            width: 6px;\n            height: 6px;\n            background: #667eea;\n            border-radius: 50%;\n            animation: thinking-pulse 1.5s ease-in-out infinite;\n            \n            &:nth-child(1) {\n              animation-delay: 0s;\n            }\n            \n            &:nth-child(2) {\n              animation-delay: 0.2s;\n            }\n            \n            &:nth-child(3) {\n              animation-delay: 0.4s;\n            }\n          }\n        }\n      }\n    }\n  }\n}\n\n@keyframes thinking-pulse {\n  0%, 80%, 100% {\n    opacity: 0.3;\n    transform: scale(1);\n  }\n  40% {\n    opacity: 1;\n    transform: scale(1.2);\n  }\n}\n\n@media (max-width: 768px) {\n  .thinking-section {\n    .thinking-header {\n      padding: 10px 14px;\n      \n      .thinking-avatar {\n        width: 28px;\n        height: 28px;\n        \n        .thinking-icon {\n          font-size: 14px;\n        }\n      }\n      \n      .thinking-label {\n        font-size: 13px;\n      }\n    }\n    \n    .thinking-content {\n      padding: 14px;\n      \n      .thinking {\n        padding: 6px 10px;\n        font-size: 12px;\n      }\n    }\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"user-input-form-container\">\n    <div class=\"user-input-header\">\n      <Icon icon=\"carbon:user\" class=\"user-icon\" />\n      <h4 class=\"user-input-title\">{{ $t('chat.userInputRequired') }}</h4>\n    </div>\n    \n    <p class=\"user-input-message\">\n      {{ userInputWaitState?.title ?? $t('chat.userInput.message') }}\n    </p>\n    \n    <p v-if=\"userInputWaitState?.formDescription\" class=\"form-description\">\n      {{ userInputWaitState?.formDescription }}\n    </p>\n\n    <form @submit.prevent=\"handleUserInputSubmit\" class=\"user-input-form\">\n      <template\n        v-if=\"userInputWaitState?.formInputs && userInputWaitState.formInputs.length > 0\"\n      >\n        <div class=\"form-grid\">\n          <div\n            v-for=\"(input, inputIndex) in userInputWaitState?.formInputs\"\n            :key=\"inputIndex\"\n            class=\"form-group\"\n          >\n            <label :for=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\">\n              {{ input.label }}{{ isRequired(input.required) ? ' *' : '' }}:\n            </label>\n\n            <!-- Form input types -->\n            <input\n              v-if=\"!input.type || input.type === 'text'\"\n              type=\"text\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :placeholder=\"input.placeholder || ''\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input\"\n            />\n\n            <input\n              v-else-if=\"input.type === 'email'\"\n              type=\"email\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :placeholder=\"input.placeholder || ''\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input\"\n            />\n\n            <input\n              v-else-if=\"input.type === 'number'\"\n              type=\"number\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :placeholder=\"input.placeholder || ''\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input\"\n            />\n\n            <input\n              v-else-if=\"input.type === 'password'\"\n              type=\"password\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :placeholder=\"input.placeholder || ''\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input\"\n            />\n\n            <textarea\n              v-else-if=\"input.type === 'textarea'\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :placeholder=\"input.placeholder || ''\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input form-textarea\"\n              rows=\"4\"\n            ></textarea>\n\n            <select\n              v-else-if=\"input.type === 'select' && input.options\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input form-select\"\n            >\n              <option value=\"\">{{ $t('selectCommon.pleaseSelect') }}</option>\n              <option\n                v-for=\"option in getOptionsArray(input.options)\"\n                :key=\"option\"\n                :value=\"option\"\n              >\n                {{ option }}\n              </option>\n            </select>\n\n            <div\n              v-else-if=\"input.type === 'checkbox' && input.options\"\n              class=\"checkbox-group\"\n            >\n              <label\n                v-for=\"option in getOptionsArray(input.options)\"\n                :key=\"option\"\n                class=\"checkbox-item\"\n              >\n                <input\n                  type=\"checkbox\"\n                  :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}-${option.replace(/\\W+/g, '_')}`\"\n                  :name=\"input.label\"\n                  :value=\"option\"\n                  v-model=\"formInputsStore[inputIndex]\"\n                  class=\"form-checkbox\"\n                />\n                <span class=\"checkbox-label\">{{ option }}</span>\n              </label>\n            </div>\n\n            <div\n              v-else-if=\"input.type === 'radio' && input.options\"\n              class=\"radio-group\"\n            >\n              <label\n                v-for=\"option in getOptionsArray(input.options)\"\n                :key=\"option\"\n                class=\"radio-item\"\n              >\n                <input\n                  type=\"radio\"\n                  :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}-${option.replace(/\\W+/g, '_')}`\"\n                  :name=\"input.label\"\n                  :value=\"option\"\n                  v-model=\"formInputsStore[inputIndex]\"\n                  class=\"form-radio\"\n                />\n                <span class=\"radio-label\">{{ option }}</span>\n              </label>\n            </div>\n\n            <input\n              v-else\n              type=\"text\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :placeholder=\"input.placeholder || ''\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input\"\n            />\n          </div>\n        </div>\n      </template>\n\n      <template v-else>\n        <div class=\"form-group\">\n          <label for=\"form-input-genericInput\">{{ $t('common.input') }}:</label>\n          <input\n            type=\"text\"\n            id=\"form-input-genericInput\"\n            name=\"genericInput\"\n            v-model=\"genericInput\"\n            class=\"form-input\"\n          />\n        </div>\n      </template>\n\n      <button type=\"submit\" class=\"submit-user-input-btn\">\n        {{ $t('chat.userInput.submit') }}\n      </button>\n    </form>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, reactive, watch, onMounted, onUnmounted } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { Icon } from '@iconify/vue'\nimport { CommonApiService } from '@/api/common-api-service'\nimport type { UserInputWaitState } from '@/types/plan-execution-record'\n\ninterface Props {\n  userInputWaitState?: UserInputWaitState\n  planId?: string\n  genericInput?: string\n}\n\ninterface Emits {\n  (e: 'user-input-submitted', inputData: any): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n\n// Initialize i18n\nuseI18n()\n\n// Local state\nconst formInputsStore = reactive<Record<number, string | string[]>>({})\nconst genericInput = ref(props.genericInput ?? '')\nconst isInitialized = ref(false)\nconst initializationTimeout = ref<ReturnType<typeof setTimeout> | null>(null)\n\n// Initialize form inputs based on type\nconst initializeFormInputs = () => {\n  const formInputs = props.userInputWaitState?.formInputs\n  if (formInputs && formInputs.length > 0) {\n    // Only initialize if not already initialized or if form structure changed\n    const needsInitialization = !isInitialized.value || \n      Object.keys(formInputsStore).length !== formInputs.length\n    \n    if (needsInitialization) {\n      formInputs.forEach((input, index) => {\n        // Only initialize if this field doesn't exist or is empty\n        if (!(index in formInputsStore) || \n            (input.type === 'checkbox' && !Array.isArray(formInputsStore[index])) ||\n            (input.type !== 'checkbox' && formInputsStore[index] === '')) {\n          \n          if (input.type === 'checkbox') {\n            formInputsStore[index] = []\n          } else {\n            formInputsStore[index] = ''\n          }\n        }\n      })\n      isInitialized.value = true\n    }\n  }\n}\n\n// Initialize on mount and when formInputs change\nonMounted(() => {\n  initializeFormInputs()\n})\n\nwatch(() => props.userInputWaitState?.formInputs, () => {\n  // Clear any existing timeout\n  if (initializationTimeout.value) {\n    clearTimeout(initializationTimeout.value)\n  }\n  \n  // Debounce initialization to avoid frequent resets\n  initializationTimeout.value = setTimeout(() => {\n    // Reset initialization flag when form structure changes\n    isInitialized.value = false\n    initializeFormInputs()\n  }, 100) // 100ms debounce\n}, { deep: true })\n\n// Event handlers\nconst handleUserInputSubmit = async () => {\n  try {\n    const inputData: any = {}\n\n    const formInputs = props.userInputWaitState?.formInputs\n    if (formInputs && formInputs.length > 0) {\n      Object.entries(formInputsStore).forEach(([index, value]) => {\n        const numIndex = parseInt(index, 10)\n        const input = formInputs[numIndex]\n        const label = input.label || `input_${index}`\n        // Handle checkbox arrays - convert to string if it's an array\n        if (Array.isArray(value)) {\n          inputData[label] = value.join(', ')\n        } else {\n          inputData[label] = value\n        }\n      })\n    } else {\n      inputData.genericInput = genericInput.value\n    }\n\n    console.log('[UserInputForm] Submitting user input:', inputData, 'for planId:', props.planId)\n\n    // Submit user input to backend API\n    if (props.planId) {\n      await CommonApiService.submitFormInput(props.planId, inputData)\n      console.log('[UserInputForm] User input submitted successfully')\n    } else {\n      console.error('[UserInputForm] No planId available for user input submission')\n    }\n\n    emit('user-input-submitted', inputData)\n  } catch (error: any) {\n    console.error('[UserInputForm] User input submission failed:', error)\n  }\n}\n\n// Helper methods\nconst getOptionsArray = (options: string | string[] | undefined): string[] => {\n  if (!options) return []\n  if (Array.isArray(options)) return options\n  if (typeof options === 'string') {\n    return options.split(',').map(opt => opt.trim()).filter(opt => opt.length > 0)\n  }\n  return []\n}\n\nconst isRequired = (required: boolean | string | undefined): boolean => {\n  if (typeof required === 'boolean') return required\n  if (typeof required === 'string') return required === 'true'\n  return false\n}\n\n// Cleanup on unmount\nonUnmounted(() => {\n  if (initializationTimeout.value) {\n    clearTimeout(initializationTimeout.value)\n  }\n})\n</script>\n\n<style lang=\"less\" scoped>\n.user-input-form-container {\n  margin-top: 20px;\n  padding: 16px;\n  background: rgba(102, 126, 234, 0.1);\n  border: 1px solid rgba(102, 126, 234, 0.2);\n  border-radius: 8px;\n  \n  .user-input-header {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    margin-bottom: 12px;\n    \n    .user-icon {\n      font-size: 16px;\n      color: #667eea;\n    }\n    \n    .user-input-title {\n      margin: 0;\n      color: #ffffff;\n      font-size: 14px;\n      font-weight: 600;\n    }\n  }\n  \n  .user-input-message {\n    margin-bottom: 12px;\n    font-weight: 500;\n    color: #ffffff;\n    font-size: 14px;\n  }\n  \n  .form-description {\n    margin-bottom: 16px;\n    color: #aaaaaa;\n    font-size: 13px;\n    line-height: 1.4;\n  }\n  \n  .user-input-form {\n    .form-grid {\n      display: flex;\n      flex-direction: column;\n      gap: 16px;\n      margin-bottom: 16px;\n      \n      @media (max-width: 768px) {\n        gap: 12px;\n      }\n    }\n    \n    .form-group {\n      display: flex;\n      flex-direction: column;\n      gap: 4px;\n      \n      label {\n        font-size: 13px;\n        font-weight: 500;\n        color: #ffffff;\n      }\n      \n      .form-input {\n        padding: 8px 12px;\n        background: rgba(0, 0, 0, 0.3);\n        border: 1px solid rgba(255, 255, 255, 0.2);\n        border-radius: 6px;\n        color: #ffffff;\n        font-size: 14px;\n        transition: border-color 0.2s ease;\n        \n        &:focus {\n          outline: none;\n          border-color: #667eea;\n          box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n        }\n        \n        &::placeholder {\n          color: #888888;\n        }\n      }\n      \n      .form-textarea {\n        resize: vertical;\n        min-height: 60px;\n        font-family: inherit;\n      }\n      \n      .form-select {\n        cursor: pointer;\n        \n        option {\n          background: #2d3748;\n          color: #ffffff;\n        }\n      }\n      \n      .checkbox-group,\n      .radio-group {\n        display: flex;\n        flex-direction: column;\n        gap: 8px;\n        \n        .checkbox-item,\n        .radio-item {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          cursor: pointer;\n          padding: 4px 0;\n          \n          .form-checkbox,\n          .form-radio {\n            width: 16px;\n            height: 16px;\n            margin: 0;\n            cursor: pointer;\n            accent-color: #667eea;\n          }\n          \n          .checkbox-label,\n          .radio-label {\n            color: #ffffff;\n            font-size: 14px;\n            user-select: none;\n          }\n        }\n      }\n    }\n    \n    .submit-user-input-btn {\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      color: #ffffff;\n      border: none;\n      padding: 10px 20px;\n      border-radius: 6px;\n      font-size: 14px;\n      font-weight: 500;\n      cursor: pointer;\n      transition: all 0.2s ease;\n      \n      &:hover {\n        transform: translateY(-1px);\n        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);\n      }\n      \n      &:active {\n        transform: translateY(0);\n      }\n    }\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"response-section\">\n    <div class=\"response-header\">\n      <div class=\"response-avatar\">\n        <Icon icon=\"carbon:bot\" class=\"bot-icon\" />\n      </div>\n      <div class=\"response-name\">{{ $t('chat.botName') }}</div>\n      \n      <!-- Response timestamp -->\n      <div v-if=\"timestamp\" class=\"response-timestamp\">\n        {{ formatTimestamp(timestamp) }}\n      </div>\n    </div>\n    \n    <div class=\"response-content\">\n      <!-- User input form -->\n      <UserInputForm\n        v-if=\"userInputWaitState?.waiting\"\n        :user-input-wait-state=\"userInputWaitState\"\n        v-bind=\"planId ? { 'plan-id': planId } : {}\"\n        :generic-input=\"genericInput ?? ''\"\n        @user-input-submitted=\"handleUserInputSubmitted\"\n      />\n      \n      <!-- Final response with content -->\n      <div v-if=\"content\" class=\"final-response\">\n        <div class=\"response-text\" v-html=\"formatResponseText(content)\"></div>\n        \n        <!-- Response actions -->\n        <div class=\"response-actions\">\n          <button\n            class=\"action-btn copy-btn\"\n            @click=\"copyToClipboard\"\n            :title=\"$t('chat.copyResponse')\"\n          >\n            <Icon icon=\"carbon:copy\" />\n          </button>\n          \n          <button\n            class=\"action-btn regenerate-btn\"\n            @click=\"handleRegenerate\"\n            :title=\"$t('chat.regenerateResponse')\"\n          >\n            <Icon icon=\"carbon:renew\" />\n          </button>\n        </div>\n      </div>\n      \n      <!-- Loading/streaming state -->\n      <div v-else-if=\"isStreaming\" class=\"response-placeholder\">\n        <div class=\"typing-indicator\">\n          <div class=\"typing-dots\">\n            <span></span>\n            <span></span>\n            <span></span>\n          </div>\n          <span class=\"typing-text\">{{ $t('chat.thinkingResponse') }}</span>\n        </div>\n      </div>\n      \n      <!-- Error state -->\n      <div v-else-if=\"error\" class=\"response-error\">\n        <Icon icon=\"carbon:warning\" class=\"error-icon\" />\n        <span class=\"error-text\">{{ error }}</span>\n        <button class=\"retry-btn\" @click=\"handleRetry\">\n          {{ $t('chat.retry') }}\n        </button>\n      </div>\n      \n      <!-- Empty state -->\n      <div v-else class=\"response-empty\">\n        <span class=\"empty-text\">{{ $t('chat.waitingForResponse') }}</span>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { Icon } from '@iconify/vue'\nimport { useMessageFormatting } from './composables/useMessageFormatting'\nimport UserInputForm from './UserInputForm.vue'\nimport type { UserInputWaitState } from '@/types/plan-execution-record'\n\ninterface Props {\n  content?: string\n  isStreaming?: boolean\n  error?: string\n  timestamp?: Date\n  userInputWaitState?: UserInputWaitState\n  planId?: string\n  genericInput?: string\n}\n\ninterface Emits {\n  (e: 'copy'): void\n  (e: 'regenerate'): void\n  (e: 'retry'): void\n  (e: 'user-input-submitted', inputData: any): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n\nconst { formatResponseText, formatTimestamp } = useMessageFormatting()\n\n// Methods\nconst copyToClipboard = async () => {\n  if (!props.content) return\n  \n  try {\n    // Strip HTML tags for clipboard\n    const plainText = props.content.replace(/<[^>]*>/g, '')\n    await navigator.clipboard.writeText(plainText)\n    emit('copy')\n  } catch (error) {\n    console.error('Failed to copy to clipboard:', error)\n  }\n}\n\nconst handleRegenerate = () => {\n  emit('regenerate')\n}\n\nconst handleRetry = () => {\n  emit('retry')\n}\n\nconst handleUserInputSubmitted = (inputData: any) => {\n  console.log('[ResponseSection] User input submitted:', inputData)\n  emit('user-input-submitted', inputData)\n}\n</script>\n\n<style lang=\"less\" scoped>\n.response-section {\n  .response-header {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n    margin-bottom: 12px;\n    \n    .response-avatar {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      width: 32px;\n      height: 32px;\n      background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);\n      border-radius: 50%;\n      flex-shrink: 0;\n      \n      .bot-icon {\n        font-size: 16px;\n        color: #ffffff;\n      }\n    }\n    \n    .response-name {\n      font-weight: 600;\n      color: #ffffff;\n      font-size: 14px;\n      flex: 1;\n    }\n    \n    .response-timestamp {\n      font-size: 11px;\n      color: #aaaaaa;\n    }\n  }\n  \n  .response-content {\n    .final-response {\n      position: relative;\n      \n      .response-text {\n        background: rgba(255, 255, 255, 0.05);\n        border: 1px solid rgba(255, 255, 255, 0.1);\n        border-radius: 12px;\n        padding: 16px;\n        color: #ffffff;\n        line-height: 1.6;\n        font-size: 14px;\n        \n        :deep(strong) {\n          font-weight: 600;\n          color: #ffffff;\n        }\n        \n        :deep(em) {\n          font-style: italic;\n          color: #cccccc;\n        }\n        \n        :deep(code) {\n          background: rgba(0, 0, 0, 0.3);\n          padding: 2px 6px;\n          border-radius: 4px;\n          font-family: 'Monaco', 'Menlo', monospace;\n          font-size: 13px;\n          color: #8be9fd;\n        }\n        \n        :deep(pre) {\n          background: rgba(0, 0, 0, 0.4);\n          padding: 12px;\n          border-radius: 8px;\n          overflow-x: auto;\n          margin: 8px 0;\n          \n          code {\n            background: none;\n            padding: 0;\n            color: #f8f8f2;\n            font-size: 12px;\n          }\n        }\n      }\n      \n      .response-actions {\n        display: flex;\n        gap: 8px;\n        margin-top: 8px;\n        opacity: 0;\n        transition: opacity 0.2s ease;\n        \n        .action-btn {\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          width: 28px;\n          height: 28px;\n          background: rgba(255, 255, 255, 0.1);\n          border: none;\n          border-radius: 6px;\n          color: #aaaaaa;\n          cursor: pointer;\n          transition: all 0.2s ease;\n          \n          &:hover {\n            background: rgba(255, 255, 255, 0.2);\n            color: #ffffff;\n          }\n          \n          svg {\n            font-size: 14px;\n          }\n        }\n      }\n      \n      &:hover .response-actions {\n        opacity: 1;\n      }\n    }\n    \n    .response-placeholder {\n      .typing-indicator {\n        display: flex;\n        align-items: center;\n        gap: 12px;\n        padding: 16px;\n        color: #aaaaaa;\n        font-size: 14px;\n        \n        .typing-dots {\n          display: flex;\n          gap: 4px;\n          \n          span {\n            width: 6px;\n            height: 6px;\n            background: #4f46e5;\n            border-radius: 50%;\n            animation: typing-pulse 1.5s ease-in-out infinite;\n            \n            &:nth-child(1) {\n              animation-delay: 0s;\n            }\n            \n            &:nth-child(2) {\n              animation-delay: 0.2s;\n            }\n            \n            &:nth-child(3) {\n              animation-delay: 0.4s;\n            }\n          }\n        }\n        \n        .typing-text {\n          font-style: italic;\n        }\n      }\n    }\n    \n    .response-error {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      padding: 12px 16px;\n      background: rgba(239, 68, 68, 0.1);\n      border: 1px solid rgba(239, 68, 68, 0.2);\n      border-radius: 8px;\n      color: #ff9999;\n      font-size: 13px;\n      \n      .error-icon {\n        font-size: 16px;\n        color: #ef4444;\n        flex-shrink: 0;\n      }\n      \n      .error-text {\n        flex: 1;\n      }\n      \n      .retry-btn {\n        background: rgba(239, 68, 68, 0.2);\n        border: none;\n        padding: 4px 8px;\n        border-radius: 4px;\n        color: #ffffff;\n        font-size: 12px;\n        cursor: pointer;\n        transition: background 0.2s ease;\n        \n        &:hover {\n          background: rgba(239, 68, 68, 0.3);\n        }\n      }\n    }\n    \n    .response-empty {\n      padding: 16px;\n      text-align: center;\n      color: #888888;\n      font-style: italic;\n      font-size: 13px;\n    }\n  }\n}\n\n@keyframes typing-pulse {\n  0%, 80%, 100% {\n    opacity: 0.3;\n    transform: scale(1);\n  }\n  40% {\n    opacity: 1;\n    transform: scale(1.2);\n  }\n}\n\n@media (max-width: 768px) {\n  .response-section {\n    .response-header {\n      gap: 10px;\n      \n      .response-avatar {\n        width: 28px;\n        height: 28px;\n        \n        .bot-icon {\n          font-size: 14px;\n        }\n      }\n      \n      .response-name {\n        font-size: 13px;\n      }\n    }\n    \n    .response-content {\n      .final-response {\n        .response-text {\n          padding: 14px;\n          font-size: 13px;\n        }\n        \n        .response-actions {\n          margin-top: 6px;\n          \n          .action-btn {\n            width: 26px;\n            height: 26px;\n            \n            svg {\n              font-size: 12px;\n            }\n          }\n        }\n      }\n    }\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"assistant-message\">\n    <!-- Thinking section (when available) -->\n    <ThinkingSection\n      v-if=\"message.thinkingDetails\"\n      :thinking-details=\"message.thinkingDetails\"\n      @step-selected=\"handleStepSelected\"\n    />\n    \n    <!-- Plan execution section (when available) -->\n    <ExecutionDetails\n      v-if=\"message.planExecution\"\n      :plan-execution=\"message.planExecution\"\n      :step-actions=\"message.stepActions || []\"\n      :generic-input=\"message.genericInput || ''\"\n      @step-selected=\"handleStepSelected\"\n    />\n    \n    <!-- Response section -->\n    <ResponseSection\n      v-if=\"message.content || message.error || isStreaming || message.planExecution?.userInputWaitState?.waiting\"\n      :content=\"message.content || ''\"\n      :is-streaming=\"isStreaming || false\"\n      v-bind=\"{\n        ...(message.error ? { error: message.error } : {}),\n        ...(message.planExecution?.userInputWaitState ? { userInputWaitState: message.planExecution.userInputWaitState } : {}),\n        ...(message.planExecution?.currentPlanId ? { planId: message.planExecution.currentPlanId } : {})\n      }\"\n      :timestamp=\"message.timestamp\"\n      :generic-input=\"message.genericInput || ''\"\n      @copy=\"handleCopy\"\n      @regenerate=\"handleRegenerate\"\n      @retry=\"handleRetry\"\n      @user-input-submitted=\"(inputData: any) => handleUserInputSubmit(message, inputData)\"\n    />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport ThinkingSection from './ThinkingSection.vue'\nimport ResponseSection from './ResponseSection.vue'\nimport ExecutionDetails from './ExecutionDetails.vue'\nimport type { ChatMessage } from './composables/useChatMessages'\n\ninterface Props {\n  message: ChatMessage\n  isStreaming?: boolean\n}\n\ninterface Emits {\n  (e: 'copy', messageId: string): void\n  (e: 'regenerate', messageId: string): void\n  (e: 'retry', messageId: string): void\n  (e: 'step-selected', stepId: string): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n\n// Event handlers\nconst handleCopy = () => {\n  emit('copy', props.message.id)\n}\n\nconst handleRegenerate = () => {\n  emit('regenerate', props.message.id)\n}\n\nconst handleRetry = () => {\n  emit('retry', props.message.id)\n}\n\n// Plan execution event handlers\n\nconst handleUserInputSubmit = (message: ChatMessage, inputData: any) => {\n  console.log('[AssistantMessage] User input submitted:', inputData, 'for message:', message.id)\n  // Handle user input submission - can be extended for more functionality\n}\n\nconst handleStepSelected = (stepId: string) => {\n  console.log('[AssistantMessage] Step selected:', stepId)\n  emit('step-selected', stepId)\n}\n</script>\n\n<style lang=\"less\" scoped>\n.assistant-message {\n  margin-bottom: 24px;\n  \n  // Add spacing between thinking and response sections\n  > * + * {\n    margin-top: 16px;\n  }\n}\n\n@media (max-width: 768px) {\n  .assistant-message {\n    margin-bottom: 20px;\n    \n    > * + * {\n      margin-top: 12px;\n    }\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"chat-message\" :class=\"messageClasses\">\n    <!-- User message -->\n    <UserMessage\n      v-if=\"message.type === 'user'\"\n      :message=\"message\"\n    />\n    \n    <!-- Assistant message -->\n    <AssistantMessage\n      v-else-if=\"message.type === 'assistant'\"\n      :message=\"message\"\n      :is-streaming=\"isStreaming || false\"\n      @copy=\"handleCopy\"\n      @regenerate=\"handleRegenerate\"\n      @retry=\"handleRetry\"\n      @step-selected=\"handleStepSelected\"\n    />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed } from 'vue'\nimport UserMessage from './UserMessage.vue'\nimport AssistantMessage from './AssistantMessage.vue'\nimport type { ChatMessage } from './composables/useChatMessages'\nimport { useMessageFormatting } from './composables/useMessageFormatting'\n\ninterface Props {\n  message: ChatMessage\n  isStreaming?: boolean\n}\n\ninterface Emits {\n  (e: 'copy', messageId: string): void\n  (e: 'regenerate', messageId: string): void\n  (e: 'retry', messageId: string): void\n  (e: 'step-selected', stepId: string): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n\nconst { getMessageClasses } = useMessageFormatting()\n\n// Computed properties\nconst messageClasses = computed(() => {\n  return getMessageClasses(props.message)\n})\n\n// Event handlers\nconst handleCopy = (messageId: string) => {\n  emit('copy', messageId)\n}\n\nconst handleRegenerate = (messageId: string) => {\n  emit('regenerate', messageId)\n}\n\nconst handleRetry = (messageId: string) => {\n  emit('retry', messageId)\n}\n\nconst handleStepSelected = (stepId: string) => {\n  emit('step-selected', stepId)\n}\n</script>\n\n<style lang=\"less\" scoped>\n.chat-message {\n  width: 100%;\n  \n  &.streaming {\n    position: relative;\n    \n    &::after {\n      content: '';\n      position: absolute;\n      bottom: 0;\n      left: 0;\n      right: 0;\n      height: 2px;\n      background: linear-gradient(90deg, transparent, #4f46e5, transparent);\n      animation: streaming-pulse 2s ease-in-out infinite;\n    }\n  }\n}\n\n@keyframes streaming-pulse {\n  0% {\n    transform: translateX(-100%);\n    opacity: 0;\n  }\n  50% {\n    opacity: 1;\n  }\n  100% {\n    transform: translateX(100%);\n    opacity: 0;\n  }\n}\n</style>\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ref, computed, readonly } from 'vue'\nimport type { PlanExecutionRecord, AgentExecutionRecord } from '@/types/plan-execution-record'\n\n// Local interface to handle readonly compatibility issues\nexport interface CompatiblePlanExecutionRecord extends Omit<PlanExecutionRecord, 'agentExecutionSequence'> {\n  agentExecutionSequence?: AgentExecutionRecord[]\n}\n\n// Message interface\nexport interface ChatMessage {\n  id: string\n  type: 'user' | 'assistant'\n  content: string\n  timestamp: Date\n  thinking?: string\n  thinkingDetails?: CompatiblePlanExecutionRecord\n  planExecution?: CompatiblePlanExecutionRecord\n  stepActions?: any[]\n  genericInput?: string\n  isStreaming?: boolean\n  error?: string\n  attachments?: File[]\n}\n\n// Input message interface\nexport interface InputMessage {\n  input: string\n  attachments?: File[]\n}\n\n/**\n * Utility type to convert readonly arrays to mutable ones\n */\ntype MakeMutable<T> = T extends readonly (infer U)[] ? U[] : T\n\n/**\n * Convert readonly PlanExecutionRecord to mutable compatible version with strong typing\n */\nfunction convertPlanExecutionRecord<T extends Record<string, any>>(\n  record: T\n): CompatiblePlanExecutionRecord {\n  const converted = { ...record } as unknown as CompatiblePlanExecutionRecord\n  \n  if ('agentExecutionSequence' in record && Array.isArray(record.agentExecutionSequence)) {\n    converted.agentExecutionSequence = record.agentExecutionSequence.map(\n      (agent: any) => convertAgentExecutionRecord(agent)\n    )\n  }\n  \n  return converted\n}\n\n/**\n * Convert readonly AgentExecutionRecord to mutable compatible version with strong typing\n */\nfunction convertAgentExecutionRecord<T extends Record<string, any>>(\n  record: T\n): AgentExecutionRecord {\n  const converted = { ...record } as unknown as AgentExecutionRecord\n  \n  if ('subPlanExecutionRecords' in record && Array.isArray(record.subPlanExecutionRecords)) {\n    converted.subPlanExecutionRecords = record.subPlanExecutionRecords.map(\n      (subPlan: any) => convertPlanExecutionRecord(subPlan)\n    )\n  }\n  \n  return converted\n}\n\n/**\n * Convert a message with potentially readonly arrays to a fully mutable version\n */\nexport function convertMessageToCompatible<T extends Record<string, any>>(message: T): ChatMessage {\n  const converted = { ...message } as unknown as ChatMessage\n  \n  if ('thinkingDetails' in message && message.thinkingDetails) {\n    converted.thinkingDetails = convertPlanExecutionRecord(message.thinkingDetails)\n  }\n  \n  if ('planExecution' in message && message.planExecution) {\n    converted.planExecution = convertPlanExecutionRecord(message.planExecution)\n  }\n  \n  if ('attachments' in message && Array.isArray(message.attachments)) {\n    converted.attachments = [...message.attachments] as MakeMutable<typeof message.attachments>\n  }\n  \n  return converted\n}\n\n/**\n * Chat messages state management\n */\nexport function useChatMessages() {\n  // State\n  const messages = ref<ChatMessage[]>([])\n  const isLoading = ref(false)\n  const streamingMessageId = ref<string | null>(null)\n  const activeMessageId = ref<string | null>(null)\n\n  // Computed properties\n  const lastMessage = computed(() => {\n    return messages.value.length > 0 ? messages.value[messages.value.length - 1] : null\n  })\n\n  const isStreaming = computed(() => {\n    return streamingMessageId.value !== null\n  })\n\n  const hasMessages = computed(() => {\n    return messages.value.length > 0\n  })\n\n  // Methods\n  const addMessage = (type: 'user' | 'assistant', content: string, options?: Partial<ChatMessage>): ChatMessage => {\n    const message: ChatMessage = {\n      id: `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n      type,\n      content,\n      timestamp: new Date(),\n      isStreaming: false,\n      ...options\n    }\n\n    messages.value.push(message)\n    return message\n  }\n\n  const updateMessage = (id: string, updates: Partial<ChatMessage>) => {\n    const index = messages.value.findIndex(m => m.id === id)\n    if (index !== -1) {\n      messages.value[index] = { ...messages.value[index], ...updates }\n    }\n  }\n\n  const removeMessage = (id: string) => {\n    const index = messages.value.findIndex(m => m.id === id)\n    if (index !== -1) {\n      messages.value.splice(index, 1)\n    }\n  }\n\n  const clearMessages = () => {\n    messages.value = []\n    streamingMessageId.value = null\n    activeMessageId.value = null\n  }\n\n  const startStreaming = (messageId: string) => {\n    streamingMessageId.value = messageId\n    updateMessage(messageId, { isStreaming: true })\n  }\n\n  const stopStreaming = (messageId?: string) => {\n    if (messageId) {\n      updateMessage(messageId, { isStreaming: false })\n    }\n    if (streamingMessageId.value === messageId) {\n      streamingMessageId.value = null\n    }\n  }\n\n  const setActiveMessage = (id: string | null) => {\n    activeMessageId.value = id\n  }\n\n  const appendToMessage = (id: string, content: string, field: keyof ChatMessage = 'content') => {\n    const message = messages.value.find(m => m.id === id)\n    if (message && typeof message[field] === 'string') {\n      updateMessage(id, { [field]: (message[field] as string) + content })\n    }\n  }\n\n  const updateMessageThinkingDetails = (id: string, thinkingDetails: PlanExecutionRecord) => {\n    updateMessage(id, { thinkingDetails })\n  }\n\n  const updateMessageThinking = (id: string, thinking: string) => {\n    updateMessage(id, { thinking })\n  }\n\n  const updateMessagePlanExecution = (id: string, planExecution: PlanExecutionRecord) => {\n    updateMessage(id, { planExecution })\n  }\n\n  const findMessage = (id: string): ChatMessage | undefined => {\n    return messages.value.find(m => m.id === id)\n  }\n\n  const getMessageIndex = (id: string): number => {\n    return messages.value.findIndex(m => m.id === id)\n  }\n\n  return {\n    // State\n    messages: readonly(messages),\n    isLoading,\n    streamingMessageId: readonly(streamingMessageId),\n    activeMessageId: readonly(activeMessageId),\n\n    // Computed\n    lastMessage,\n    isStreaming,\n    hasMessages,\n\n    // Methods\n    addMessage,\n    updateMessage,\n    removeMessage,\n    clearMessages,\n    startStreaming,\n    stopStreaming,\n    setActiveMessage,\n    appendToMessage,\n    updateMessageThinking,\n    updateMessageThinkingDetails,\n    updateMessagePlanExecution,\n    findMessage,\n    getMessageIndex\n  }\n}\n\n// Message utilities\nexport const createUserMessage = (content: string): Omit<ChatMessage, 'id' | 'timestamp'> => ({\n  type: 'user',\n  content,\n  isStreaming: false\n})\n\nexport const createAssistantMessage = (options?: Partial<ChatMessage>): Omit<ChatMessage, 'id' | 'timestamp'> => ({\n  type: 'assistant',\n  content: '',\n  thinking: '',\n  isStreaming: true,\n  ...options\n})\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ref, nextTick, onMounted, onUnmounted, readonly } from 'vue'\nimport type { Ref } from 'vue'\n\n/**\n * Scroll behavior management for chat messages\n */\nexport function useScrollBehavior(containerRef: Ref<HTMLElement | null>) {\n  const showScrollToBottom = ref(false)\n  const isAutoScrollEnabled = ref(true)\n  const scrollThreshold = 150 // pixels from bottom to show scroll button\n\n  /**\n   * Scroll to bottom of container\n   */\n  const scrollToBottom = async (smooth = true) => {\n    if (!containerRef.value) return\n    \n    await nextTick()\n    \n    containerRef.value.scrollTo({\n      top: containerRef.value.scrollHeight,\n      behavior: smooth ? 'smooth' : 'auto'\n    })\n  }\n\n  /**\n   * Check if user is near bottom of container\n   */\n  const isNearBottom = (): boolean => {\n    if (!containerRef.value) return false\n    \n    const { scrollTop, scrollHeight, clientHeight } = containerRef.value\n    return scrollHeight - scrollTop - clientHeight < scrollThreshold\n  }\n\n  /**\n   * Check scroll position and update scroll button visibility\n   */\n  const checkScrollPosition = () => {\n    if (!containerRef.value) return\n    \n    const nearBottom = isNearBottom()\n    showScrollToBottom.value = !nearBottom && containerRef.value.scrollHeight > containerRef.value.clientHeight\n    \n    // Enable auto-scroll when user scrolls to bottom\n    if (nearBottom) {\n      isAutoScrollEnabled.value = true\n    }\n  }\n\n  /**\n   * Handle scroll event\n   */\n  const handleScroll = () => {\n    checkScrollPosition()\n    \n    // Disable auto-scroll when user manually scrolls up\n    if (!isNearBottom()) {\n      isAutoScrollEnabled.value = false\n    }\n  }\n\n  /**\n   * Auto scroll to bottom when new messages arrive\n   */\n  const autoScrollToBottom = async () => {\n    if (isAutoScrollEnabled.value) {\n      await scrollToBottom()\n    }\n  }\n\n  /**\n   * Force scroll to bottom and enable auto-scroll\n   */\n  const forceScrollToBottom = async () => {\n    isAutoScrollEnabled.value = true\n    await scrollToBottom()\n  }\n\n  /**\n   * Scroll to a specific message element\n   */\n  const scrollToMessage = (messageId: string, smooth = true) => {\n    if (!containerRef.value) return\n    \n    const messageElement = containerRef.value.querySelector(`[data-message-id=\"${messageId}\"]`)\n    if (messageElement) {\n      messageElement.scrollIntoView({\n        behavior: smooth ? 'smooth' : 'auto',\n        block: 'center'\n      })\n    }\n  }\n\n  /**\n   * Get scroll position info\n   */\n  const getScrollInfo = () => {\n    if (!containerRef.value) {\n      return {\n        scrollTop: 0,\n        scrollHeight: 0,\n        clientHeight: 0,\n        isAtTop: true,\n        isAtBottom: true,\n        scrollPercentage: 0\n      }\n    }\n\n    const { scrollTop, scrollHeight, clientHeight } = containerRef.value\n    const isAtTop = scrollTop === 0\n    const isAtBottom = scrollTop + clientHeight >= scrollHeight - 5\n    const scrollPercentage = scrollHeight > clientHeight \n      ? (scrollTop / (scrollHeight - clientHeight)) * 100 \n      : 100\n\n    return {\n      scrollTop,\n      scrollHeight,\n      clientHeight,\n      isAtTop,\n      isAtBottom,\n      scrollPercentage\n    }\n  }\n\n  /**\n   * Add scroll event listener\n   */\n  const addScrollListener = () => {\n    if (containerRef.value) {\n      containerRef.value.addEventListener('scroll', handleScroll, { passive: true })\n    }\n  }\n\n  /**\n   * Remove scroll event listener\n   */\n  const removeScrollListener = () => {\n    if (containerRef.value) {\n      containerRef.value.removeEventListener('scroll', handleScroll)\n    }\n  }\n\n  /**\n   * Initialize scroll behavior\n   */\n  const initializeScrollBehavior = () => {\n    addScrollListener()\n    checkScrollPosition()\n  }\n\n  /**\n   * Clean up scroll behavior\n   */\n  const cleanupScrollBehavior = () => {\n    removeScrollListener()\n  }\n\n  // Auto-initialize on mount\n  onMounted(() => {\n    nextTick(() => {\n      initializeScrollBehavior()\n    })\n  })\n\n  // Cleanup on unmount\n  onUnmounted(() => {\n    cleanupScrollBehavior()\n  })\n\n  return {\n    // State\n    showScrollToBottom: readonly(showScrollToBottom),\n    isAutoScrollEnabled: readonly(isAutoScrollEnabled),\n\n    // Methods\n    scrollToBottom,\n    autoScrollToBottom,\n    forceScrollToBottom,\n    scrollToMessage,\n    isNearBottom,\n    checkScrollPosition,\n    getScrollInfo,\n    addScrollListener,\n    removeScrollListener,\n    initializeScrollBehavior,\n    cleanupScrollBehavior\n  }\n}\n\n/**\n * Smooth scroll behavior with easing\n */\nexport function useSmoothScroll() {\n  const scrollWithEasing = (\n    element: HTMLElement,\n    targetPosition: number,\n    duration: number = 300\n  ) => {\n    const startPosition = element.scrollTop\n    const distance = targetPosition - startPosition\n    let startTime: number | null = null\n\n    const animation = (currentTime: number) => {\n      if (startTime === null) startTime = currentTime\n      const timeElapsed = currentTime - startTime\n      const run = easeInOutQuad(timeElapsed, startPosition, distance, duration)\n      \n      element.scrollTop = run\n      \n      if (timeElapsed < duration) {\n        requestAnimationFrame(animation)\n      }\n    }\n\n    requestAnimationFrame(animation)\n  }\n\n  // Easing function\n  const easeInOutQuad = (t: number, b: number, c: number, d: number): number => {\n    t /= d / 2\n    if (t < 1) return c / 2 * t * t + b\n    t--\n    return -c / 2 * (t * (t - 2) - 1) + b\n  }\n\n  return {\n    scrollWithEasing\n  }\n}\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommonApiService } from '@/api/common-api-service'\nimport { DirectApiService } from '@/api/direct-api-service'\nimport { PlanActApiService } from '@/api/plan-act-api-service'\nimport { useTaskStore } from '@/stores/task'\nimport type { UIStateData } from '@/types/cache-data'\nimport type { PlanExecutionRecord } from '@/types/plan-execution-record'\nimport { reactive } from 'vue'\n\n// Define event callback interface\ninterface EventCallbacks {\n  onPlanUpdate?: (rootPlanId: string) => void\n  onPlanCompleted?: (rootPlanId: string) => void\n  onDialogRoundStart?: (rootPlanId: string) => void\n  onChatInputUpdateState?: (rootPlanId: string) => void\n  onChatInputClear?: () => void\n  onPlanError?: (message: string) => void\n}\n\ninterface ExecutionState {\n  activePlanId: string | null\n  lastSequenceSize: number\n  isPolling: boolean\n  pollTimer: number | null\n}\n\nexport class PlanExecutionManager {\n  private static instance: PlanExecutionManager | null = null\n  private readonly POLL_INTERVAL = 5000\n\n  // Reactive state\n  private state = reactive<ExecutionState>({\n    activePlanId: null,\n    lastSequenceSize: 0,\n    isPolling: false,\n    pollTimer: null,\n  })\n\n  // Event callbacks\n  private callbacks: EventCallbacks = {}\n\n  // Cache for PlanExecutionRecord by rootPlanId\n  private planExecutionCache = new Map<string, PlanExecutionRecord>()\n\n  // Cache for UI state by rootPlanId\n  private uiStateCache = new Map<string, UIStateData>()\n\n  /**\n   * Get cached plan execution record by rootPlanId\n   */\n  getCachedPlanRecord(rootPlanId: string): PlanExecutionRecord | undefined {\n    return this.planExecutionCache.get(rootPlanId)\n  }\n\n  /**\n   * Get cached UI state by rootPlanId\n   */\n  getCachedUIState(rootPlanId: string): UIStateData | undefined {\n    return this.uiStateCache.get(rootPlanId)\n  }\n\n  /**\n   * Set cached UI state by rootPlanId\n   */\n  setCachedUIState(rootPlanId: string, uiState: UIStateData): void {\n    this.uiStateCache.set(rootPlanId, uiState)\n    console.log(`[PlanExecutionManager] Cached UI state for rootPlanId: ${rootPlanId}`)\n  }\n\n  /**\n   * Get all cached plan execution records\n   */\n  getAllCachedRecords(): Map<string, PlanExecutionRecord> {\n    return new Map(this.planExecutionCache)\n  }\n\n  /**\n   * Check if a plan execution record exists in cache\n   */\n  hasCachedPlanRecord(rootPlanId: string): boolean {\n    return this.planExecutionCache.has(rootPlanId)\n  }\n\n  /**\n   * Set cached plan execution record by rootPlanId\n   */\n  setCachedPlanRecord(rootPlanId: string, record: PlanExecutionRecord): void {\n    this.planExecutionCache.set(rootPlanId, record)\n    console.log(`[PlanExecutionManager] Cached plan execution record for rootPlanId: ${rootPlanId}`)\n  }\n\n  /**\n   * Clear cached plan execution record by rootPlanId\n   */\n  clearCachedPlanRecord(rootPlanId: string): boolean {\n    const deleted = this.planExecutionCache.delete(rootPlanId)\n    if (deleted) {\n      console.log(\n        `[PlanExecutionManager] Cleared cached plan execution record for rootPlanId: ${rootPlanId}`\n      )\n    }\n    return deleted\n  }\n\n  /**\n   * Clear all cached plan execution records\n   */\n  clearAllCachedRecords(): void {\n    const planCacheSize = this.planExecutionCache.size\n    const uiStateCacheSize = this.uiStateCache.size\n\n    this.planExecutionCache.clear()\n    this.uiStateCache.clear()\n\n    console.log(\n      `[PlanExecutionManager] Cleared all caches - Plans: ${planCacheSize}, UI States: ${uiStateCacheSize}`\n    )\n  }\n\n  private constructor() {\n    // Remove window event listener initialization\n    console.log('[PlanExecutionManager] Initialized with callback-based event system')\n  }\n\n  /**\n   * Get singleton instance\n   */\n  public static getInstance(): PlanExecutionManager {\n    if (!PlanExecutionManager.instance) {\n      PlanExecutionManager.instance = new PlanExecutionManager()\n    }\n    return PlanExecutionManager.instance\n  }\n\n  /**\n   * Get current active plan ID\n   */\n  public getActivePlanId(): string | null {\n    return this.state.activePlanId\n  }\n\n  /**\n   * Get current state (reactive)\n   */\n  public getState() {\n    return this.state\n  }\n\n  /**\n   * Set event callbacks\n   */\n  public setEventCallbacks(callbacks: EventCallbacks): void {\n    this.callbacks = { ...this.callbacks, ...callbacks }\n    console.log('[PlanExecutionManager] Event callbacks set:', Object.keys(callbacks))\n  }\n\n  /**\n   * Handle user message send request\n   */\n  public async handleUserMessageSendRequested(query: string): Promise<void> {\n    if (!this.validateAndPrepareUIForNewRequest(query)) {\n      return\n    }\n\n    try {\n      await this.sendUserMessageAndSetPlanId(query)\n\n      if (this.state.activePlanId) {\n        this.initiatePlanExecutionSequence(query, this.state.activePlanId)\n      } else {\n        throw new Error('Failed to get valid plan ID')\n      }\n    } catch (error: any) {\n      console.error('[PlanExecutionManager] Failed to send user message:', error)\n      // Set UI state to enabled for error recovery\n      const errorPlanId = this.state.activePlanId ?? 'error'\n      this.setCachedUIState(errorPlanId, { enabled: true })\n\n      this.emitChatInputUpdateState(errorPlanId)\n      this.state.activePlanId = null\n    }\n  }\n\n  /**\n   * Handle plan execution request\n   */\n  public handlePlanExecutionRequested(planId: string, query?: string): void {\n    console.log('[PlanExecutionManager] Received plan execution request:', { planId, query })\n\n    if (planId) {\n      this.state.activePlanId = planId\n      this.initiatePlanExecutionSequence(query ?? 'Execute Plan', planId)\n    } else {\n      console.error('[PlanExecutionManager] Invalid plan execution request: missing planId')\n    }\n  }\n\n  /**\n   * Handle plan execution request with cache lookup by rootPlanId\n   */\n  public handleCachedPlanExecution(rootPlanId: string, query?: string): boolean {\n    const cachedRecord = this.getCachedPlanRecord(rootPlanId)\n\n    if (cachedRecord?.currentPlanId) {\n      console.log(\n        `[PlanExecutionManager] Found cached plan execution record for rootPlanId: ${rootPlanId}`\n      )\n      this.handlePlanExecutionRequested(cachedRecord.currentPlanId, query)\n      return true\n    } else {\n      console.log(\n        `[PlanExecutionManager] No cached plan execution record found for rootPlanId: ${rootPlanId}`\n      )\n      return false\n    }\n  }\n\n  /**\n   * Validate request and prepare UI\n   */\n  private validateAndPrepareUIForNewRequest(query: string): boolean {\n    if (!query) {\n      console.warn('[PlanExecutionManager] Query is empty')\n      return false\n    }\n\n    if (this.state.activePlanId) {\n      // There is already an active plan, cannot start new request\n      return false\n    }\n\n    // Clear input and set to disabled state\n    this.emitChatInputClear()\n\n    // Cache UI state data first\n    const uiStatePlanId = this.state.activePlanId ?? 'ui-state'\n    this.setCachedUIState(uiStatePlanId, { enabled: false, placeholder: 'Processing...' })\n    this.emitChatInputUpdateState(uiStatePlanId)\n\n    return true\n  }\n\n  /**\n   * Send user message and set plan ID\n   */\n  private async sendUserMessageAndSetPlanId(query: string): Promise<any> {\n    try {\n      // Use direct execution mode API to send message\n      const response = await DirectApiService.sendMessage({\n        input: query,\n      })\n\n      if (response?.planId) {\n        this.state.activePlanId = response.planId\n        return response\n      } else if (response?.planTemplateId) {\n        // If response contains planTemplateId instead of planId\n        this.state.activePlanId = response.planTemplateId\n        return { ...response, planId: response.planTemplateId }\n      }\n\n      console.error('[PlanExecutionManager] Failed to get planId from response:', response)\n      throw new Error('Failed to get valid planId from API response')\n    } catch (error: any) {\n      console.error('[PlanExecutionManager] API call failed:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Start plan execution sequence\n   */\n  public initiatePlanExecutionSequence(query: string, planId: string): void {\n    console.log(\n      `[PlanExecutionManager] Starting plan execution sequence for query: \"${query}\", planId: ${planId}`\n    )\n\n    // Use planId as rootPlanId for now (assume they are the same initially)\n    const rootPlanId = planId\n\n    // Mark task as running in task store\n    const taskStore = useTaskStore()\n    taskStore.setTaskRunning(planId)\n    console.log('[PlanExecutionManager] Task marked as running with planId:', planId)\n\n    // Try to emit dialog start\n    this.emitDialogRoundStart(rootPlanId)\n\n    this.startPolling()\n  }\n\n  /**\n   * Handle plan completion common logic\n   */\n  private handlePlanCompletion(details: PlanExecutionRecord): void {\n    this.emitPlanCompleted(details.rootPlanId ?? '')\n    this.state.lastSequenceSize = 0\n    this.stopPolling()\n\n    // Mark task as no longer running\n    const taskStore = useTaskStore()\n    if (taskStore.currentTask && taskStore.currentTask.isRunning) {\n      taskStore.currentTask.isRunning = false\n      console.log('[PlanExecutionManager] Task marked as completed')\n    }\n\n    // Delay deletion of plan execution record\n    try {\n      setTimeout(async () => {\n        if (this.state.activePlanId) {\n          try {\n            await PlanActApiService.deletePlanTemplate(this.state.activePlanId)\n            console.log(\n              `[PlanExecutionManager] Plan template ${this.state.activePlanId} deleted successfully`\n            )\n          } catch (error: any) {\n            console.log(`Delete plan execution record failed: ${error.message}`)\n          }\n        }\n      }, 5000)\n    } catch (error: any) {\n      console.log(`Delete plan execution record failed: ${error.message}`)\n    }\n\n    if (details.completed) {\n      this.state.activePlanId = null\n      this.emitChatInputUpdateState(details.rootPlanId ?? '')\n    }\n  }\n\n  private handlePlanError(details: PlanExecutionRecord): void {\n    this.emitPlanError(details.message ?? '')\n    this.state.lastSequenceSize = 0\n    this.stopPolling()\n\n    // Mark task as no longer running\n    const taskStore = useTaskStore()\n    if (taskStore.currentTask && taskStore.currentTask.isRunning) {\n      taskStore.currentTask.isRunning = false\n      console.log('[PlanExecutionManager] Task marked as stopped due to error')\n    }\n\n    // Delay deletion of plan execution record\n    try {\n      setTimeout(async () => {\n        if (this.state.activePlanId) {\n          try {\n            await PlanActApiService.deletePlanTemplate(this.state.activePlanId)\n            console.log(\n              `[PlanExecutionManager] Plan template ${this.state.activePlanId} deleted successfully`\n            )\n          } catch (error: any) {\n            console.log(`Delete plan execution record failed: ${error.message}`)\n          }\n        }\n      }, 5000)\n    } catch (error: any) {\n      console.log(`Delete plan execution record failed: ${error.message}`)\n    }\n  }\n\n  /**\n   * Poll plan execution status\n   */\n  private async pollPlanStatus(): Promise<void> {\n    if (!this.state.activePlanId) return\n\n    if (this.state.isPolling) {\n      console.log('[PlanExecutionManager] Previous polling still in progress, skipping')\n      return\n    }\n\n    try {\n      this.state.isPolling = true\n\n      // Here we need to implement the API call to get plan details\n      // Since the original code calls ManusAPI.getDetails, we need to use the existing API services\n      // For now, we'll use the relevant methods of PlanActApiService\n      const details = await this.getPlanDetails(this.state.activePlanId)\n\n      if (!details) {\n        console.warn(\n          '[PlanExecutionManager] No details received from API - this might be a temporary network issue'\n        )\n        return\n      }\n\n      // Only handle actual plan execution failures, not network errors\n      if (\n        details.status &&\n        details.status === 'failed' &&\n        details.message &&\n        !details.message.includes('Failed to get detailed information')\n      ) {\n        this.handlePlanError(details)\n        return\n      }\n\n      // Update cache with latest plan details if rootPlanId exists\n      if (details.rootPlanId) {\n        this.setCachedPlanRecord(details.rootPlanId, details)\n      }\n\n      this.emitPlanUpdate(details.rootPlanId ?? '')\n\n      if (details.completed) {\n        this.handlePlanCompletion(details)\n      }\n    } catch (error: any) {\n      console.error('[PlanExecutionManager] Failed to poll plan status:', error)\n    } finally {\n      this.state.isPolling = false\n    }\n  }\n\n  /**\n   * Get plan details (needs to be adjusted based on actual API)\n   */\n  private async getPlanDetails(planId: string): Promise<PlanExecutionRecord | null> {\n    try {\n      // Use CommonApiService's getDetails method\n      const details = await CommonApiService.getDetails(planId)\n\n      // Cache the plan execution record by rootPlanId if it exists\n      if (details?.rootPlanId) {\n        this.planExecutionCache.set(details.rootPlanId, details)\n        console.log(\n          `[PlanExecutionManager] Cached plan execution record for rootPlanId: ${details.rootPlanId}`\n        )\n      }\n\n      return details\n    } catch (error: any) {\n      console.error('[PlanExecutionManager] Failed to get plan details:', error)\n      return {\n        currentPlanId: planId,\n        status: 'failed',\n        message: error instanceof Error ? error.message : 'Failed to get plan',\n      }\n    }\n  }\n\n  /**\n   * Start polling plan execution status\n   */\n  public startPolling(): void {\n    if (this.state.pollTimer) {\n      clearInterval(this.state.pollTimer)\n    }\n\n    this.state.pollTimer = window.setInterval(() => {\n      this.pollPlanStatus()\n    }, this.POLL_INTERVAL)\n\n    console.log('[PlanExecutionManager] Started polling')\n  }\n\n  /**\n   * Immediately poll plan execution status (for manual refresh trigger)\n   */\n  public async pollPlanStatusImmediately(): Promise<void> {\n    console.log('[PlanExecutionManager] Polling plan status immediately')\n    await this.pollPlanStatus()\n  }\n\n  /**\n   * Stop polling\n   */\n  public stopPolling(): void {\n    if (this.state.pollTimer) {\n      clearInterval(this.state.pollTimer)\n      this.state.pollTimer = null\n    }\n    console.log('[PlanExecutionManager] Stopped polling')\n  }\n\n  /**\n   * Clean up resources\n   */\n  public cleanup(): void {\n    this.stopPolling()\n    this.state.activePlanId = null\n    this.state.lastSequenceSize = 0\n    this.state.isPolling = false\n\n    // Clear all cached plan execution records\n    this.clearAllCachedRecords()\n  }\n\n  // Event emission helpers - Use callback functions instead of window events\n  private emitChatInputClear(): void {\n    if (this.callbacks.onChatInputClear) {\n      this.callbacks.onChatInputClear()\n    }\n  }\n\n  private emitChatInputUpdateState(rootPlanId: string): void {\n    if (this.callbacks.onChatInputUpdateState) {\n      this.callbacks.onChatInputUpdateState(rootPlanId)\n    }\n  }\n\n  private emitDialogRoundStart(rootPlanId: string): void {\n    if (this.callbacks.onDialogRoundStart) {\n      this.callbacks.onDialogRoundStart(rootPlanId)\n    }\n  }\n\n  private emitPlanUpdate(rootPlanId: string): void {\n    if (this.callbacks.onPlanUpdate) {\n      this.callbacks.onPlanUpdate(rootPlanId)\n    }\n  }\n\n  private emitPlanCompleted(rootPlanId: string): void {\n    if (this.callbacks.onPlanCompleted) {\n      this.callbacks.onPlanCompleted(rootPlanId)\n    }\n  }\n\n  private emitPlanError(message: string): void {\n    if (this.callbacks.onPlanError) {\n      this.callbacks.onPlanError(message)\n    }\n  }\n}\n\n// Export singleton instance\nexport const planExecutionManager = PlanExecutionManager.getInstance()\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"chat-container\">\n    <!-- Messages container -->\n    <div \n      class=\"messages\" \n      ref=\"messagesRef\" \n      @scroll=\"handleScroll\"\n      @click=\"handleMessageContainerClick\"\n    >\n      <!-- Message list -->\n      <ChatMessage\n        v-for=\"message in compatibleMessages\"\n        :key=\"message.id\"\n        :message=\"message\"\n        :is-streaming=\"isMessageStreaming(message.id)\"\n        @copy=\"handleCopyMessage\"\n        @regenerate=\"handleRegenerateMessage\"\n        @retry=\"handleRetryMessage\"\n        @step-selected=\"handleStepSelected\"\n      />\n      \n      <!-- Loading indicator -->\n      <div v-if=\"isLoading\" class=\"loading-message\">\n        <div class=\"loading-content\">\n          <Icon icon=\"carbon:circle-dash\" class=\"loading-icon\" />\n          <span>{{ $t('chat.processing') }}</span>\n        </div>\n      </div>\n    </div>\n\n    <!-- Scroll to bottom button -->\n    <Transition name=\"scroll-button\">\n      <button\n        v-if=\"showScrollToBottom\"\n        class=\"scroll-to-bottom\"\n        @click=\"() => scrollToBottom()\"\n        :title=\"$t('chat.scrollToBottom')\"\n      >\n        <Icon icon=\"carbon:chevron-down\" />\n      </button>\n    </Transition>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, watch, onMounted, onUnmounted, nextTick, computed } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { Icon } from '@iconify/vue'\n\n// Import new modular components\nimport ChatMessage from './ChatMessage.vue'\n\n// Import composables\nimport { useChatMessages, convertMessageToCompatible } from './composables/useChatMessages'\nimport { useScrollBehavior } from './composables/useScrollBehavior'\n\n// Import plan execution manager\nimport { planExecutionManager } from '@/utils/plan-execution-manager'\n\ninterface Props {\n}\n\ninterface Emits {\n  (e: 'step-selected', stepId: string): void\n}\n\n// InputMessage interface removed - not needed in display component\n\nwithDefaults(defineProps<Props>(), {\n})\n\nconst emit = defineEmits<Emits>()\n\n// Initialize composables\nconst { t } = useI18n()\n\n// Chat messages state\nconst {\n  messages,\n  isLoading,\n  streamingMessageId,\n  addMessage,\n  updateMessage,\n  startStreaming,\n  stopStreaming,\n  findMessage\n} = useChatMessages()\n\n// Scroll behavior\nconst messagesRef = ref<HTMLElement | null>(null)\nconst {\n  scrollToBottom,\n  autoScrollToBottom,\n  showScrollToBottom\n} = useScrollBehavior(messagesRef)\n\n// Local state\nconst pollingInterval = ref<number>()\n\n// Computed properties\nconst isMessageStreaming = (messageId: string) => {\n  return streamingMessageId.value === messageId\n}\n\n// Convert messages to compatible format for ChatMessage component\nconst compatibleMessages = computed(() => {\n  return messages.value.map(convertMessageToCompatible)\n})\n\n// Event handlers\nconst handleScroll = () => {\n  // Scroll behavior is handled by useScrollBehavior composable\n}\n\nconst handleMessageContainerClick = (event: Event) => {\n  // Handle markdown copy buttons and other click events\n  const target = event.target as HTMLElement\n  \n  if (target.classList.contains('md-copy-btn')) {\n    const rawText = target.getAttribute('data-raw')\n    if (rawText) {\n      const text = decodeURIComponent(rawText)\n      navigator.clipboard.writeText(text).then(() => {\n        // Show copy feedback\n        target.textContent = t('chat.copied')\n        setTimeout(() => {\n          target.textContent = t('chat.copy')\n        }, 1000)\n      })\n    }\n  }\n}\n\nconst handleCopyMessage = async (messageId: string) => {\n  const message = findMessage(messageId)\n  if (!message) return\n  \n  try {\n    // Strip HTML tags for clipboard\n    const plainText = message.content.replace(/<[^>]*>/g, '')\n    await navigator.clipboard.writeText(plainText)\n    // Could add toast notification here\n  } catch (error) {\n    console.error('Failed to copy message:', error)\n  }\n}\n\nconst handleRegenerateMessage = (messageId: string) => {\n  // Implementation for regenerating assistant response\n  const message = findMessage(messageId)\n  if (message && message.type === 'assistant') {\n    // Reset message content and restart generation\n    updateMessage(messageId, {\n      content: ''\n    })\n    startStreaming(messageId)\n    // Trigger regeneration logic here\n  }\n}\n\nconst handleRetryMessage = (messageId: string) => {\n  // Implementation for retrying failed message\n  const message = findMessage(messageId)\n  if (message) {\n    updateMessage(messageId, {\n      content: ''\n    })\n    startStreaming(messageId)\n    // Trigger retry logic here\n  }\n}\n\nconst handleStepSelected = (stepId: string) => {\n  console.log('[ChatContainer] Step selected:', stepId)\n  emit('step-selected', stepId)\n}\n\n// Message handling methods removed - ChatContainer is now a pure display component\n\n// Plan execution handlers\nconst handlePlanUpdate = (rootPlanId: string) => {\n  console.log('[ChatContainer] Plan update received:', rootPlanId)\n  \n  // Get the PlanExecutionRecord from the cache\n  const planDetails = planExecutionManager.getCachedPlanRecord(rootPlanId)\n  \n  if (!planDetails) {\n    console.warn('[ChatContainer] No cached plan data found for rootPlanId:', rootPlanId)\n    return\n  }\n  \n  console.log('[ChatContainer] Retrieved plan details from cache:', planDetails)\n  \n  // Find the corresponding message\n  const messageIndex = messages.value.findIndex(\n    m => m.planExecution?.currentPlanId === planDetails.currentPlanId && m.type === 'assistant'\n  )\n  \n  if (messageIndex !== -1) {\n    const message = messages.value[messageIndex]\n    \n    // Update planExecution data using updateMessage\n    const updates: any = {\n      planExecution: JSON.parse(JSON.stringify(planDetails))\n    }\n    \n    // Handle simple responses (cases without agent execution sequence)\n    if (!planDetails.agentExecutionSequence || planDetails.agentExecutionSequence.length === 0) {\n      console.log('[ChatContainer] Handling simple response without agent execution sequence')\n      \n      if (planDetails.completed) {\n        // Clear thinking state and set final response\n        updates.thinking = ''\n        const finalResponse = planDetails.summary ?? planDetails.result ?? planDetails.message ?? 'Execution completed'\n        updates.content = finalResponse\n        console.log('[ChatContainer] Set simple response content:', finalResponse)\n      }\n    } else {\n      console.log('[ChatContainer] Handling detailed plan with agent execution sequence')\n      // This is a detailed plan with execution steps, keep the plan execution display\n    }\n    \n    // Update the message\n    updateMessage(message.id, updates)\n  }\n}\n\nconst handlePlanCompleted = (planDetails: any) => {\n  console.log('[ChatContainer] Plan completed:', planDetails)\n  \n  if (planDetails.rootPlanId) {\n    const messageIndex = messages.value.findIndex(\n      m => m.planExecution?.currentPlanId === planDetails.rootPlanId\n    )\n    \n    if (messageIndex !== -1) {\n      const message = messages.value[messageIndex]\n      \n      const summary = planDetails.summary ?? planDetails.result ?? 'Execution completed'\n      updateMessage(message.id, {\n        thinking: '',\n        content: summary\n      })\n      console.log('[ChatContainer] Updated completed message:', summary)\n    }\n  }\n}\n\nconst handleDialogRoundStart = (planId: string) => {\n  console.log('[ChatContainer] Dialog round start:', planId)\n  // This method can be used to initialize plan execution state\n}\n\nconst handlePlanError = (message: string) => {\n  console.log('[ChatContainer] Plan error:', message)\n  \n  // Show error message\n  addMessage('assistant', `Error: ${message}`)\n  console.error('[ChatContainer] Plan execution error:', message)\n}\n\n// Scroll handlers (remove unused function)\n\n// Lifecycle\nonMounted(() => {\n  // Initial prompt processing removed - handled by parent component\n\n  // Auto-scroll to bottom when new messages are added\n  watch(messages, () => {\n    nextTick(() => {\n      autoScrollToBottom()\n    })\n  }, { deep: true })\n\n  // Register plan execution callbacks\n  planExecutionManager.setEventCallbacks({\n    onPlanUpdate: handlePlanUpdate,\n    onPlanCompleted: handlePlanCompleted,\n    onDialogRoundStart: handleDialogRoundStart,\n    onPlanError: handlePlanError\n  })\n})\n\nonUnmounted(() => {\n  if (pollingInterval.value) {\n    clearInterval(pollingInterval.value)\n  }\n})\n\n// Expose methods for parent components\ndefineExpose({\n  scrollToBottom,\n  handlePlanUpdate,\n  handlePlanCompleted,\n  handleDialogRoundStart,\n  handlePlanError,\n  addMessage,\n  updateMessage,\n  startStreaming,\n  stopStreaming\n})\n</script>\n\n<style lang=\"less\" scoped>\n.chat-container {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  position: relative;\n  background: #1a1a1a;\n  \n  .messages {\n    flex: 1;\n    overflow-y: auto;\n    padding: 20px;\n    scroll-behavior: smooth;\n    \n    // Custom scrollbar\n    &::-webkit-scrollbar {\n      width: 6px;\n    }\n    \n    &::-webkit-scrollbar-track {\n      background: rgba(255, 255, 255, 0.1);\n      border-radius: 3px;\n    }\n    \n    &::-webkit-scrollbar-thumb {\n      background: rgba(255, 255, 255, 0.3);\n      border-radius: 3px;\n      \n      &:hover {\n        background: rgba(255, 255, 255, 0.5);\n      }\n    }\n  }\n  \n  .loading-message {\n    display: flex;\n    justify-content: center;\n    padding: 20px;\n    \n    .loading-content {\n      display: flex;\n      align-items: center;\n      gap: 12px;\n      color: #aaaaaa;\n      font-size: 14px;\n      \n      .loading-icon {\n        font-size: 16px;\n        animation: spin 1s linear infinite;\n      }\n    }\n  }\n  \n  .scroll-to-bottom {\n    position: absolute;\n    bottom: 30px;\n    right: 30px;\n    width: 40px;\n    height: 40px;\n    background: rgba(79, 70, 229, 0.9);\n    border: none;\n    border-radius: 50%;\n    color: #ffffff;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n    transition: all 0.2s ease;\n    z-index: 10;\n    \n    &:hover {\n      background: rgba(79, 70, 229, 1);\n      transform: scale(1.1);\n    }\n    \n    svg {\n      font-size: 20px;\n    }\n  }\n}\n\n// Transitions\n.scroll-button-enter-active,\n.scroll-button-leave-active {\n  transition: all 0.3s ease;\n}\n\n.scroll-button-enter-from,\n.scroll-button-leave-to {\n  opacity: 0;\n  transform: translateY(20px) scale(0.8);\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n@media (max-width: 768px) {\n  .chat-container {\n    .messages {\n      padding: 16px;\n    }\n    \n    .scroll-to-bottom {\n      bottom: 20px;\n      right: 20px;\n      width: 36px;\n      height: 36px;\n      \n      svg {\n        font-size: 18px;\n      }\n    }\n  }\n}\n</style>\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport interface CoordinatorToolVO {\n  id?: number\n  toolName: string\n  toolDescription: string\n  planTemplateId: string\n  httpEndpoint?: string | undefined\n  mcpEndpoint?: string | undefined\n  inputSchema: string\n  serviceGroup?: string\n  enableInternalToolcall?: boolean\n  enableHttpService?: boolean\n  enableMcpService?: boolean\n  createTime?: string\n  updateTime?: string\n}\n\nexport interface CoordinatorToolConfig {\n  enabled: boolean\n  success: boolean\n  message?: string\n}\n\nexport class CoordinatorToolApiService {\n  private static readonly BASE_URL = '/api/coordinator-tools'\n\n  /**\n   * Get all coordinator tools\n   * @returns List of all coordinator tools\n   */\n  public static async getAllCoordinatorTools(): Promise<CoordinatorToolVO[]> {\n    try {\n      const response = await fetch(`${this.BASE_URL}`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      })\n\n      if (!response.ok) {\n        throw new Error(`Failed to get coordinator tools: ${response.status}`)\n      }\n\n      const result = await response.json()\n      return result || []\n    } catch (error: any) {\n      console.error('Failed to get coordinator tools:', error)\n      throw new Error('Failed to get coordinator tools: ' + error.message)\n    }\n  }\n\n  /**\n   * Get CoordinatorTool configuration information\n   */\n  public static async getCoordinatorToolConfig(): Promise<CoordinatorToolConfig> {\n    try {\n      const response = await fetch(`${this.BASE_URL}/config`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      })\n\n      if (!response.ok) {\n        throw new Error(`Failed to get coordinator tool config: ${response.status}`)\n      }\n\n      return await response.json()\n    } catch (error: any) {\n      console.error('Failed to get CoordinatorTool configuration:', error)\n      // Return default configuration\n      return {\n        enabled: true,\n        success: false,\n        message: error.message,\n      }\n    }\n  }\n\n  /**\n   * Get all endpoint list\n   */\n  public static async getAllEndpoints(): Promise<string[]> {\n    try {\n      const response = await fetch(`${this.BASE_URL}/endpoints`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      })\n\n      if (!response.ok) {\n        throw new Error(`Failed to get endpoints: ${response.status}`)\n      }\n\n      return await response.json()\n    } catch (error: any) {\n      console.error('Failed to get endpoints:', error)\n      throw new Error('Failed to get endpoints: ' + error.message)\n    }\n  }\n\n  /**\n   * Get coordinator tool by plan template ID\n   * @param planTemplateId Plan template ID\n   * @returns Coordinator tool if exists, null if not found\n   */\n  public static async getCoordinatorToolByTemplate(\n    planTemplateId: string\n  ): Promise<CoordinatorToolVO | null> {\n    console.log(\n      '[CoordinatorToolApiService] Getting coordinator tool, planTemplateId:',\n      planTemplateId\n    )\n    console.log(\n      '[CoordinatorToolApiService] Request URL:',\n      `${this.BASE_URL}/by-template/${planTemplateId}`\n    )\n\n    try {\n      const response = await fetch(`${this.BASE_URL}/by-template/${planTemplateId}`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      })\n\n      console.log('[CoordinatorToolApiService] Response status:', response.status)\n\n      if (!response.ok) {\n        const errorText = await response.text()\n        console.error('[CoordinatorToolApiService] Response error content:', errorText)\n        throw new Error(`Failed to get coordinator tool: ${response.status} - ${errorText}`)\n      }\n\n      // Get response text first to check if empty\n      const text = await response.text()\n\n      // If response body is empty, treat as not found\n      if (!text || text.trim() === '') {\n        console.log(\n          '[CoordinatorToolApiService] Tool not found for planTemplateId (empty response):',\n          planTemplateId\n        )\n        return null\n      }\n\n      // Parse JSON response\n      let result: CoordinatorToolVO | null\n      try {\n        result = JSON.parse(text)\n      } catch (parseError) {\n        console.error('[CoordinatorToolApiService] Failed to parse JSON response:', parseError)\n        return null\n      }\n\n      // If result is null or empty object, treat as not found\n      if (result === null || (typeof result === 'object' && Object.keys(result).length === 0)) {\n        console.log(\n          '[CoordinatorToolApiService] Tool not found for planTemplateId:',\n          planTemplateId\n        )\n        return null\n      }\n\n      console.log('[CoordinatorToolApiService] Successfully got coordinator tool:', result)\n      return result\n    } catch (error: any) {\n      console.error('[CoordinatorToolApiService] Failed to get coordinator tool:', error)\n      throw new Error('Failed to get coordinator tool: ' + error.message)\n    }\n  }\n\n  /**\n   * Create a default coordinator tool VO for a plan template\n   * This creates a VO object but does not save it to the database\n   * @param planTemplateId Plan template ID\n   * @param planTitle Optional plan template title\n   * @param planDescription Optional plan template description\n   * @returns Default coordinator tool VO\n   */\n  public static createDefaultCoordinatorTool(\n    planTemplateId: string,\n    planTitle?: string,\n    planDescription?: string\n  ): CoordinatorToolVO {\n    return {\n      toolName: planTitle ? `tool_${planTitle}` : '',\n      toolDescription: planDescription ?? '',\n      planTemplateId: planTemplateId,\n      inputSchema: '[]',\n      serviceGroup: '',\n      enableInternalToolcall: false,\n      enableHttpService: false,\n      enableMcpService: false,\n    }\n  }\n\n  /**\n   * Create coordinator tool\n   */\n  public static async createCoordinatorTool(tool: CoordinatorToolVO): Promise<CoordinatorToolVO> {\n    console.log('[CoordinatorToolApiService] Starting to create coordinator tool')\n    console.log('[CoordinatorToolApiService] Original data:', JSON.stringify(tool, null, 2))\n    console.log('[CoordinatorToolApiService] Request URL:', `${this.BASE_URL}`)\n\n    // Only send necessary fields, excluding createTime and updateTime\n    const requestData = {\n      id: tool.id,\n      toolName: tool.toolName,\n      toolDescription: tool.toolDescription,\n      inputSchema: tool.inputSchema,\n      planTemplateId: tool.planTemplateId,\n      httpEndpoint: tool.httpEndpoint,\n      mcpEndpoint: tool.mcpEndpoint,\n      serviceGroup: tool.serviceGroup,\n      enableInternalToolcall: tool.enableInternalToolcall,\n      enableHttpService: tool.enableHttpService,\n      enableMcpService: tool.enableMcpService,\n    }\n\n    console.log(\n      '[CoordinatorToolApiService] Cleaned sending data:',\n      JSON.stringify(requestData, null, 2)\n    )\n\n    try {\n      const response = await fetch(`${this.BASE_URL}`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(requestData),\n      })\n\n      console.log('[CoordinatorToolApiService] Response status:', response.status)\n      console.log('[CoordinatorToolApiService] Response status text:', response.statusText)\n\n      if (!response.ok) {\n        let errorMessage = 'Unknown error'\n        try {\n          const errorData = await response.json()\n          errorMessage = errorData.message || errorData.error || errorMessage\n        } catch {\n          // If JSON parsing fails, try to get text\n          const errorText = await response.text()\n          errorMessage = errorText || errorMessage\n        }\n        console.error('[CoordinatorToolApiService] Response error content:', errorMessage)\n        throw new Error(`Failed to create coordinator tool: ${response.status} - ${errorMessage}`)\n      }\n\n      const result = await response.json()\n      console.log('[CoordinatorToolApiService] Created successfully, result:', result)\n      return result\n    } catch (error: any) {\n      console.error('[CoordinatorToolApiService] Failed to create coordinator tool:', error)\n      throw new Error('Failed to create coordinator tool: ' + error.message)\n    }\n  }\n\n  /**\n   * Update coordinator tool\n   */\n  public static async updateCoordinatorTool(\n    id: number,\n    tool: CoordinatorToolVO\n  ): Promise<CoordinatorToolVO> {\n    console.log('[CoordinatorToolApiService] Starting to update coordinator tool, ID:', id)\n    console.log('[CoordinatorToolApiService] Sending data:', tool)\n    console.log('[CoordinatorToolApiService] Request URL:', `${this.BASE_URL}/${id}`)\n\n    // Only send necessary fields, excluding createTime and updateTime\n    const requestData = {\n      id: tool.id,\n      toolName: tool.toolName,\n      toolDescription: tool.toolDescription,\n      inputSchema: tool.inputSchema,\n      planTemplateId: tool.planTemplateId,\n      httpEndpoint: tool.httpEndpoint,\n      mcpEndpoint: tool.mcpEndpoint,\n      serviceGroup: tool.serviceGroup,\n      enableInternalToolcall: tool.enableInternalToolcall,\n      enableHttpService: tool.enableHttpService,\n      enableMcpService: tool.enableMcpService,\n    }\n\n    console.log('[CoordinatorToolApiService] Cleaned sending data:', requestData)\n\n    try {\n      const response = await fetch(`${this.BASE_URL}/${id}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(requestData),\n      })\n\n      console.log('[CoordinatorToolApiService] Response status:', response.status)\n      console.log('[CoordinatorToolApiService] Response status text:', response.statusText)\n\n      if (!response.ok) {\n        let errorMessage = 'Unknown error'\n        try {\n          const errorData = await response.json()\n          errorMessage = errorData.message || errorData.error || errorMessage\n        } catch {\n          // If JSON parsing fails, try to get text\n          const errorText = await response.text()\n          errorMessage = errorText || errorMessage\n        }\n        console.error('[CoordinatorToolApiService] Response error content:', errorMessage)\n        throw new Error(`Failed to update coordinator tool: ${response.status} - ${errorMessage}`)\n      }\n\n      const result = await response.json()\n      console.log('[CoordinatorToolApiService] Updated successfully, result:', result)\n      return result\n    } catch (error: any) {\n      console.error('[CoordinatorToolApiService] Failed to update coordinator tool:', error)\n      throw new Error('Failed to update coordinator tool: ' + error.message)\n    }\n  }\n\n  /**\n   * Delete coordinator tool\n   */\n  public static async deleteCoordinatorTool(\n    id: number\n  ): Promise<{ success: boolean; message: string }> {\n    console.log('[CoordinatorToolApiService] Starting to delete coordinator tool, ID:', id)\n    console.log('[CoordinatorToolApiService] Request URL:', `${this.BASE_URL}/${id}`)\n\n    try {\n      const response = await fetch(`${this.BASE_URL}/${id}`, {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      })\n\n      console.log('[CoordinatorToolApiService] Response status:', response.status)\n      console.log('[CoordinatorToolApiService] Response status text:', response.statusText)\n\n      if (!response.ok) {\n        const errorText = await response.text()\n        console.error('[CoordinatorToolApiService] Response error content:', errorText)\n        throw new Error(`Failed to delete coordinator tool: ${response.status} - ${errorText}`)\n      }\n\n      const result = await response.json()\n      console.log('[CoordinatorToolApiService] Deleted successfully, result:', result)\n      return result\n    } catch (error: any) {\n      console.error('[CoordinatorToolApiService] Failed to delete coordinator tool:', error)\n      throw new Error('Failed to delete coordinator tool: ' + error.message)\n    }\n  }\n}\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * File information interface matching FileUploadResult.FileInfo from Java\n */\nexport interface FileInfo {\n  originalName: string\n  size: number\n  type: string\n  uploadTime: string\n  success: boolean\n  error?: string\n}\n\n/**\n * File upload result interface matching FileUploadResult from Java\n */\nexport interface FileUploadResult {\n  success: boolean\n  message: string\n  uploadKey: string\n  uploadedFiles: FileInfo[]\n  totalFiles: number\n  successfulFiles: number\n  failedFiles: number\n}\n\n/**\n * Get uploaded files response interface\n */\nexport interface GetUploadedFilesResponse {\n  success: boolean\n  uploadKey: string\n  files: FileInfo[]\n  totalCount: number\n}\n\n/**\n * Delete file response interface\n */\nexport interface DeleteFileResponse {\n  success: boolean\n  message?: string\n  error?: string\n  uploadKey: string\n  fileName: string\n}\n\n/**\n * Upload configuration interface\n */\nexport interface UploadConfig {\n  success: boolean\n  maxFileSize: string\n  maxFiles: number\n  allowedTypes: string[]\n}\n\nexport class FileUploadApiService {\n  \n  /**\n   * Upload files\n   * @param files Files to upload\n   * @returns FileUploadResult with upload information\n   */\n  public static async uploadFiles(files: File[]): Promise<FileUploadResult> {\n    try {\n      console.log('[FileUploadApiService] Uploading files:', files.length)\n      \n      const formData = new FormData()\n      files.forEach(file => {\n        formData.append('files', file)\n      })\n      \n      const response = await fetch('/api/file-upload/upload', {\n        method: 'POST',\n        body: formData,\n      })\n\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`)\n      }\n\n      const result: FileUploadResult = await response.json()\n      console.log('[FileUploadApiService] Files uploaded successfully:', result.successfulFiles, 'uploadKey:', result.uploadKey)\n      return result\n      \n    } catch (error) {\n      console.error('[FileUploadApiService] Error uploading files:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Get uploaded files for a specific upload key\n   * @param uploadKey Upload key to get files for\n   * @returns GetUploadedFilesResponse with file information\n   */\n  public static async getUploadedFiles(uploadKey: string): Promise<GetUploadedFilesResponse> {\n    try {\n      console.log('[FileUploadApiService] Getting uploaded files for uploadKey:', uploadKey)\n      \n      const response = await fetch(`/api/file-upload/files/${encodeURIComponent(uploadKey)}`)\n      \n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`)\n      }\n\n      const result: GetUploadedFilesResponse = await response.json()\n      console.log('[FileUploadApiService] Got uploaded files:', result.totalCount, 'for uploadKey:', uploadKey)\n      return result\n      \n    } catch (error) {\n      console.error('[FileUploadApiService] Error getting uploaded files:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Delete an uploaded file from a specific upload key directory\n   * @param uploadKey Upload key directory\n   * @param fileName File name to delete\n   * @returns DeleteFileResponse with deletion result\n   */\n  public static async deleteFile(uploadKey: string, fileName: string): Promise<DeleteFileResponse> {\n    try {\n      console.log('[FileUploadApiService] Deleting file:', fileName, 'from uploadKey:', uploadKey)\n      \n      const response = await fetch(`/api/file-upload/files/${encodeURIComponent(uploadKey)}/${encodeURIComponent(fileName)}`, {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      })\n\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`)\n      }\n\n      const result: DeleteFileResponse = await response.json()\n      console.log('[FileUploadApiService] File deleted successfully:', result.success)\n      return result\n      \n    } catch (error) {\n      console.error('[FileUploadApiService] Error deleting file:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Get upload configuration and limits\n   * @returns UploadConfig with configuration information\n   */\n  public static async getUploadConfig(): Promise<UploadConfig> {\n    try {\n      console.log('[FileUploadApiService] Getting upload configuration')\n      \n      const response = await fetch('/api/file-upload/config')\n      \n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`)\n      }\n\n      const result: UploadConfig = await response.json()\n      console.log('[FileUploadApiService] Got upload configuration:', result)\n      return result\n      \n    } catch (error) {\n      console.error('[FileUploadApiService] Error getting upload configuration:', error)\n      throw error\n    }\n  }\n}\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"file-upload-component\">\n    <!-- Hidden file input -->\n    <input\n      ref=\"fileInputRef\"\n      type=\"file\"\n      multiple\n      style=\"display: none\"\n      @change=\"handleFileChange\"\n      :accept=\"acceptedFileTypes || ''\"\n    />\n\n    <!-- Uploaded files display with integrated upload button -->\n    <div class=\"uploaded-files\" :class=\"{ 'has-files': uploadedFiles.length > 0 }\">\n      <div class=\"files-header\" @click=\"handleFileUpload\">\n        <Icon icon=\"carbon:attachment\" />\n        <span v-if=\"uploadedFiles.length === 0\">{{ t('input.attachFile') }}</span>\n        <span v-else>{{ t('input.attachedFiles') }} ({{ uploadedFiles.length }})</span>\n      </div>\n      <div v-if=\"uploadedFiles.length > 0\" class=\"files-list\">\n        <div v-for=\"file in uploadedFiles\" :key=\"file.originalName\" class=\"file-item\">\n          <Icon icon=\"carbon:document\" class=\"file-icon\" />\n          <span class=\"file-name\">{{ file.originalName }}</span>\n          <span class=\"file-size\">({{ formatFileSize(file.size) }})</span>\n          <button @click=\"removeFile(file)\" class=\"remove-btn\" :title=\"t('input.removeFile')\">\n            <Icon icon=\"carbon:close\" />\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <!-- Upload progress indicator -->\n    <div v-if=\"isUploading\" class=\"upload-progress\">\n      <Icon icon=\"carbon:rotate--clockwise\" class=\"loading-icon\" />\n      <span>{{ t('input.uploading') }}</span>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, onUnmounted, watch } from 'vue'\nimport { Icon } from '@iconify/vue'\nimport { useI18n } from 'vue-i18n'\nimport { FileInfo, FileUploadApiService, type DeleteFileResponse, type FileUploadResult } from \"@/api/file-upload-api-service\"\n\nconst { t } = useI18n()\n\ntype FileUploadProps = {\n  acceptedFileTypes?: string\n  disabled?: boolean\n}\n\ninterface Emits {\n  (e: 'files-uploaded', files: FileInfo[], uploadKey: string | null): void\n  (e: 'files-removed', files: FileInfo[]): void\n  (e: 'upload-key-changed', uploadKey: string | null): void\n  (e: 'upload-started'): void\n  (e: 'upload-completed'): void\n  (e: 'upload-error', error: any): void\n}\n\nconst props = withDefaults(defineProps<FileUploadProps>(), {\n  acceptedFileTypes: '.pdf,.txt,.md,.doc,.docx,.csv,.xlsx,.xls,.json,.xml,.html,.htm,.log,.java,.py,.js,.ts,.sql,.sh,.bat,.yaml,.yml,.properties,.conf,.ini,.jpg,.jpeg,.png,.gif',\n  disabled: false\n})\n\nconst emit = defineEmits<Emits>()\n\n// Reactive state\nconst fileInputRef = ref<HTMLInputElement>()\nconst uploadedFiles = ref<FileInfo[]>([])\nconst isUploading = ref(false)\nconst uploadKey = ref<string | null>(null)\n\n// Function to reset session when starting a new conversation session\nconst resetSession = () => {\n  console.log('[FileUpload] Resetting session and clearing uploadKey')\n  uploadedFiles.value = []\n  uploadKey.value = null\n  emit('upload-key-changed', null)\n}\n\n// Auto-reset session when component is unmounted to prevent memory leaks\nonUnmounted(() => {\n  resetSession()\n})\n\n// Watch for file changes to emit events\nwatch(() => uploadedFiles.value, (newFiles) => {\n  emit('files-removed', newFiles)\n}, { deep: true })\n\n// File upload handlers\nconst handleFileUpload = () => {\n  if (props.disabled) return\n  if (fileInputRef.value) {\n    fileInputRef.value.click()\n  }\n}\n\nconst handleFileChange = async (event: Event) => {\n  const target = event.target as HTMLInputElement\n  const files = target.files\n\n  if (!files || files.length === 0) return\n\n  // Convert FileList to Array and add to pending files (for batch upload)\n  const fileArray = Array.from(files)\n  console.log('[FileUpload] Selected files for upload:', fileArray.map(f => f.name))\n\n  // Immediately upload all selected files\n  await uploadFiles(fileArray)\n\n  // Reset file input\n  target.value = ''\n}\n\nconst uploadFiles = async (files: File[]) => {\n  if (files.length === 0) return\n\n  isUploading.value = true\n  emit('upload-started')\n\n  try {\n    // Upload files using the new API service\n    const result: FileUploadResult = await FileUploadApiService.uploadFiles(files)\n\n    if (result.success) {\n      // Set uploadKey for file management\n      if (!uploadKey.value && result.uploadKey) {\n        uploadKey.value = result.uploadKey\n        console.log('[FileUpload] Set uploadKey:', uploadKey.value)\n        // New upload session - replace entire array\n        uploadedFiles.value = result.uploadedFiles\n      } else if (uploadKey.value) {\n        console.log('[FileUpload] Using existing uploadKey:', uploadKey.value)\n        // Existing upload session - append to existing files\n        uploadedFiles.value = [...uploadedFiles.value, ...result.uploadedFiles]\n      } else {\n        console.warn('[FileUpload] No uploadKey returned from upload')\n        // Fallback - replace entire array\n        uploadedFiles.value = result.uploadedFiles\n      }\n\n      // Save uploadKey locally\n      if (result.uploadKey) {\n        uploadKey.value = result.uploadKey\n        console.log('[Input] Saved uploadKey locally:', result.uploadKey)\n        emit('upload-key-changed', uploadKey.value)\n      }\n\n      console.log('[Input] Updated global uploadedFiles state:', uploadedFiles.value)\n\n      // Emit files uploaded event\n      emit('files-uploaded', uploadedFiles.value, uploadKey.value)\n    }\n\n    // Show success message or update UI as needed\n    console.log('Files uploaded successfully:', result)\n    emit('upload-completed')\n\n  } catch (error) {\n    console.error('File upload error:', error)\n    emit('upload-error', error)\n  } finally {\n    isUploading.value = false\n  }\n}\n\n// File management functions\nconst removeFile = async (fileToRemove: FileInfo) => {\n  try {\n    console.log(' Removing file:', fileToRemove.originalName, 'from uploadKey:', uploadKey)\n\n    // Call backend API to delete the file from the server\n    if (uploadKey.value) {\n      const result: DeleteFileResponse = await FileUploadApiService.deleteFile(uploadKey.value, fileToRemove.originalName)\n      if (result.success) {\n        console.log(' File deleted from server successfully')\n      } else {\n        console.error(' Failed to delete file from server:', result.error)\n      }\n    }\n\n    // Update frontend state\n    uploadedFiles.value = uploadedFiles.value.filter(file => file.originalName !== fileToRemove.originalName)\n\n    // Clear uploadKey to force new plan for new files if no files remain\n    if (uploadedFiles.value.length === 0) {\n      console.log('[FileUpload]  Clearing uploadKey to force new plan for new files')\n      uploadKey.value = null\n      emit('upload-key-changed', null)\n    }\n\n    console.log(' File removal completed, remaining files:', uploadedFiles.value.length)\n\n  } catch (error) {\n    console.error(' Error removing file:', error)\n    emit('upload-error', error)\n  }\n}\n\nconst formatFileSize = (bytes: number): string => {\n  if (bytes === 0) return '0 Bytes'\n  const k = 1024\n  const sizes = ['Bytes', 'KB', 'MB', 'GB']\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]\n}\n\n// Expose methods and state to parent component\ndefineExpose({\n  uploadedFiles,\n  uploadKey,\n  resetSession,\n  uploadFiles,\n  removeFile,\n  isUploading\n})\n</script>\n\n<style lang=\"less\" scoped>\n.file-upload-component {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  width: 100%;\n}\n\n/* File upload styles */\n.uploaded-files {\n  padding: 8px;\n  border-radius: 8px;\n  transition: all 0.2s ease;\n  width: 100%;\n  box-sizing: border-box;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.08);\n    border-color: rgba(255, 255, 255, 0.2);\n  }\n\n  &.has-files {\n    background: rgba(255, 255, 255, 0.08);\n    border-color: rgba(255, 255, 255, 0.15);\n  }\n}\n\n.files-header {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 4px;\n  font-size: 12px;\n  color: rgba(255, 255, 255, 0.7);\n  font-weight: 500;\n  cursor: pointer;\n  padding: 4px 2px;\n  transition: all 0.2s ease;\n  user-select: none;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.1);\n    color: #007acc;\n  }\n\n  &:active {\n    transform: translateY(1px);\n  }\n}\n\n.files-list {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.file-item {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 6px 8px;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 6px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.08);\n    border-color: rgba(255, 255, 255, 0.2);\n  }\n}\n\n.file-icon {\n  font-size: 14px;\n  color: #007acc;\n  flex-shrink: 0;\n}\n\n.file-name {\n  flex: 1;\n  font-size: 13px;\n  color: #ffffff;\n  font-weight: 500;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.file-size {\n  font-size: 11px;\n  color: rgba(255, 255, 255, 0.6);\n  flex-shrink: 0;\n}\n\n.remove-btn {\n  background: none;\n  border: none;\n  padding: 2px;\n  cursor: pointer;\n  color: rgba(255, 255, 255, 0.5);\n  transition: all 0.2s ease;\n  border-radius: 3px;\n  flex-shrink: 0;\n\n  &:hover {\n    color: #ff6b6b;\n    background: rgba(255, 107, 107, 0.1);\n  }\n}\n\n.upload-progress {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 8px 12px;\n  background: rgba(0, 122, 204, 0.1);\n  border-radius: 6px;\n  border: 1px solid rgba(0, 122, 204, 0.2);\n  font-size: 12px;\n  color: #007acc;\n}\n\n.loading-icon {\n  font-size: 14px;\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n</style>\n","/*\n * Copyright 2024-2026 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {reactive} from \"vue\";\n\nexport interface MemoryEmits {\n    (e: 'memory-selected'): void\n}\n\nexport interface InputMessage {\n    input: string\n    memoryId?: string\n    uploadedFiles?: string[]\n    uploadKey?: string\n}\n\nexport class MemoryStore {\n    // Basic state\n    isCollapsed = false\n    selectMemoryId = ''\n    loadMessages = () => {}\n    intervalId: number | undefined = undefined\n\n    toggleSidebar() {\n        this.isCollapsed = !this.isCollapsed\n        if (this.isCollapsed) {\n            this.loadMessages();\n            this.intervalId = window.setInterval(() => {\n                this.loadMessages();\n            }, 3000);\n        } else {\n            clearInterval(this.intervalId);\n        }\n    }\n\n    selectMemory(memoryId: string) {\n        this.toggleSidebar()\n        this.selectMemoryId = memoryId\n    }\n\n    setMemory(memoryId: string) {\n        this.selectMemoryId = memoryId\n    }\n\n    defaultMemoryId() {\n        this.selectMemoryId = this.generateRandomId()\n    }\n\n    clearMemoryId() {\n        this.selectMemoryId = ''\n    }\n\n    generateRandomId(): string {\n        return Math.random().toString(36).substring(2, 10);\n    }\n\n    setLoadMessages(messages : () => void) {\n        this.loadMessages = messages\n    }\n}\n\nexport const memoryStore = reactive(new MemoryStore())\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"input-area\">\n    <!-- File upload component at the top, full width -->\n    <FileUploadComponent\n      ref=\"fileUploadRef\"\n      :disabled=\"isDisabled\"\n      @files-uploaded=\"handleFilesUploaded\"\n      @files-removed=\"handleFilesRemoved\"\n      @upload-key-changed=\"handleUploadKeyChanged\"\n      @upload-started=\"handleUploadStarted\"\n      @upload-completed=\"handleUploadCompleted\"\n      @upload-error=\"handleUploadError\"\n    />\n\n    <div class=\"input-container\">\n      <!-- First line: User input form -->\n      <div class=\"input-row-first\">\n        <textarea\n          v-model=\"currentInput\"\n          ref=\"inputRef\"\n          class=\"chat-input\"\n          :placeholder=\"currentPlaceholder\"\n          :disabled=\"isDisabled\"\n          @keydown=\"handleKeydown\"\n          @input=\"adjustInputHeight\"\n        ></textarea>\n      </div>\n\n      <!-- Second line: Selection input, Func-Agent mode and send button -->\n      <div class=\"input-row-second\">\n        <select\n          v-model=\"selectedOption\"\n          class=\"selection-input\"\n          :title=\"$t('input.selectionTitle')\"\n          :disabled=\"isLoadingTools || isDisabled\"\n        >\n          <option value=\"\">{{ $t('input.defaultFuncAgent') }}</option>\n          <option v-for=\"option in selectionOptions\" :key=\"option.value\" :value=\"option.value\">\n            {{ option.label }}\n          </option>\n        </select>\n        <button class=\"plan-mode-btn\" :title=\"$t('input.planMode')\" @click=\"handlePlanModeClick\">\n          <Icon icon=\"carbon:document\" />\n          {{ $t('input.planMode') }}\n        </button>\n        <button\n          v-if=\"!isTaskRunning\"\n          class=\"send-button\"\n          :disabled=\"!currentInput.trim() || isDisabled\"\n          @click=\"handleSend\"\n          :title=\"$t('input.send')\"\n        >\n          <Icon icon=\"carbon:send-alt\" />\n          {{ $t('input.send') }}\n        </button>\n        <button\n          v-else\n          class=\"send-button stop-button\"\n          @click=\"handleStop\"\n          :title=\"$t('input.stop')\"\n        >\n          <Icon icon=\"carbon:stop-filled\" />\n          {{ $t('input.stop') }}\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { CoordinatorToolApiService } from '@/api/coordinator-tool-api-service'\nimport { FileInfo } from '@/api/file-upload-api-service'\nimport FileUploadComponent from '@/components/file-upload/FileUploadComponent.vue'\nimport type { InputMessage } from '@/stores/memory'\nimport { memoryStore } from '@/stores/memory'\nimport { useTaskStore } from '@/stores/task'\nimport { Icon } from '@iconify/vue'\nimport { computed, nextTick, onMounted, onUnmounted, ref, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\n\nconst { t } = useI18n()\nconst taskStore = useTaskStore()\n\n// Track if task is running\nconst isTaskRunning = computed(() => taskStore.hasRunningTask())\n\ninterface Props {\n  placeholder?: string\n  disabled?: boolean\n  initialValue?: string\n  selectionOptions?: Array<{ value: string; label: string }>\n}\n\ninterface InnerToolOption {\n  value: string\n  label: string\n  toolName: string\n  planTemplateId: string\n  paramName: string\n}\n\ninterface Emits {\n  (e: 'send', message: InputMessage): void\n  (e: 'clear'): void\n  (e: 'update-state', enabled: boolean, placeholder?: string): void\n  (e: 'plan-mode-clicked'): void\n  (e: 'selection-changed', value: string): void\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  placeholder: '',\n  disabled: false,\n  initialValue: '',\n  selectionOptions: () => [],\n})\n\nconst emit = defineEmits<Emits>()\n\nconst inputRef = ref<HTMLTextAreaElement>()\nconst fileUploadRef = ref<InstanceType<typeof FileUploadComponent>>()\nconst currentInput = ref('')\nconst defaultPlaceholder = computed(() => props.placeholder || t('input.placeholder'))\nconst currentPlaceholder = ref(defaultPlaceholder.value)\nconst uploadedFiles = ref<string[]>([])\nconst uploadKey = ref<string | null>(null)\nconst selectedOption = ref('')\nconst innerToolOptions = ref<InnerToolOption[]>([])\nconst isLoadingTools = ref(false)\n\n// Load inner tools with single parameter\nconst loadInnerTools = async () => {\n  isLoadingTools.value = true\n  try {\n    console.log('[InputArea] Loading inner tools...')\n    const allTools = await CoordinatorToolApiService.getAllCoordinatorTools()\n\n    // Filter tools: enableInternalToolcall=true and exactly one parameter\n    const filteredTools: InnerToolOption[] = []\n\n    for (const tool of allTools) {\n      // Check if it's an internal toolcall\n      if (!tool.enableInternalToolcall) {\n        continue\n      }\n\n      // Parse inputSchema to count parameters\n      try {\n        const inputSchema = JSON.parse(tool.inputSchema || '[]')\n        if (Array.isArray(inputSchema) && inputSchema.length === 1) {\n          // Exactly one parameter\n          const param = inputSchema[0]\n          filteredTools.push({\n            value: tool.planTemplateId,\n            label: `${tool.toolName} (${param.name})`,\n            toolName: tool.toolName,\n            planTemplateId: tool.planTemplateId,\n            paramName: param.name,\n          })\n        }\n      } catch (e) {\n        console.warn('[InputArea] Failed to parse inputSchema for tool:', tool.toolName, e)\n      }\n    }\n\n    innerToolOptions.value = filteredTools\n    console.log('[InputArea] Loaded', filteredTools.length, 'inner tools with single parameter')\n\n    // Restore selected tool from localStorage and validate it still exists\n    const savedTool = localStorage.getItem('inputAreaSelectedTool')\n    if (savedTool) {\n      const toolExists = filteredTools.some(tool => tool.value === savedTool)\n      if (toolExists) {\n        selectedOption.value = savedTool\n        console.log('[InputArea] Restored selected tool from localStorage:', savedTool)\n      } else {\n        console.log('[InputArea] Saved tool no longer available, clearing selection')\n        localStorage.removeItem('inputAreaSelectedTool')\n        selectedOption.value = ''\n      }\n    }\n  } catch (error) {\n    console.error('[InputArea] Failed to load inner tools:', error)\n    innerToolOptions.value = []\n  } finally {\n    isLoadingTools.value = false\n  }\n}\n\n// Computed property for selection options (use inner tools if available, otherwise use props)\nconst selectionOptions = computed(() => {\n  if (innerToolOptions.value.length > 0) {\n    return innerToolOptions.value.map(tool => ({\n      value: tool.value,\n      label: tool.label,\n    }))\n  }\n  return props.selectionOptions\n})\n\n// Watch for selection changes and persist to localStorage\nwatch(selectedOption, newValue => {\n  emit('selection-changed', newValue)\n  // Save to localStorage\n  localStorage.setItem('inputAreaSelectedTool', newValue || '')\n})\n\n// Load inner tools on mount\nonMounted(() => {\n  loadInnerTools()\n})\n\n// Function to reset session when starting a new conversation session\nconst resetSession = () => {\n  console.log('[FileUpload] Resetting session and clearing uploadKey')\n  fileUploadRef.value?.resetSession()\n}\n\n// Auto-reset session when component is unmounted to prevent memory leaks\nonUnmounted(() => {\n  resetSession()\n})\n// File upload event handlers\nconst handleFilesUploaded = (files: FileInfo[], key: string | null) => {\n  uploadedFiles.value = files.map(file => file.originalName)\n  uploadKey.value = key\n  console.log('[InputArea] Files uploaded:', files.length, 'uploadKey:', key)\n\n  // Update placeholder to show files are attached\n  if (uploadedFiles.value.length > 0) {\n    currentPlaceholder.value = t('input.filesAttached', { count: uploadedFiles.value.length })\n  }\n}\n\nconst handleFilesRemoved = (files: FileInfo[]) => {\n  uploadedFiles.value = files.map(file => file.originalName)\n  console.log('[InputArea] Files removed, remaining:', files.length)\n\n  // Update placeholder\n  if (uploadedFiles.value.length === 0) {\n    currentPlaceholder.value = defaultPlaceholder.value\n  } else {\n    currentPlaceholder.value = t('input.filesAttached', { count: uploadedFiles.value.length })\n  }\n}\n\nconst handleUploadKeyChanged = (key: string | null) => {\n  uploadKey.value = key\n  console.log('[InputArea] Upload key changed:', key)\n}\n\nconst handleUploadStarted = () => {\n  console.log('[InputArea] Upload started')\n}\n\nconst handleUploadCompleted = () => {\n  console.log('[InputArea] Upload completed')\n}\n\nconst handleUploadError = (error: any) => {\n  console.error('[InputArea] Upload error:', error)\n}\n\n// Computed property to ensure 'disabled' is a boolean type\nconst isDisabled = computed(() => Boolean(props.disabled))\n\nconst adjustInputHeight = () => {\n  nextTick(() => {\n    if (inputRef.value) {\n      inputRef.value.style.height = 'auto'\n      inputRef.value.style.height = Math.min(inputRef.value.scrollHeight, 120) + 'px'\n    }\n  })\n}\n\nconst handleKeydown = (event: KeyboardEvent) => {\n  if (event.key === 'Enter' && !event.shiftKey) {\n    event.preventDefault()\n    handleSend()\n  }\n}\n\nconst handleSend = async () => {\n  if (!currentInput.value.trim() || isDisabled.value) return\n\n  const finalInput = currentInput.value.trim()\n\n  // Prepare query with tool information if selected\n  const query: InputMessage = {\n    input: finalInput,\n    memoryId: memoryStore.selectMemoryId,\n    uploadedFiles: uploadedFiles.value,\n  }\n\n  // Add uploadKey if it exists\n  if (uploadKey.value) {\n    query.uploadKey = uploadKey.value\n    console.log('[InputArea] Including uploadKey in message:', uploadKey.value)\n  } else {\n    console.log('[InputArea] No uploadKey available for message')\n  }\n\n  // Check if a tool is selected\n  if (selectedOption.value) {\n    const selectedTool = innerToolOptions.value.find(tool => tool.value === selectedOption.value)\n\n    if (selectedTool) {\n      // Add tool information to query for backend processing\n      // This will be handled by handleChatSendMessage which will call executeByToolName\n      ;(query as any).toolName = selectedTool.planTemplateId\n      ;(query as any).replacementParams = {\n        [selectedTool.paramName]: finalInput,\n      }\n      console.log('[InputArea] Sending message with tool:', selectedTool.toolName)\n    }\n  }\n\n  // Use Vue's emit to send a message (this will trigger handleChatSendMessage which shows assistant message)\n  emit('send', query)\n\n  // Clear the input but keep uploaded files and uploadKey for follow-up conversations\n  clearInput()\n}\n\nconst handlePlanModeClick = () => {\n  // Trigger the plan mode toggle event\n  emit('plan-mode-clicked')\n}\n\nconst handleStop = async () => {\n  console.log('[InputArea] Stop button clicked')\n  const success = await taskStore.stopCurrentTask()\n  if (success) {\n    console.log('[InputArea] Task stopped successfully')\n  } else {\n    console.error('[InputArea] Failed to stop task')\n  }\n}\n\n/**\n * Clear the input box\n */\nconst clearInput = () => {\n  currentInput.value = ''\n  adjustInputHeight()\n  emit('clear')\n}\n\n/**\n * Update the state of the input area (enable/disable)\n * @param {boolean} enabled - Whether to enable input\n * @param {string} [placeholder] - Placeholder text when enabled\n */\nconst updateState = (enabled: boolean, placeholder?: string) => {\n  if (placeholder) {\n    currentPlaceholder.value = enabled ? placeholder : t('input.waiting')\n  }\n  emit('update-state', enabled, placeholder)\n}\n\n/**\n * Set the input value without triggering send\n * @param {string} value - The value to set\n */\nconst setInputValue = (value: string) => {\n  currentInput.value = value\n  adjustInputHeight()\n}\n\n/**\n * Get the current value of the input box\n * @returns {string} The text value of the current input box (trimmed)\n */\nconst getQuery = () => {\n  return currentInput.value.trim()\n}\n\n// Watch for initialValue changes\nwatch(\n  () => props.initialValue,\n  newValue => {\n    if (newValue.trim()) {\n      currentInput.value = newValue\n      adjustInputHeight()\n    }\n  },\n  { immediate: true }\n)\n\n// Expose methods to the parent component\ndefineExpose({\n  clearInput,\n  updateState,\n  setInputValue,\n  getQuery,\n  resetSession,\n  focus: () => inputRef.value?.focus(),\n  get uploadedFiles() {\n    return fileUploadRef.value?.uploadedFiles?.map(f => f.originalName) || []\n  },\n  get uploadKey() {\n    return fileUploadRef.value?.uploadKey || null\n  },\n})\n\nonMounted(() => {\n  // Initialization logic after component mounting\n})\n\nonUnmounted(() => {\n  // Cleanup logic before component unmounting\n})\n</script>\n\n<style lang=\"less\" scoped>\n.input-area {\n  min-height: 112px;\n  padding: 10px 12px;\n  border-top: 1px solid #1a1a1a;\n  background: rgba(255, 255, 255, 0.02);\n  /* Ensure the input area is always at the bottom */\n  flex-shrink: 0; /* Won't be compressed */\n  position: sticky; /* Fixed at the bottom */\n  bottom: 0;\n  z-index: 100;\n  /* Add a slight shadow to distinguish the message area */\n  box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);\n  backdrop-filter: blur(20px);\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.input-container {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 12px;\n  padding: 12px 16px;\n\n  &:focus-within {\n    border-color: #667eea;\n  }\n}\n\n.input-row-first {\n  display: flex;\n  align-items: center;\n  width: 100%;\n}\n\n.input-row-second {\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n  gap: 8px;\n}\n\n.selection-input {\n  flex-shrink: 0;\n  padding: 6px 8px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: #ffffff;\n  font-size: 12px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  outline: none;\n  width: 24ch;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.1);\n    border-color: rgba(255, 255, 255, 0.3);\n  }\n\n  &:focus {\n    border-color: #667eea;\n    background: rgba(255, 255, 255, 0.08);\n  }\n\n  option {\n    background: #1a1a1a;\n    color: #ffffff;\n    white-space: normal;\n    padding: 4px 8px;\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n}\n\n.chat-input {\n  flex: 1;\n  background: transparent;\n  border: none;\n  outline: none;\n  color: #ffffff;\n  font-size: 14px;\n  line-height: 1.5;\n  resize: none;\n  min-height: 20px;\n  max-height: 120px;\n\n  &::placeholder {\n    color: #666666;\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n\n    &::placeholder {\n      color: #444444;\n    }\n  }\n}\n\n.plan-mode-btn {\n  flex-shrink: 0;\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  padding: 6px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: #ffffff;\n  font-size: 12px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.1);\n    border-color: #667eea;\n    transform: translateY(-1px);\n  }\n}\n\n.send-button {\n  flex-shrink: 0;\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  padding: 6px 12px;\n  border: none;\n  border-radius: 6px;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: #ffffff;\n  font-size: 12px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n\n  &:hover:not(:disabled) {\n    transform: translateY(-1px);\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n\n  &.stop-button {\n    background: linear-gradient(135deg, #f56565 0%, #c53030 100%);\n\n    &:hover {\n      background: linear-gradient(135deg, #fc8181 0%, #e53e3e 100%);\n    }\n  }\n}\n\n.clear-memory-btn {\n  width: 1.5em;\n  height: 1.5em;\n}\n</style>\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport interface Memory {\n    id: number;\n    conversation_id: string;\n    memory_name: string;\n    create_time: string;\n    messages?: MessageBubble[];\n}\n\nexport interface MemoryResponse {\n    success: boolean;\n    message: string;\n    data?: Memory;\n    memories?: Memory[];\n    total_count?: number;\n    response_time: string;\n}\n\nexport interface MessageBubble {\n    messageType: string;\n    text: string;\n}\n\nexport class MemoryApiService {\n    private static readonly BASE_URL = '/api/memories'\n\n    private static async handleResponse(response: Response) {\n        if (!response.ok) {\n            try {\n                const errorData = await response.json()\n                throw new Error(errorData.message || `API request failed: ${response.status}`)\n            } catch {\n                throw new Error(`API request failed: ${response.status} ${response.statusText}`)\n            }\n        }\n        return response\n    }\n\n    static async getMemories(): Promise<Memory[]> {\n        try {\n            const response = await fetch(`${this.BASE_URL}`)\n            const result = await this.handleResponse(response)\n            const data: MemoryResponse = await result.json()\n            return data.memories ?? []\n        } catch (error) {\n            console.error('Failed to get memory list:', error)\n            throw error\n        }\n    }\n\n    static async getMemory(conversationId: string): Promise<Memory> {\n        try {\n            const response = await fetch(`${this.BASE_URL}/single?conversationId=${conversationId}`)\n            const result = await this.handleResponse(response)\n            const data: MemoryResponse = await result.json()\n            if (!data.data) {\n                throw new Error('Memory not found')\n            }\n            return data.data\n        } catch (error) {\n            console.error('Failed to get memory:', error)\n            throw error\n        }\n    }\n\n    static async createMemory(conversationId: string, memoryName: string): Promise<Memory> {\n        try {\n            const response = await fetch(`${this.BASE_URL}`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({\n                    conversation_id: conversationId,\n                    memory_name: memoryName\n                })\n            })\n            const result = await this.handleResponse(response)\n            const data: MemoryResponse = await result.json()\n            if (!data.data) {\n                throw new Error('Failed to create memory')\n            }\n            return data.data\n        } catch (error) {\n            console.error('Failed to create memory:', error)\n            throw error\n        }\n    }\n\n    static async updateMemory(conversationId: string, memoryName: string): Promise<Memory> {\n        try {\n            const response = await fetch(`${this.BASE_URL}`, {\n                method: 'PUT',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({\n                    conversation_id: conversationId,\n                    memory_name: memoryName\n                })\n            })\n            const result = await this.handleResponse(response)\n            const data: MemoryResponse = await result.json()\n            if (!data.data) {\n                throw new Error('Failed to update memory')\n            }\n            return data.data\n        } catch (error) {\n            console.error('Failed to update memory:', error)\n            throw error\n        }\n    }\n\n    static async deleteMemory(conversationId: string): Promise<void> {\n        try {\n            const response = await fetch(`${this.BASE_URL}/${conversationId}`, {\n                method: 'DELETE'\n            })\n            await this.handleResponse(response)\n        } catch (error) {\n            console.error('Failed to delete memory:', error)\n            throw error\n        }\n    }\n\n    static async generateConversationId(): Promise<Memory> {\n        try {\n            const response = await fetch(`${this.BASE_URL}/generate-id`)\n            const result = await this.handleResponse(response)\n            const data: MemoryResponse = await result.json()\n            if (!data.data) {\n                throw new Error('Failed to generate conversation ID')\n            }\n            return data.data\n        } catch (error) {\n            console.error('Failed to generate conversation ID:', error)\n            throw error\n        }\n    }\n}\n","<template>\n  <Teleport to=\"body\">\n    <Transition name=\"modal\">\n      <div class=\"app-container\" v-if=\"memoryStore.isCollapsed\">\n        <div class=\"app-content\">\n          <div class=\"header\">\n            <div class=\"relative\">\n              <div class=\"title-edit-group\">\n                <h1 id=\"main-title\" class=\"main-title\">\n                  <span>{{ $t('memory.title') }}</span>\n                </h1>\n              </div>\n\n              <div\n                  id=\"title-edit-container\"\n                  class=\"title-edit-container\"\n                  v-if=\"showTitleEdit\"\n              >\n              </div>\n            </div>\n            <button class=\"close-btn\" @click=\"memoryStore.toggleSidebar()\">\n              <Icon icon=\"carbon:close\" />\n            </button>\n          </div>\n\n          <div class=\"search-bar\">\n            <div class=\"search-container\">\n              <Icon class=\"search-container-icon\" icon=\"carbon:search\" />\n              <input\n                  type=\"text\"\n                  :placeholder=\"$t('memory.searchPlaceholder')\"\n                  class=\"search-input\"\n                  v-model=\"searchQuery\"\n                  @input=\"handleSearch\"\n              >\n            </div>\n          </div>\n\n          <div class=\"message-list\" id=\"message-list\">\n            <div>\n              <div\n                  class=\"message-item\"\n                  v-for=\"message in filteredMessages\"\n                  :key=\"message.conversation_id\"\n                  :class=\"{ 'expanded': message.expanded }\"\n              >\n                <div class=\"message-header\">\n                  <div class=\"message-content\">\n                    <div class=\"sender-info\">\n                      <div class=\"sender-div\" @click.stop=\"selectMemory(message.conversation_id)\">\n                        <h3\n                            class=\"sender-name\"\n                        >\n                          {{ message.memory_name }}\n                        </h3>\n                      </div>\n\n                      <div class=\"toggle-container\" @click.stop=\"showNameEditModal(message.conversation_id, message.memory_name)\">\n                        <Icon\n                            icon=\"carbon:edit\"\n                            class=\"edit-btn\"\n                        >\n                        </Icon>\n                      </div>\n                      <div class=\"action-buttons\">\n                        <button\n                            class=\"delete-btn\"\n                            @click.stop=\"toggleMessage(message.conversation_id)\"\n                        >\n                          <Icon :id=\"'toggle-' + message.conversation_id\"\n                                icon=\"carbon:chevron-down\"\n                                class=\"down-btn\"\n                          ></Icon>\n                        </button>\n                      </div>\n                      <div class=\"action-buttons\">\n                        <button\n                            class=\"delete-btn\"\n                            @click.stop=\"showDeleteConfirm(message.conversation_id)\"\n                        >\n                          <Icon icon=\"carbon:delete\"></Icon>\n                        </button>\n                      </div>\n                    </div>\n\n                    <div class=\"message-preview\">\n                      <p class=\"preview-line\">\n                        {{ message.messages && message.messages.length > 0 ? message.messages[0].text : 'none message' }}\n                      </p>\n                      <p\n                          class=\"preview-line\"\n                          style=\"opacity: 0.8;\"\n                          v-if=\"message.messages && message.messages.length > 1\"\n                      >\n                        {{ message.messages[1].text }}\n                      </p>\n                    </div>\n\n                    <div class=\"message-meta\">\n                      <span class=\"message-id\">ID: {{ message.conversation_id }}</span>\n                      <div class=\"meta-right\">\n                      <span class=\"unread-count\" v-if=\"message.messages && message.messages.length > 0\">\n                        {{ message.messages.length }} {{$t('memory.size')}}\n                      </span>\n                        <span class=\"message-time\">{{ formatTimestamp(message.create_time) }}</span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n                <div\n                    :id=\"'content-' + message.conversation_id\"\n                    class=\"expanded-content\"\n                    v-if=\"message.expanded\"\n                >\n                  <div style=\"display: flex; flex-direction: column; gap: 0.75rem;\">\n                    <div class=\"message-bubble\" v-for=\"(bubble, idx) in message.messages\" :key=\"idx\">\n                      <div class=\"bubble-avatar\">\n                        {{ bubble.messageType }}\n                      </div>\n                      <div class=\"bubble-content\">\n                        <p class=\"bubble-text\">{{ bubble.text }}</p>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div v-if=\"filteredMessages.length === 0 && searchQuery\" class=\"empty-state\">\n              <p class=\"state-text\">none message</p>\n            </div>\n          </div>\n\n          <div\n              id=\"name-edit-modal\"\n              class=\"modal-overlay\"\n              v-if=\"showNameModal\"\n              @click.self=\"closeNameModal\"\n          >\n            <div class=\"modal-content\">\n              <div class=\"modal-header\">\n                <h3 class=\"modal-title\">{{$t('memory.changeName')}}</h3>\n                <input\n                    type=\"text\"\n                    v-model=\"nameInput\"\n                    class=\"edit-input\"\n                    :placeholder=\"$t('memory.newNamePlaceholder')\"\n                >\n                <span id=\"name-char-count\" class=\"char-count\" style=\"text-align: right; display: block; margin-top: 0.25rem;\">\n                {{ nameInput.length }}\n              </span>\n              </div>\n\n              <div class=\"modal-footer\">\n                <button\n                    id=\"cancel-name\"\n                    class=\"modal-btn cancel-btn\"\n                    @click=\"closeNameModal\"\n                >\n                  {{$t('memory.cancel')}}\n                </button>\n                <button\n                    id=\"save-name\"\n                    class=\"modal-btn confirm-btn\"\n                    @click=\"saveName\"\n                >\n                  {{$t('memory.save')}}\n                </button>\n              </div>\n            </div>\n          </div>\n\n          <div\n              id=\"delete-modal\"\n              class=\"modal-overlay\"\n              v-if=\"showDeleteModal\"\n              @click.self=\"closeDeleteModal\"\n          >\n            <div class=\"modal-content\">\n              <div class=\"modal-header\">\n                <h3 class=\"modal-title\">{{$t('memory.deleteHint')}}</h3>\n                <p class=\"state-text\" id=\"delete-message\">\n                  {{$t('memory.deleteHintPrefix')}} {{ currentDeleteId }} {{$t('memory.deleteHintSuffix')}}\n                </p>\n              </div>\n\n              <div class=\"modal-footer\">\n                <button\n                    id=\"cancel-delete\"\n                    class=\"modal-btn cancel-btn\"\n                    @click=\"closeDeleteModal\"\n                >\n                  {{$t('memory.cancel')}}\n                </button>\n                <button\n                    id=\"confirm-delete\"\n                    class=\"modal-btn delete-btn-confirm\"\n                    @click=\"confirmDelete\"\n                >\n                  {{$t('memory.delete')}}\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </Transition>\n  </Teleport>\n</template>\n\n<script setup lang=\"ts\">\nimport {onMounted, onUnmounted, ref} from 'vue';\nimport {MemoryApiService} from '@/api/memory-api-service'\nimport type { Memory} from '@/api/memory-api-service'\n\n// Extended interface for UI state\ninterface MemoryWithExpanded extends Memory {\n  expanded: boolean;\n}\nimport {Icon} from '@iconify/vue'\nimport {memoryStore} from \"@/stores/memory\";\nimport type {MemoryEmits} from \"@/stores/memory\";\n\nconst showTitleEdit = ref(false);\nconst searchQuery = ref('');\nconst messages = ref<MemoryWithExpanded[]>([]);\nconst filteredMessages = ref<MemoryWithExpanded[]>([]);\n\nconst showNameModal = ref(false);\nconst currentEditMessageId = ref<string | null>(null);\nconst nameInput = ref('');\n\nconst showDeleteModal = ref(false);\nconst currentDeleteId = ref<string | null>(null);\nconst expandedMap = new Map()\nconst emit = defineEmits<MemoryEmits>()\n\n// Handle ESC key to close modals\nconst handleEscKey = (e: KeyboardEvent) => {\n  if (e.key === 'Escape') {\n    if (showDeleteModal.value) {\n      closeDeleteModal()\n    } else if (showNameModal.value) {\n      closeNameModal()\n    }\n  }\n}\n\nonMounted(() => {\n  memoryStore.setLoadMessages(loadMessages)\n  document.addEventListener('keydown', handleEscKey)\n});\n\nonUnmounted(() => {\n  document.removeEventListener('keydown', handleEscKey)\n});\n\nconst loadMessages = async () => {\n  try {\n    const mes = await MemoryApiService.getMemories()\n    messages.value = mes.map((mesMsg: Memory): MemoryWithExpanded => ({\n      ...mesMsg,\n      expanded: expandedMap.has(mesMsg.conversation_id)\n          ? expandedMap.get(mesMsg.conversation_id)\n          : false\n    }));\n    filteredMessages.value = [...messages.value];\n    handleSearch()\n  } catch (e) {\n    console.error('error:', e);\n    messages.value = [];\n\n    filteredMessages.value = [];\n  }\n};\n\nconst selectMemory = (conversationId: string) => {\n  memoryStore.selectMemory(conversationId);\n  emit('memory-selected')\n};\n\nconst formatTimestamp = (timestamp: number | string): string => {\n  const timestampNum = typeof timestamp === 'string' ? parseInt(timestamp, 10) : timestamp;\n  if (isNaN(timestampNum) || timestampNum <= 0) {\n    return 'unknow time';\n  }\n  const date = new Date(\n      timestampNum.toString().length === 13\n          ? timestampNum\n          : timestampNum * 1000\n  );\n\n  return date.toLocaleString('zh-CN', {\n    year: 'numeric',\n    month: '2-digit',\n    day: '2-digit',\n    hour: '2-digit',\n    minute: '2-digit',\n    second: '2-digit',\n    hour12: false\n  }).replace(',', ' ');\n};\n\nconst handleSearch = () => {\n  const query = searchQuery.value.toLowerCase().trim();\n\n  if (!query) {\n    filteredMessages.value = [...messages.value];\n    return;\n  }\n\n  filteredMessages.value = messages.value.filter(message => {\n    const matchesName = message.memory_name.toLowerCase().includes(query);\n    const matchesId = message.conversation_id.toLowerCase().includes(query);\n    const matchesContent = message.messages?.some(bubble =>\n        bubble.text.toLowerCase().includes(query)\n    ) ?? false;\n    return matchesName || matchesId || matchesContent;\n  });\n};\n\nconst showNameEditModal = (messageId: string, currentName: string) => {\n  currentEditMessageId.value = messageId;\n  nameInput.value = currentName;\n  showNameModal.value = true;\n};\n\nconst closeNameModal = () => {\n  showNameModal.value = false;\n  currentEditMessageId.value = null;\n};\n\nconst saveName = async () => {\n  if (!currentEditMessageId.value) return;\n  const newName = nameInput.value.trim() || 'unknow name';\n  const messageIndex = messages.value.findIndex(\n      msg => msg.conversation_id === currentEditMessageId.value\n  );\n  if (messageIndex !== -1) {\n    const currentMessage = messages.value[messageIndex]\n    try {\n      const returnMemory = await MemoryApiService.updateMemory(currentMessage.conversation_id, newName)\n      if (!returnMemory.messages) {\n        returnMemory.messages = [];\n      }\n      messages.value[messageIndex] = {...returnMemory, expanded: currentMessage.expanded} as MemoryWithExpanded;\n      handleSearch();\n      showNameModal.value = false;\n    } catch (error) {\n      console.error('error:', error);\n    }\n  }\n};\n\nconst toggleMessage = (id: string) => {\n  const message = messages.value.find(msg => msg.conversation_id === id);\n  if (message) {\n    message.expanded = !message.expanded;\n    expandedMap.set(id, message.expanded)\n    const filteredIndex = filteredMessages.value.findIndex(msg => msg.conversation_id === id);\n    if (filteredIndex !== -1) {\n      filteredMessages.value[filteredIndex] = {...message};\n    }\n  }\n};\n\nconst showDeleteConfirm = (id: string) => {\n  currentDeleteId.value = id;\n  showDeleteModal.value = true;\n};\n\nconst closeDeleteModal = () => {\n  showDeleteModal.value = false;\n  currentDeleteId.value = null;\n};\n\nconst confirmDelete = async () => {\n  if (!currentDeleteId.value) return;\n\n  try {\n    await MemoryApiService.deleteMemory(currentDeleteId.value);\n    messages.value = messages.value.filter(msg => msg.conversation_id !== currentDeleteId.value);\n    handleSearch();\n    if(messages.value.length === 0){\n      memoryStore.clearMemoryId()\n    }\n    showDeleteModal.value = false;\n    currentDeleteId.value = null;\n  } catch (error) {\n    console.error('error:', error);\n  }\n};\n</script>\n\n<style scoped>\n* {\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n  font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif;\n}\n\n.app-container {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.7);\n  backdrop-filter: blur(4px);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n\n.app-content {\n  position: relative;\n  transition: all 0.3s ease-in-out;\n  overflow-y: auto;\n  border-radius: 16px;\n  width: 90%;\n  background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.15));\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);\n  max-width: 800px;\n  max-height: 80vh;\n  min-height: 500px;\n}\n\n.memory-wrapper-collapsed {\n  border-right: none;\n  width: 0;\n}\n\n.header {\n  padding: 1rem;\n  border-bottom: 1px solid #333333;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.main-title {\n  font-size: 1.25rem;\n  font-weight: bold;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  -webkit-background-clip: text;\n  background-clip: text;\n  color: transparent;\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n}\n\n.main-title i {\n  margin-right: 0.5rem;\n}\n\n.close-btn {\n  background: none;\n  border: none;\n  color: rgba(255, 255, 255, 0.6);\n  cursor: pointer;\n  padding: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.3s;\n}\n\n.close-btn:hover {\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.search-bar {\n  padding: 1rem;\n  border-bottom: 1px solid #333333;\n}\n\n.search-container {\n  position: relative;\n}\n.search-container-icon {\n  position: absolute;\n  top: 10px;\n  left: 8px;\n}\n\n.search-input {\n  width: 100%;\n  background-color: #2d2d2d;\n  border: 1px solid #333333;\n  border-radius: 0.5rem;\n  padding: 0.5rem 0.5rem 0.5rem 2.5rem;\n  color: #ffffff;\n  font-size: 0.875rem;\n}\n\n.search-input:focus {\n  outline: none;\n  border-color: #667eea;\n}\n\n.search-icon {\n  position: absolute;\n  left: 0.75rem;\n  top: 50%;\n  transform: translateY(-50%);\n  color: #888888;\n}\n\n.message-list {\n  flex: 1;\n  overflow-y: auto;\n  padding: 0.5rem;\n}\n\n.message-item {\n  background-color: #2d2d2d;\n  border: 1px solid #333333;\n  border-radius: 0.5rem;\n  overflow: hidden;\n  margin-bottom: 0.5rem;\n  transition: all 0.2s ease;\n}\n\n.message-item:hover {\n  background-color: #333333;\n  border-color: rgba(102, 126, 234, 0.5);\n}\n\n.message-header {\n  cursor: text;\n  padding: 0.75rem;\n  align-items: center;\n  width: 100%;\n}\n\n.message-content {\n  flex: 1;\n  min-width: 0;\n  padding-right: 0.5rem;\n}\n.message.user .message-content {\n  flex: none !important;\n}\n\n.sender-info {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  margin-bottom: 0.25rem;\n}\n\n.sender-div {\n  display: flex;\n  align-items: center;\n  width: 85%;\n  cursor: pointer;\n}\n\n.sender-div:hover:not(:has(.edit-btn:hover, .down-btn:hover, .delete-btn:hover)) .sender-name {\n  color: #667eea;\n}\n\n.sender-name {\n  font-weight: 600;\n  color: rgba(255, 255, 255, 0.9);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.message-preview {\n  margin-bottom: 0.25rem;\n  padding: 8px;\n  background: rgba(0, 0, 0, 0.3);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n}\n\n.preview-line {\n  font-size: 0.875rem;\n  color: rgba(255, 255, 255, 0.7);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  margin-bottom: 0.125rem;\n}\n\n.message-meta {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  width: 100%;\n  margin-top: 0.25rem;\n}\n\n.meta-right {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n\n.message-id {\n  font-size: 0.75rem;\n  color: #667eea;\n}\n\n.message-time {\n  font-size: 0.75rem;\n  color: rgba(255, 255, 255, 0.5);\n  white-space: nowrap;\n}\n\n.unread-count {\n  font-size: 0.75rem;\n  background-color: rgba(102, 126, 234, 0.2);\n  color: #667eea;\n  padding: 0.125rem 0.375rem;\n  margin-top: 2px;\n  border-radius: 1rem;\n}\n\n.toggle-container {\n  margin-left: auto;\n  margin-top: 4px;\n  display: flex;\n  align-items: center;\n}\n\n.action-buttons {\n  margin-left: 0.5rem;\n  transition: opacity 0.2s ease;\n}\n\n.message-item:hover .action-buttons {\n  opacity: 1;\n}\n\n.edit-btn {\n  margin-left: 10px;\n  cursor: pointer;\n}\n\n.edit-btn:hover {\n  color: #667eea;\n}\n\n.down-btn {\n  cursor: pointer;\n}\n\n.down-btn:hover {\n  color: #667eea;\n}\n\n.delete-btn {\n  color: rgba(255, 255, 255, 0.7);\n  background: none;\n  border: none;\n  cursor: pointer;\n  padding: 0.25rem 0;\n  font-size: 1rem;\n}\n\n.delete-btn:hover {\n  color: #ff6b6b;\n}\n\n.expanded-content {\n  background-color: #333333;\n  border-top: 1px solid #444444;\n  padding: 0.75rem;\n  animation: fadeIn 0.3s ease-in-out;\n}\n\n.message-bubble {\n}\n\n.bubble-avatar {\n  width: 5rem;\n  overflow: hidden;\n  margin-right: 0.5rem;\n  flex-shrink: 0;\n  margin-bottom: 6px;\n  font-size: 16px;\n  color: rgba(255, 255, 255, 0.8);\n  font-weight: 500;\n}\n\n.bubble-avatar img {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.bubble-content {\n  padding: 8px;\n  background: rgba(0, 0, 0, 0.3);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n}\n\n.bubble-text {\n  font-size: 12px;\n  margin-bottom: 0.25rem;\n}\n\n.state-text {\n  color: rgba(255, 255, 255, 0.5);\n}\n\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 50;\n}\n\n.modal-content {\n  background-color: #2d2d2d;\n  border: 1px solid #444444;\n  border-radius: 0.5rem;\n  width: 100%;\n  max-width: 28rem;\n  padding: 1.25rem;\n  transition: all 0.3s ease;\n}\n\n.modal-header {\n  text-align: center;\n  margin-bottom: 1rem;\n}\n\n.modal-title {\n  font-size: 1.125rem;\n  font-weight: 600;\n  margin-bottom: 0.5rem;\n}\n\n.modal-footer {\n  display: flex;\n  justify-content: space-between;\n  gap: 0.75rem;\n}\n\n.modal-btn {\n  flex: 1;\n  padding: 0.5rem;\n  border-radius: 0.25rem;\n  font-size: 0.875rem;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border: none;\n}\n\n.cancel-btn {\n  background-color: #333333;\n  border: 1px solid #444444;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.cancel-btn:hover {\n  background-color: #444444;\n}\n\n.confirm-btn {\n  background-color: #667eea;\n  color: #ffffff;\n}\n\n.confirm-btn:hover {\n  background-color: rgba(102, 126, 234, 0.9);\n}\n\n.delete-btn-confirm {\n  background-color: #ff6b6b;\n  color: #ffffff;\n}\n\n.delete-btn-confirm:hover {\n  background-color: #ff5252;\n}\n\n.edit-input {\n  width: 100%;\n  background-color: #333333;\n  border: 1px solid #444444;\n  border-radius: 0.5rem;\n  padding: 0.5rem 0.75rem;\n  color: #ffffff;\n  font-size: 0.875rem;\n}\n\n.edit-input:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 1px rgba(102, 126, 234, 0.3);\n}\n\n.char-count {\n  font-size: 0.75rem;\n  color: rgba(255, 255, 255, 0.5);\n}\n\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n    transform: translateY(-10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n@keyframes fadeInOut {\n  0% {\n    opacity: 0;\n    transform: translateY(-20px) translateX(-50%);\n  }\n  20% {\n    opacity: 1;\n    transform: translateY(0) translateX(-50%);\n  }\n  80% {\n    opacity: 1;\n    transform: translateY(0) translateX(-50%);\n  }\n  100% {\n    opacity: 0;\n    transform: translateY(-20px) translateX(-50%);\n  }\n}\n\n@media (max-width: 640px) {\n  .main-title {\n    font-size: 1.125rem;\n  }\n\n  .message-id {\n    display: none;\n  }\n\n  .message-time {\n    font-size: 0.7rem;\n  }\n}\n</style>\n","import type { AgentExecutionRecordDetail } from '@/types/agent-execution-detail'\n\nconst API_BASE_URL = '/api/executor'\n\n/**\n * Fetch detailed agent execution record by stepId\n * @param stepId The stepId to query\n * @returns Promise<AgentExecutionRecordDetail | null>\n */\nexport async function fetchAgentExecutionDetail(stepId: string): Promise<AgentExecutionRecordDetail | null> {\n  try {\n    const response = await fetch(`${API_BASE_URL}/agent-execution/${stepId}`)\n    \n    if (!response.ok) {\n      if (response.status === 404) {\n        console.warn(`Agent execution detail not found for stepId: ${stepId}`)\n        return null\n      }\n      throw new Error(`HTTP error! status: ${response.status}`)\n    }\n    \n    const data = await response.json()\n    return data as AgentExecutionRecordDetail\n  } catch (error) {\n    console.error(`Error fetching agent execution detail for stepId: ${stepId}:`, error)\n    return null\n  }\n}\n\n/**\n * Refresh agent execution detail by stepId\n * This is a wrapper around fetchAgentExecutionDetail for explicit refresh operations\n * @param stepId The stepId to refresh\n * @returns Promise<AgentExecutionRecordDetail | null>\n */\nexport async function refreshAgentExecutionDetail(stepId: string): Promise<AgentExecutionRecordDetail | null> {\n  console.log(`Refreshing agent execution detail for stepId: ${stepId}`)\n  return fetchAgentExecutionDetail(stepId)\n}\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Define interface types\nexport interface FileNode {\n    name: string\n    path: string\n    type: 'file' | 'directory'\n    size: number\n    lastModified: string\n    children?: FileNode[]\n}\n\nexport interface FileContent {\n    content: string\n    mimeType: string\n    size: number\n}\n\nexport interface ApiResponse<T> {\n    success: boolean\n    data?: T\n    message?: string\n}\n\n/**\n * File Browser API service class\n * Responsible for interacting with backend FileBrowserController\n */\nexport class FileBrowserApiService {\n    private static readonly BASE_URL = '/api/file-browser'\n\n    /**\n     * Handle HTTP response\n     */\n    private static async handleResponse(response: Response) {\n        if (!response.ok) {\n            try {\n                const errorData = await response.json()\n                throw new Error(errorData.message ?? `API request failed: ${response.status}`)\n            } catch {\n                throw new Error(`API request failed: ${response.status} ${response.statusText}`)\n            }\n        }\n        return response\n    }\n\n    /**\n     * Get file tree for a specific plan ID\n     */\n    static async getFileTree(planId: string): Promise<FileNode> {\n        try {\n            const response = await fetch(`${this.BASE_URL}/tree/${planId}`)\n            const result = await this.handleResponse(response)\n            const apiResponse: ApiResponse<FileNode> = await result.json()\n\n            if (!apiResponse.success) {\n                throw new Error(apiResponse.message ?? 'Failed to get file tree')\n            }\n\n            return apiResponse.data!\n        } catch (error) {\n            console.error('Failed to get file tree:', error)\n            throw error\n        }\n    }\n\n    /**\n     * Get file content\n     */\n    static async getFileContent(planId: string, filePath: string): Promise<FileContent> {\n        try {\n            const response = await fetch(`${this.BASE_URL}/content/${planId}?path=${encodeURIComponent(filePath)}`)\n            const result = await this.handleResponse(response)\n            const apiResponse: ApiResponse<FileContent> = await result.json()\n\n            if (!apiResponse.success) {\n                throw new Error(apiResponse.message ?? 'Failed to get file content')\n            }\n\n            return apiResponse.data!\n        } catch (error) {\n            console.error('Failed to get file content:', error)\n            throw error\n        }\n    }\n\n    /**\n     * Download file\n     */\n    static async downloadFile(planId: string, filePath: string, fileName?: string): Promise<void> {\n        try {\n            const response = await fetch(`${this.BASE_URL}/download/${planId}?path=${encodeURIComponent(filePath)}`)\n            await this.handleResponse(response)\n\n            const blob = await response.blob()\n            const url = window.URL.createObjectURL(blob)\n            const a = document.createElement('a')\n            a.href = url\n            a.download = fileName ?? filePath.split('/').pop() ?? 'download'\n            document.body.appendChild(a)\n            a.click()\n            window.URL.revokeObjectURL(url)\n            document.body.removeChild(a)\n        } catch (error) {\n            console.error('Failed to download file:', error)\n            throw error\n        }\n    }\n\n    /**\n     * Check if file is text-based (can be displayed in editor)\n     */\n    static isTextFile(mimeType: string, fileName: string): boolean {\n        const textMimeTypes = [\n            'text/',\n            'application/json',\n            'application/xml',\n            'application/javascript',\n            'application/typescript'\n        ]\n\n        const textExtensions = [\n            '.txt', '.md', '.json', '.xml', '.html', '.css', '.js', '.ts',\n            '.vue', '.jsx', '.tsx', '.py', '.java', '.cpp', '.c', '.h',\n            '.sh', '.bat', '.yml', '.yaml', '.properties', '.conf', '.cfg'\n        ]\n\n        // Check mime type\n        if (textMimeTypes.some(type => mimeType.startsWith(type))) {\n            return true\n        }\n\n        // Check file extension\n        const lowerFileName = fileName.toLowerCase()\n        return textExtensions.some(ext => lowerFileName.endsWith(ext))\n    }\n\n    /**\n     * Get file icon based on file type\n     */\n    static getFileIcon(node: FileNode): string {\n        if (node.type === 'directory') {\n            return 'carbon:folder'\n        }\n\n        const fileName = node.name.toLowerCase()\n\n        // Programming languages\n        if (fileName.endsWith('.js')) return 'vscode-icons:file-type-js'\n        if (fileName.endsWith('.ts')) return 'vscode-icons:file-type-typescript'\n        if (fileName.endsWith('.vue')) return 'vscode-icons:file-type-vue'\n        if (fileName.endsWith('.java')) return 'vscode-icons:file-type-java'\n        if (fileName.endsWith('.py')) return 'vscode-icons:file-type-python'\n        if (fileName.endsWith('.json')) return 'vscode-icons:file-type-json'\n        if (fileName.endsWith('.xml')) return 'vscode-icons:file-type-xml'\n        if (fileName.endsWith('.html')) return 'vscode-icons:file-type-html'\n        if (fileName.endsWith('.css')) return 'vscode-icons:file-type-css'\n        if (fileName.endsWith('.md')) return 'vscode-icons:file-type-markdown'\n        if (fileName.endsWith('.yml') || fileName.endsWith('.yaml')) return 'vscode-icons:file-type-yaml'\n\n        // Documents\n        if (fileName.endsWith('.pdf')) return 'vscode-icons:file-type-pdf2'\n        if (fileName.endsWith('.doc') || fileName.endsWith('.docx')) return 'vscode-icons:file-type-word'\n        if (fileName.endsWith('.xls') || fileName.endsWith('.xlsx')) return 'vscode-icons:file-type-excel'\n        if (fileName.endsWith('.ppt') || fileName.endsWith('.pptx')) return 'vscode-icons:file-type-powerpoint'\n\n        // Images\n        if (fileName.match(/\\.(jpg|jpeg|png|gif|bmp|svg)$/)) return 'carbon:image'\n\n        // Archives\n        if (fileName.match(/\\.(zip|rar|7z|tar|gz)$/)) return 'carbon:archive'\n\n        // Default file icon\n        return 'carbon:document'\n    }\n}\n","<!--\n  /*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n-->\n\n<template>\n  <div class=\"file-tree-node\">\n    <div\n      class=\"node-content\"\n      :class=\"{\n        'is-directory': node.type === 'directory',\n        'is-file': node.type === 'file',\n        'is-expanded': isExpanded\n      }\"\n      :style=\"{ paddingLeft: `${level * 16 + 12}px` }\"\n      @click=\"handleClick\"\n      @contextmenu.prevent=\"handleRightClick\"\n    >\n      <!-- Expand/Collapse Icon for directories -->\n      <div\n        v-if=\"node.type === 'directory'\"\n        class=\"expand-icon\"\n        @click.stop=\"toggleExpanded\"\n      >\n        <Icon\n          :icon=\"isExpanded ? 'carbon:chevron-down' : 'carbon:chevron-right'\"\n          class=\"chevron-icon\"\n        />\n      </div>\n\n      <!-- File/Directory Icon -->\n      <div class=\"node-icon\">\n        <Icon :icon=\"getNodeIcon()\" />\n      </div>\n\n      <!-- Name -->\n      <span class=\"node-name\">{{ node.name }}</span>\n\n      <!-- File size for files -->\n      <span v-if=\"node.type === 'file'\" class=\"file-size\">\n        {{ formatFileSize(node.size) }}\n      </span>\n\n      <!-- Actions -->\n      <div class=\"node-actions\" v-if=\"showActions\">\n        <button\n          v-if=\"node.type === 'file'\"\n          @click.stop=\"$emit('download-file', node)\"\n          class=\"action-btn download-btn\"\n          title=\"Download\"\n        >\n          <Icon icon=\"carbon:download\" />\n        </button>\n      </div>\n    </div>\n\n    <!-- Children (for directories) -->\n    <div v-if=\"node.type === 'directory' && isExpanded && node.children\" class=\"children\">\n      <FileTreeNode\n        v-for=\"child in node.children\"\n        :key=\"child.path\"\n        :node=\"child\"\n        :level=\"level + 1\"\n        @file-selected=\"$emit('file-selected', $event)\"\n        @download-file=\"$emit('download-file', $event)\"\n      />\n    </div>\n\n    <!-- Context Menu -->\n    <div\n      v-if=\"showContextMenu\"\n      class=\"context-menu\"\n      :style=\"contextMenuStyle\"\n      @click.stop\n    >\n      <div class=\"context-menu-item\" @click=\"handleFileSelect\">\n        <Icon icon=\"carbon:view\" />\n        <span>Open</span>\n      </div>\n      <div\n        v-if=\"node.type === 'file'\"\n        class=\"context-menu-item\"\n        @click=\"handleDownload\"\n      >\n        <Icon icon=\"carbon:download\" />\n        <span>Download</span>\n      </div>\n      <div class=\"context-menu-divider\"></div>\n      <div class=\"context-menu-item\" @click=\"copyPath\">\n        <Icon icon=\"carbon:copy\" />\n        <span>Copy Path</span>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, onUnmounted } from 'vue'\nimport { Icon } from '@iconify/vue'\nimport { FileBrowserApiService, type FileNode } from '@/api/file-browser-api-service'\n\ninterface Props {\n  node: FileNode\n  level: number\n}\n\ninterface Emits {\n  (e: 'file-selected', file: FileNode): void\n  (e: 'download-file', file: FileNode): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n// const { t } = useI18n()\n\n// State\nconst isExpanded = ref(props.level === 0) // Root directory expanded by default\nconst showActions = ref(false)\nconst showContextMenu = ref(false)\nconst contextMenuStyle = ref({})\n\n// Computed\n// const hasChildren = computed(() => {\n//   return props.node.type === 'directory' && props.node.children && props.node.children.length > 0\n// })\n\n// Methods\nconst toggleExpanded = () => {\n  if (props.node.type === 'directory') {\n    isExpanded.value = !isExpanded.value\n  }\n}\n\nconst handleClick = () => {\n  if (props.node.type === 'directory') {\n    toggleExpanded()\n  } else {\n    handleFileSelect()\n  }\n}\n\nconst handleFileSelect = () => {\n  if (props.node.type === 'file') {\n    emit('file-selected', props.node)\n  }\n  hideContextMenu()\n}\n\nconst handleDownload = () => {\n  emit('download-file', props.node)\n  hideContextMenu()\n}\n\nconst handleRightClick = (event: MouseEvent) => {\n  event.preventDefault()\n  showContextMenu.value = true\n\n  // Position context menu\n  // const rect = (event.target as HTMLElement).getBoundingClientRect()\n  contextMenuStyle.value = {\n    position: 'fixed',\n    top: `${event.clientY}px`,\n    left: `${event.clientX}px`,\n    zIndex: 1000\n  }\n\n  // Add click listener to hide context menu\n  setTimeout(() => {\n    document.addEventListener('click', hideContextMenu)\n  }, 0)\n}\n\nconst hideContextMenu = () => {\n  showContextMenu.value = false\n  document.removeEventListener('click', hideContextMenu)\n}\n\nconst copyPath = async () => {\n  try {\n    await navigator.clipboard.writeText(props.node.path)\n    // You could show a toast message here\n  } catch (err) {\n    console.error('Failed to copy path:', err)\n  }\n  hideContextMenu()\n}\n\nconst getNodeIcon = () => {\n  if (props.node.type === 'directory') {\n    return isExpanded.value ? 'carbon:folder-open' : 'carbon:folder'\n  }\n  return FileBrowserApiService.getFileIcon(props.node)\n}\n\nconst formatFileSize = (bytes: number): string => {\n  if (bytes === 0) return '0 B'\n  const k = 1024\n  const sizes = ['B', 'KB', 'MB', 'GB']\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i]\n}\n\n// Lifecycle\nonUnmounted(() => {\n  document.removeEventListener('click', hideContextMenu)\n})\n</script>\n\n<style scoped>\n.file-tree-node {\n  position: relative;\n}\n\n.node-content {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 6px 12px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border-radius: 6px;\n  margin: 1px 8px;\n  position: relative;\n}\n\n.node-content:hover {\n  background: rgba(255, 255, 255, 0.08);\n}\n\n.node-content.is-directory {\n  font-weight: 500;\n}\n\n.expand-icon {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 16px;\n  height: 16px;\n  cursor: pointer;\n  color: rgba(255, 255, 255, 0.7);\n  transition: color 0.2s ease;\n}\n\n.expand-icon:hover {\n  color: #ffffff;\n}\n\n.chevron-icon {\n  font-size: 12px;\n  transition: transform 0.2s ease;\n}\n\n.node-icon {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 18px;\n  height: 18px;\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.node-icon .iconify {\n  font-size: 16px;\n}\n\n.node-name {\n  flex: 1;\n  color: #ffffff;\n  font-size: 13px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.file-size {\n  color: rgba(255, 255, 255, 0.5);\n  font-size: 11px;\n  white-space: nowrap;\n}\n\n.node-actions {\n  display: flex;\n  gap: 4px;\n  opacity: 0;\n  transition: opacity 0.2s ease;\n}\n\n.node-content:hover .node-actions {\n  opacity: 1;\n}\n\n.action-btn {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 20px;\n  height: 20px;\n  background: rgba(255, 255, 255, 0.1);\n  border: none;\n  border-radius: 4px;\n  color: rgba(255, 255, 255, 0.7);\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.action-btn:hover {\n  background: rgba(255, 255, 255, 0.2);\n  color: #ffffff;\n}\n\n.action-btn .iconify {\n  font-size: 12px;\n}\n\n.children {\n  overflow: hidden;\n}\n\n.context-menu {\n  background: rgba(20, 20, 20, 0.95);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 8px;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);\n  backdrop-filter: blur(20px);\n  padding: 6px;\n  min-width: 160px;\n}\n\n.context-menu-item {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 8px 12px;\n  cursor: pointer;\n  border-radius: 4px;\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 13px;\n  transition: background-color 0.2s ease;\n}\n\n.context-menu-item:hover {\n  background: rgba(255, 255, 255, 0.1);\n}\n\n.context-menu-item .iconify {\n  font-size: 14px;\n  color: rgba(255, 255, 255, 0.7);\n}\n\n.context-menu-divider {\n  height: 1px;\n  background: rgba(255, 255, 255, 0.1);\n  margin: 4px 0;\n}\n\n/* Directory specific styles */\n.node-content.is-directory .node-name {\n  color: #ffffff;\n  font-weight: 500;\n}\n\n.node-content.is-directory.is-expanded .node-icon {\n  color: #677eea;\n}\n\n/* File specific styles */\n.node-content.is-file .node-name {\n  color: rgba(255, 255, 255, 0.9);\n}\n\n/* Animation for expanding/collapsing */\n.children {\n  animation: slideDown 0.2s ease-out;\n}\n\n@keyframes slideDown {\n  from {\n    opacity: 0;\n    transform: translateY(-10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n</style>\n","<!--\n  /*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n-->\n\n<template>\n  <div class=\"file-browser\">\n    <div class=\"file-browser-header\">\n      <h3>{{ $t('fileBrowser.title') }}</h3>\n      <div class=\"header-actions\">\n                <button\n          class=\"refresh-btn\"\n          @click=\"refreshFileTree\"\n          :disabled=\"loading\"\n          :title=\"$t('fileBrowser.refresh')\"\n        >\n          <Icon\n            icon=\"carbon:refresh\"\n            :class=\"{ 'rotating': loading }\"\n            :style=\"{ color: '#ffffff', fontSize: '18px', width: '18px', height: '18px' }\"\n          />\n        </button>\n      </div>\n    </div>\n\n    <div class=\"file-browser-content\">\n      <!-- File Tree -->\n      <div class=\"file-tree-panel\">\n        <div v-if=\"loading\" class=\"loading-state\">\n          <Icon icon=\"carbon:loading\" class=\"rotating\" />\n          <span>{{ $t('fileBrowser.loading') }}</span>\n        </div>\n\n        <div v-else-if=\"error\" class=\"error-state\">\n          <div v-if=\"isPlanDirectoryNotFound\" class=\"waiting-for-files\">\n            <Icon icon=\"carbon:time\" class=\"rotating\" />\n            <div class=\"message-content\">\n              <h3>{{ $t('fileBrowser.waitingForGeneration') }}</h3>\n              <p>{{ $t('fileBrowser.planExecuting') }}</p>\n              <div class=\"tips\">\n                <Icon icon=\"carbon:information\" />\n                <span>{{ $t('fileBrowser.filesTip') }}</span>\n              </div>\n            </div>\n            <button @click=\"refreshFileTree\" class=\"retry-btn\" :disabled=\"loading\">\n              <Icon icon=\"carbon:refresh\" :class=\"{ 'rotating': loading }\" />\n              {{ loading ? $t('fileBrowser.checking') : $t('fileBrowser.checkNow') }}\n            </button>\n          </div>\n          <div v-else class=\"actual-error\">\n            <Icon icon=\"carbon:warning\" />\n            <span>{{ error }}</span>\n            <button @click=\"refreshFileTree\" class=\"retry-btn\">\n              {{ $t('fileBrowser.retry') }}\n            </button>\n          </div>\n        </div>\n\n        <div v-else-if=\"!fileTree\" class=\"empty-state\">\n          <Icon icon=\"carbon:folder-off\" />\n          <span>{{ $t('fileBrowser.noFiles') }}</span>\n        </div>\n\n        <div v-else class=\"file-tree\">\n          <FileTreeNode\n            :node=\"fileTree\"\n            :level=\"0\"\n            @file-selected=\"handleFileSelected\"\n            @download-file=\"handleDownloadFile\"\n          />\n        </div>\n      </div>\n\n      <!-- File Content Viewer -->\n      <div class=\"file-content-panel\" v-if=\"selectedFile\">\n        <div class=\"file-content-header\">\n          <div class=\"file-info\">\n            <Icon :icon=\"getFileIcon(selectedFile)\" />\n            <span class=\"file-name\">{{ selectedFile.name }}</span>\n            <span class=\"file-size\">({{ formatFileSize(selectedFile.size) }})</span>\n          </div>\n          <div class=\"file-actions\">\n            <button\n              @click=\"handleDownloadFile(selectedFile)\"\n              class=\"download-btn\"\n              :title=\"$t('fileBrowser.download')\"\n            >\n              <Icon icon=\"carbon:download\" />\n            </button>\n            <button\n              @click=\"closeFileViewer\"\n              class=\"close-btn\"\n              :title=\"$t('common.close')\"\n            >\n              <Icon icon=\"carbon:close\" />\n            </button>\n          </div>\n        </div>\n\n        <div class=\"file-content-body\">\n          <div v-if=\"loadingContent\" class=\"loading-content\">\n            <Icon icon=\"carbon:loading\" class=\"rotating\" />\n            <span>{{ $t('fileBrowser.loadingContent') }}</span>\n          </div>\n\n          <div v-else-if=\"contentError\" class=\"content-error\">\n            <Icon icon=\"carbon:warning\" />\n            <span>{{ contentError }}</span>\n          </div>\n\n          <div v-else-if=\"fileContent\" class=\"file-content\">\n            <div v-if=\"isTextFile\" class=\"text-content\">\n              <pre><code>{{ fileContent.content }}</code></pre>\n            </div>\n            <div v-else class=\"binary-content\">\n              <Icon icon=\"carbon:document-unknown\" />\n              <p>{{ $t('fileBrowser.binaryFile') }}</p>\n              <button @click=\"handleDownloadFile(selectedFile)\" class=\"download-btn-large\">\n                <Icon icon=\"carbon:download\" />\n                {{ $t('fileBrowser.downloadToView') }}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed, onMounted, onUnmounted, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { Icon } from '@iconify/vue'\nimport FileTreeNode from './FileTreeNode.vue'\nimport { FileBrowserApiService, type FileNode, type FileContent } from '@/api/file-browser-api-service'\n\ninterface Props {\n  planId: string\n}\n\nconst props = defineProps<Props>()\nconst { t } = useI18n()\n\n// State\nconst loading = ref(false)\nconst error = ref<string | null>(null)\nconst fileTree = ref<FileNode | null>(null)\nconst selectedFile = ref<FileNode | null>(null)\nconst fileContent = ref<FileContent | null>(null)\nconst loadingContent = ref(false)\nconst contentError = ref<string | null>(null)\nconst autoRefreshTimer = ref<number | null>(null)\n\n// Computed\nconst isTextFile = computed(() => {\n  if (!fileContent.value || !selectedFile.value) return false\n  return FileBrowserApiService.isTextFile(fileContent.value.mimeType, selectedFile.value.name)\n})\n\nconst isPlanDirectoryNotFound = computed(() => {\n  return error.value && (\n    error.value.includes('Plan directory not found') ||\n    error.value.includes('not found')\n  )\n})\n\n// Methods\nconst clearAutoRefresh = () => {\n  if (autoRefreshTimer.value) {\n    clearTimeout(autoRefreshTimer.value)\n    autoRefreshTimer.value = null\n  }\n}\n\nconst startAutoRefresh = () => {\n  clearAutoRefresh()\n  // Auto refresh every 5 seconds when plan directory is not found\n  autoRefreshTimer.value = window.setTimeout(() => {\n    if (isPlanDirectoryNotFound.value) {\n      refreshFileTree()\n    }\n  }, 5000)\n}\n\nconst refreshFileTree = async () => {\n  if (!props.planId) return\n\n  loading.value = true\n  error.value = null\n  clearAutoRefresh()\n\n  try {\n    fileTree.value = await FileBrowserApiService.getFileTree(props.planId)\n    // Success - no need to auto refresh\n  } catch (err) {\n    error.value = err instanceof Error ? err.message : t('fileBrowser.loadError')\n    console.error('Failed to load file tree:', err)\n\n    // Start auto refresh if it's a \"directory not found\" error\n    const errorMessage = err instanceof Error ? err.message : ''\n    if (errorMessage.includes('Plan directory not found') ||\n        errorMessage.includes('not found')) {\n      startAutoRefresh()\n    }\n  } finally {\n    loading.value = false\n  }\n}\n\nconst handleFileSelected = async (file: FileNode) => {\n  if (file.type === 'directory') return\n\n  selectedFile.value = file\n  fileContent.value = null\n  loadingContent.value = true\n  contentError.value = null\n\n  try {\n    fileContent.value = await FileBrowserApiService.getFileContent(props.planId, file.path)\n  } catch (err) {\n    contentError.value = err instanceof Error ? err.message : t('fileBrowser.contentLoadError')\n    console.error('Failed to load file content:', err)\n  } finally {\n    loadingContent.value = false\n  }\n}\n\nconst handleDownloadFile = async (file: FileNode) => {\n  try {\n    await FileBrowserApiService.downloadFile(props.planId, file.path, file.name)\n  } catch (err) {\n    console.error('Failed to download file:', err)\n    // You could show a toast message here\n  }\n}\n\nconst closeFileViewer = () => {\n  selectedFile.value = null\n  fileContent.value = null\n  contentError.value = null\n}\n\nconst getFileIcon = (file: FileNode) => {\n  return FileBrowserApiService.getFileIcon(file)\n}\n\nconst formatFileSize = (bytes: number): string => {\n  if (bytes === 0) return '0 B'\n  const k = 1024\n  const sizes = ['B', 'KB', 'MB', 'GB']\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i]\n}\n\n// Watch for plan ID changes\nwatch(() => props.planId, (newPlanId) => {\n  if (newPlanId) {\n    selectedFile.value = null\n    fileContent.value = null\n    refreshFileTree()\n  }\n}, { immediate: true })\n\n// Lifecycle\nonMounted(() => {\n  if (props.planId) {\n    refreshFileTree()\n  }\n})\n\nonUnmounted(() => {\n  clearAutoRefresh()\n})\n</script>\n\n<style scoped>\n.file-browser {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  background: rgba(255, 255, 255, 0.02);\n  border-radius: 12px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  overflow: hidden;\n}\n\n.file-browser-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px 20px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n  background: rgba(255, 255, 255, 0.05);\n}\n\n.file-browser-header h3 {\n  margin: 0;\n  color: #ffffff;\n  font-size: 16px;\n  font-weight: 600;\n}\n\n.header-actions {\n  display: flex;\n  gap: 8px;\n}\n\n.refresh-btn {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 36px;\n  height: 36px;\n  background: rgba(255, 255, 255, 0.15);\n  border: 1px solid rgba(255, 255, 255, 0.3);\n  border-radius: 8px;\n  color: #ffffff;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 18px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);\n}\n\n.refresh-btn .iconify {\n  color: #ffffff !important;\n  font-size: 18px !important;\n  width: 18px !important;\n  height: 18px !important;\n}\n\n.refresh-btn svg {\n  fill: #ffffff !important;\n  color: #ffffff !important;\n  width: 18px !important;\n  height: 18px !important;\n}\n\n.refresh-btn:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.25);\n  border-color: rgba(255, 255, 255, 0.4);\n  transform: translateY(-1px);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);\n}\n\n.refresh-btn:hover:not(:disabled) .iconify,\n.refresh-btn:hover:not(:disabled) svg {\n  color: #ffffff !important;\n  fill: #ffffff !important;\n}\n\n.refresh-btn:active:not(:disabled) {\n  transform: translateY(0);\n}\n\n.refresh-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n  background: rgba(255, 255, 255, 0.08);\n  border-color: rgba(255, 255, 255, 0.15);\n}\n\n.refresh-btn:disabled .iconify,\n.refresh-btn:disabled svg {\n  color: rgba(255, 255, 255, 0.4) !important;\n  fill: rgba(255, 255, 255, 0.4) !important;\n}\n\n.file-browser-content {\n  display: flex;\n  flex: 1;\n  min-height: 0;\n}\n\n.file-tree-panel {\n  flex: 0 0 300px;\n  border-right: 1px solid rgba(255, 255, 255, 0.1);\n  overflow-y: auto;\n}\n\n.file-content-panel {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  min-width: 0;\n}\n\n.loading-state,\n.error-state,\n.empty-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 40px 20px;\n  color: rgba(255, 255, 255, 0.7);\n  gap: 12px;\n}\n\n.loading-state .iconify,\n.error-state .iconify,\n.empty-state .iconify {\n  font-size: 32px;\n}\n\n.retry-btn {\n  padding: 8px 16px;\n  background: rgba(103, 126, 234, 0.2);\n  border: 1px solid rgba(103, 126, 234, 0.3);\n  border-radius: 6px;\n  color: #677eea;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.retry-btn:hover {\n  background: rgba(103, 126, 234, 0.3);\n}\n\n.retry-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.waiting-for-files {\n  color: #74c0fc;\n}\n\n.waiting-for-files .iconify {\n  font-size: 48px;\n  margin-bottom: 20px;\n  opacity: 0.8;\n}\n\n.waiting-for-files .message-content {\n  margin-bottom: 24px;\n  text-align: center;\n}\n\n.waiting-for-files h3 {\n  margin: 0 0 8px 0;\n  color: #ffffff;\n  font-size: 18px;\n  font-weight: 600;\n}\n\n.waiting-for-files p {\n  margin: 0 0 16px 0;\n  color: rgba(255, 255, 255, 0.7);\n  font-size: 14px;\n  line-height: 1.5;\n}\n\n.waiting-for-files .tips {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 12px 16px;\n  background: rgba(116, 192, 252, 0.1);\n  border: 1px solid rgba(116, 192, 252, 0.2);\n  border-radius: 8px;\n  color: #74c0fc;\n  font-size: 13px;\n}\n\n.waiting-for-files .tips .iconify {\n  font-size: 16px;\n  margin: 0;\n}\n\n.actual-error {\n  color: #ff6b6b;\n}\n\n.file-tree {\n  padding: 8px 0;\n}\n\n.file-content-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px 20px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n  background: rgba(255, 255, 255, 0.05);\n}\n\n.file-info {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  color: #ffffff;\n}\n\n.file-info .iconify {\n  font-size: 18px;\n}\n\n.file-name {\n  font-weight: 600;\n}\n\n.file-size {\n  color: rgba(255, 255, 255, 0.6);\n  font-size: 12px;\n}\n\n.file-actions {\n  display: flex;\n  gap: 8px;\n}\n\n.download-btn,\n.close-btn {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 32px;\n  height: 32px;\n  background: rgba(255, 255, 255, 0.1);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  color: #ffffff;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.download-btn:hover,\n.close-btn:hover {\n  background: rgba(255, 255, 255, 0.15);\n  transform: translateY(-1px);\n}\n\n.file-content-body {\n  flex: 1;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n}\n\n.loading-content,\n.content-error {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  flex: 1;\n  color: rgba(255, 255, 255, 0.7);\n  gap: 12px;\n}\n\n.file-content {\n  flex: 1;\n  overflow: hidden;\n}\n\n.text-content {\n  height: 100%;\n  overflow: auto;\n  padding: 20px;\n}\n\n.text-content pre {\n  margin: 0;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  font-size: 13px;\n  line-height: 1.6;\n  color: #ffffff;\n  white-space: pre-wrap;\n  word-wrap: break-word;\n}\n\n.binary-content {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  flex: 1;\n  color: rgba(255, 255, 255, 0.7);\n  gap: 16px;\n}\n\n.binary-content .iconify {\n  font-size: 48px;\n}\n\n.download-btn-large {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 12px 24px;\n  background: rgba(103, 126, 234, 0.2);\n  border: 1px solid rgba(103, 126, 234, 0.3);\n  border-radius: 8px;\n  color: #677eea;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 14px;\n}\n\n.download-btn-large:hover {\n  background: rgba(103, 126, 234, 0.3);\n  transform: translateY(-1px);\n}\n\n.rotating {\n  animation: rotate 1s linear infinite;\n}\n\n@keyframes rotate {\n  from { transform: rotate(0deg); }\n  to { transform: rotate(360deg); }\n}\n\n/* Scrollbar styling */\n.file-tree-panel::-webkit-scrollbar,\n.text-content::-webkit-scrollbar {\n  width: 6px;\n}\n\n.file-tree-panel::-webkit-scrollbar-track,\n.text-content::-webkit-scrollbar-track {\n  background: rgba(255, 255, 255, 0.05);\n}\n\n.file-tree-panel::-webkit-scrollbar-thumb,\n.text-content::-webkit-scrollbar-thumb {\n  background: rgba(255, 255, 255, 0.2);\n  border-radius: 3px;\n}\n\n.file-tree-panel::-webkit-scrollbar-thumb:hover,\n.text-content::-webkit-scrollbar-thumb:hover {\n  background: rgba(255, 255, 255, 0.3);\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"right-panel\">\n    <div class=\"preview-header\">\n      <div class=\"preview-tabs\">\n        <!-- Step Execution Details tab -->\n        <div\n            class=\"tab-item\"\n            :class=\"{ active: activeTab === 'details' }\"\n            @click=\"activeTab = 'details'\"\n        >\n          <Icon icon=\"carbon:events\"/>\n          <span>{{ t('rightPanel.stepExecutionDetails') }}</span>\n        </div>\n        <!-- File Browser tab -->\n        <div\n            class=\"tab-item\"\n            :class=\"{ active: activeTab === 'files' }\"\n            @click=\"activeTab = 'files'\"\n        >\n          <Icon icon=\"carbon:folder\"/>\n          <span>{{ t('fileBrowser.title') }}</span>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"preview-content\">\n      <!-- Step Execution Details -->\n      <div v-if=\"activeTab === 'details'\" class=\"step-details\">\n        <!-- Step basic information -->\n        <div v-if=\"selectedStep\" class=\"step-info\">\n          <h3>\n            {{\n              selectedStep.title ||\n              selectedStep.description ||\n              t('rightPanel.defaultStepTitle', { number: 1 })\n            }}\n          </h3>\n\n          <div class=\"agent-info\" v-if=\"selectedStep.agentExecution\">\n            <div class=\"info-item\">\n              <span class=\"label\">{{ t('rightPanel.executingAgent') }}:</span>\n              <span class=\"value\">{{ selectedStep.agentExecution.agentName }}</span>\n            </div>\n            <div class=\"info-item\">\n              <span class=\"label\">{{ t('rightPanel.callingModel') }}:</span>\n              <span class=\"value\">{{ selectedStep.agentExecution.modelName }}</span>\n            </div>\n            <div class=\"info-item\">\n              <span class=\"label\">{{ t('rightPanel.executionResult') }}:</span>\n              <span\n                  class=\"value\"\n                  :class=\"{ success: selectedStep.agentExecution.status === 'FINISHED' }\"\n              >\n                {{ selectedStep.agentExecution.status || t('rightPanel.executing') }}\n              </span>\n            </div>\n          </div>\n\n          <div class=\"execution-status\">\n            <div class=\"status-item\">\n              <Icon\n                  icon=\"carbon:checkmark-filled\"\n                  v-if=\"selectedStep.completed\"\n                  class=\"status-icon success\"\n              />\n              <Icon\n                  icon=\"carbon:in-progress\"\n                  v-else-if=\"selectedStep.current\"\n                  class=\"status-icon progress\"\n              />\n              <Icon icon=\"carbon:time\" v-else class=\"status-icon pending\"/>\n              <span class=\"status-text\">\n                {{ stepStatusText }}\n              </span>\n            </div>\n          </div>\n        </div>\n\n        <!-- Scrollable detailed content area -->\n        <div\n            ref=\"scrollContainer\"\n            class=\"step-details-scroll-container\"\n            @scroll=\"checkScrollState\"\n        >\n          <div v-if=\"selectedStep\">\n            <!-- Think and action steps -->\n            <div\n                class=\"think-act-steps\"\n                v-if=\"selectedStep.agentExecution?.thinkActSteps && selectedStep.agentExecution.thinkActSteps.length > 0\"\n            >\n              <h4>{{ t('rightPanel.thinkAndActionSteps') }}</h4>\n              <div class=\"steps-container\">\n                <div\n                    v-for=\"(tas, index) in selectedStep.agentExecution.thinkActSteps\"\n                    :key=\"index\"\n                    class=\"think-act-step\"\n                >\n                  <div class=\"step-header\">\n                    <span class=\"step-number\">#{{ index + 1 }}</span>\n                    <span class=\"step-status\" :class=\"tas.status\">{{\n                        tas.status || t('rightPanel.executing')\n                      }}</span>\n                  </div>\n\n                  <!-- Think section - strictly follow right-sidebar.js logic -->\n                  <div class=\"think-section\">\n                    <h5>\n                      <Icon icon=\"carbon:thinking\"/>\n                      {{ t('rightPanel.thinking') }}\n                    </h5>\n                    <div class=\"think-content\">\n                      <div class=\"input\">\n                        <span class=\"label\">{{ t('rightPanel.input') }}:</span>\n                        <pre>{{ formatJson(tas.thinkInput) }}</pre>\n                      </div>\n                      <div class=\"output\">\n                        <span class=\"label\">{{ t('rightPanel.output') }}:</span>\n                        <pre>{{ formatJson(tas.thinkOutput) }}</pre>\n                      </div>\n                    </div>\n                  </div>\n\n                  <!-- Action section - strictly follow right-sidebar.js logic -->\n                  <div v-if=\"tas.actionNeeded\" class=\"action-section\">\n                    <h5>\n                      <Icon icon=\"carbon:play\"/>\n                      {{ t('rightPanel.action') }}\n                    </h5>\n                    <div class=\"action-content\">\n                      <div v-for=\"(actToolInfo, index) in tas.actToolInfoList\" :key=\"index\">\n                        <div class=\"tool-info\">\n                          <span class=\"label\">{{ t('rightPanel.tool') }}:</span>\n                          <span class=\"value\">{{ actToolInfo.name || '' }}</span>\n                        </div>\n                        <div class=\"input\">\n                          <span class=\"label\">{{ t('rightPanel.toolParameters') }}:</span>\n                          <pre>{{ formatJson(actToolInfo.parameters) }}</pre>\n                        </div>\n                        <div class=\"output\">\n                          <span class=\"label\">{{ t('rightPanel.executionResult') }}:</span>\n                          <pre>{{ formatJson(actToolInfo.result) }}</pre>\n                        </div>\n                      </div>\n                    </div>\n\n                    <!-- Sub execution plan section - new feature -->\n                    <div v-if=\"tas.subPlanExecutionRecord\" class=\"sub-plan-section\">\n                      <h5>\n                        <Icon icon=\"carbon:tree-view\"/>\n                        {{ t('rightPanel.subPlan') }}\n                      </h5>\n                      <div class=\"sub-plan-content\">\n                        <div class=\"sub-plan-header\">\n                          <div class=\"sub-plan-info\">\n                            <span class=\"label\">{{ $t('rightPanel.subPlanId') }}:</span>\n                            <span class=\"value\">{{ tas.subPlanExecutionRecord.currentPlanId }}</span>\n                          </div>\n                          <div class=\"sub-plan-info\" v-if=\"tas.subPlanExecutionRecord.title\">\n                            <span class=\"label\">{{ $t('rightPanel.title') }}:</span>\n                            <span class=\"value\">{{ tas.subPlanExecutionRecord.title }}</span>\n                          </div>\n                          <div class=\"sub-plan-status\">\n                            <Icon\n                                icon=\"carbon:checkmark-filled\"\n                                v-if=\"tas.subPlanExecutionRecord.completed\"\n                                class=\"status-icon success\"\n                            />\n                            <Icon icon=\"carbon:in-progress\" v-else class=\"status-icon progress\"/>\n                            <span class=\"status-text\">\n                            {{ tas.subPlanExecutionRecord.completed ? $t('rightPanel.status.completed') : $t('rightPanel.status.executing') }}\n                          </span>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <div\n                  v-if=\"\n                selectedStep.agentExecution &&\n                !selectedStep.agentExecution.thinkActSteps?.length\n              \"\n                  class=\"no-steps-message\"\n              >\n                <p>{{ t('rightPanel.noStepDetails') }}</p>\n              </div>\n\n              <!-- Handle no agentExecution case -->\n              <div\n                  v-else-if=\"!selectedStep.agentExecution\"\n                  class=\"no-execution-message\"\n              >\n                <Icon icon=\"carbon:information\" class=\"info-icon\"/>\n                <h4>{{ t('rightPanel.stepInfo') }}</h4>\n                <div class=\"step-basic-info\">\n                  <div class=\"info-item\">\n                    <span class=\"label\">{{ t('rightPanel.stepName') }}:</span>\n                    <span class=\"value\">{{\n                        selectedStep.title ||\n                        selectedStep.description ||\n                        selectedStep.stepId\n                      }}</span>\n                  </div>\n                  <div class=\"info-item\" v-if=\"selectedStep.description\">\n                    <span class=\"label\">{{ $t('rightPanel.description') }}:</span>\n                    <span class=\"value\">{{ selectedStep.description }}</span>\n                  </div>\n                  <div class=\"info-item\">\n                    <span class=\"label\">{{ $t('rightPanel.status.label') }}:</span>\n                    <span class=\"value\" :class=\"{\n                    'status-completed': selectedStep.completed,\n                    'status-current': selectedStep.current,\n                    'status-pending': !selectedStep.completed && !selectedStep.current\n                  }\">\n                    {{\n                        selectedStep.completed ? $t('rightPanel.status.completed') :\n                            selectedStep.current ? $t('rightPanel.status.executing') : $t('rightPanel.status.pending')\n                      }}\n                  </span>\n                  </div>\n                </div>\n                <p class=\"no-execution-hint\">{{ t('rightPanel.noExecutionInfo') }}</p>\n              </div>\n\n              <!-- Dynamic effect during execution -->\n              <div\n                  v-if=\"selectedStep.current && !selectedStep.completed\"\n                  class=\"execution-indicator\"\n              >\n                <div class=\"execution-waves\">\n                  <div class=\"wave wave-1\"></div>\n                  <div class=\"wave wave-2\"></div>\n                  <div class=\"wave wave-3\"></div>\n                </div>\n                <p class=\"execution-text\">\n                  <Icon icon=\"carbon:in-progress\" class=\"rotating-icon\"/>\n                  {{ t('rightPanel.stepExecuting') }}\n                </p>\n              </div>\n            </div>\n\n            <div v-else class=\"no-selection\">\n              <Icon icon=\"carbon:events\" class=\"empty-icon\"/>\n              <h3>{{ t('rightPanel.noStepSelected') }}</h3>\n              <p>{{ t('rightPanel.selectStepHint') }}</p>\n            </div>\n          </div>\n\n          <!-- Scroll to bottom button -->\n          <Transition name=\"scroll-button\">\n            <button\n                v-if=\"showScrollToBottomButton\"\n                @click=\"scrollToBottom\"\n                class=\"scroll-to-bottom-btn\"\n                :title=\"t('rightPanel.scrollToBottom')\"\n            >\n              <Icon icon=\"carbon:chevron-down\"/>\n            </button>\n          </Transition>\n        </div>\n      </div>\n\n      <!-- File Browser -->\n      <div v-if=\"activeTab === 'files'\" class=\"file-browser-container\">\n        <FileBrowser \n          v-if=\"fileBrowserPlanId\" \n          :plan-id=\"fileBrowserPlanId\"\n        />\n        <div v-else-if=\"shouldShowNoTaskMessage\" class=\"no-plan-message\">\n          <Icon icon=\"carbon:folder-off\" />\n          <div class=\"message-content\">\n            <h3>{{ t('fileBrowser.noFilesYet') }}</h3>\n            <p>{{ t('fileBrowser.noPlanExecuting') }}</p>\n            <div class=\"tips\">\n              <Icon icon=\"carbon:information\" />\n              <span>{{ t('fileBrowser.startTaskTip') }}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed, onMounted, onUnmounted, nextTick, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { Icon } from '@iconify/vue'\nimport { fetchAgentExecutionDetail, refreshAgentExecutionDetail } from '@/api/agent-execution'\nimport type { AgentExecutionRecordDetail } from '@/types/agent-execution-detail'\nimport FileBrowser from '@/components/file-browser/index.vue'\n\n// Define props interface\ninterface Props {\n  currentRootPlanId?: string | null\n  selectedStepId?: string | null\n}\n\nconst props = defineProps<Props>()\n\n// Define selected step interface\ninterface SelectedStep {\n  stepId: string\n  title: string\n  description: string\n  agentExecution?: AgentExecutionRecordDetail\n  completed: boolean\n  current: boolean\n}\n\nconst { t } = useI18n()\n\n// DOM element reference\nconst scrollContainer = ref<HTMLElement>()\n\n// Local state\nconst selectedStep = ref<SelectedStep | null>()\nconst activeTab = ref<'details' | 'files'>('details')\n\n// Keep track of the last executed plan for file browser\nconst lastExecutedPlanId = ref<string | null>(localStorage.getItem('jmanus-last-plan-id'))\nconst hasExecutedAnyPlan = ref(localStorage.getItem('jmanus-has-executed-plan') === 'true')\n\n// Scroll-related state\nconst showScrollToBottomButton = ref(false)\nconst isNearBottom = ref(true)\nconst shouldAutoScrollToBottom = ref(true)\n\n\nconst stepStatusText = computed(() => {\n  if (!selectedStep.value) return ''\n  if (selectedStep.value.completed) return t('rightPanel.status.completed')\n  if (selectedStep.value.current) return t('rightPanel.status.executing')\n  return t('rightPanel.status.waiting')\n})\n\n// Computed property to determine which planId to show in file browser\nconst fileBrowserPlanId = computed(() => {\n  // If there's a current plan, use it\n  if (props.currentRootPlanId) {\n    return props.currentRootPlanId\n  }\n  // Otherwise, use the last executed plan if any\n  return lastExecutedPlanId.value\n})\n\n// Computed property to determine if we should show the \"no task\" message\nconst shouldShowNoTaskMessage = computed(() => {\n  return !fileBrowserPlanId.value && !hasExecutedAnyPlan.value\n})\n\n// Actions - Step selection and refresh control\n\n/**\n * Handle step selection by stepId\n * @param stepId - The step ID to display\n */\nconst handleStepSelected = async (stepId: string) => {\n  console.log('[RightPanel] Step selected:', { stepId })\n\n  if (!stepId) {\n    console.warn('[RightPanel] No stepId provided')\n    selectedStep.value = null\n    return\n  }\n\n  try {\n    // Fetch agent execution detail from API\n    const agentExecutionDetail = await fetchAgentExecutionDetail(stepId)\n    \n    if (!agentExecutionDetail) {\n      console.warn('[RightPanel] Agent execution detail not found for stepId:', stepId)\n      selectedStep.value = null\n      return\n    }\n\n    // Create step data object\n    const stepData: SelectedStep = {\n      stepId: stepId,\n      title: agentExecutionDetail.agentName ?? `Step ${stepId}`,\n      description: agentExecutionDetail.agentDescription ?? '',\n      agentExecution: agentExecutionDetail,\n      completed: agentExecutionDetail.status === 'FINISHED',\n      current: agentExecutionDetail.status === 'RUNNING'\n    }\n\n    selectedStep.value = stepData\n    console.log('[RightPanel] Step details updated:', stepData)\n    console.log('[RightPanel] activeTab:', activeTab.value)\n    console.log('[RightPanel] selectedStep.value:', selectedStep.value)\n    console.log('[RightPanel] agentExecution:', selectedStep.value.agentExecution)\n    console.log('[RightPanel] thinkActSteps:', selectedStep.value.agentExecution?.thinkActSteps)\n    console.log('[RightPanel] thinkActSteps length:', selectedStep.value.agentExecution?.thinkActSteps?.length)\n\n    // Force reactivity update\n    await nextTick()\n    console.log('[RightPanel] After nextTick - selectedStep:', selectedStep.value)\n\n    // Delay scroll state check to ensure DOM is updated\n    setTimeout(() => {\n      checkScrollState()\n    }, 100)\n\n    // Auto-scroll to latest content if previously at bottom\n    autoScrollToBottomIfNeeded()\n  } catch (error) {\n    console.error('[RightPanel] Error fetching step details:', error)\n    selectedStep.value = null\n  }\n}\n\n/**\n * Refresh the currently selected step\n */\nconst refreshCurrentStep = async () => {\n  if (!selectedStep.value?.stepId) {\n    console.warn('[RightPanel] No step selected for refresh')\n    return\n  }\n\n  console.log('[RightPanel] Refreshing current step:', selectedStep.value.stepId)\n  \n  try {\n    const agentExecutionDetail = await refreshAgentExecutionDetail(selectedStep.value.stepId)\n    \n    if (agentExecutionDetail) {\n      // Update the existing step data\n      selectedStep.value.agentExecution = agentExecutionDetail\n      selectedStep.value.completed = agentExecutionDetail.status === 'FINISHED'\n      selectedStep.value.current = agentExecutionDetail.status === 'RUNNING'\n      \n      console.log('[RightPanel] Step refreshed successfully')\n      \n      // Auto-scroll to latest content if previously at bottom\n      autoScrollToBottomIfNeeded()\n    }\n  } catch (error) {\n    console.error('[RightPanel] Error refreshing step:', error)\n  }\n}\n\n// Watch for selectedStepId prop changes\nwatch(() => props.selectedStepId, async (newStepId) => {\n  if (newStepId) {\n    await handleStepSelected(newStepId)\n  } else {\n    selectedStep.value = null\n  }\n}, { immediate: true })\n\n\n\n// Actions - Scroll management\nconst setScrollContainer = (element: HTMLElement | null) => {\n  scrollContainer.value = element ?? undefined\n}\n\nconst checkScrollState = () => {\n  if (!scrollContainer.value) return\n\n  const { scrollTop, scrollHeight, clientHeight } = scrollContainer.value\n  const isAtBottom = scrollHeight - scrollTop - clientHeight < 50\n  const hasScrollableContent = scrollHeight > clientHeight\n\n  isNearBottom.value = isAtBottom\n  showScrollToBottomButton.value = hasScrollableContent && !isAtBottom\n\n  // Update auto-scroll flag: should auto-scroll if user scrolls to bottom\n  // If user actively scrolls up away from bottom, stop auto-scrolling\n  if (isAtBottom) {\n    shouldAutoScrollToBottom.value = true\n  } else if (scrollHeight - scrollTop - clientHeight > 100) {\n    // If user clearly scrolled up (more than 100px from bottom), stop auto-scrolling\n    shouldAutoScrollToBottom.value = false\n  }\n\n  console.log('[RightPanel] Scroll state check:', {\n    scrollTop,\n    scrollHeight,\n    clientHeight,\n    isAtBottom,\n    hasScrollableContent,\n    showButton: showScrollToBottomButton.value,\n    shouldAutoScroll: shouldAutoScrollToBottom.value,\n  })\n}\n\nconst scrollToBottom = () => {\n  if (!scrollContainer.value) return\n\n  scrollContainer.value.scrollTo({\n    top: scrollContainer.value.scrollHeight,\n    behavior: 'smooth',\n  })\n\n  // Reset state after scrolling\n  nextTick(() => {\n    shouldAutoScrollToBottom.value = true\n    checkScrollState()\n  })\n}\n\nconst autoScrollToBottomIfNeeded = () => {\n  if (!shouldAutoScrollToBottom.value || !scrollContainer.value) return\n\n  nextTick(() => {\n    if (scrollContainer.value) {\n      scrollContainer.value.scrollTop = scrollContainer.value.scrollHeight\n      console.log('[RightPanel] Auto scroll to bottom')\n    }\n  })\n}\n\n\n// Actions - Utility functions\nconst formatJson = (jsonData: any): string => {\n  if (jsonData === null || typeof jsonData === 'undefined' || jsonData === '') {\n    return 'N/A'\n  }\n  try {\n    const jsonObj = typeof jsonData === 'object' ? jsonData : JSON.parse(jsonData)\n    return JSON.stringify(jsonObj, null, 2)\n  } catch {\n    // If parsing fails, return string format directly (similar to _escapeHtml in right-sidebar.js)\n    return String(jsonData)\n  }\n}\n\n// Actions - Resource cleanup\nconst cleanup = () => {\n  selectedStep.value = null\n  shouldAutoScrollToBottom.value = true\n\n  if (scrollContainer.value) {\n    scrollContainer.value.removeEventListener('scroll', checkScrollState)\n  }\n}\n\n// Initialize scroll listener\nconst initScrollListener = () => {\n  const setupScrollListener = () => {\n    const element = scrollContainer.value\n    if (!element) {\n      console.log('[RightPanel] Scroll container not found, retrying...')\n      return false\n    }\n\n    // Set scroll container\n    setScrollContainer(element)\n\n    element.addEventListener('scroll', checkScrollState)\n    // Initial state check\n    shouldAutoScrollToBottom.value = true // Reset to auto scroll state\n    checkScrollState()\n    console.log('[RightPanel] Scroll listener initialized successfully')\n    return true\n  }\n\n  // Use nextTick to ensure DOM is updated\n  nextTick(() => {\n    if (!setupScrollListener()) {\n      // If first attempt fails, try again\n      setTimeout(() => {\n        setupScrollListener()\n      }, 100)\n    }\n  })\n}\n\n// Watch for currentRootPlanId changes to track execution history\nwatch(() => props.currentRootPlanId, (newPlanId, oldPlanId) => {\n  if (newPlanId && newPlanId !== oldPlanId) {\n    // A new plan has started executing\n    lastExecutedPlanId.value = newPlanId\n    hasExecutedAnyPlan.value = true\n    \n    // Persist to localStorage\n    localStorage.setItem('jmanus-last-plan-id', newPlanId)\n    localStorage.setItem('jmanus-has-executed-plan', 'true')\n    \n    console.log('[RightPanel] New plan started:', newPlanId)\n  } else if (!newPlanId && oldPlanId) {\n    // Plan execution finished, but keep the lastExecutedPlanId for file browser\n    console.log('[RightPanel] Plan execution finished, keeping last plan:', lastExecutedPlanId.value)\n  }\n}, { immediate: true })\n\n// Lifecycle - initialization on mount\nonMounted(() => {\n  console.log('[RightPanel] Component mounted')\n  // Use nextTick to ensure DOM is rendered\n  nextTick(() => {\n    initScrollListener()\n  })\n})\n\n// Lifecycle - cleanup on unmount\nonUnmounted(() => {\n  console.log('[RightPanel] Component unmounting, cleaning up...')\n  cleanup()\n})\n\n/**\n * Update displayed plan progress\n * This method is called when a plan is updated to refresh the display\n * @param rootPlanId - The root plan ID to update\n */\nconst updateDisplayedPlanProgress = (rootPlanId: string) => {\n  console.log('[RightPanel] updateDisplayedPlanProgress called with rootPlanId:', rootPlanId)\n  \n  // Update the last executed plan ID for file browser\n  if (rootPlanId) {\n    lastExecutedPlanId.value = rootPlanId\n    hasExecutedAnyPlan.value = true\n    \n    // Persist to localStorage\n    localStorage.setItem('jmanus-last-plan-id', rootPlanId)\n    localStorage.setItem('jmanus-has-executed-plan', 'true')\n    \n    console.log('[RightPanel] Plan progress updated:', rootPlanId)\n  }\n}\n\n// Expose methods to parent component - only keep necessary interfaces\ndefineExpose({\n  handleStepSelected,\n  refreshCurrentStep,\n  updateDisplayedPlanProgress,\n})\n</script>\n\n<style lang=\"less\" scoped>\n.right-panel {\n  width: 50%;\n  display: flex;\n  flex-direction: column;\n  height: 100%; /* Ensure it takes full height */\n  overflow: hidden; /* Prevent content from overflowing */\n}\n\n.preview-header {\n  padding: 20px 24px;\n  border-bottom: 1px solid #1a1a1a;\n  background: rgba(255, 255, 255, 0.02);\n\n  .tab-button {\n    padding: 8px 16px;\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 6px;\n    background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(118, 75, 162, 0.2) 100%);\n    border-color: #667eea;\n    color: #667eea;\n    cursor: default;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    font-size: 14px;\n  }\n}\n\n\n.preview-content {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  min-height: 0; /* Ensure flex items can shrink */\n  height: 100%; /* Ensure it takes full height */\n  overflow: hidden; /* Prevent content from overflowing */\n}\n\n/* Step details styles */\n.step-details {\n  flex: 1;\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  min-height: 0; /* Ensure flex items can shrink */\n  height: 100%; /* Ensure it takes full height */\n}\n\n/* Step basic information */\n.step-info {\n  padding: 20px;\n  margin: 0 20px;\n  background: rgba(41, 42, 45, 0.8);\n  border-radius: 8px;\n  margin-bottom: 16px;\n  min-height: 100px; /* Ensure minimum height */\n\n  h3 {\n    color: #ffffff;\n    margin: 0 0 16px 0;\n    font-size: 18px;\n    font-weight: 600;\n    padding-bottom: 8px;\n    border-bottom: 2px solid #667eea;\n  }\n}\n\n.step-details-scroll-container {\n  flex: 1;\n  overflow-y: auto;\n  overflow-x: hidden;\n  padding: 0 20px 20px;\n  margin: 0 20px 20px;\n  background: rgba(255, 255, 255, 0.01);\n  border-radius: 8px;\n  min-height: 200px; /* Ensure minimum height */\n\n  /* Custom scrollbar styles */\n  &::-webkit-scrollbar {\n    width: 6px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: rgba(255, 255, 255, 0.1);\n    border-radius: 3px;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: rgba(255, 255, 255, 0.3);\n    border-radius: 3px;\n\n    &:hover {\n      background: rgba(255, 255, 255, 0.5);\n    }\n  }\n}\n\n/* Step information styles - for fixed top */\n.agent-info {\n  margin-bottom: 16px;\n\n  .info-item {\n    display: flex;\n    margin-bottom: 8px;\n    font-size: 14px;\n    line-height: 1.4;\n\n    .label {\n      min-width: 100px;\n      font-weight: 600;\n      color: #888888;\n      flex-shrink: 0;\n    }\n\n    .value {\n      flex: 1;\n      color: #cccccc;\n      word-break: break-word;\n\n      &.success {\n        color: #27ae60;\n      }\n    }\n  }\n}\n\n.execution-status {\n  margin-top: 16px;\n  padding-top: 16px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n\n  .status-item {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n\n    .status-icon {\n      font-size: 16px;\n\n      &.success {\n        color: #27ae60;\n      }\n\n      &.progress {\n        color: #3498db;\n      }\n\n      &.pending {\n        color: #f39c12;\n      }\n    }\n\n    .status-text {\n      color: #cccccc;\n      font-weight: 500;\n    }\n  }\n}\n\n.no-steps-message {\n  text-align: center;\n  color: #666666;\n  font-style: italic;\n  margin-top: 16px;\n\n  p {\n    margin: 0;\n  }\n}\n\n.no-execution-message {\n  padding: 20px;\n  background: #f8f9fa;\n  border: 1px solid #e9ecef;\n  border-radius: 8px;\n  margin-top: 16px;\n\n  .info-icon {\n    color: #6c757d;\n    font-size: 20px;\n    margin-bottom: 8px;\n  }\n\n  h4 {\n    margin: 0 0 16px 0;\n    color: #495057;\n    font-size: 16px;\n    font-weight: 500;\n  }\n\n  .step-basic-info {\n    .info-item {\n      display: flex;\n      margin-bottom: 8px;\n      font-size: 14px;\n\n      .label {\n        font-weight: 500;\n        color: #6c757d;\n        min-width: 80px;\n        margin-right: 8px;\n      }\n\n      .value {\n        color: #333;\n        flex: 1;\n\n        &.status-completed {\n          color: #28a745;\n          font-weight: 500;\n        }\n\n        &.status-current {\n          color: #007bff;\n          font-weight: 500;\n        }\n\n        &.status-pending {\n          color: #6c757d;\n        }\n      }\n    }\n  }\n\n  .no-execution-hint {\n    margin: 16px 0 0 0;\n    color: #6c757d;\n    font-style: italic;\n    font-size: 13px;\n    text-align: center;\n  }\n}\n\n.execution-indicator {\n  margin-top: 20px;\n  padding: 20px;\n  background: rgba(74, 144, 226, 0.1);\n  border: 1px solid rgba(74, 144, 226, 0.3);\n  border-radius: 8px;\n  text-align: center;\n  position: relative;\n  overflow: hidden;\n}\n\n.execution-waves {\n  position: relative;\n  height: 4px;\n  margin-bottom: 16px;\n  background: rgba(74, 144, 226, 0.2);\n  border-radius: 2px;\n  overflow: hidden;\n}\n\n.wave {\n  position: absolute;\n  top: 0;\n  left: -100%;\n  width: 100%;\n  height: 100%;\n  background: linear-gradient(90deg, transparent, rgba(74, 144, 226, 0.6), transparent);\n  border-radius: 2px;\n}\n\n.wave-1 {\n  animation: wave-animation 2s ease-in-out infinite;\n}\n\n.wave-2 {\n  animation: wave-animation 2s ease-in-out infinite 0.6s;\n}\n\n.wave-3 {\n  animation: wave-animation 2s ease-in-out infinite 1.2s;\n}\n\n@keyframes wave-animation {\n  0% {\n    left: -100%;\n  }\n  50% {\n    left: 100%;\n  }\n  100% {\n    left: 100%;\n  }\n}\n\n.execution-text {\n  color: #4a90e2;\n  font-size: 14px;\n  margin: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n}\n\n.rotating-icon {\n  animation: rotate-animation 1s linear infinite;\n}\n\n@keyframes rotate-animation {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n.step-info {\n  h3 {\n    color: #ffffff;\n    margin: 0 0 20px 0;\n    font-size: 18px;\n    font-weight: 600;\n  }\n}\n\n.think-act-steps {\n  margin-top: 20px; /* Increase top spacing since there's no fixed header step info now */\n\n  h4 {\n    color: #ffffff;\n    margin: 0 0 16px 0;\n    font-size: 16px;\n    font-weight: 600;\n    padding-bottom: 8px;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.2);\n  }\n}\n\n.steps-container {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.think-act-step {\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  padding: 16px;\n\n  .step-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 16px;\n\n    .step-number {\n      font-weight: 600;\n      color: #667eea;\n      font-size: 14px;\n    }\n\n    .step-status {\n      padding: 4px 8px;\n      border-radius: 4px;\n      font-size: 12px;\n      font-weight: 500;\n\n      &.completed {\n        background: rgba(39, 174, 96, 0.2);\n        color: #27ae60;\n      }\n\n      &.running {\n        background: rgba(52, 152, 219, 0.2);\n        color: #3498db;\n      }\n\n      &.pending {\n        background: rgba(243, 156, 18, 0.2);\n        color: #f39c12;\n      }\n    }\n  }\n\n  .think-section,\n  .action-section,\n  .sub-plan-section {\n    margin-bottom: 16px;\n\n    &:last-child {\n      margin-bottom: 0;\n    }\n\n    h5 {\n      display: flex;\n      align-items: center;\n      gap: 6px;\n      margin: 0 0 12px 0;\n      font-size: 14px;\n      font-weight: 600;\n      color: #ffffff;\n    }\n  }\n\n  .think-content,\n  .action-content {\n    .input,\n    .output,\n    .tool-info {\n      margin-bottom: 12px;\n\n      &:last-child {\n        margin-bottom: 0;\n      }\n\n      .label {\n        display: block;\n        font-weight: 600;\n        color: #888888;\n        margin-bottom: 4px;\n        font-size: 12px;\n      }\n\n      .value {\n        color: #cccccc;\n        font-size: 14px;\n      }\n\n      pre {\n        background: rgba(0, 0, 0, 0.3);\n        border: 1px solid rgba(255, 255, 255, 0.1);\n        border-radius: 4px;\n        padding: 12px;\n        color: #cccccc;\n        font-size: 12px;\n        overflow-x: auto;\n        white-space: pre-wrap;\n        margin: 0;\n        line-height: 1.4;\n        max-height: 200px;\n        overflow-y: auto;\n      }\n    }\n  }\n\n  /* Sub plan styles */\n  .sub-plan-content {\n    .sub-plan-header {\n      background: rgba(102, 126, 234, 0.1);\n      border: 1px solid rgba(102, 126, 234, 0.3);\n      border-radius: 6px;\n      padding: 12px;\n      margin-bottom: 12px;\n\n      .sub-plan-info {\n        display: flex;\n        margin-bottom: 8px;\n        font-size: 12px;\n\n        &:last-child {\n          margin-bottom: 0;\n        }\n\n        .label {\n          min-width: 80px;\n          font-weight: 600;\n          color: #888888;\n          flex-shrink: 0;\n        }\n\n        .value {\n          flex: 1;\n          color: #cccccc;\n          word-break: break-word;\n        }\n      }\n\n      .sub-plan-status {\n        display: flex;\n        align-items: center;\n        gap: 6px;\n        padding-top: 8px;\n        border-top: 1px solid rgba(255, 255, 255, 0.1);\n\n        .status-icon {\n          font-size: 14px;\n\n          &.success {\n            color: #27ae60;\n          }\n\n          &.progress {\n            color: #3498db;\n          }\n        }\n\n        .status-text {\n          color: #cccccc;\n          font-size: 12px;\n          font-weight: 500;\n        }\n      }\n    }\n  }\n}\n\n.no-selection {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  color: #666666;\n\n  .empty-icon {\n    font-size: 48px;\n    margin-bottom: 16px;\n    color: #444444;\n  }\n\n  h3 {\n    margin: 0 0 8px 0;\n    font-size: 18px;\n    color: #888888;\n  }\n\n  p {\n    margin: 0;\n    font-size: 14px;\n    text-align: center;\n    max-width: 300px;\n    line-height: 1.5;\n  }\n}\n\n/* Scroll to bottom button */\n.scroll-to-bottom-btn {\n  position: fixed;\n  bottom: 40px;\n  right: 40px;\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  background: rgba(74, 144, 226, 0.9);\n  border: none;\n  color: white;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 18px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n  transition: all 0.3s ease;\n  z-index: 100;\n\n  &:hover {\n    background: rgba(74, 144, 226, 1);\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);\n  }\n\n  &:active {\n    transform: translateY(0);\n  }\n}\n\n/* Scroll button transition animation */\n.scroll-button-enter-active,\n.scroll-button-leave-active {\n  transition: all 0.3s ease;\n}\n\n.scroll-button-enter-from,\n.scroll-button-leave-to {\n  opacity: 0;\n  transform: translateY(20px) scale(0.8);\n}\n\n/* File Browser Container */\n.file-browser-container {\n  height: 100%;\n  padding: 0;\n  overflow: hidden;\n}\n\n.no-plan-message {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  color: rgba(255, 255, 255, 0.6);\n  gap: 24px;\n  padding: 40px 20px;\n  text-align: center;\n}\n\n.no-plan-message > .iconify {\n  font-size: 64px;\n  color: rgba(255, 255, 255, 0.3);\n}\n\n.message-content {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 16px;\n  max-width: 300px;\n}\n\n.message-content h3 {\n  margin: 0;\n  font-size: 18px;\n  font-weight: 600;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.message-content p {\n  margin: 0;\n  font-size: 14px;\n  line-height: 1.5;\n  color: rgba(255, 255, 255, 0.6);\n}\n\n.tips {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 12px 16px;\n  background: rgba(103, 126, 234, 0.1);\n  border: 1px solid rgba(103, 126, 234, 0.2);\n  border-radius: 8px;\n  font-size: 12px;\n  color: rgba(103, 126, 234, 0.9);\n}\n\n.tips .iconify {\n  font-size: 14px;\n  flex-shrink: 0;\n}\n\n/* Tab styles */\n.preview-tabs {\n  display: flex;\n  gap: 0;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n  padding: 4px;\n}\n\n.tab-item {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 10px 16px;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  color: rgba(255, 255, 255, 0.7);\n  font-size: 13px;\n  font-weight: 500;\n  min-width: 0;\n  flex: 1;\n  justify-content: center;\n  position: relative;\n}\n\n.tab-item:hover {\n  background: rgba(255, 255, 255, 0.08);\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.tab-item.active {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: #ffffff;\n  box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);\n}\n\n.tab-item .iconify {\n  font-size: 16px;\n  flex-shrink: 0;\n}\n\n.tab-item span {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n</style>\n","/**\n * Plan Parameter API Service\n * Handles API calls for plan parameter requirements\n */\n\nexport interface ParameterRequirements {\n  parameters: string[]\n  hasParameters: boolean\n  requirements: string\n}\n\nexport class PlanParameterApiService {\n  private static readonly BASE_URL = '/api/plan-template'\n\n  /**\n   * Get parameter requirements for a plan template\n   * @param planTemplateId The plan template ID\n   * @returns Parameter requirements\n   */\n  static async getParameterRequirements(planTemplateId: string): Promise<ParameterRequirements> {\n    try {\n      const response = await fetch(`${this.BASE_URL}/${planTemplateId}/parameters`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      })\n\n      if (!response.ok) {\n        throw new Error(`Failed to get parameter requirements: ${response.statusText}`)\n      }\n\n      const data = await response.json()\n      return data\n    } catch (error) {\n      console.error('Error getting parameter requirements:', error)\n      throw error\n    }\n  }\n}\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <Modal v-model=\"showModal\" :title=\"modalTitle\" @confirm=\"handlePublish\">\n    <div class=\"modal-form wide-modal\">\n      <!-- Tool Name -->\n      <div class=\"form-section\">\n        <div class=\"form-item\">\n          <label>{{ t('mcpService.toolNameRequired') }}</label>\n          <input\n            type=\"text\"\n            v-model=\"formData.serviceName\"\n            :placeholder=\"t('mcpService.toolNamePlaceholder')\"\n            :class=\"{ error: !formData.serviceName || !formData.serviceName.trim() }\"\n            required\n          />\n          <div class=\"field-description\">{{ t('mcpService.toolNameDescription') }}</div>\n        </div>\n      </div>\n\n      <!-- Tool Description -->\n      <div class=\"form-section\">\n        <div class=\"form-item\">\n          <label>{{ t('mcpService.toolDescriptionRequired') }}</label>\n          <textarea\n            v-model=\"formData.userRequest\"\n            :placeholder=\"t('mcpService.toolDescriptionPlaceholder')\"\n            :class=\"{ error: !formData.userRequest || !formData.userRequest.trim() }\"\n            class=\"description-field\"\n            rows=\"4\"\n            required\n          />\n          <div class=\"field-description\">{{ t('mcpService.toolDescriptionDescription') }}</div>\n        </div>\n      </div>\n\n      <!-- Service Group -->\n      <div class=\"form-section\">\n        <div class=\"form-item\">\n          <label>{{ t('mcpService.serviceGroup') }}</label>\n          <div class=\"service-group-autocomplete\">\n            <input\n              type=\"text\"\n              v-model=\"formData.serviceGroup\"\n              @input=\"handleServiceGroupInput\"\n              @focus=\"showGroupSuggestions = true\"\n              @blur=\"handleServiceGroupBlur\"\n              :placeholder=\"t('mcpService.serviceGroupPlaceholder')\"\n              :class=\"{ error: !formData.serviceGroup || !formData.serviceGroup.trim() }\"\n              required\n            />\n            <!-- Filtered group suggestions dropdown -->\n            <div\n              v-if=\"showGroupSuggestions && filteredServiceGroups.length > 0\"\n              class=\"service-group-dropdown\"\n            >\n              <div\n                v-for=\"group in filteredServiceGroups\"\n                :key=\"group\"\n                class=\"service-group-option\"\n                @mousedown=\"selectServiceGroup(group)\"\n              >\n                {{ group }}\n              </div>\n            </div>\n          </div>\n          <div class=\"field-description\">{{ t('mcpService.serviceGroupDescription') }}</div>\n        </div>\n      </div>\n\n      <!-- Parameter Configuration -->\n      <div class=\"form-section\">\n        <div class=\"section-title\">{{ t('mcpService.parameterConfig') }}</div>\n\n        <!-- Parameter Requirements Help Text -->\n        <div v-if=\"parameterRequirements.hasParameters\" class=\"params-help-text\">\n          {{ t('sidebar.parameterRequirementsHelp') }}\n        </div>\n\n        <div class=\"parameter-table\">\n          <table>\n            <thead>\n              <tr>\n                <th>{{ t('mcpService.parameterName') }}</th>\n                <th>{{ t('mcpService.parameterDescription') }}</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"(param, index) in formData.parameters\" :key=\"index\">\n                <td>\n                  <input\n                    type=\"text\"\n                    v-model=\"param.name\"\n                    :placeholder=\"t('mcpService.parameterName')\"\n                    class=\"parameter-input\"\n                    :readonly=\"parameterRequirements.hasParameters\"\n                    :class=\"{ 'readonly-input': parameterRequirements.hasParameters }\"\n                    required\n                  />\n                </td>\n                <td>\n                  <input\n                    type=\"text\"\n                    v-model=\"param.description\"\n                    :placeholder=\"t('mcpService.parameterDescription')\"\n                    class=\"parameter-input\"\n                    required\n                  />\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n\n      <!-- Service Publishing Options -->\n      <div class=\"form-section\">\n        <div class=\"service-publish-options\">\n          <!-- Internal Toolcall Publishing Option -->\n          <div class=\"internal-toolcall-publish-option\">\n            <label class=\"checkbox-label\">\n              <input type=\"checkbox\" v-model=\"publishAsInternalToolcall\" class=\"checkbox-input\" />\n              <span class=\"checkbox-text\">{{ t('mcpService.publishAsInternalToolcall') }}</span>\n            </label>\n            <div class=\"checkbox-description\">\n              {{ t('mcpService.publishAsInternalToolcallDescription') }}\n            </div>\n          </div>\n\n          <!-- HTTP POST Service Publishing Option -->\n          <div class=\"http-publish-option\">\n            <label class=\"checkbox-label\">\n              <input type=\"checkbox\" v-model=\"publishAsHttpService\" class=\"checkbox-input\" />\n              <span class=\"checkbox-text\">{{ t('mcpService.publishAsHttpService') }}</span>\n            </label>\n            <div class=\"checkbox-description\">\n              {{ t('mcpService.publishAsHttpServiceDescription') }}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <template #footer>\n      <div class=\"button-container\">\n        <!-- Delete Button - Only shown when saved -->\n        <button\n          v-if=\"isSaved && currentTool?.id\"\n          class=\"action-btn danger\"\n          @click=\"handleDelete\"\n          :disabled=\"deleting\"\n        >\n          <Icon icon=\"carbon:loading\" v-if=\"deleting\" class=\"loading-icon\" />\n          <Icon icon=\"carbon:trash-can\" v-else />\n          {{ deleting ? t('mcpService.deleting') : t('mcpService.delete') }}\n        </button>\n\n        <!-- Publish as Service Button - Always shown -->\n        <button class=\"action-btn primary\" @click=\"handlePublish\" :disabled=\"publishing\">\n          <Icon icon=\"carbon:loading\" v-if=\"publishing\" class=\"loading-icon\" />\n          <Icon icon=\"carbon:cloud-upload\" v-else />\n          {{ publishing ? t('mcpService.publishing') : t('mcpService.publishAsService') }}\n        </button>\n      </div>\n    </template>\n  </Modal>\n\n  <!-- Error Toast -->\n  <div v-if=\"error\" class=\"error-toast\" @click=\"error = ''\">\n    <Icon icon=\"carbon:error\" />\n    {{ error }}\n  </div>\n\n  <!-- Success Toast -->\n  <div v-if=\"success\" class=\"success-toast\" @click=\"success = ''\">\n    <Icon icon=\"carbon:checkmark\" />\n    {{ success }}\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport {\n  CoordinatorToolApiService,\n  type CoordinatorToolVO,\n} from '@/api/coordinator-tool-api-service'\nimport {\n  PlanParameterApiService,\n  type ParameterRequirements,\n} from '@/api/plan-parameter-api-service'\nimport { ToolApiService } from '@/api/tool-api-service'\nimport Modal from '@/components/modal/index.vue'\nimport { Icon } from '@iconify/vue'\nimport { computed, onMounted, reactive, ref, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\n\nconst { t } = useI18n()\n\n// Props\ninterface Props {\n  modelValue: boolean\n  planTemplateId?: string\n  planDescription?: string\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  modelValue: false,\n  planTemplateId: '',\n  planDescription: '',\n})\n\n// Emits\nconst emit = defineEmits<{\n  'update:modelValue': [value: boolean]\n  published: [tool: CoordinatorToolVO | null]\n}>()\n\n// Reactive data\nconst showModal = computed({\n  get: () => props.modelValue,\n  set: value => emit('update:modelValue', value),\n})\n\nconst error = ref('')\nconst success = ref('')\nconst publishing = ref(false)\nconst deleting = ref(false)\n\n// Current tool data, used to determine whether to create or update\nconst currentTool = ref<CoordinatorToolVO | null>(null)\n\n// Publishing status\nconst isSaved = ref(false)\n\n// Service publishing options\nconst publishAsHttpService = ref(false)\nconst publishAsInternalToolcall = ref(true) // Default to true\n\n// Parameter requirements from plan template\nconst parameterRequirements = ref<ParameterRequirements>({\n  parameters: [],\n  hasParameters: false,\n  requirements: '',\n})\nconst isLoadingParameters = ref(false)\n\n// Service group autocomplete state\nconst showGroupSuggestions = ref(false)\nconst availableServiceGroups = ref<string[]>([])\nconst isLoadingGroups = ref(false)\n\n// Form data\nconst formData = reactive({\n  serviceName: '',\n  userRequest: '',\n  endpoint: '',\n  serviceGroup: '',\n  parameters: [] as Array<{ name: string; description: string }>,\n})\n\n// Filtered service groups based on input (reusing filtering pattern from ToolSelectionModal)\nconst filteredServiceGroups = computed(() => {\n  const trimmedGroup = formData.serviceGroup.trim()\n  if (!trimmedGroup) {\n    return availableServiceGroups.value\n  }\n\n  const query = trimmedGroup.toLowerCase()\n  return availableServiceGroups.value.filter(group => group.toLowerCase().includes(query))\n})\n\n// Calculate modal title\nconst modalTitle = computed(() => {\n  const isUpdate = currentTool.value?.id\n  return isUpdate ? t('mcpService.updateService') : t('mcpService.createService')\n})\n\n// Initialize form data\nconst initializeFormData = () => {\n  formData.serviceName = '' // Show empty when no entity\n  formData.userRequest = props.planDescription || ''\n  formData.endpoint = ''\n  formData.serviceGroup = ''\n  // Only reset parameters when not loaded from plan template\n  if (!parameterRequirements.value.hasParameters) {\n    formData.parameters = []\n  }\n  currentTool.value = null\n  isSaved.value = false\n}\n\n// Watch tool description and copy to tool name when description changes\nwatch(\n  () => formData.userRequest,\n  newDescription => {\n    // Copy description to tool name when description is entered\n    const trimmedDescription = newDescription.trim()\n    if (trimmedDescription) {\n      // Only copy if tool name is empty to avoid overwriting user input\n      if (!formData.serviceName.trim()) {\n        formData.serviceName = trimmedDescription\n      }\n    }\n  }\n)\n\n// Load available service groups from tools (reusing logic from ToolSelectionModal)\nconst loadAvailableServiceGroups = async () => {\n  if (isLoadingGroups.value) {\n    return\n  }\n\n  isLoadingGroups.value = true\n  try {\n    const tools = await ToolApiService.getAvailableTools()\n    // Extract unique service groups (same pattern as groupedTools in ToolSelectionModal)\n    const groupsSet = new Set<string>()\n    tools.forEach(tool => {\n      if (tool.serviceGroup) {\n        groupsSet.add(tool.serviceGroup)\n      }\n    })\n    availableServiceGroups.value = Array.from(groupsSet).sort()\n  } catch (error) {\n    console.error('[PublishModal] Failed to load service groups:', error)\n    availableServiceGroups.value = []\n  } finally {\n    isLoadingGroups.value = false\n  }\n}\n\n// Handle service group input\nconst handleServiceGroupInput = () => {\n  showGroupSuggestions.value = true\n}\n\n// Handle service group blur (with delay to allow option click)\nconst handleServiceGroupBlur = () => {\n  setTimeout(() => {\n    showGroupSuggestions.value = false\n  }, 200)\n}\n\n// Select a service group from dropdown\nconst selectServiceGroup = (group: string) => {\n  formData.serviceGroup = group\n  showGroupSuggestions.value = false\n}\n\n// Load parameter requirements from plan template\nconst loadParameterRequirements = async () => {\n  if (!props.planTemplateId) {\n    parameterRequirements.value = {\n      parameters: [],\n      hasParameters: false,\n      requirements: '',\n    }\n    return\n  }\n\n  isLoadingParameters.value = true\n  try {\n    const requirements = await PlanParameterApiService.getParameterRequirements(\n      props.planTemplateId\n    )\n    parameterRequirements.value = requirements\n\n    // Initialize form parameters with extracted parameters\n    if (requirements.hasParameters) {\n      formData.parameters = requirements.parameters.map(param => ({\n        name: param,\n        description: '',\n      }))\n    }\n  } catch (error) {\n    console.error('[PublishModal] Failed to load parameter requirements:', error)\n    // Don't show error for 404 - template might not be ready yet\n    if (error instanceof Error && !error.message.includes('404')) {\n      console.warn('[PublishModal] Parameter requirements not available yet, will retry later')\n    }\n    parameterRequirements.value = {\n      parameters: [],\n      hasParameters: false,\n      requirements: '',\n    }\n  } finally {\n    isLoadingParameters.value = false\n  }\n}\n\n// Show message\nconst showMessage = (msg: string, type: 'success' | 'error' | 'info') => {\n  if (type === 'success') {\n    success.value = msg\n    setTimeout(() => {\n      success.value = ''\n    }, 3000)\n  } else if (type === 'error') {\n    error.value = msg\n    setTimeout(() => {\n      error.value = ''\n    }, 5000)\n  }\n}\n\n// Validate form\nconst validateForm = (): boolean => {\n  // Validate tool name\n  if (!formData.serviceName.trim()) {\n    showMessage(t('mcpService.toolNameRequiredError'), 'error')\n    return false\n  }\n\n  // Validate tool description\n  if (!formData.userRequest.trim()) {\n    showMessage(t('mcpService.toolDescriptionRequiredError'), 'error')\n    return false\n  }\n\n  // Validate service group\n  if (!formData.serviceGroup.trim()) {\n    showMessage(t('mcpService.serviceGroupRequiredError'), 'error')\n    return false\n  }\n\n  // Ensure at least one service is selected\n  if (!publishAsInternalToolcall.value && !publishAsHttpService.value) {\n    showMessage('Please select at least one service type', 'error')\n    return false\n  }\n\n  // Validate parameter names and descriptions\n  for (let i = 0; i < formData.parameters.length; i++) {\n    const param = formData.parameters[i]\n    if (param.name && !param.description.trim()) {\n      showMessage(`Parameter \"${param.name}\" description cannot be empty`, 'error')\n      return false\n    }\n    if (param.description && !param.name.trim()) {\n      showMessage(\n        `Parameter description \"${param.description}\" corresponding name cannot be empty`,\n        'error'\n      )\n      return false\n    }\n  }\n\n  return true\n}\n\n// Handle publishing\nconst handlePublish = async () => {\n  console.log('[PublishModal] Starting to handle publish request')\n  console.log('[PublishModal] Form data:', formData)\n  console.log('[PublishModal] Current tool:', currentTool.value)\n  console.log('[PublishModal] Publish as HTTP service:', publishAsHttpService.value)\n\n  if (!validateForm()) {\n    console.log('[PublishModal] Form validation failed')\n    return\n  }\n\n  publishing.value = true\n  try {\n    // 1. If no current tool data, get or create default first\n    if (!currentTool.value) {\n      console.log('[PublishModal] No current tool data, getting existing tool or creating default')\n      const existingTool = await CoordinatorToolApiService.getCoordinatorToolByTemplate(\n        props.planTemplateId\n      )\n\n      if (existingTool) {\n        currentTool.value = existingTool\n      } else {\n        // Create default tool VO (not saved yet)\n        currentTool.value = CoordinatorToolApiService.createDefaultCoordinatorTool(\n          props.planTemplateId,\n          undefined,\n          props.planDescription\n        )\n      }\n    }\n\n    // 2. Update tool information\n    console.log('[PublishModal] Updating tool information')\n    currentTool.value.toolName = formData.serviceName.trim()\n    currentTool.value.toolDescription = formData.userRequest.trim()\n    currentTool.value.serviceGroup = formData.serviceGroup.trim()\n    currentTool.value.planTemplateId = props.planTemplateId // Ensure planTemplateId is set\n\n    // Set service enabled status and corresponding endpoint\n    currentTool.value.enableInternalToolcall = publishAsInternalToolcall.value\n    currentTool.value.enableHttpService = publishAsHttpService.value\n    currentTool.value.enableMcpService = false\n\n    // Set corresponding endpoint\n    currentTool.value.mcpEndpoint = undefined\n\n    // 3. Update inputSchema\n    const inputSchema = formData.parameters\n      .filter(param => param.name.trim() && param.description.trim())\n      .map(param => ({\n        name: param.name.trim(),\n        description: param.description.trim(),\n        type: 'string',\n      }))\n\n    currentTool.value.inputSchema = JSON.stringify(inputSchema)\n    console.log('[PublishModal] Updated tool information:', currentTool.value)\n\n    // 4. Save tool\n    if (currentTool.value.id) {\n      console.log('[PublishModal] Updating existing tool, ID:', currentTool.value.id)\n      await CoordinatorToolApiService.updateCoordinatorTool(currentTool.value.id, currentTool.value)\n    } else {\n      console.log('[PublishModal] Creating new tool')\n      const savedTool = await CoordinatorToolApiService.createCoordinatorTool(currentTool.value)\n      currentTool.value = savedTool // Update current tool, including newly generated ID\n    }\n\n    // 5. Perform corresponding publishing operations based on publish type\n    const enabledServices = []\n    if (publishAsInternalToolcall.value) enabledServices.push('Internal Method Call')\n    if (publishAsHttpService.value) enabledServices.push('HTTP Service')\n\n    if (enabledServices.length > 0) {\n      console.log(\n        '[PublishModal] Step 5: Publishing service, ID:',\n        currentTool.value.id,\n        'Enabled services:',\n        enabledServices.join(', ')\n      )\n\n      // Build service URL information\n      const serviceUrls = []\n      if (publishAsInternalToolcall.value) {\n        serviceUrls.push(`Internal Call: ${formData.serviceName}`)\n      }\n\n      console.log('[PublishModal] Service published successfully')\n      showMessage(t('mcpService.publishSuccess'), 'success')\n      emit('published', currentTool.value)\n    } else {\n      // Just save, don't publish as any service\n      console.log('[PublishModal] Only saving tool, not publishing as any service')\n      showMessage(t('mcpService.saveSuccess'), 'success')\n      emit('published', currentTool.value)\n    }\n  } catch (err: any) {\n    console.error('[PublishModal] Failed to publish service:', err)\n    showMessage(t('mcpService.publishFailed') + ': ' + err.message, 'error')\n  } finally {\n    publishing.value = false\n  }\n}\n\n// Handle delete\nconst handleDelete = async () => {\n  if (deleting.value) return\n\n  // Confirm deletion\n  if (!confirm(t('mcpService.deleteConfirmMessage'))) {\n    return\n  }\n\n  if (!currentTool.value?.id) {\n    showMessage(\n      t('mcpService.deleteFailed') + ': ' + t('mcpService.selectPlanTemplateFirst'),\n      'error'\n    )\n    return\n  }\n\n  deleting.value = true\n  try {\n    console.log('[PublishModal] Starting to delete MCP service, ID:', currentTool.value.id)\n\n    // Call delete API\n    const result = await CoordinatorToolApiService.deleteCoordinatorTool(currentTool.value.id)\n\n    if (result.success) {\n      console.log('[PublishModal] Deleted successfully')\n      showMessage(t('mcpService.deleteSuccess'), 'success')\n\n      // Close modal\n      showModal.value = false\n\n      // Notify parent component of successful deletion\n      emit('published', null)\n    } else {\n      throw new Error(result.message)\n    }\n  } catch (error: any) {\n    console.error('[PublishModal] Failed to delete MCP service:', error)\n    showMessage(t('mcpService.deleteFailed') + ': ' + error.message, 'error')\n  } finally {\n    deleting.value = false\n  }\n}\n\n// Watch modal display state\nconst watchModal = async () => {\n  if (showModal.value) {\n    console.log('[PublishModal] Modal opened, starting to initialize data')\n    initializeFormData()\n    await loadCoordinatorToolData()\n  }\n}\n\n// Load coordinator tool data\nconst loadCoordinatorToolData = async () => {\n  if (!props.planTemplateId) {\n    console.log('[PublishModal] ' + t('mcpService.noPlanTemplateId'))\n    return\n  }\n\n  try {\n    console.log(\n      '[PublishModal] Starting to load coordinator tool data, planTemplateId:',\n      props.planTemplateId\n    )\n\n    // Try to get existing tool\n    const existingTool = await CoordinatorToolApiService.getCoordinatorToolByTemplate(\n      props.planTemplateId\n    )\n\n    let tool: CoordinatorToolVO\n    if (existingTool) {\n      // Use existing tool\n      tool = existingTool\n      console.log('[PublishModal] Found existing coordinator tool:', tool)\n    } else {\n      // Create default tool VO (not saved to database)\n      tool = CoordinatorToolApiService.createDefaultCoordinatorTool(\n        props.planTemplateId,\n        undefined,\n        props.planDescription\n      )\n      console.log('[PublishModal] Created default coordinator tool VO:', tool)\n    }\n\n    // Save current tool data\n    currentTool.value = tool\n\n    // Only existing tools (with ID) are set as saved\n    isSaved.value = !!tool.id\n\n    // Build service URL information\n    const serviceUrls = []\n    if (tool.enableMcpService && tool.mcpEndpoint) {\n      const baseUrl = window.location.origin\n      serviceUrls.push(`MCP: ${baseUrl}/mcp${tool.mcpEndpoint}`)\n    }\n    if (tool.enableInternalToolcall) {\n      serviceUrls.push(`Internal Call: ${tool.toolName}`)\n    }\n\n    console.log('[PublishModal] Load tool data completed')\n    // Fill form data\n    formData.serviceName = tool.toolName || ''\n    formData.userRequest = tool.toolDescription || props.planDescription || ''\n    formData.serviceGroup = tool.serviceGroup ?? ''\n\n    // Set form data based on service type\n    publishAsHttpService.value = tool.enableHttpService ?? false\n    publishAsInternalToolcall.value = tool.enableInternalToolcall ?? false\n\n    // Parse inputSchema as parameters\n    try {\n      if (tool.inputSchema) {\n        const parameters = JSON.parse(tool.inputSchema)\n        if (Array.isArray(parameters) && parameters.length > 0) {\n          // Only override when inputSchema has parameters, otherwise keep parameters loaded from plan template\n          formData.parameters = parameters.map(param => ({\n            name: param.name || '',\n            description: param.description || '',\n          }))\n          console.log('[PublishModal] Load parameters from inputSchema:', formData.parameters)\n        } else {\n          console.log(\n            '[PublishModal] inputSchema is empty, keeping existing parameters:',\n            formData.parameters\n          )\n        }\n      }\n    } catch (e) {\n      console.warn('[PublishModal] ' + t('mcpService.parseInputSchemaFailed') + ':', e)\n      // Don't clear parameters when parsing fails, keep existing parameters\n      console.log(\n        '[PublishModal] Parsing failed, keeping existing parameters:',\n        formData.parameters\n      )\n    }\n\n    console.log('[PublishModal] Form data filled:', formData)\n  } catch (err: any) {\n    console.error('[PublishModal] ' + t('mcpService.loadToolDataFailed') + ':', err)\n    showMessage(t('mcpService.loadToolDataFailed') + ': ' + err.message, 'error')\n  }\n}\n\n// Watch props changes\nwatch(() => props.modelValue, watchModal)\n\n// Watch for planTemplateId changes\nwatch(\n  () => props.planTemplateId,\n  (newId, oldId) => {\n    if (newId && newId !== oldId) {\n      // If this is a new template ID (not from initial load), retry loading parameters\n      if (oldId && newId.startsWith('planTemplate-')) {\n        // Retry loading parameters with a delay for new templates\n        setTimeout(() => {\n          loadParameterRequirements()\n        }, 1000)\n      } else {\n        loadParameterRequirements()\n      }\n    }\n  }\n)\n\n// Load available service groups when modal opens\nwatch(showModal, newVisible => {\n  if (newVisible) {\n    loadAvailableServiceGroups()\n  }\n})\n\n// Initialize when component mounts\nonMounted(async () => {\n  if (showModal.value) {\n    console.log('[PublishModal] Initialize when component mounted')\n    initializeFormData()\n    await loadCoordinatorToolData()\n    await loadParameterRequirements()\n  }\n})\n\n// Expose methods for parent component\ndefineExpose({\n  loadParameterRequirements,\n})\n</script>\n\n<style scoped>\n/* Wide modal styles */\n:deep(.wide-modal .modal-container) {\n  width: 90%;\n  max-width: 900px !important; /* Adjust width to 900px */\n}\n\n/* Form layout optimization - reference new Model modal styles */\n.modal-form {\n  display: flex;\n  flex-direction: column;\n  gap: 16px; /* Adjust to 16px, consistent with new Model modal */\n  width: 100%;\n}\n\n.form-section {\n  display: flex;\n  flex-direction: column;\n  gap: 8px; /* Adjust to 8px, optimize title and input spacing */\n  width: 100%;\n}\n\n.section-title {\n  margin: 0;\n  font-size: 16px;\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n  padding-bottom: 8px;\n}\n\n.form-item {\n  display: flex;\n  flex-direction: column;\n  gap: 8px; /* Adjust to 8px, optimize title and input spacing */\n}\n\n.form-item label {\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 14px;\n  margin: 0; /* Remove default margin */\n}\n\n.required {\n  color: #ff6b6b;\n}\n\n/* Field description styles */\n.field-description {\n  font-size: 12px;\n  color: rgba(255, 255, 255, 0.6);\n  margin-top: 4px;\n  line-height: 1.4;\n  font-style: italic;\n}\n\n.form-item input,\n.form-item textarea {\n  width: 100%;\n  padding: 12px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  color: #fff;\n  font-size: 14px;\n  transition: all 0.3s ease;\n  font-family: inherit;\n  box-sizing: border-box;\n  min-height: 48px; /* Ensure consistent minimum height */\n}\n\n.form-item input {\n  height: 48px; /* Single line input fixed height */\n}\n\n.form-item input:focus,\n.form-item textarea:focus {\n  border-color: #667eea;\n  outline: none;\n  background: rgba(255, 255, 255, 0.08);\n  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);\n}\n\n.form-item input::placeholder,\n.form-item textarea::placeholder {\n  color: rgba(255, 255, 255, 0.4);\n}\n\n/* Service Group Autocomplete Styles */\n.service-group-autocomplete {\n  position: relative;\n}\n\n.service-group-autocomplete input {\n  width: 100%;\n}\n\n.service-group-dropdown {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  right: 0;\n  z-index: 99999;\n  margin-top: 4px;\n  background: rgba(15, 15, 20, 0.98);\n  backdrop-filter: blur(20px);\n  border: 1px solid rgba(102, 126, 234, 0.3);\n  border-radius: 8px;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);\n  max-height: 200px;\n  overflow-y: auto;\n}\n\n.service-group-option {\n  padding: 12px 16px;\n  color: rgba(255, 255, 255, 0.9);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 14px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.05);\n}\n\n.service-group-option:last-child {\n  border-bottom: none;\n}\n\n.service-group-option:hover {\n  background: rgba(102, 126, 234, 0.1);\n  color: #667eea;\n}\n\n.description-field {\n  resize: vertical;\n  min-height: 80px;\n  line-height: 1.5;\n  width: 100%;\n}\n\n/* Parameter Requirements Help Text */\n.params-help-text {\n  margin-bottom: 12px;\n  font-size: 11px;\n  color: rgba(255, 255, 255, 0.6);\n  line-height: 1.4;\n  padding: 6px 8px;\n  background: rgba(102, 126, 234, 0.1);\n  border: 1px solid rgba(102, 126, 234, 0.2);\n  border-radius: 4px;\n}\n\n/* Parameter table responsive */\n.parameter-table {\n  margin-bottom: 16px;\n  width: 100%;\n  overflow-x: auto;\n}\n\n.parameter-table table {\n  width: 100%;\n  border-collapse: collapse;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n  overflow: hidden;\n  min-width: 600px;\n}\n\n.parameter-table th {\n  background: rgba(255, 255, 255, 0.1);\n  color: rgba(255, 255, 255, 0.9);\n  font-weight: 500;\n  padding: 12px;\n  text-align: left;\n  font-size: 14px;\n  white-space: nowrap;\n}\n\n.parameter-table td {\n  padding: 8px 12px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.parameter-input {\n  width: 100%;\n  padding: 8px 12px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  color: #fff;\n  font-size: 14px;\n  transition: all 0.3s ease;\n}\n\n.parameter-input:focus {\n  border-color: #667eea;\n  outline: none;\n  background: rgba(255, 255, 255, 0.08);\n}\n\n.readonly-input {\n  background: rgba(255, 255, 255, 0.02) !important;\n  color: rgba(255, 255, 255, 0.6) !important;\n  cursor: not-allowed;\n  border-color: rgba(255, 255, 255, 0.05) !important;\n}\n\n/* Delete and add button styles removed */\n\n/* Endpoint component responsive - supports manual input */\n.custom-dropdown {\n  position: relative;\n  width: 100%;\n}\n\n.dropdown-input {\n  width: 100%;\n  padding: 12px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  color: #fff;\n  font-size: 14px;\n  transition: all 0.3s ease;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  box-sizing: border-box;\n  height: 48px; /* Ensure consistent height with other inputs */\n}\n\n.dropdown-input input {\n  background: transparent;\n  border: none;\n  outline: none;\n  color: #fff;\n  font-size: 14px;\n  width: 100%;\n  cursor: text; /* Allow text input */\n  height: 100%;\n  padding: 0;\n}\n\n.dropdown-input input::placeholder {\n  color: rgba(255, 255, 255, 0.4);\n  font-style: italic;\n}\n\n.dropdown-input.active {\n  border-color: #667eea;\n  outline: none;\n  background-color: rgba(255, 255, 255, 0.08);\n  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);\n  transform: translateY(-1px);\n}\n\n.dropdown-input:hover {\n  border-color: rgba(255, 255, 255, 0.2);\n  background-color: rgba(255, 255, 255, 0.07);\n  transform: translateY(-1px);\n}\n\n.dropdown-arrow {\n  transition: transform 0.3s ease;\n  color: rgba(255, 255, 255, 0.6);\n  font-size: 16px;\n  flex-shrink: 0;\n  margin-left: 8px;\n}\n\n.dropdown-arrow.rotated {\n  transform: rotate(180deg);\n}\n\n.dropdown-menu {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  width: 100%;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  overflow: hidden;\n  max-height: 200px;\n  overflow-y: auto;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);\n  backdrop-filter: blur(10px);\n  z-index: 10;\n  margin-top: 4px;\n}\n\n.dropdown-item {\n  padding: 12px 16px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.05);\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.dropdown-item:last-child {\n  border-bottom: none;\n}\n\n.dropdown-item:hover {\n  background: linear-gradient(135deg, rgba(102, 126, 234, 0.2), rgba(102, 126, 234, 0.1));\n  color: #a8b3ff;\n  transform: translateX(4px);\n}\n\n.dropdown-item.selected {\n  background: linear-gradient(135deg, rgba(102, 126, 234, 0.3), rgba(102, 126, 234, 0.2));\n  color: #a8b3ff;\n  font-weight: 500;\n}\n\n.dropdown-item.custom-input {\n  color: rgba(255, 255, 255, 0.6);\n  font-style: italic;\n  padding-left: 16px; /* Align with other items */\n}\n\n.dropdown-item.custom-input .custom-label {\n  color: rgba(255, 255, 255, 0.6);\n  margin-right: 4px;\n}\n\n/* Button container - reference screenshot styles */\n.button-container {\n  display: flex;\n  gap: 12px;\n  justify-content: flex-end;\n  margin-top: 0;\n  align-items: center;\n  padding: 16px 0;\n  min-height: 52px; /* Ensure container has fixed height, prevent jitter */\n  position: relative; /* Provide reference for absolutely positioned child elements */\n}\n\n.action-btn {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 10px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  color: #fff;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  font-size: 14px;\n}\n\n.action-btn:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.1);\n  border-color: rgba(255, 255, 255, 0.2);\n}\n\n.action-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.action-btn.primary {\n  background: rgba(102, 126, 234, 0.2);\n  border-color: rgba(102, 126, 234, 0.3);\n  color: #a8b3ff;\n}\n\n.action-btn.primary:hover:not(:disabled) {\n  background: rgba(102, 126, 234, 0.3);\n}\n\n.action-btn.danger {\n  background: rgba(234, 102, 102, 0.2);\n  border-color: rgba(234, 102, 102, 0.3);\n  color: #ff6b6b;\n}\n\n.action-btn.danger:hover:not(:disabled) {\n  background: rgba(234, 102, 102, 0.3);\n}\n\n.action-btn.danger:disabled {\n  background: rgba(234, 102, 102, 0.1);\n  border-color: rgba(234, 102, 102, 0.2);\n  color: rgba(255, 107, 107, 0.5);\n  cursor: not-allowed;\n}\n\n/* Read-only input styles */\n.readonly-input {\n  background: rgba(255, 255, 255, 0.03) !important;\n  color: rgba(255, 255, 255, 0.7) !important;\n  cursor: not-allowed !important;\n  opacity: 0.8;\n}\n\n.readonly-input::placeholder {\n  color: rgba(255, 255, 255, 0.4) !important;\n}\n\n/* Endpoint container layout */\n.endpoint-container {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  width: 100%;\n}\n\n.endpoint-row {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  width: 100%;\n}\n\n/* Custom dropdown styles - reference screenshot three */\n.custom-select {\n  position: relative;\n  display: inline-block;\n  width: 100%; /* Adjust to 100% to fit new layout */\n  flex-shrink: 0;\n}\n\n.select-input-container {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  background: rgba(20, 20, 25, 0.95);\n  border: 2px solid rgba(102, 126, 234, 0.6);\n  border-radius: 12px;\n  color: #667eea;\n  transition: all 0.3s ease;\n  font-size: 14px;\n  font-weight: 600;\n  outline: none;\n  width: 100%;\n  justify-content: space-between;\n  height: 44px;\n  box-sizing: border-box;\n  box-shadow: 0 0 0 1px rgba(102, 126, 234, 0.3);\n  padding: 0 12px;\n}\n\n.select-input-container:hover {\n  border-color: rgba(102, 126, 234, 0.8);\n  background-color: rgba(20, 20, 25, 0.98);\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.4);\n}\n\n.select-input-container:focus-within {\n  border-color: rgba(102, 126, 234, 0.9);\n  outline: none;\n  background-color: rgba(20, 20, 25, 0.98);\n  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.3);\n}\n\n.input-content {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex: 1;\n  min-width: 0;\n}\n\n.input-icon {\n  color: #667eea;\n  flex-shrink: 0;\n}\n\n.select-input {\n  flex: 1;\n  background: transparent;\n  border: none;\n  outline: none;\n  color: #667eea;\n  font-size: 14px;\n  font-weight: 600;\n  text-shadow: none;\n  display: flex;\n  align-items: center;\n  gap: 0;\n  min-width: 0;\n  height: 100%;\n}\n\n.select-input::placeholder {\n  color: rgba(255, 255, 255, 0.4);\n  font-style: italic;\n}\n\n.select-arrow-btn {\n  background: none;\n  border: none;\n  color: #667eea;\n  cursor: pointer;\n  padding: 8px;\n  border-radius: 6px;\n  transition: all 0.2s ease;\n  flex-shrink: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 32px;\n  height: 32px;\n}\n\n.select-arrow-btn:hover {\n  background: rgba(102, 126, 234, 0.1);\n  color: #667eea;\n}\n\n.chevron {\n  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  opacity: 0.9;\n  filter: none;\n  width: 16px;\n  height: 16px;\n}\n\n.select-dropdown {\n  position: absolute;\n  top: 100%;\n  z-index: 99999;\n  margin-top: 6px;\n  background: rgba(15, 15, 20, 0.98);\n  backdrop-filter: blur(20px);\n  border: 1px solid rgba(102, 126, 234, 0.3);\n  border-radius: 12px;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);\n  width: 280px; /* Keep consistent with select-btn width */\n  max-height: 280px;\n  overflow: hidden;\n  /* Ensure not occupying document flow */\n  pointer-events: auto;\n}\n\n.select-dropdown.dropdown-top {\n  top: auto;\n  bottom: 100%;\n  margin-top: 0;\n  margin-bottom: 4px;\n}\n\n.dropdown-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 14px 18px;\n  border-bottom: 1px solid rgba(102, 126, 234, 0.2);\n  font-size: 14px;\n  font-weight: 600;\n  color: #667eea;\n  background: rgba(102, 126, 234, 0.05);\n}\n\n.close-btn {\n  background: none;\n  border: none;\n  color: rgba(255, 255, 255, 0.6);\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 4px;\n  transition: all 0.2s ease;\n}\n\n.close-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.select-options {\n  padding: 12px 0;\n  max-height: 200px;\n  overflow-y: auto;\n}\n\n.select-option {\n  display: flex;\n  align-items: center;\n  gap: 0;\n  width: 100%;\n  padding: 12px 18px;\n  background: none;\n  border: none;\n  color: rgba(255, 255, 255, 0.9);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  text-align: left;\n  font-size: 14px;\n}\n\n.select-option:hover {\n  background: rgba(102, 126, 234, 0.1);\n  color: #667eea;\n}\n\n.select-option.active {\n  background: rgba(102, 126, 234, 0.2);\n  color: #667eea;\n  border-left: 3px solid #667eea;\n  padding-left: 15px;\n  font-weight: 500;\n}\n\n.select-option.custom-input {\n  color: rgba(255, 255, 255, 0.6);\n  font-style: italic;\n}\n\n.select-option.custom-input .custom-label {\n  color: rgba(255, 255, 255, 0.6);\n  margin-right: 4px;\n}\n\n.option-name {\n  flex: 1;\n  font-size: 14px;\n  font-weight: 500;\n}\n\n.check-icon {\n  color: #667eea;\n  opacity: 0.8;\n}\n\n/* Manual input area styles */\n.manual-input-section {\n  padding: 14px 18px;\n  border-top: 1px solid rgba(102, 126, 234, 0.2);\n  background: rgba(102, 126, 234, 0.03);\n}\n\n.manual-input-container {\n  display: flex;\n  gap: 8px;\n  align-items: center;\n  width: 100%;\n}\n\n.manual-input {\n  flex: 1;\n  padding: 8px 12px;\n  background: rgba(20, 20, 25, 0.8);\n  border: 1px solid rgba(102, 126, 234, 0.3);\n  border-radius: 8px;\n  color: #667eea;\n  font-size: 14px;\n  transition: all 0.3s ease;\n}\n\n.manual-input:focus {\n  border-color: rgba(102, 126, 234, 0.8);\n  outline: none;\n  background: rgba(20, 20, 25, 0.9);\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n}\n\n.manual-input::placeholder {\n  color: rgba(102, 126, 234, 0.5);\n}\n\n.add-manual-btn {\n  padding: 8px 12px;\n  background: rgba(102, 126, 234, 0.15);\n  border: 1px solid rgba(102, 126, 234, 0.3);\n  border-radius: 8px;\n  color: #667eea;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.add-manual-btn:hover {\n  background: rgba(102, 126, 234, 0.25);\n  border-color: rgba(102, 126, 234, 0.5);\n}\n\n/* Service publishing option styles */\n.service-publish-options {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.mcp-publish-option,\n.http-publish-option,\n.internal-toolcall-publish-option {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  padding: 16px;\n  background: rgba(255, 255, 255, 0.03);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n}\n\n/* .http-publish-option, .mcp-publish-option, .internal-toolcall-publish-option now use the same styles */\n\n.checkbox-label {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  cursor: pointer;\n  user-select: none;\n}\n\n.checkbox-input {\n  width: 16px;\n  height: 16px;\n  accent-color: #667eea;\n  cursor: pointer;\n}\n\n.checkbox-text {\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 14px;\n}\n\n.checkbox-description {\n  font-size: 12px;\n  color: rgba(255, 255, 255, 0.6);\n  line-height: 1.4;\n  margin-left: 24px;\n}\n\n/* HTTP service options now use the same styles as MCP service, no special handling needed */\n\n.endpoint-description {\n  font-size: 12px;\n  color: rgba(255, 255, 255, 0.6);\n  line-height: 1.4;\n  margin-bottom: 8px;\n}\n\n/* Two-column layout styles */\n.endpoint-url-row {\n  display: flex;\n  gap: 16px;\n  width: 100%;\n}\n\n.endpoint-url-row.single-item {\n  gap: 0;\n}\n\n.endpoint-url-row.single-item .endpoint-item {\n  flex: 0 0 50%; /* Maintain 50% width even when displayed alone */\n}\n\n.endpoint-item {\n  flex: 0 0 50%; /* Fixed width 50%, not responsive */\n  min-width: 0;\n}\n\n.url-item {\n  flex: 1;\n  min-width: 0;\n}\n\n/* URL display styles */\n.url-container {\n  width: 100%;\n}\n\n.url-display {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 12px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  color: #fff;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  min-height: 48px;\n}\n\n.url-display:hover {\n  background: rgba(255, 255, 255, 0.08);\n  border-color: rgba(255, 255, 255, 0.2);\n}\n\n.url-text {\n  flex: 1;\n  font-size: 14px;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  word-break: break-all;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.copy-icon {\n  color: rgba(255, 255, 255, 0.6);\n  margin-left: 8px;\n  flex-shrink: 0;\n  transition: all 0.3s ease;\n}\n\n.url-display:hover .copy-icon {\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.backdrop {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  z-index: 99998;\n  background: transparent;\n}\n\n.slideDown-enter-active,\n.slideDown-leave-active {\n  transition: all 0.2s ease;\n  transform-origin: top;\n}\n\n.slideDown-enter-from,\n.slideDown-leave-to {\n  opacity: 0;\n  transform: translateY(-8px) scale(0.95);\n}\n\n/* Old save button styles removed */\n\n.loading-icon {\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n/* Required field styles */\n.required {\n  color: #ff4d4f;\n  margin-left: 4px;\n}\n\n/* Error state styles */\n.form-item input.error,\n.form-item textarea.error {\n  border-color: #ff4d4f;\n  box-shadow: 0 0 0 2px rgba(255, 77, 79, 0.1);\n}\n\n.form-item input.error:focus,\n.form-item textarea.error:focus {\n  border-color: #ff4d4f;\n  box-shadow: 0 0 0 2px rgba(255, 77, 79, 0.2);\n}\n\n/* Tooltip messages */\n.error-toast,\n.success-toast {\n  position: fixed;\n  top: 20px;\n  right: 20px;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 12px 16px;\n  border-radius: 8px;\n  color: #fff;\n  cursor: pointer;\n  z-index: 10000; /* Ensure above modal */\n  animation: slideIn 0.3s ease;\n}\n\n.error-toast {\n  background: rgba(234, 102, 102, 0.9);\n  border: 1px solid rgba(234, 102, 102, 0.5);\n}\n\n.success-toast {\n  background: rgba(102, 234, 102, 0.9);\n  border: 1px solid rgba(102, 234, 102, 0.5);\n}\n\n@keyframes slideIn {\n  from {\n    transform: translateX(100%);\n    opacity: 0;\n  }\n  to {\n    transform: translateX(0);\n    opacity: 1;\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"config-section\">\n    <div class=\"section-header\">\n      <Icon icon=\"carbon:play\" width=\"16\" />\n      <span>{{ t('sidebar.executionController') }}</span>\n    </div>\n    <div class=\"execution-content\">\n      <!-- Parameter Requirements Display -->\n      <div class=\"params-requirements-group\">\n        <label>{{ t('sidebar.parameterRequirements') }}</label>\n        <div class=\"params-help-text\">\n          {{ t('sidebar.parameterRequirementsHelp') }}\n        </div>\n\n        <!-- Show parameter fields only if there are parameters -->\n        <div v-if=\"parameterRequirements.hasParameters\" class=\"parameter-fields\">\n          <div\n            v-for=\"param in parameterRequirements.parameters\"\n            :key=\"param\"\n            class=\"parameter-field\"\n          >\n            <label class=\"parameter-label\">\n              {{ param }}\n              <span class=\"required\">*</span>\n            </label>\n            <input\n              v-model=\"parameterValues[param]\"\n              class=\"parameter-input\"\n              :class=\"{ error: parameterErrors[param] }\"\n              :placeholder=\"t('sidebar.enterValueFor', { param })\"\n              @input=\"updateParameterValue(param, ($event.target as HTMLInputElement).value)\"\n              required\n            />\n            <div v-if=\"parameterErrors[param]\" class=\"parameter-error\">\n              {{ parameterErrors[param] }}\n            </div>\n          </div>\n        </div>\n\n        <!-- Validation status message -->\n        <div\n          v-if=\"\n            parameterRequirements.hasParameters &&\n            !canExecute &&\n            !props.isExecuting &&\n            !props.isGenerating\n          \"\n          class=\"validation-message\"\n        >\n          <Icon icon=\"carbon:warning\" width=\"14\" />\n          {{ t('sidebar.fillAllRequiredParameters') }}\n        </div>\n      </div>\n\n      <!-- File Upload Component -->\n      <FileUploadComponent\n        ref=\"fileUploadRef\"\n        :disabled=\"props.isExecuting || props.isGenerating\"\n        @files-uploaded=\"handleFilesUploaded\"\n        @files-removed=\"handleFilesRemoved\"\n        @upload-key-changed=\"handleUploadKeyChanged\"\n        @upload-started=\"handleUploadStarted\"\n        @upload-completed=\"handleUploadCompleted\"\n        @upload-error=\"handleUploadError\"\n      />\n\n      <button\n        class=\"btn btn-primary execute-btn\"\n        @click=\"handleExecutePlan\"\n        :disabled=\"!canExecute\"\n      >\n        <Icon\n          :icon=\"props.isExecuting ? 'carbon:circle-dash' : 'carbon:play'\"\n          width=\"16\"\n          :class=\"{ spinning: props.isExecuting }\"\n        />\n        {{ props.isExecuting ? t('sidebar.executing') : t('sidebar.executePlan') }}\n      </button>\n      <button\n        class=\"btn publish-mcp-btn\"\n        @click=\"handlePublishMcpService\"\n        :disabled=\"!currentPlanTemplateId\"\n        v-if=\"showPublishButton\"\n      >\n        <Icon icon=\"carbon:application\" width=\"16\" />\n        {{ buttonText }}\n      </button>\n\n      <!-- Internal Call wrapper - only show when enableInternalToolcall is true -->\n      <div v-if=\"toolInfo?.enableInternalToolcall\" class=\"call-example-wrapper\">\n        <div class=\"call-example-header\">\n          <h4 class=\"call-example-title\">{{ t('sidebar.internalCall') }}</h4>\n          <p class=\"call-example-description\">{{ t('sidebar.internalCallDescription') }}</p>\n        </div>\n        <div class=\"internal-call-wrapper\">\n          <div class=\"call-info\">\n            <div class=\"call-method\">{{ t('sidebar.internalMethodCall') }}</div>\n            <div class=\"call-endpoint\">\n              {{ t('sidebar.toolName') }}: {{ toolInfo?.toolName || currentPlanTemplateId }}\n            </div>\n            <div v-if=\"toolInfo?.serviceGroup\" class=\"call-endpoint\">\n              {{ t('sidebar.serviceGroup') }}: {{ toolInfo.serviceGroup }}\n            </div>\n            <div class=\"call-description\">{{ t('sidebar.internalCallUsage') }}</div>\n            <div class=\"call-example\">\n              <strong>{{ t('sidebar.usage') }}:</strong>\n              <pre class=\"example-code\">{{ t('sidebar.internalCallExample') }}</pre>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- HTTP API URLs wrapper with tabs - only show when enableHttpService is true -->\n      <div v-if=\"toolInfo?.enableHttpService\" class=\"call-example-wrapper\">\n        <div class=\"call-example-header\">\n          <h4 class=\"call-example-title\">{{ t('sidebar.httpCallExample') }}</h4>\n          <p class=\"call-example-description\">{{ t('sidebar.httpCallDescription') }}</p>\n        </div>\n        <div class=\"http-api-urls-wrapper\">\n          <div class=\"tab-container\">\n            <div class=\"tab-header\">\n              <button\n                v-for=\"tab in apiTabs\"\n                :key=\"tab.id\"\n                :class=\"['tab-button', { active: activeTab === tab.id }]\"\n                @click=\"activeTab = tab.id\"\n              >\n                {{ tab.label }}\n              </button>\n            </div>\n            <div class=\"tab-content\">\n              <div\n                v-for=\"tab in apiTabs\"\n                :key=\"tab.id\"\n                v-show=\"activeTab === tab.id\"\n                class=\"tab-panel\"\n              >\n                <div class=\"http-api-url-display\">\n                  <div class=\"api-method\">{{ tab.method }}</div>\n                  <div class=\"api-endpoint\">{{ tab.endpoint }}</div>\n                  <div class=\"api-description\">{{ tab.description }}</div>\n                  <div v-if=\"tab.example\" class=\"api-example\">\n                    <strong>{{ t('sidebar.example') }}:</strong>\n                    <pre class=\"example-code\">{{ tab.example }}</pre>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- MCP Call wrapper - only show when enableMcpService is true -->\n      <div v-if=\"toolInfo?.enableMcpService\" class=\"call-example-wrapper\">\n        <div class=\"call-example-header\">\n          <h4 class=\"call-example-title\">{{ t('sidebar.mcpCall') }}</h4>\n          <p class=\"call-example-description\">{{ t('sidebar.mcpCallDescription') }}</p>\n        </div>\n        <div class=\"mcp-call-wrapper\">\n          <div class=\"call-info\">\n            <div class=\"call-method\">{{ t('sidebar.mcpServiceCall') }}</div>\n            <div class=\"call-endpoint\">{{ t('sidebar.mcpEndpoint') }}: /mcp/execute</div>\n            <div class=\"call-description\">{{ t('sidebar.mcpCallUsage') }}</div>\n            <div class=\"call-example\">\n              <strong>{{ t('sidebar.usage') }}:</strong>\n              <pre class=\"example-code\">{{ t('sidebar.mcpCallExample') }}</pre>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport type { CoordinatorToolVO } from '@/api/coordinator-tool-api-service'\nimport { FileInfo } from '@/api/file-upload-api-service'\nimport {\n  PlanParameterApiService,\n  type ParameterRequirements,\n} from '@/api/plan-parameter-api-service'\nimport FileUploadComponent from '@/components/file-upload/FileUploadComponent.vue'\nimport type { PlanExecutionRequestPayload } from '@/types/plan-execution'\nimport { Icon } from '@iconify/vue'\nimport { computed, onMounted, ref, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\n\nconst { t } = useI18n()\n\n// Props\ninterface Props {\n  currentPlanTemplateId?: string\n  isExecuting?: boolean\n  isGenerating?: boolean\n  showPublishButton?: boolean\n  toolInfo?: CoordinatorToolVO\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  currentPlanTemplateId: '',\n  isExecuting: false,\n  isGenerating: false,\n  showPublishButton: true,\n  toolInfo: () => ({\n    toolName: '',\n    toolDescription: '',\n    planTemplateId: '',\n    inputSchema: '[]',\n    enableHttpService: false,\n    enableMcpService: false,\n    enableInternalToolcall: false,\n    serviceGroup: '',\n  }),\n})\n\n// Emits\nconst emit = defineEmits<{\n  executePlan: [payload: PlanExecutionRequestPayload]\n  publishMcpService: []\n  clearParams: []\n  updateExecutionParams: [params: string]\n}>()\n\n// Local state\nconst executionParams = ref('')\nconst parameterRequirements = ref<ParameterRequirements>({\n  parameters: [],\n  hasParameters: false,\n  requirements: '',\n})\nconst parameterValues = ref<Record<string, string>>({})\nconst isLoadingParameters = ref(false)\nconst activeTab = ref('get-sync')\nconst parameterErrors = ref<Record<string, string>>({})\nconst isValidationError = ref(false)\nconst isExecutingPlan = ref(false) // Flag to prevent parameter reload during execution\n\n// File upload state\nconst fileUploadRef = ref<InstanceType<typeof FileUploadComponent>>()\nconst uploadedFiles = ref<string[]>([])\nconst uploadKey = ref<string | null>(null)\n\n// API tabs configuration\nconst apiTabs = ref([\n  {\n    id: 'get-sync',\n    label: 'GET + Sync',\n    method: 'GET',\n    endpoint: '/api/executor/executeByToolNameSync/{toolName}',\n    description: 'Synchronous GET request - returns execution result immediately',\n    example: `GET /api/executor/executeByToolNameSync/my-tool?allParams={\"rawParam\":\"test\"}\nResponse: {\n  \"status\": \"completed\",\n  \"result\": \"Execution result here\"\n}`,\n  },\n  {\n    id: 'post-sync',\n    label: 'POST + Sync',\n    method: 'POST',\n    endpoint: '/api/executor/executeByToolNameSync',\n    description: 'Synchronous POST request - returns execution result immediately',\n    example: `POST /api/executor/executeByToolNameSync\nContent-Type: application/json\n\n{\n  \"toolName\": \"my-tool\",\n  \"replacementParams\": {\n    \"rawParam\": \"test\"\n  },\n  \"uploadedFiles\": []\n}\n\nResponse: {\n  \"status\": \"completed\",\n  \"result\": \"Execution result here\"\n}`,\n  },\n  {\n    id: 'post-async',\n    label: 'POST + Async',\n    method: 'POST',\n    endpoint: '/api/executor/executeByToolNameAsync',\n    description: 'Asynchronous POST request - returns task ID, check status separately',\n    example: `POST /api/executor/executeByToolNameAsync\nContent-Type: application/json\n\n{\n  \"toolName\": \"my-tool\",\n  \"replacementParams\": {\n    \"rawParam\": \"test\"\n  },\n  \"uploadedFiles\": []\n}\n\nResponse: {\n  \"planId\": \"plan-123\",\n  \"status\": \"processing\",\n  \"message\": \"Task submitted, processing\",\n  \"memoryId\": \"ABC12345\",\n  \"toolName\": \"my-tool\",\n  \"planTemplateId\": \"template-456\"\n}\n\n# Check execution status and get detailed results:\nGET /api/executor/details/{planId}\nResponse: {\n  \"currentPlanId\": \"plan-123\",\n  \"title\": \"Plan Title\",\n  \"status\": \"completed\",\n  \"summary\": \"Execution completed successfully\",\n  \"agentExecutionSequence\": [...],\n  \"userInputWaitState\": null,\n  \"structureResult\": {\n    \"message\": [\n      {\n        \"name\": \"Product A\",\n        \"price\": \"100\",\n        \"quantity\": \"5\"\n      }\n    ],\n    \"fileList\": [\n      {\n        \"fileName\": \"report.md\",\n        \"fileDescription\": \"Generated report with product information\"\n      }\n    ]\n  }\n}`,\n  },\n])\n\n// Computed properties\nconst isAnyServiceEnabled = computed(() => {\n  return (\n    props.toolInfo.enableInternalToolcall ??\n    props.toolInfo.enableHttpService ??\n    props.toolInfo.enableMcpService\n  )\n})\n\nconst buttonText = computed(() => {\n  return isAnyServiceEnabled.value\n    ? t('sidebar.updateServiceStatus')\n    : t('sidebar.publishMcpService')\n})\n\nconst canExecute = computed(() => {\n  if (props.isExecuting || props.isGenerating) {\n    return false\n  }\n\n  if (parameterRequirements.value.hasParameters) {\n    // Check if all required parameters are filled\n    return parameterRequirements.value.parameters.every(param => {\n      const value = parameterValues.value[param]\n      return typeof value === 'string' && value.trim() !== ''\n    })\n  }\n\n  return true\n})\n\n// File upload event handlers\nconst handleFilesUploaded = (files: FileInfo[], key: string | null) => {\n  uploadedFiles.value = files.map(file => file.originalName)\n  uploadKey.value = key\n  console.log('[ExecutionController] Files uploaded:', files.length, 'uploadKey:', key)\n}\n\nconst handleFilesRemoved = (files: FileInfo[]) => {\n  uploadedFiles.value = files.map(file => file.originalName)\n  console.log('[ExecutionController] Files removed, remaining:', files.length)\n}\n\nconst handleUploadKeyChanged = (key: string | null) => {\n  uploadKey.value = key\n  console.log('[ExecutionController] Upload key changed:', key)\n}\n\nconst handleUploadStarted = () => {\n  console.log('[ExecutionController] Upload started')\n}\n\nconst handleUploadCompleted = () => {\n  console.log('[ExecutionController] Upload completed')\n}\n\nconst handleUploadError = (error: any) => {\n  console.error('[ExecutionController] Upload error:', error)\n}\n\n// Methods\nconst handleExecutePlan = () => {\n  console.log('[ExecutionController]  Execute button clicked')\n\n  // Set execution flag to prevent parameter reload\n  isExecutingPlan.value = true\n  console.log('[ExecutionController]  Set isExecutingPlan to true')\n\n  // Validate parameters before execution\n  if (!validateParameters()) {\n    console.log('[ExecutionController]  Parameter validation failed:', parameterErrors.value)\n    isExecutingPlan.value = false // Reset flag on validation failure\n    return\n  }\n\n  // Pass replacement parameters if available\n  const replacementParams =\n    parameterRequirements.value.hasParameters && Object.keys(parameterValues.value).length > 0\n      ? parameterValues.value\n      : undefined\n\n  console.log('[ExecutionController]  Replacement params:', replacementParams)\n\n  const payload: PlanExecutionRequestPayload = {\n    title: '', // Will be set by the parent component\n    planData: {\n      title: '',\n      steps: [],\n      directResponse: false,\n    }, // Will be set by the parent component\n    params: undefined, // Will be set by the parent component\n    replacementParams,\n    uploadedFiles: uploadedFiles.value,\n    uploadKey: uploadKey.value,\n  }\n\n  console.log(\n    '[ExecutionController]  Emitting executePlan with payload:',\n    JSON.stringify(payload, null, 2)\n  )\n  emit('executePlan', payload)\n}\n\nconst handlePublishMcpService = () => {\n  emit('publishMcpService')\n}\n\nconst clearExecutionParams = () => {\n  console.log('[ExecutionController]  clearExecutionParams called')\n  executionParams.value = ''\n  // Clear parameter values as well\n  parameterValues.value = {}\n\n  // Reset execution flag after clearing\n  isExecutingPlan.value = false\n  console.log('[ExecutionController]  Reset isExecutingPlan to false')\n\n  console.log('[ExecutionController]  After clear - parameterValues cleared')\n  emit('clearParams')\n}\n\n// Load parameter requirements when plan template changes\nconst loadParameterRequirements = async () => {\n  console.log(\n    '[ExecutionController]  loadParameterRequirements called for templateId:',\n    props.currentPlanTemplateId\n  )\n  console.log(\n    '[ExecutionController]  Current parameterRequirements before load:',\n    JSON.stringify(parameterRequirements.value, null, 2)\n  )\n\n  if (!props.currentPlanTemplateId) {\n    console.log('[ExecutionController]  No template ID, resetting parameters')\n    parameterRequirements.value = {\n      parameters: [],\n      hasParameters: false,\n      requirements: '',\n    }\n    parameterValues.value = {}\n    return\n  }\n\n  // Clear previous data immediately to prevent stale data display\n  parameterRequirements.value = {\n    parameters: [],\n    hasParameters: false,\n    requirements: '',\n  }\n  parameterValues.value = {}\n  console.log('[ExecutionController]  Cleared previous data before loading new template')\n\n  isLoadingParameters.value = true\n  try {\n    console.log('[ExecutionController]  Fetching parameter requirements from API...')\n    const requirements = await PlanParameterApiService.getParameterRequirements(\n      props.currentPlanTemplateId\n    )\n    console.log(\n      '[ExecutionController]  Received requirements from API:',\n      JSON.stringify(requirements, null, 2)\n    )\n\n    parameterRequirements.value = requirements\n\n    // Initialize parameter values\n    const newValues: Record<string, string> = {}\n    requirements.parameters.forEach(param => {\n      newValues[param] = parameterValues.value[param] || ''\n    })\n    parameterValues.value = newValues\n\n    console.log(\n      '[ExecutionController]  Updated parameterRequirements:',\n      JSON.stringify(parameterRequirements.value, null, 2)\n    )\n    console.log(\n      '[ExecutionController]  Updated parameterValues:',\n      JSON.stringify(parameterValues.value, null, 2)\n    )\n\n    // Update execution params with current parameter values\n    updateExecutionParamsFromParameters()\n  } catch (error) {\n    console.error('[ExecutionController]  Failed to load parameter requirements:', error)\n    // Don't show error for 404 - template might not be ready yet\n    if (error instanceof Error && !error.message.includes('404')) {\n      console.warn(\n        '[ExecutionController]  Parameter requirements not available yet, will retry later'\n      )\n    }\n    parameterRequirements.value = {\n      parameters: [],\n      hasParameters: false,\n      requirements: '',\n    }\n    // Clear parameter values when there's an error to prevent stale data\n    parameterValues.value = {}\n    console.log(\n      '[ExecutionController]  Reset parameterRequirements due to error:',\n      JSON.stringify(parameterRequirements.value, null, 2)\n    )\n    console.log(\n      '[ExecutionController]  Cleared parameterValues:',\n      JSON.stringify(parameterValues.value, null, 2)\n    )\n  } finally {\n    isLoadingParameters.value = false\n    console.log('[ExecutionController]  loadParameterRequirements completed')\n  }\n}\n\n// Update parameter value and sync with execution params\nconst updateParameterValue = (paramName: string, value: string) => {\n  parameterValues.value[paramName] = value\n  // Clear error for this parameter when user starts typing\n  if (parameterErrors.value[paramName]) {\n    delete parameterErrors.value[paramName]\n  }\n  updateExecutionParamsFromParameters()\n}\n\n// Validate all parameters\nconst validateParameters = (): boolean => {\n  parameterErrors.value = {}\n  isValidationError.value = false\n\n  if (!parameterRequirements.value.hasParameters) {\n    return true\n  }\n\n  let hasErrors = false\n\n  parameterRequirements.value.parameters.forEach(param => {\n    const value = parameterValues.value[param] ? parameterValues.value[param].trim() : ''\n    if (!value) {\n      parameterErrors.value[param] = `${param} is required`\n      hasErrors = true\n    }\n  })\n\n  isValidationError.value = hasErrors\n  return !hasErrors\n}\n\n// Update execution params from parameter values\nconst updateExecutionParamsFromParameters = () => {\n  if (parameterRequirements.value.hasParameters) {\n    // Convert parameter values to JSON string for execution\n    executionParams.value = JSON.stringify(parameterValues.value, null, 2)\n  } else {\n    executionParams.value = ''\n  }\n  emit('updateExecutionParams', executionParams.value)\n}\n\n// Watch for changes in plan template ID\nwatch(\n  () => props.currentPlanTemplateId,\n  (newId, oldId) => {\n    if (newId && newId !== oldId) {\n      // Skip parameter reload if we're currently executing a plan\n      if (isExecutingPlan.value) {\n        console.log('[ExecutionController]  Skipping parameter reload - plan is executing')\n        return\n      }\n\n      console.log('[ExecutionController]  Template ID changed, will reload parameters')\n      // If this is a new template ID (not from initial load), retry loading parameters\n      if (oldId && newId.startsWith('planTemplate-')) {\n        console.log('[ExecutionController]  New template detected, retrying with delay...')\n        // Retry loading parameters with a delay for new templates\n        setTimeout(() => {\n          console.log('[ExecutionController]  Delay timeout, calling loadParameterRequirements')\n          loadParameterRequirements()\n        }, 1000)\n      } else {\n        console.log('[ExecutionController]  Immediate reload of parameters')\n        loadParameterRequirements()\n      }\n    }\n  }\n)\n\n// Watch for changes in execution params (for backward compatibility)\nwatch(\n  () => executionParams.value,\n  newValue => {\n    emit('updateExecutionParams', newValue)\n  }\n)\n\n// Load parameters on mount\nonMounted(() => {\n  loadParameterRequirements()\n})\n\n// Expose methods for parent component\ndefineExpose({\n  executionParams,\n  clearExecutionParams,\n  loadParameterRequirements,\n  fileUploadRef,\n  uploadedFiles,\n  uploadKey,\n})\n</script>\n\n<style scoped>\n.config-section {\n  margin-bottom: 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n  padding: 12px;\n}\n\n.section-header {\n  display: flex;\n  align-items: center;\n  margin-bottom: 12px;\n  color: #667eea;\n  font-size: 13px;\n  font-weight: 600;\n  gap: 8px;\n}\n\n.execution-content {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.params-requirements-group {\n  label {\n    display: block;\n    margin-bottom: 6px;\n    font-size: 12px;\n    color: rgba(255, 255, 255, 0.8);\n    font-weight: 500;\n  }\n\n  .params-help-text {\n    margin-bottom: 12px;\n    font-size: 11px;\n    color: rgba(255, 255, 255, 0.6);\n    line-height: 1.4;\n    padding: 6px 8px;\n    background: rgba(102, 126, 234, 0.1);\n    border: 1px solid rgba(102, 126, 234, 0.2);\n    border-radius: 4px;\n  }\n\n  .parameter-fields {\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n    margin-bottom: 12px;\n  }\n\n  .parameter-field {\n    display: flex;\n    flex-direction: column;\n    gap: 6px;\n\n    .parameter-label {\n      font-size: 11px;\n      color: rgba(255, 255, 255, 0.8);\n      font-weight: 500;\n      display: flex;\n      align-items: center;\n      gap: 4px;\n\n      .required {\n        color: #ff6b6b;\n        font-weight: bold;\n      }\n    }\n\n    .parameter-input {\n      width: 100%;\n      background: rgba(0, 0, 0, 0.3);\n      border: 1px solid rgba(255, 255, 255, 0.2);\n      border-radius: 6px;\n      color: white;\n      font-size: 12px;\n      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n      padding: 8px 12px;\n      min-height: 36px;\n\n      &:focus {\n        outline: none;\n        border-color: #667eea;\n        box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n      }\n\n      &::placeholder {\n        color: rgba(255, 255, 255, 0.4);\n      }\n\n      &.error {\n        border-color: #ff6b6b;\n        box-shadow: 0 0 0 2px rgba(255, 107, 107, 0.2);\n      }\n    }\n\n    .parameter-error {\n      color: #ff6b6b;\n      font-size: 11px;\n      margin-top: 4px;\n      display: block;\n      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n    }\n  }\n\n  .validation-message {\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    color: #ffa726;\n    font-size: 14px;\n    margin-top: 8px;\n    padding: 8px 12px;\n    background: rgba(255, 167, 38, 0.1);\n    border: 1px solid rgba(255, 167, 38, 0.3);\n    border-radius: 4px;\n    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  }\n}\n\n.call-example-wrapper {\n  margin-top: 12px;\n}\n\n.call-example-header {\n  margin-bottom: 12px;\n}\n\n.call-example-title {\n  color: #667eea;\n  font-size: 14px;\n  font-weight: 600;\n  margin: 0 0 6px 0;\n}\n\n.call-example-description {\n  color: rgba(255, 255, 255, 0.8);\n  font-size: 12px;\n  line-height: 1.4;\n  margin: 0;\n  padding: 8px 12px;\n  background: rgba(102, 126, 234, 0.1);\n  border: 1px solid rgba(102, 126, 234, 0.2);\n  border-radius: 6px;\n}\n\n.http-api-urls-wrapper {\n  margin-top: 0;\n}\n\n.internal-call-wrapper,\n.mcp-call-wrapper {\n  background: rgba(0, 0, 0, 0.2);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  padding: 12px;\n}\n\n.call-info {\n  font-size: 11px;\n\n  .call-method {\n    display: inline-block;\n    padding: 2px 6px;\n    background: #667eea;\n    color: white;\n    border-radius: 3px;\n    font-size: 10px;\n    font-weight: 600;\n    margin-bottom: 8px;\n  }\n\n  .call-endpoint {\n    color: #64b5f6;\n    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n    font-size: 12px;\n    margin-bottom: 8px;\n    word-break: break-all;\n    background: rgba(0, 0, 0, 0.3);\n    padding: 6px 8px;\n    border-radius: 4px;\n    border: 1px solid rgba(100, 181, 246, 0.2);\n  }\n\n  .call-description {\n    color: rgba(255, 255, 255, 0.8);\n    margin-bottom: 8px;\n    line-height: 1.4;\n  }\n\n  .call-example {\n    margin-top: 8px;\n\n    strong {\n      color: rgba(255, 255, 255, 0.9);\n      font-size: 10px;\n      display: block;\n      margin-bottom: 4px;\n    }\n\n    .example-code {\n      background: rgba(0, 0, 0, 0.4);\n      border: 1px solid rgba(255, 255, 255, 0.1);\n      border-radius: 4px;\n      padding: 8px;\n      color: #e0e0e0;\n      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n      font-size: 10px;\n      line-height: 1.3;\n      white-space: pre-wrap;\n      word-break: break-all;\n      overflow-x: auto;\n    }\n  }\n}\n\n.tab-container {\n  background: rgba(0, 0, 0, 0.2);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  overflow: hidden;\n}\n\n.tab-header {\n  display: flex;\n  background: rgba(0, 0, 0, 0.3);\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.tab-button {\n  flex: 1;\n  padding: 8px 12px;\n  background: transparent;\n  border: none;\n  color: rgba(255, 255, 255, 0.6);\n  font-size: 11px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border-right: 1px solid rgba(255, 255, 255, 0.1);\n\n  &:last-child {\n    border-right: none;\n  }\n\n  &:hover {\n    background: rgba(102, 126, 234, 0.1);\n    color: rgba(255, 255, 255, 0.8);\n  }\n\n  &.active {\n    background: rgba(102, 126, 234, 0.2);\n    color: #667eea;\n    font-weight: 600;\n  }\n}\n\n.tab-content {\n  padding: 0;\n}\n\n.tab-panel {\n  padding: 0;\n}\n\n.http-api-url-display {\n  padding: 12px;\n  font-size: 11px;\n\n  .api-method {\n    display: inline-block;\n    padding: 2px 6px;\n    background: #667eea;\n    color: white;\n    border-radius: 3px;\n    font-size: 10px;\n    font-weight: 600;\n    margin-bottom: 8px;\n  }\n\n  .api-endpoint {\n    color: #64b5f6;\n    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n    font-size: 12px;\n    margin-bottom: 8px;\n    word-break: break-all;\n    background: rgba(0, 0, 0, 0.3);\n    padding: 6px 8px;\n    border-radius: 4px;\n    border: 1px solid rgba(100, 181, 246, 0.2);\n  }\n\n  .api-description {\n    color: rgba(255, 255, 255, 0.8);\n    margin-bottom: 8px;\n    line-height: 1.4;\n  }\n\n  .api-example {\n    margin-top: 8px;\n\n    strong {\n      color: rgba(255, 255, 255, 0.9);\n      font-size: 10px;\n      display: block;\n      margin-bottom: 4px;\n    }\n\n    .example-code {\n      background: rgba(0, 0, 0, 0.4);\n      border: 1px solid rgba(255, 255, 255, 0.1);\n      border-radius: 4px;\n      padding: 8px;\n      color: #e0e0e0;\n      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n      font-size: 10px;\n      line-height: 1.3;\n      white-space: pre-wrap;\n      word-break: break-all;\n      overflow-x: auto;\n    }\n  }\n}\n\n.btn {\n  padding: 6px 12px;\n  border: none;\n  border-radius: 4px;\n  font-size: 12px;\n  font-weight: 500;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 6px;\n  transition: all 0.2s ease;\n\n  &.btn-primary {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n\n    &:hover:not(:disabled) {\n      transform: translateY(-1px);\n      box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);\n    }\n  }\n\n  &.publish-mcp-btn {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: #ffffff;\n    border: none;\n\n    &:hover:not(:disabled) {\n      transform: translateY(-2px);\n      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);\n    }\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n    transform: none !important;\n    box-shadow: none !important;\n  }\n\n  .spinning {\n    animation: spin 1s linear infinite;\n  }\n}\n\n.execute-btn,\n.publish-mcp-btn {\n  padding: 10px 16px;\n  font-size: 13px;\n  font-weight: 500;\n  width: 100%;\n  margin-bottom: 8px;\n}\n\n.publish-mcp-btn {\n  margin-bottom: 0;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n</style>\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { reactive, computed, watch, ref } from 'vue'\n// import { useI18n } from 'vue-i18n' // Currently unused\nimport type { StepData, DisplayPlanData } from '@/types/plan-execution'\n\nexport interface JsonEditorProps {\n  jsonContent: string\n  canRollback: boolean\n  canRestore: boolean\n  isGenerating: boolean\n  isExecuting: boolean\n  hiddenFields?: string[]\n  currentPlanTemplateId: string\n}\n\nexport interface JsonEditorEmits {\n  (e: 'rollback'): void\n  (e: 'restore'): void\n  (e: 'save'): void\n  (e: 'update:jsonContent', value: string): void\n}\n\n/**\n * Business logic for JsonEditor component\n */\nexport function useJsonEditor(props: JsonEditorProps, emit: JsonEditorEmits) {\n  // I18n\n  // const { t } = useI18n() // Currently unused\n  \n  // State\n  const showJsonPreview = ref(false)\n\n  // Reactive display data - Based on DynamicAgentExecutionPlan structure\n  const displayData = reactive<DisplayPlanData>({\n    title: '',\n    steps: [],\n    directResponse: false, // Always false for dynamic agent planning\n    planTemplateId: props.currentPlanTemplateId || '',\n    planType: 'dynamic_agent'\n  })\n\n  /**\n   * Parse JSON content into visual data\n   * Maps backend DynamicAgentExecutionPlan structure to frontend DisplayPlanData\n   */\n  const parseJsonToVisual = (jsonContent: string) => {\n    console.log('[JsonEditorLogic] parseJsonToVisual called with jsonContent:', jsonContent)\n    console.log('[JsonEditorLogic] parseJsonToVisual called with currentPlanTemplateId:', props.currentPlanTemplateId)\n    \n    try {\n      if (!jsonContent) {\n        console.log('[JsonEditorLogic] No jsonContent, resetting to default')\n        // Reset to default - matches DynamicAgentExecutionPlan structure\n        Object.assign(displayData, {\n          title: '',\n          steps: [],\n          directResponse: false,\n          planTemplateId: props.currentPlanTemplateId || '',\n          planType: 'dynamic_agent'\n        })\n        console.log('[JsonEditorLogic] Reset displayData to:', displayData)\n        return\n      }\n\n      const parsed = JSON.parse(jsonContent)\n      console.log('[JsonEditorLogic] Parsed JSON:', parsed)\n      \n      // Map basic fields from DynamicAgentExecutionPlan\n      displayData.title = parsed.title || ''\n      displayData.directResponse = false // Always false for dynamic agent planning\n      displayData.planTemplateId = parsed.planTemplateId || props.currentPlanTemplateId || ''\n      displayData.planType = parsed.planType || 'dynamic_agent'\n      \n      // Parse steps - maps ExecutionStep structure\n      displayData.steps = (parsed.steps || []).map((step: any) => ({\n        stepRequirement: step.stepRequirement || '',\n        agentName: step.agentName || '',\n        modelName: step.modelName || null, // Default to null if not specified\n        selectedToolKeys: step.selectedToolKeys || [],\n        terminateColumns: step.terminateColumns || ''\n      }))\n      \n      console.log('[JsonEditorLogic] Updated displayData to:', displayData)\n    } catch (error) {\n      console.warn('Failed to parse JSON content:', error)\n      // Reset to default when parsing fails to prevent stale data\n      Object.assign(displayData, {\n        title: '',\n        steps: [],\n        directResponse: false,\n        planTemplateId: props.currentPlanTemplateId || '',\n        planType: 'dynamic_agent'\n      })\n      console.log('[JsonEditorLogic] Error occurred, reset displayData to:', displayData)\n    }\n  }\n\n  /**\n   * Convert visual data back to JSON\n   * Maps frontend DisplayPlanData to backend DynamicAgentExecutionPlan structure\n   */\n  const convertVisualToJson = (): string => {\n    try {\n      const result: any = {\n        title: displayData.title,\n        steps: displayData.steps.map(step => ({\n          stepRequirement: step.stepRequirement,\n          agentName: step.agentName,\n          modelName: step.modelName ?? '', // Convert null to empty string for JSON\n          selectedToolKeys: step.selectedToolKeys,\n          terminateColumns: step.terminateColumns\n        })),\n        directResponse: displayData.directResponse,\n        planTemplateId: displayData.planTemplateId,\n        planType: displayData.planType\n      }\n      \n      return JSON.stringify(result, null, 2)\n    } catch (error) {\n      console.error('Failed to convert visual data to JSON:', error)\n      return '{}'\n    }\n  }\n\n  // Computed properties\n  const formattedJsonOutput = computed(() => convertVisualToJson())\n\n  // Watch for JSON content changes\n  watch(() => props.jsonContent, (newContent, oldContent) => {\n    console.log('[JsonEditorLogic] Watch triggered - jsonContent changed from', oldContent, 'to', newContent)\n    parseJsonToVisual(newContent)\n  }, { immediate: true })\n\n  // Watch for display data changes and emit updates\n  watch(displayData, () => {\n    const jsonOutput = convertVisualToJson()\n    emit('update:jsonContent', jsonOutput)\n  }, { deep: true })\n\n  // Watch for currentPlanTemplateId changes\n  watch(() => props.currentPlanTemplateId, (newId) => {\n    if (newId) {\n      displayData.planTemplateId = newId\n    }\n  })\n\n  // Step management functions\n  const addStep = () => {\n    const newStep: StepData = {\n      stepRequirement: '',\n      agentName: 'ConfigurableDynaAgent', // Default agent name\n      modelName: null, // Default to null (no model selected)\n      selectedToolKeys: [],\n      terminateColumns: '',\n      agentType: '',\n      stepContent: ''\n    }\n    displayData.steps.push(newStep)\n  }\n\n  const removeStep = (index: number) => {\n    if (index >= 0 && index < displayData.steps.length) {\n      displayData.steps.splice(index, 1)\n    }\n  }\n\n  const moveStepUp = (index: number) => {\n    if (index > 0) {\n      const step = displayData.steps.splice(index, 1)[0]\n      displayData.steps.splice(index - 1, 0, step)\n    }\n  }\n\n  const moveStepDown = (index: number) => {\n    if (index < displayData.steps.length - 1) {\n      const step = displayData.steps.splice(index, 1)[0]\n      displayData.steps.splice(index + 1, 0, step)\n    }\n  }\n\n  // JSON preview functions\n  const toggleJsonPreview = () => {\n    showJsonPreview.value = !showJsonPreview.value\n  }\n\n  const closeJsonPreview = () => {\n    showJsonPreview.value = false\n  }\n\n  // Action handlers\n  const handleRollback = () => {\n    emit('rollback')\n  }\n\n  const handleRestore = () => {\n    emit('restore')\n  }\n\n  const handleSave = () => {\n    emit('save')\n  }\n\n  return {\n    // State\n    showJsonPreview,\n    displayData,\n    formattedJsonOutput,\n    \n    // Step management\n    addStep,\n    removeStep,\n    moveStepUp,\n    moveStepDown,\n    \n    // JSON preview\n    toggleJsonPreview,\n    closeJsonPreview,\n    \n    // Actions\n    handleRollback,\n    handleRestore,\n    handleSave\n  }\n}\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by appl.form-select:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n}\n\n.form-select:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n\n.form-textarea {law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"config-section\">\n    <div class=\"section-header\">\n      <Icon icon=\"carbon:code\" width=\"16\" />\n      <span>{{ $t('sidebar.jsonTemplate') }}</span>\n    </div>\n    <!-- Visual JSON Editor -->\n    <div class=\"visual-editor\">\n      <!-- Plan Basic Info -->\n      <div class=\"plan-basic-info\">\n        <div class=\"form-row\">\n          <label class=\"form-label\">{{ $t('sidebar.title') }}</label>\n          <input\n            v-model=\"displayData.title\"\n            type=\"text\"\n            class=\"form-input\"\n            :placeholder=\"$t('sidebar.titlePlaceholder')\"\n          />\n        </div>\n      </div>\n\n      <!-- Steps Editor -->\n      <div class=\"steps-section\">\n        <div class=\"steps-header\">\n          <label class=\"form-label\">{{ $t('sidebar.tasks') }}</label>\n        </div>\n\n        <div class=\"steps-container\">\n          <div v-for=\"(step, index) in displayData.steps\" :key=\"index\" class=\"step-item\">\n            <div class=\"step-header\">\n              <span class=\"step-number\">{{ $t('sidebar.subtask') }} {{ index + 1 }}</span>\n              <div class=\"step-actions\">\n                <button\n                  @click=\"moveStepUp(index)\"\n                  :disabled=\"index === 0\"\n                  class=\"btn btn-xs\"\n                  :title=\"$t('sidebar.moveUp')\"\n                >\n                  <Icon icon=\"carbon:chevron-up\" width=\"12\" />\n                </button>\n                <button\n                  @click=\"moveStepDown(index)\"\n                  :disabled=\"index === displayData.steps.length - 1\"\n                  class=\"btn btn-xs\"\n                  :title=\"$t('sidebar.moveDown')\"\n                >\n                  <Icon icon=\"carbon:chevron-down\" width=\"12\" />\n                </button>\n                <button\n                  @click=\"removeStep(index)\"\n                  class=\"btn btn-xs btn-danger\"\n                  :title=\"$t('sidebar.removeStep')\"\n                >\n                  <Icon icon=\"carbon:trash-can\" width=\"12\" />\n                </button>\n              </div>\n            </div>\n\n            <div class=\"step-content\">\n              <!-- Agent Selection -->\n              <div class=\"form-row\">\n                <label class=\"form-label\">{{ $t('sidebar.agent') }}</label>\n                <div class=\"agent-selector\">\n                  <select v-model=\"step.agentName\" class=\"form-select agent-select\">\n                    <option value=\"\">{{ $t('sidebar.selectAgent') }}</option>\n                    <option value=\"DEFAULT_AGENT\">DEFAULT_AGENT</option>\n                    <option value=\"BROWSER_AGENT\">BROWSER_AGENT</option>\n                    <option value=\"TEXT_FILE_AGENT\">TEXT_FILE_AGENT</option>\n                    <option value=\"JSX_GENERATOR_AGENT\">JSX_GENERATOR_AGENT</option>\n                    <option value=\"FILE_MANAGER_AGENT\">FILE_MANAGER_AGENT</option>\n                  </select>\n\n                  <!-- Add step button -->\n                  <button\n                    @click=\"addStep\"\n                    class=\"btn btn-sm btn-add-step\"\n                    :title=\"$t('sidebar.addStep')\"\n                  >\n                    <Icon icon=\"carbon:add\" width=\"14\" />\n                  </button>\n                </div>\n              </div>\n\n              <!-- Step Requirement -->\n              <div class=\"form-row\">\n                <label class=\"form-label\">{{ $t('sidebar.stepRequirement') }}</label>\n                <textarea\n                  v-model=\"step.stepContent\"\n                  class=\"form-textarea auto-resize\"\n                  :placeholder=\"$t('sidebar.stepRequirementPlaceholder')\"\n                  rows=\"4\"\n                  @input=\"autoResizeTextarea($event)\"\n                ></textarea>\n              </div>\n\n              <!-- Terminate Columns -->\n              <div class=\"form-row\">\n                <label class=\"form-label\">{{ $t('sidebar.terminateColumns') }}</label>\n                <input\n                  v-model=\"step.terminateColumns\"\n                  type=\"text\"\n                  class=\"form-input\"\n                  :placeholder=\"$t('sidebar.terminateColumnsPlaceholder')\"\n                />\n              </div>\n            </div>\n          </div>\n\n          <!-- Empty State -->\n          <div v-if=\"displayData.steps.length === 0\" class=\"empty-steps\">\n            <Icon icon=\"carbon:add-alt\" width=\"32\" class=\"empty-icon\" />\n            <p>{{ $t('sidebar.noSteps') }}</p>\n            <button @click=\"addStep\" class=\"btn btn-primary\">\n              <Icon icon=\"carbon:add\" width=\"14\" />\n              {{ $t('sidebar.addFirstStep') }}\n            </button>\n          </div>\n        </div>\n      </div>\n\n      <!-- Plan ID Section -->\n      <div class=\"plan-id-section\">\n        <div class=\"form-row\">\n          <label class=\"form-label\">{{ $t('sidebar.planId') }}</label>\n          <input\n            v-model=\"displayData.planTemplateId\"\n            type=\"text\"\n            class=\"form-input\"\n            placeholder=\"planTemplate-1756109892045\"\n          />\n        </div>\n      </div>\n\n      <!-- JSON Preview (Optional) -->\n      <div class=\"json-preview\" v-if=\"showJsonPreview\">\n        <div class=\"preview-header\">\n          <label class=\"form-label\">{{ $t('sidebar.jsonPreview') }}</label>\n          <button @click=\"closeJsonPreview\" class=\"btn btn-xs\">\n            <Icon icon=\"carbon:close\" width=\"12\" />\n          </button>\n        </div>\n        <pre class=\"json-code\">{{ formattedJsonOutput }}</pre>\n      </div>\n\n      <!-- Toggle JSON Preview -->\n      <div class=\"editor-footer\">\n        <button @click=\"toggleJsonPreview\" class=\"btn btn-sm btn-secondary\">\n          <Icon icon=\"carbon:code\" width=\"14\" />\n          {{ showJsonPreview ? $t('sidebar.hideJson') : $t('sidebar.showJson') }}\n        </button>\n        <div class=\"section-actions\">\n          <button\n            class=\"btn btn-sm\"\n            @click=\"handleRollback\"\n            :disabled=\"!(canRollback ?? false)\"\n            :title=\"$t('sidebar.rollback')\"\n          >\n            <Icon icon=\"carbon:undo\" width=\"14\" />\n          </button>\n          <button\n            class=\"btn btn-sm\"\n            @click=\"handleRestore\"\n            :disabled=\"!(canRestore ?? false)\"\n            :title=\"$t('sidebar.restore')\"\n          >\n            <Icon icon=\"carbon:redo\" width=\"14\" />\n          </button>\n          <button\n            class=\"btn btn-primary\"\n            @click=\"handleSave\"\n            :disabled=\"isGenerating || isExecuting\"\n          >\n            <Icon icon=\"carbon:save\" width=\"14\" />\n            Save\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { Icon } from '@iconify/vue'\nimport { useJsonEditor, type JsonEditorProps } from './json-editor-logic'\n\n// Props\n// eslint-disable-next-line vue/no-unused-properties\nconst props = withDefaults(defineProps<JsonEditorProps>(), {\n  currentPlanTemplateId: '',\n  hiddenFields: () => [],\n})\n\n// Emits\nconst emit = defineEmits<{\n  rollback: []\n  restore: []\n  save: []\n  'update:jsonContent': [value: string]\n}>()\n\nconst {\n  showJsonPreview,\n  displayData,\n  formattedJsonOutput,\n  addStep,\n  removeStep,\n  moveStepUp,\n  moveStepDown,\n  handleRollback,\n  handleRestore,\n  handleSave,\n  toggleJsonPreview,\n  closeJsonPreview,\n} = useJsonEditor(props, emit)\n\nconst autoResizeTextarea = (event: Event) => {\n  const textarea = event.target as HTMLTextAreaElement\n\n  textarea.style.height = 'auto'\n\n  const lineHeight = 20\n  const lines = Math.ceil(textarea.scrollHeight / lineHeight)\n\n  const minRows = 4\n  const maxRows = 12\n  const targetRows = Math.max(minRows, Math.min(maxRows, lines))\n\n  const newHeight = targetRows * lineHeight\n  textarea.style.height = `${newHeight}px`\n  textarea.rows = targetRows\n\n  if (lines > maxRows) {\n    textarea.style.overflowY = 'auto'\n  } else {\n    textarea.style.overflowY = 'hidden'\n  }\n}\n</script>\n\n<style scoped>\n.config-section {\n  margin-bottom: 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n  padding: 12px;\n}\n\n.section-header {\n  display: flex;\n  align-items: center;\n  margin-bottom: 12px;\n  color: #667eea;\n  font-size: 13px;\n  font-weight: 600;\n  gap: 8px;\n}\n\n.section-actions {\n  margin-left: auto;\n  display: flex;\n  gap: 6px;\n}\n\n/* Visual Editor Styles */\n.visual-editor {\n  background: rgba(0, 0, 0, 0.2);\n  border-radius: 8px;\n  padding: 16px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.plan-basic-info {\n  margin-bottom: 20px;\n  padding-bottom: 16px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.form-row {\n  margin-bottom: 12px;\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.form-label {\n  font-size: 10px;\n  font-weight: 600;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.form-input,\n.form-select,\n.form-textarea {\n  padding: 8px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(0, 0, 0, 0.3);\n  color: white;\n  font-size: 11px;\n  font-family: inherit;\n  transition: all 0.2s ease;\n}\n\n.form-input:focus,\n.form-select:focus,\n.form-textarea:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n}\n\n.form-textarea {\n  resize: vertical;\n  min-height: 80px;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  line-height: 1.4;\n}\n\n.form-textarea.auto-resize {\n  resize: none;\n  transition: height 0.2s ease;\n  overflow-y: auto;\n  max-height: 240px;\n}\n\n.checkbox-wrapper {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  cursor: pointer;\n}\n\n.form-checkbox {\n  width: 16px;\n  height: 16px;\n  accent-color: #667eea;\n}\n\n.checkbox-label {\n  font-size: 11px;\n  color: rgba(255, 255, 255, 0.8);\n}\n\n/* Steps Section */\n.steps-section {\n  margin-bottom: 20px;\n}\n\n/* Plan ID Section */\n.plan-id-section {\n  margin-bottom: 20px;\n  padding-bottom: 16px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.steps-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 16px;\n}\n\n.steps-actions {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.agent-count-badge {\n  font-size: 10px;\n  color: rgba(255, 255, 255, 0.6);\n  background: rgba(255, 255, 255, 0.1);\n  padding: 2px 6px;\n  border-radius: 4px;\n}\n\n.error-badge {\n  font-size: 10px;\n  color: #ef4444;\n  background: rgba(239, 68, 68, 0.1);\n  padding: 2px 6px;\n  border-radius: 4px;\n  border: 1px solid rgba(239, 68, 68, 0.2);\n  display: flex;\n  align-items: center;\n  gap: 2px;\n}\n\n.error-message {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  font-size: 10px;\n  color: #ef4444;\n  margin-top: 4px;\n  padding: 4px 8px;\n  background: rgba(239, 68, 68, 0.1);\n  border-radius: 4px;\n  border: 1px solid rgba(239, 68, 68, 0.2);\n}\n\n.steps-container {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.step-item {\n  background: rgba(0, 0, 0, 0.3);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  overflow: hidden;\n}\n\n.step-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 9px 16px;\n  background: rgba(102, 126, 234, 0.1);\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.step-number {\n  font-weight: 600;\n  color: #667eea;\n  font-size: 11px;\n  min-width: 20px;\n}\n\n.step-actions {\n  display: flex;\n  gap: 4px;\n}\n\n.step-content {\n  padding: 16px;\n}\n\n.agent-selector {\n  display: flex;\n  gap: 8px;\n  align-items: center;\n}\n\n.agent-select {\n  flex: 1;\n}\n\n.btn-add-step {\n  padding: 6px 8px;\n  min-width: auto;\n}\n\n/* Empty State */\n.empty-steps {\n  text-align: center;\n  padding: 40px 20px;\n  color: rgba(255, 255, 255, 0.6);\n}\n\n.empty-icon {\n  color: rgba(255, 255, 255, 0.3);\n  margin-bottom: 12px;\n}\n\n/* JSON Preview */\n.json-preview {\n  margin-bottom: 16px;\n  background: rgba(0, 0, 0, 0.4);\n  border-radius: 6px;\n  overflow: hidden;\n}\n\n.preview-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 8px 12px;\n  background: rgba(255, 255, 255, 0.05);\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.json-code {\n  padding: 12px;\n  margin: 0;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  font-size: 10px;\n  color: rgba(255, 255, 255, 0.8);\n  background: transparent;\n  overflow-x: auto;\n  white-space: pre-wrap;\n  word-break: break-word;\n}\n\n.editor-footer {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding-top: 12px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n/* Button Styles */\n.btn {\n  padding: 6px 12px;\n  border: none;\n  border-radius: 4px;\n  font-size: 12px;\n  font-weight: 500;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 6px;\n  transition: all 0.2s ease;\n  background: rgba(255, 255, 255, 0.1);\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.btn:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.2);\n  color: white;\n  transform: translateY(-1px);\n}\n\n.btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n  transform: none !important;\n  box-shadow: none !important;\n}\n\n.btn-sm {\n  padding: 4px 8px;\n  font-size: 11px;\n}\n\n.btn-xs {\n  padding: 2px 4px;\n  font-size: 10px;\n  min-width: auto;\n}\n\n.btn-primary {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: white;\n}\n\n.btn-primary:hover:not(:disabled) {\n  background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);\n  box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);\n}\n\n.btn-secondary {\n  background: rgba(255, 255, 255, 0.05);\n  color: rgba(255, 255, 255, 0.7);\n}\n\n.btn-add {\n  background: linear-gradient(135deg, #10b981 0%, #059669 100%);\n  color: white;\n}\n\n.btn-add:hover:not(:disabled) {\n  background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);\n  box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);\n}\n\n.btn-danger {\n  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);\n  color: white;\n}\n\n.btn-danger:hover:not(:disabled) {\n  background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);\n  box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);\n}\n\n/* Legacy styles for compatibility */\n.json-editor {\n  width: 100%;\n  background: rgba(0, 0, 0, 0.3);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  color: white;\n  font-size: 11px;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  padding: 8px;\n  resize: vertical;\n  min-height: 200px;\n  line-height: 1.5;\n  white-space: pre-wrap;\n  overflow-wrap: break-word;\n  word-break: break-word;\n  tab-size: 2;\n  font-variant-ligatures: none;\n}\n\n.json-editor:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n}\n\n.json-editor::placeholder {\n  color: rgba(255, 255, 255, 0.4);\n}\n</style>\n","'use strict';\n\nexport default function bind(fn, thisArg) {\n  return function wrap() {\n    return fn.apply(thisArg, arguments);\n  };\n}\n","'use strict';\n\nimport bind from './helpers/bind.js';\n\n// utils is a library of generic helper functions non-specific to axios\n\nconst {toString} = Object.prototype;\nconst {getPrototypeOf} = Object;\nconst {iterator, toStringTag} = Symbol;\n\nconst kindOf = (cache => thing => {\n    const str = toString.call(thing);\n    return cache[str] || (cache[str] = str.slice(8, -1).toLowerCase());\n})(Object.create(null));\n\nconst kindOfTest = (type) => {\n  type = type.toLowerCase();\n  return (thing) => kindOf(thing) === type\n}\n\nconst typeOfTest = type => thing => typeof thing === type;\n\n/**\n * Determine if a value is an Array\n *\n * @param {Object} val The value to test\n *\n * @returns {boolean} True if value is an Array, otherwise false\n */\nconst {isArray} = Array;\n\n/**\n * Determine if a value is undefined\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if the value is undefined, otherwise false\n */\nconst isUndefined = typeOfTest('undefined');\n\n/**\n * Determine if a value is a Buffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Buffer, otherwise false\n */\nfunction isBuffer(val) {\n  return val !== null && !isUndefined(val) && val.constructor !== null && !isUndefined(val.constructor)\n    && isFunction(val.constructor.isBuffer) && val.constructor.isBuffer(val);\n}\n\n/**\n * Determine if a value is an ArrayBuffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is an ArrayBuffer, otherwise false\n */\nconst isArrayBuffer = kindOfTest('ArrayBuffer');\n\n\n/**\n * Determine if a value is a view on an ArrayBuffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a view on an ArrayBuffer, otherwise false\n */\nfunction isArrayBufferView(val) {\n  let result;\n  if ((typeof ArrayBuffer !== 'undefined') && (ArrayBuffer.isView)) {\n    result = ArrayBuffer.isView(val);\n  } else {\n    result = (val) && (val.buffer) && (isArrayBuffer(val.buffer));\n  }\n  return result;\n}\n\n/**\n * Determine if a value is a String\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a String, otherwise false\n */\nconst isString = typeOfTest('string');\n\n/**\n * Determine if a value is a Function\n *\n * @param {*} val The value to test\n * @returns {boolean} True if value is a Function, otherwise false\n */\nconst isFunction = typeOfTest('function');\n\n/**\n * Determine if a value is a Number\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Number, otherwise false\n */\nconst isNumber = typeOfTest('number');\n\n/**\n * Determine if a value is an Object\n *\n * @param {*} thing The value to test\n *\n * @returns {boolean} True if value is an Object, otherwise false\n */\nconst isObject = (thing) => thing !== null && typeof thing === 'object';\n\n/**\n * Determine if a value is a Boolean\n *\n * @param {*} thing The value to test\n * @returns {boolean} True if value is a Boolean, otherwise false\n */\nconst isBoolean = thing => thing === true || thing === false;\n\n/**\n * Determine if a value is a plain Object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a plain Object, otherwise false\n */\nconst isPlainObject = (val) => {\n  if (kindOf(val) !== 'object') {\n    return false;\n  }\n\n  const prototype = getPrototypeOf(val);\n  return (prototype === null || prototype === Object.prototype || Object.getPrototypeOf(prototype) === null) && !(toStringTag in val) && !(iterator in val);\n}\n\n/**\n * Determine if a value is a Date\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Date, otherwise false\n */\nconst isDate = kindOfTest('Date');\n\n/**\n * Determine if a value is a File\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a File, otherwise false\n */\nconst isFile = kindOfTest('File');\n\n/**\n * Determine if a value is a Blob\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Blob, otherwise false\n */\nconst isBlob = kindOfTest('Blob');\n\n/**\n * Determine if a value is a FileList\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a File, otherwise false\n */\nconst isFileList = kindOfTest('FileList');\n\n/**\n * Determine if a value is a Stream\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Stream, otherwise false\n */\nconst isStream = (val) => isObject(val) && isFunction(val.pipe);\n\n/**\n * Determine if a value is a FormData\n *\n * @param {*} thing The value to test\n *\n * @returns {boolean} True if value is an FormData, otherwise false\n */\nconst isFormData = (thing) => {\n  let kind;\n  return thing && (\n    (typeof FormData === 'function' && thing instanceof FormData) || (\n      isFunction(thing.append) && (\n        (kind = kindOf(thing)) === 'formdata' ||\n        // detect form-data instance\n        (kind === 'object' && isFunction(thing.toString) && thing.toString() === '[object FormData]')\n      )\n    )\n  )\n}\n\n/**\n * Determine if a value is a URLSearchParams object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a URLSearchParams object, otherwise false\n */\nconst isURLSearchParams = kindOfTest('URLSearchParams');\n\nconst [isReadableStream, isRequest, isResponse, isHeaders] = ['ReadableStream', 'Request', 'Response', 'Headers'].map(kindOfTest);\n\n/**\n * Trim excess whitespace off the beginning and end of a string\n *\n * @param {String} str The String to trim\n *\n * @returns {String} The String freed of excess whitespace\n */\nconst trim = (str) => str.trim ?\n  str.trim() : str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n\n/**\n * Iterate over an Array or an Object invoking a function for each item.\n *\n * If `obj` is an Array callback will be called passing\n * the value, index, and complete array for each item.\n *\n * If 'obj' is an Object callback will be called passing\n * the value, key, and complete object for each property.\n *\n * @param {Object|Array} obj The object to iterate\n * @param {Function} fn The callback to invoke for each item\n *\n * @param {Boolean} [allOwnKeys = false]\n * @returns {any}\n */\nfunction forEach(obj, fn, {allOwnKeys = false} = {}) {\n  // Don't bother if no value provided\n  if (obj === null || typeof obj === 'undefined') {\n    return;\n  }\n\n  let i;\n  let l;\n\n  // Force an array if not already something iterable\n  if (typeof obj !== 'object') {\n    /*eslint no-param-reassign:0*/\n    obj = [obj];\n  }\n\n  if (isArray(obj)) {\n    // Iterate over array values\n    for (i = 0, l = obj.length; i < l; i++) {\n      fn.call(null, obj[i], i, obj);\n    }\n  } else {\n    // Iterate over object keys\n    const keys = allOwnKeys ? Object.getOwnPropertyNames(obj) : Object.keys(obj);\n    const len = keys.length;\n    let key;\n\n    for (i = 0; i < len; i++) {\n      key = keys[i];\n      fn.call(null, obj[key], key, obj);\n    }\n  }\n}\n\nfunction findKey(obj, key) {\n  key = key.toLowerCase();\n  const keys = Object.keys(obj);\n  let i = keys.length;\n  let _key;\n  while (i-- > 0) {\n    _key = keys[i];\n    if (key === _key.toLowerCase()) {\n      return _key;\n    }\n  }\n  return null;\n}\n\nconst _global = (() => {\n  /*eslint no-undef:0*/\n  if (typeof globalThis !== \"undefined\") return globalThis;\n  return typeof self !== \"undefined\" ? self : (typeof window !== 'undefined' ? window : global)\n})();\n\nconst isContextDefined = (context) => !isUndefined(context) && context !== _global;\n\n/**\n * Accepts varargs expecting each argument to be an object, then\n * immutably merges the properties of each object and returns result.\n *\n * When multiple objects contain the same key the later object in\n * the arguments list will take precedence.\n *\n * Example:\n *\n * ```js\n * var result = merge({foo: 123}, {foo: 456});\n * console.log(result.foo); // outputs 456\n * ```\n *\n * @param {Object} obj1 Object to merge\n *\n * @returns {Object} Result of all merge properties\n */\nfunction merge(/* obj1, obj2, obj3, ... */) {\n  const {caseless} = isContextDefined(this) && this || {};\n  const result = {};\n  const assignValue = (val, key) => {\n    const targetKey = caseless && findKey(result, key) || key;\n    if (isPlainObject(result[targetKey]) && isPlainObject(val)) {\n      result[targetKey] = merge(result[targetKey], val);\n    } else if (isPlainObject(val)) {\n      result[targetKey] = merge({}, val);\n    } else if (isArray(val)) {\n      result[targetKey] = val.slice();\n    } else {\n      result[targetKey] = val;\n    }\n  }\n\n  for (let i = 0, l = arguments.length; i < l; i++) {\n    arguments[i] && forEach(arguments[i], assignValue);\n  }\n  return result;\n}\n\n/**\n * Extends object a by mutably adding to it the properties of object b.\n *\n * @param {Object} a The object to be extended\n * @param {Object} b The object to copy properties from\n * @param {Object} thisArg The object to bind function to\n *\n * @param {Boolean} [allOwnKeys]\n * @returns {Object} The resulting value of object a\n */\nconst extend = (a, b, thisArg, {allOwnKeys}= {}) => {\n  forEach(b, (val, key) => {\n    if (thisArg && isFunction(val)) {\n      a[key] = bind(val, thisArg);\n    } else {\n      a[key] = val;\n    }\n  }, {allOwnKeys});\n  return a;\n}\n\n/**\n * Remove byte order marker. This catches EF BB BF (the UTF-8 BOM)\n *\n * @param {string} content with BOM\n *\n * @returns {string} content value without BOM\n */\nconst stripBOM = (content) => {\n  if (content.charCodeAt(0) === 0xFEFF) {\n    content = content.slice(1);\n  }\n  return content;\n}\n\n/**\n * Inherit the prototype methods from one constructor into another\n * @param {function} constructor\n * @param {function} superConstructor\n * @param {object} [props]\n * @param {object} [descriptors]\n *\n * @returns {void}\n */\nconst inherits = (constructor, superConstructor, props, descriptors) => {\n  constructor.prototype = Object.create(superConstructor.prototype, descriptors);\n  constructor.prototype.constructor = constructor;\n  Object.defineProperty(constructor, 'super', {\n    value: superConstructor.prototype\n  });\n  props && Object.assign(constructor.prototype, props);\n}\n\n/**\n * Resolve object with deep prototype chain to a flat object\n * @param {Object} sourceObj source object\n * @param {Object} [destObj]\n * @param {Function|Boolean} [filter]\n * @param {Function} [propFilter]\n *\n * @returns {Object}\n */\nconst toFlatObject = (sourceObj, destObj, filter, propFilter) => {\n  let props;\n  let i;\n  let prop;\n  const merged = {};\n\n  destObj = destObj || {};\n  // eslint-disable-next-line no-eq-null,eqeqeq\n  if (sourceObj == null) return destObj;\n\n  do {\n    props = Object.getOwnPropertyNames(sourceObj);\n    i = props.length;\n    while (i-- > 0) {\n      prop = props[i];\n      if ((!propFilter || propFilter(prop, sourceObj, destObj)) && !merged[prop]) {\n        destObj[prop] = sourceObj[prop];\n        merged[prop] = true;\n      }\n    }\n    sourceObj = filter !== false && getPrototypeOf(sourceObj);\n  } while (sourceObj && (!filter || filter(sourceObj, destObj)) && sourceObj !== Object.prototype);\n\n  return destObj;\n}\n\n/**\n * Determines whether a string ends with the characters of a specified string\n *\n * @param {String} str\n * @param {String} searchString\n * @param {Number} [position= 0]\n *\n * @returns {boolean}\n */\nconst endsWith = (str, searchString, position) => {\n  str = String(str);\n  if (position === undefined || position > str.length) {\n    position = str.length;\n  }\n  position -= searchString.length;\n  const lastIndex = str.indexOf(searchString, position);\n  return lastIndex !== -1 && lastIndex === position;\n}\n\n\n/**\n * Returns new array from array like object or null if failed\n *\n * @param {*} [thing]\n *\n * @returns {?Array}\n */\nconst toArray = (thing) => {\n  if (!thing) return null;\n  if (isArray(thing)) return thing;\n  let i = thing.length;\n  if (!isNumber(i)) return null;\n  const arr = new Array(i);\n  while (i-- > 0) {\n    arr[i] = thing[i];\n  }\n  return arr;\n}\n\n/**\n * Checking if the Uint8Array exists and if it does, it returns a function that checks if the\n * thing passed in is an instance of Uint8Array\n *\n * @param {TypedArray}\n *\n * @returns {Array}\n */\n// eslint-disable-next-line func-names\nconst isTypedArray = (TypedArray => {\n  // eslint-disable-next-line func-names\n  return thing => {\n    return TypedArray && thing instanceof TypedArray;\n  };\n})(typeof Uint8Array !== 'undefined' && getPrototypeOf(Uint8Array));\n\n/**\n * For each entry in the object, call the function with the key and value.\n *\n * @param {Object<any, any>} obj - The object to iterate over.\n * @param {Function} fn - The function to call for each entry.\n *\n * @returns {void}\n */\nconst forEachEntry = (obj, fn) => {\n  const generator = obj && obj[iterator];\n\n  const _iterator = generator.call(obj);\n\n  let result;\n\n  while ((result = _iterator.next()) && !result.done) {\n    const pair = result.value;\n    fn.call(obj, pair[0], pair[1]);\n  }\n}\n\n/**\n * It takes a regular expression and a string, and returns an array of all the matches\n *\n * @param {string} regExp - The regular expression to match against.\n * @param {string} str - The string to search.\n *\n * @returns {Array<boolean>}\n */\nconst matchAll = (regExp, str) => {\n  let matches;\n  const arr = [];\n\n  while ((matches = regExp.exec(str)) !== null) {\n    arr.push(matches);\n  }\n\n  return arr;\n}\n\n/* Checking if the kindOfTest function returns true when passed an HTMLFormElement. */\nconst isHTMLForm = kindOfTest('HTMLFormElement');\n\nconst toCamelCase = str => {\n  return str.toLowerCase().replace(/[-_\\s]([a-z\\d])(\\w*)/g,\n    function replacer(m, p1, p2) {\n      return p1.toUpperCase() + p2;\n    }\n  );\n};\n\n/* Creating a function that will check if an object has a property. */\nconst hasOwnProperty = (({hasOwnProperty}) => (obj, prop) => hasOwnProperty.call(obj, prop))(Object.prototype);\n\n/**\n * Determine if a value is a RegExp object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a RegExp object, otherwise false\n */\nconst isRegExp = kindOfTest('RegExp');\n\nconst reduceDescriptors = (obj, reducer) => {\n  const descriptors = Object.getOwnPropertyDescriptors(obj);\n  const reducedDescriptors = {};\n\n  forEach(descriptors, (descriptor, name) => {\n    let ret;\n    if ((ret = reducer(descriptor, name, obj)) !== false) {\n      reducedDescriptors[name] = ret || descriptor;\n    }\n  });\n\n  Object.defineProperties(obj, reducedDescriptors);\n}\n\n/**\n * Makes all methods read-only\n * @param {Object} obj\n */\n\nconst freezeMethods = (obj) => {\n  reduceDescriptors(obj, (descriptor, name) => {\n    // skip restricted props in strict mode\n    if (isFunction(obj) && ['arguments', 'caller', 'callee'].indexOf(name) !== -1) {\n      return false;\n    }\n\n    const value = obj[name];\n\n    if (!isFunction(value)) return;\n\n    descriptor.enumerable = false;\n\n    if ('writable' in descriptor) {\n      descriptor.writable = false;\n      return;\n    }\n\n    if (!descriptor.set) {\n      descriptor.set = () => {\n        throw Error('Can not rewrite read-only method \\'' + name + '\\'');\n      };\n    }\n  });\n}\n\nconst toObjectSet = (arrayOrString, delimiter) => {\n  const obj = {};\n\n  const define = (arr) => {\n    arr.forEach(value => {\n      obj[value] = true;\n    });\n  }\n\n  isArray(arrayOrString) ? define(arrayOrString) : define(String(arrayOrString).split(delimiter));\n\n  return obj;\n}\n\nconst noop = () => {}\n\nconst toFiniteNumber = (value, defaultValue) => {\n  return value != null && Number.isFinite(value = +value) ? value : defaultValue;\n}\n\n/**\n * If the thing is a FormData object, return true, otherwise return false.\n *\n * @param {unknown} thing - The thing to check.\n *\n * @returns {boolean}\n */\nfunction isSpecCompliantForm(thing) {\n  return !!(thing && isFunction(thing.append) && thing[toStringTag] === 'FormData' && thing[iterator]);\n}\n\nconst toJSONObject = (obj) => {\n  const stack = new Array(10);\n\n  const visit = (source, i) => {\n\n    if (isObject(source)) {\n      if (stack.indexOf(source) >= 0) {\n        return;\n      }\n\n      if(!('toJSON' in source)) {\n        stack[i] = source;\n        const target = isArray(source) ? [] : {};\n\n        forEach(source, (value, key) => {\n          const reducedValue = visit(value, i + 1);\n          !isUndefined(reducedValue) && (target[key] = reducedValue);\n        });\n\n        stack[i] = undefined;\n\n        return target;\n      }\n    }\n\n    return source;\n  }\n\n  return visit(obj, 0);\n}\n\nconst isAsyncFn = kindOfTest('AsyncFunction');\n\nconst isThenable = (thing) =>\n  thing && (isObject(thing) || isFunction(thing)) && isFunction(thing.then) && isFunction(thing.catch);\n\n// original code\n// https://github.com/DigitalBrainJS/AxiosPromise/blob/16deab13710ec09779922131f3fa5954320f83ab/lib/utils.js#L11-L34\n\nconst _setImmediate = ((setImmediateSupported, postMessageSupported) => {\n  if (setImmediateSupported) {\n    return setImmediate;\n  }\n\n  return postMessageSupported ? ((token, callbacks) => {\n    _global.addEventListener(\"message\", ({source, data}) => {\n      if (source === _global && data === token) {\n        callbacks.length && callbacks.shift()();\n      }\n    }, false);\n\n    return (cb) => {\n      callbacks.push(cb);\n      _global.postMessage(token, \"*\");\n    }\n  })(`axios@${Math.random()}`, []) : (cb) => setTimeout(cb);\n})(\n  typeof setImmediate === 'function',\n  isFunction(_global.postMessage)\n);\n\nconst asap = typeof queueMicrotask !== 'undefined' ?\n  queueMicrotask.bind(_global) : ( typeof process !== 'undefined' && process.nextTick || _setImmediate);\n\n// *********************\n\n\nconst isIterable = (thing) => thing != null && isFunction(thing[iterator]);\n\n\nexport default {\n  isArray,\n  isArrayBuffer,\n  isBuffer,\n  isFormData,\n  isArrayBufferView,\n  isString,\n  isNumber,\n  isBoolean,\n  isObject,\n  isPlainObject,\n  isReadableStream,\n  isRequest,\n  isResponse,\n  isHeaders,\n  isUndefined,\n  isDate,\n  isFile,\n  isBlob,\n  isRegExp,\n  isFunction,\n  isStream,\n  isURLSearchParams,\n  isTypedArray,\n  isFileList,\n  forEach,\n  merge,\n  extend,\n  trim,\n  stripBOM,\n  inherits,\n  toFlatObject,\n  kindOf,\n  kindOfTest,\n  endsWith,\n  toArray,\n  forEachEntry,\n  matchAll,\n  isHTMLForm,\n  hasOwnProperty,\n  hasOwnProp: hasOwnProperty, // an alias to avoid ESLint no-prototype-builtins detection\n  reduceDescriptors,\n  freezeMethods,\n  toObjectSet,\n  toCamelCase,\n  noop,\n  toFiniteNumber,\n  findKey,\n  global: _global,\n  isContextDefined,\n  isSpecCompliantForm,\n  toJSONObject,\n  isAsyncFn,\n  isThenable,\n  setImmediate: _setImmediate,\n  asap,\n  isIterable\n};\n","'use strict';\n\nimport utils from '../utils.js';\n\n/**\n * Create an Error with the specified message, config, error code, request and response.\n *\n * @param {string} message The error message.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [config] The config.\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n *\n * @returns {Error} The created error.\n */\nfunction AxiosError(message, code, config, request, response) {\n  Error.call(this);\n\n  if (Error.captureStackTrace) {\n    Error.captureStackTrace(this, this.constructor);\n  } else {\n    this.stack = (new Error()).stack;\n  }\n\n  this.message = message;\n  this.name = 'AxiosError';\n  code && (this.code = code);\n  config && (this.config = config);\n  request && (this.request = request);\n  if (response) {\n    this.response = response;\n    this.status = response.status ? response.status : null;\n  }\n}\n\nutils.inherits(AxiosError, Error, {\n  toJSON: function toJSON() {\n    return {\n      // Standard\n      message: this.message,\n      name: this.name,\n      // Microsoft\n      description: this.description,\n      number: this.number,\n      // Mozilla\n      fileName: this.fileName,\n      lineNumber: this.lineNumber,\n      columnNumber: this.columnNumber,\n      stack: this.stack,\n      // Axios\n      config: utils.toJSONObject(this.config),\n      code: this.code,\n      status: this.status\n    };\n  }\n});\n\nconst prototype = AxiosError.prototype;\nconst descriptors = {};\n\n[\n  'ERR_BAD_OPTION_VALUE',\n  'ERR_BAD_OPTION',\n  'ECONNABORTED',\n  'ETIMEDOUT',\n  'ERR_NETWORK',\n  'ERR_FR_TOO_MANY_REDIRECTS',\n  'ERR_DEPRECATED',\n  'ERR_BAD_RESPONSE',\n  'ERR_BAD_REQUEST',\n  'ERR_CANCELED',\n  'ERR_NOT_SUPPORT',\n  'ERR_INVALID_URL'\n// eslint-disable-next-line func-names\n].forEach(code => {\n  descriptors[code] = {value: code};\n});\n\nObject.defineProperties(AxiosError, descriptors);\nObject.defineProperty(prototype, 'isAxiosError', {value: true});\n\n// eslint-disable-next-line func-names\nAxiosError.from = (error, code, config, request, response, customProps) => {\n  const axiosError = Object.create(prototype);\n\n  utils.toFlatObject(error, axiosError, function filter(obj) {\n    return obj !== Error.prototype;\n  }, prop => {\n    return prop !== 'isAxiosError';\n  });\n\n  AxiosError.call(axiosError, error.message, code, config, request, response);\n\n  axiosError.cause = error;\n\n  axiosError.name = error.name;\n\n  customProps && Object.assign(axiosError, customProps);\n\n  return axiosError;\n};\n\nexport default AxiosError;\n","// eslint-disable-next-line strict\nexport default null;\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosError from '../core/AxiosError.js';\n// temporary hotfix to avoid circular references until AxiosURLSearchParams is refactored\nimport PlatformFormData from '../platform/node/classes/FormData.js';\n\n/**\n * Determines if the given thing is a array or js object.\n *\n * @param {string} thing - The object or array to be visited.\n *\n * @returns {boolean}\n */\nfunction isVisitable(thing) {\n  return utils.isPlainObject(thing) || utils.isArray(thing);\n}\n\n/**\n * It removes the brackets from the end of a string\n *\n * @param {string} key - The key of the parameter.\n *\n * @returns {string} the key without the brackets.\n */\nfunction removeBrackets(key) {\n  return utils.endsWith(key, '[]') ? key.slice(0, -2) : key;\n}\n\n/**\n * It takes a path, a key, and a boolean, and returns a string\n *\n * @param {string} path - The path to the current key.\n * @param {string} key - The key of the current object being iterated over.\n * @param {string} dots - If true, the key will be rendered with dots instead of brackets.\n *\n * @returns {string} The path to the current key.\n */\nfunction renderKey(path, key, dots) {\n  if (!path) return key;\n  return path.concat(key).map(function each(token, i) {\n    // eslint-disable-next-line no-param-reassign\n    token = removeBrackets(token);\n    return !dots && i ? '[' + token + ']' : token;\n  }).join(dots ? '.' : '');\n}\n\n/**\n * If the array is an array and none of its elements are visitable, then it's a flat array.\n *\n * @param {Array<any>} arr - The array to check\n *\n * @returns {boolean}\n */\nfunction isFlatArray(arr) {\n  return utils.isArray(arr) && !arr.some(isVisitable);\n}\n\nconst predicates = utils.toFlatObject(utils, {}, null, function filter(prop) {\n  return /^is[A-Z]/.test(prop);\n});\n\n/**\n * Convert a data object to FormData\n *\n * @param {Object} obj\n * @param {?Object} [formData]\n * @param {?Object} [options]\n * @param {Function} [options.visitor]\n * @param {Boolean} [options.metaTokens = true]\n * @param {Boolean} [options.dots = false]\n * @param {?Boolean} [options.indexes = false]\n *\n * @returns {Object}\n **/\n\n/**\n * It converts an object into a FormData object\n *\n * @param {Object<any, any>} obj - The object to convert to form data.\n * @param {string} formData - The FormData object to append to.\n * @param {Object<string, any>} options\n *\n * @returns\n */\nfunction toFormData(obj, formData, options) {\n  if (!utils.isObject(obj)) {\n    throw new TypeError('target must be an object');\n  }\n\n  // eslint-disable-next-line no-param-reassign\n  formData = formData || new (PlatformFormData || FormData)();\n\n  // eslint-disable-next-line no-param-reassign\n  options = utils.toFlatObject(options, {\n    metaTokens: true,\n    dots: false,\n    indexes: false\n  }, false, function defined(option, source) {\n    // eslint-disable-next-line no-eq-null,eqeqeq\n    return !utils.isUndefined(source[option]);\n  });\n\n  const metaTokens = options.metaTokens;\n  // eslint-disable-next-line no-use-before-define\n  const visitor = options.visitor || defaultVisitor;\n  const dots = options.dots;\n  const indexes = options.indexes;\n  const _Blob = options.Blob || typeof Blob !== 'undefined' && Blob;\n  const useBlob = _Blob && utils.isSpecCompliantForm(formData);\n\n  if (!utils.isFunction(visitor)) {\n    throw new TypeError('visitor must be a function');\n  }\n\n  function convertValue(value) {\n    if (value === null) return '';\n\n    if (utils.isDate(value)) {\n      return value.toISOString();\n    }\n\n    if (!useBlob && utils.isBlob(value)) {\n      throw new AxiosError('Blob is not supported. Use a Buffer instead.');\n    }\n\n    if (utils.isArrayBuffer(value) || utils.isTypedArray(value)) {\n      return useBlob && typeof Blob === 'function' ? new Blob([value]) : Buffer.from(value);\n    }\n\n    return value;\n  }\n\n  /**\n   * Default visitor.\n   *\n   * @param {*} value\n   * @param {String|Number} key\n   * @param {Array<String|Number>} path\n   * @this {FormData}\n   *\n   * @returns {boolean} return true to visit the each prop of the value recursively\n   */\n  function defaultVisitor(value, key, path) {\n    let arr = value;\n\n    if (value && !path && typeof value === 'object') {\n      if (utils.endsWith(key, '{}')) {\n        // eslint-disable-next-line no-param-reassign\n        key = metaTokens ? key : key.slice(0, -2);\n        // eslint-disable-next-line no-param-reassign\n        value = JSON.stringify(value);\n      } else if (\n        (utils.isArray(value) && isFlatArray(value)) ||\n        ((utils.isFileList(value) || utils.endsWith(key, '[]')) && (arr = utils.toArray(value))\n        )) {\n        // eslint-disable-next-line no-param-reassign\n        key = removeBrackets(key);\n\n        arr.forEach(function each(el, index) {\n          !(utils.isUndefined(el) || el === null) && formData.append(\n            // eslint-disable-next-line no-nested-ternary\n            indexes === true ? renderKey([key], index, dots) : (indexes === null ? key : key + '[]'),\n            convertValue(el)\n          );\n        });\n        return false;\n      }\n    }\n\n    if (isVisitable(value)) {\n      return true;\n    }\n\n    formData.append(renderKey(path, key, dots), convertValue(value));\n\n    return false;\n  }\n\n  const stack = [];\n\n  const exposedHelpers = Object.assign(predicates, {\n    defaultVisitor,\n    convertValue,\n    isVisitable\n  });\n\n  function build(value, path) {\n    if (utils.isUndefined(value)) return;\n\n    if (stack.indexOf(value) !== -1) {\n      throw Error('Circular reference detected in ' + path.join('.'));\n    }\n\n    stack.push(value);\n\n    utils.forEach(value, function each(el, key) {\n      const result = !(utils.isUndefined(el) || el === null) && visitor.call(\n        formData, el, utils.isString(key) ? key.trim() : key, path, exposedHelpers\n      );\n\n      if (result === true) {\n        build(el, path ? path.concat(key) : [key]);\n      }\n    });\n\n    stack.pop();\n  }\n\n  if (!utils.isObject(obj)) {\n    throw new TypeError('data must be an object');\n  }\n\n  build(obj);\n\n  return formData;\n}\n\nexport default toFormData;\n","'use strict';\n\nimport toFormData from './toFormData.js';\n\n/**\n * It encodes a string by replacing all characters that are not in the unreserved set with\n * their percent-encoded equivalents\n *\n * @param {string} str - The string to encode.\n *\n * @returns {string} The encoded string.\n */\nfunction encode(str) {\n  const charMap = {\n    '!': '%21',\n    \"'\": '%27',\n    '(': '%28',\n    ')': '%29',\n    '~': '%7E',\n    '%20': '+',\n    '%00': '\\x00'\n  };\n  return encodeURIComponent(str).replace(/[!'()~]|%20|%00/g, function replacer(match) {\n    return charMap[match];\n  });\n}\n\n/**\n * It takes a params object and converts it to a FormData object\n *\n * @param {Object<string, any>} params - The parameters to be converted to a FormData object.\n * @param {Object<string, any>} options - The options object passed to the Axios constructor.\n *\n * @returns {void}\n */\nfunction AxiosURLSearchParams(params, options) {\n  this._pairs = [];\n\n  params && toFormData(params, this, options);\n}\n\nconst prototype = AxiosURLSearchParams.prototype;\n\nprototype.append = function append(name, value) {\n  this._pairs.push([name, value]);\n};\n\nprototype.toString = function toString(encoder) {\n  const _encode = encoder ? function(value) {\n    return encoder.call(this, value, encode);\n  } : encode;\n\n  return this._pairs.map(function each(pair) {\n    return _encode(pair[0]) + '=' + _encode(pair[1]);\n  }, '').join('&');\n};\n\nexport default AxiosURLSearchParams;\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosURLSearchParams from '../helpers/AxiosURLSearchParams.js';\n\n/**\n * It replaces all instances of the characters `:`, `$`, `,`, `+`, `[`, and `]` with their\n * URI encoded counterparts\n *\n * @param {string} val The value to be encoded.\n *\n * @returns {string} The encoded value.\n */\nfunction encode(val) {\n  return encodeURIComponent(val).\n    replace(/%3A/gi, ':').\n    replace(/%24/g, '$').\n    replace(/%2C/gi, ',').\n    replace(/%20/g, '+').\n    replace(/%5B/gi, '[').\n    replace(/%5D/gi, ']');\n}\n\n/**\n * Build a URL by appending params to the end\n *\n * @param {string} url The base of the url (e.g., http://www.google.com)\n * @param {object} [params] The params to be appended\n * @param {?(object|Function)} options\n *\n * @returns {string} The formatted url\n */\nexport default function buildURL(url, params, options) {\n  /*eslint no-param-reassign:0*/\n  if (!params) {\n    return url;\n  }\n  \n  const _encode = options && options.encode || encode;\n\n  if (utils.isFunction(options)) {\n    options = {\n      serialize: options\n    };\n  } \n\n  const serializeFn = options && options.serialize;\n\n  let serializedParams;\n\n  if (serializeFn) {\n    serializedParams = serializeFn(params, options);\n  } else {\n    serializedParams = utils.isURLSearchParams(params) ?\n      params.toString() :\n      new AxiosURLSearchParams(params, options).toString(_encode);\n  }\n\n  if (serializedParams) {\n    const hashmarkIndex = url.indexOf(\"#\");\n\n    if (hashmarkIndex !== -1) {\n      url = url.slice(0, hashmarkIndex);\n    }\n    url += (url.indexOf('?') === -1 ? '?' : '&') + serializedParams;\n  }\n\n  return url;\n}\n","'use strict';\n\nimport utils from './../utils.js';\n\nclass InterceptorManager {\n  constructor() {\n    this.handlers = [];\n  }\n\n  /**\n   * Add a new interceptor to the stack\n   *\n   * @param {Function} fulfilled The function to handle `then` for a `Promise`\n   * @param {Function} rejected The function to handle `reject` for a `Promise`\n   *\n   * @return {Number} An ID used to remove interceptor later\n   */\n  use(fulfilled, rejected, options) {\n    this.handlers.push({\n      fulfilled,\n      rejected,\n      synchronous: options ? options.synchronous : false,\n      runWhen: options ? options.runWhen : null\n    });\n    return this.handlers.length - 1;\n  }\n\n  /**\n   * Remove an interceptor from the stack\n   *\n   * @param {Number} id The ID that was returned by `use`\n   *\n   * @returns {Boolean} `true` if the interceptor was removed, `false` otherwise\n   */\n  eject(id) {\n    if (this.handlers[id]) {\n      this.handlers[id] = null;\n    }\n  }\n\n  /**\n   * Clear all interceptors from the stack\n   *\n   * @returns {void}\n   */\n  clear() {\n    if (this.handlers) {\n      this.handlers = [];\n    }\n  }\n\n  /**\n   * Iterate over all the registered interceptors\n   *\n   * This method is particularly useful for skipping over any\n   * interceptors that may have become `null` calling `eject`.\n   *\n   * @param {Function} fn The function to call for each interceptor\n   *\n   * @returns {void}\n   */\n  forEach(fn) {\n    utils.forEach(this.handlers, function forEachHandler(h) {\n      if (h !== null) {\n        fn(h);\n      }\n    });\n  }\n}\n\nexport default InterceptorManager;\n","'use strict';\n\nexport default {\n  silentJSONParsing: true,\n  forcedJSONParsing: true,\n  clarifyTimeoutError: false\n};\n","'use strict';\n\nimport AxiosURLSearchParams from '../../../helpers/AxiosURLSearchParams.js';\nexport default typeof URLSearchParams !== 'undefined' ? URLSearchParams : AxiosURLSearchParams;\n","'use strict';\n\nexport default typeof FormData !== 'undefined' ? FormData : null;\n","'use strict'\n\nexport default typeof Blob !== 'undefined' ? Blob : null\n","import URLSearchParams from './classes/URLSearchParams.js'\nimport FormData from './classes/FormData.js'\nimport Blob from './classes/Blob.js'\n\nexport default {\n  isBrowser: true,\n  classes: {\n    URLSearchParams,\n    FormData,\n    Blob\n  },\n  protocols: ['http', 'https', 'file', 'blob', 'url', 'data']\n};\n","const hasBrowserEnv = typeof window !== 'undefined' && typeof document !== 'undefined';\n\nconst _navigator = typeof navigator === 'object' && navigator || undefined;\n\n/**\n * Determine if we're running in a standard browser environment\n *\n * This allows axios to run in a web worker, and react-native.\n * Both environments support XMLHttpRequest, but not fully standard globals.\n *\n * web workers:\n *  typeof window -> undefined\n *  typeof document -> undefined\n *\n * react-native:\n *  navigator.product -> 'ReactNative'\n * nativescript\n *  navigator.product -> 'NativeScript' or 'NS'\n *\n * @returns {boolean}\n */\nconst hasStandardBrowserEnv = hasBrowserEnv &&\n  (!_navigator || ['ReactNative', 'NativeScript', 'NS'].indexOf(_navigator.product) < 0);\n\n/**\n * Determine if we're running in a standard browser webWorker environment\n *\n * Although the `isStandardBrowserEnv` method indicates that\n * `allows axios to run in a web worker`, the WebWorker will still be\n * filtered out due to its judgment standard\n * `typeof window !== 'undefined' && typeof document !== 'undefined'`.\n * This leads to a problem when axios post `FormData` in webWorker\n */\nconst hasStandardBrowserWebWorkerEnv = (() => {\n  return (\n    typeof WorkerGlobalScope !== 'undefined' &&\n    // eslint-disable-next-line no-undef\n    self instanceof WorkerGlobalScope &&\n    typeof self.importScripts === 'function'\n  );\n})();\n\nconst origin = hasBrowserEnv && window.location.href || 'http://localhost';\n\nexport {\n  hasBrowserEnv,\n  hasStandardBrowserWebWorkerEnv,\n  hasStandardBrowserEnv,\n  _navigator as navigator,\n  origin\n}\n","import platform from './node/index.js';\nimport * as utils from './common/utils.js';\n\nexport default {\n  ...utils,\n  ...platform\n}\n","'use strict';\n\nimport utils from '../utils.js';\nimport toFormData from './toFormData.js';\nimport platform from '../platform/index.js';\n\nexport default function toURLEncodedForm(data, options) {\n  return toFormData(data, new platform.classes.URLSearchParams(), Object.assign({\n    visitor: function(value, key, path, helpers) {\n      if (platform.isNode && utils.isBuffer(value)) {\n        this.append(key, value.toString('base64'));\n        return false;\n      }\n\n      return helpers.defaultVisitor.apply(this, arguments);\n    }\n  }, options));\n}\n","'use strict';\n\nimport utils from '../utils.js';\n\n/**\n * It takes a string like `foo[x][y][z]` and returns an array like `['foo', 'x', 'y', 'z']\n *\n * @param {string} name - The name of the property to get.\n *\n * @returns An array of strings.\n */\nfunction parsePropPath(name) {\n  // foo[x][y][z]\n  // foo.x.y.z\n  // foo-x-y-z\n  // foo x y z\n  return utils.matchAll(/\\w+|\\[(\\w*)]/g, name).map(match => {\n    return match[0] === '[]' ? '' : match[1] || match[0];\n  });\n}\n\n/**\n * Convert an array to an object.\n *\n * @param {Array<any>} arr - The array to convert to an object.\n *\n * @returns An object with the same keys and values as the array.\n */\nfunction arrayToObject(arr) {\n  const obj = {};\n  const keys = Object.keys(arr);\n  let i;\n  const len = keys.length;\n  let key;\n  for (i = 0; i < len; i++) {\n    key = keys[i];\n    obj[key] = arr[key];\n  }\n  return obj;\n}\n\n/**\n * It takes a FormData object and returns a JavaScript object\n *\n * @param {string} formData The FormData object to convert to JSON.\n *\n * @returns {Object<string, any> | null} The converted object.\n */\nfunction formDataToJSON(formData) {\n  function buildPath(path, value, target, index) {\n    let name = path[index++];\n\n    if (name === '__proto__') return true;\n\n    const isNumericKey = Number.isFinite(+name);\n    const isLast = index >= path.length;\n    name = !name && utils.isArray(target) ? target.length : name;\n\n    if (isLast) {\n      if (utils.hasOwnProp(target, name)) {\n        target[name] = [target[name], value];\n      } else {\n        target[name] = value;\n      }\n\n      return !isNumericKey;\n    }\n\n    if (!target[name] || !utils.isObject(target[name])) {\n      target[name] = [];\n    }\n\n    const result = buildPath(path, value, target[name], index);\n\n    if (result && utils.isArray(target[name])) {\n      target[name] = arrayToObject(target[name]);\n    }\n\n    return !isNumericKey;\n  }\n\n  if (utils.isFormData(formData) && utils.isFunction(formData.entries)) {\n    const obj = {};\n\n    utils.forEachEntry(formData, (name, value) => {\n      buildPath(parsePropPath(name), value, obj, 0);\n    });\n\n    return obj;\n  }\n\n  return null;\n}\n\nexport default formDataToJSON;\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosError from '../core/AxiosError.js';\nimport transitionalDefaults from './transitional.js';\nimport toFormData from '../helpers/toFormData.js';\nimport toURLEncodedForm from '../helpers/toURLEncodedForm.js';\nimport platform from '../platform/index.js';\nimport formDataToJSON from '../helpers/formDataToJSON.js';\n\n/**\n * It takes a string, tries to parse it, and if it fails, it returns the stringified version\n * of the input\n *\n * @param {any} rawValue - The value to be stringified.\n * @param {Function} parser - A function that parses a string into a JavaScript object.\n * @param {Function} encoder - A function that takes a value and returns a string.\n *\n * @returns {string} A stringified version of the rawValue.\n */\nfunction stringifySafely(rawValue, parser, encoder) {\n  if (utils.isString(rawValue)) {\n    try {\n      (parser || JSON.parse)(rawValue);\n      return utils.trim(rawValue);\n    } catch (e) {\n      if (e.name !== 'SyntaxError') {\n        throw e;\n      }\n    }\n  }\n\n  return (encoder || JSON.stringify)(rawValue);\n}\n\nconst defaults = {\n\n  transitional: transitionalDefaults,\n\n  adapter: ['xhr', 'http', 'fetch'],\n\n  transformRequest: [function transformRequest(data, headers) {\n    const contentType = headers.getContentType() || '';\n    const hasJSONContentType = contentType.indexOf('application/json') > -1;\n    const isObjectPayload = utils.isObject(data);\n\n    if (isObjectPayload && utils.isHTMLForm(data)) {\n      data = new FormData(data);\n    }\n\n    const isFormData = utils.isFormData(data);\n\n    if (isFormData) {\n      return hasJSONContentType ? JSON.stringify(formDataToJSON(data)) : data;\n    }\n\n    if (utils.isArrayBuffer(data) ||\n      utils.isBuffer(data) ||\n      utils.isStream(data) ||\n      utils.isFile(data) ||\n      utils.isBlob(data) ||\n      utils.isReadableStream(data)\n    ) {\n      return data;\n    }\n    if (utils.isArrayBufferView(data)) {\n      return data.buffer;\n    }\n    if (utils.isURLSearchParams(data)) {\n      headers.setContentType('application/x-www-form-urlencoded;charset=utf-8', false);\n      return data.toString();\n    }\n\n    let isFileList;\n\n    if (isObjectPayload) {\n      if (contentType.indexOf('application/x-www-form-urlencoded') > -1) {\n        return toURLEncodedForm(data, this.formSerializer).toString();\n      }\n\n      if ((isFileList = utils.isFileList(data)) || contentType.indexOf('multipart/form-data') > -1) {\n        const _FormData = this.env && this.env.FormData;\n\n        return toFormData(\n          isFileList ? {'files[]': data} : data,\n          _FormData && new _FormData(),\n          this.formSerializer\n        );\n      }\n    }\n\n    if (isObjectPayload || hasJSONContentType ) {\n      headers.setContentType('application/json', false);\n      return stringifySafely(data);\n    }\n\n    return data;\n  }],\n\n  transformResponse: [function transformResponse(data) {\n    const transitional = this.transitional || defaults.transitional;\n    const forcedJSONParsing = transitional && transitional.forcedJSONParsing;\n    const JSONRequested = this.responseType === 'json';\n\n    if (utils.isResponse(data) || utils.isReadableStream(data)) {\n      return data;\n    }\n\n    if (data && utils.isString(data) && ((forcedJSONParsing && !this.responseType) || JSONRequested)) {\n      const silentJSONParsing = transitional && transitional.silentJSONParsing;\n      const strictJSONParsing = !silentJSONParsing && JSONRequested;\n\n      try {\n        return JSON.parse(data);\n      } catch (e) {\n        if (strictJSONParsing) {\n          if (e.name === 'SyntaxError') {\n            throw AxiosError.from(e, AxiosError.ERR_BAD_RESPONSE, this, null, this.response);\n          }\n          throw e;\n        }\n      }\n    }\n\n    return data;\n  }],\n\n  /**\n   * A timeout in milliseconds to abort a request. If set to 0 (default) a\n   * timeout is not created.\n   */\n  timeout: 0,\n\n  xsrfCookieName: 'XSRF-TOKEN',\n  xsrfHeaderName: 'X-XSRF-TOKEN',\n\n  maxContentLength: -1,\n  maxBodyLength: -1,\n\n  env: {\n    FormData: platform.classes.FormData,\n    Blob: platform.classes.Blob\n  },\n\n  validateStatus: function validateStatus(status) {\n    return status >= 200 && status < 300;\n  },\n\n  headers: {\n    common: {\n      'Accept': 'application/json, text/plain, */*',\n      'Content-Type': undefined\n    }\n  }\n};\n\nutils.forEach(['delete', 'get', 'head', 'post', 'put', 'patch'], (method) => {\n  defaults.headers[method] = {};\n});\n\nexport default defaults;\n","'use strict';\n\nimport utils from './../utils.js';\n\n// RawAxiosHeaders whose duplicates are ignored by node\n// c.f. https://nodejs.org/api/http.html#http_message_headers\nconst ignoreDuplicateOf = utils.toObjectSet([\n  'age', 'authorization', 'content-length', 'content-type', 'etag',\n  'expires', 'from', 'host', 'if-modified-since', 'if-unmodified-since',\n  'last-modified', 'location', 'max-forwards', 'proxy-authorization',\n  'referer', 'retry-after', 'user-agent'\n]);\n\n/**\n * Parse headers into an object\n *\n * ```\n * Date: Wed, 27 Aug 2014 08:58:49 GMT\n * Content-Type: application/json\n * Connection: keep-alive\n * Transfer-Encoding: chunked\n * ```\n *\n * @param {String} rawHeaders Headers needing to be parsed\n *\n * @returns {Object} Headers parsed into an object\n */\nexport default rawHeaders => {\n  const parsed = {};\n  let key;\n  let val;\n  let i;\n\n  rawHeaders && rawHeaders.split('\\n').forEach(function parser(line) {\n    i = line.indexOf(':');\n    key = line.substring(0, i).trim().toLowerCase();\n    val = line.substring(i + 1).trim();\n\n    if (!key || (parsed[key] && ignoreDuplicateOf[key])) {\n      return;\n    }\n\n    if (key === 'set-cookie') {\n      if (parsed[key]) {\n        parsed[key].push(val);\n      } else {\n        parsed[key] = [val];\n      }\n    } else {\n      parsed[key] = parsed[key] ? parsed[key] + ', ' + val : val;\n    }\n  });\n\n  return parsed;\n};\n","'use strict';\n\nimport utils from '../utils.js';\nimport parseHeaders from '../helpers/parseHeaders.js';\n\nconst $internals = Symbol('internals');\n\nfunction normalizeHeader(header) {\n  return header && String(header).trim().toLowerCase();\n}\n\nfunction normalizeValue(value) {\n  if (value === false || value == null) {\n    return value;\n  }\n\n  return utils.isArray(value) ? value.map(normalizeValue) : String(value);\n}\n\nfunction parseTokens(str) {\n  const tokens = Object.create(null);\n  const tokensRE = /([^\\s,;=]+)\\s*(?:=\\s*([^,;]+))?/g;\n  let match;\n\n  while ((match = tokensRE.exec(str))) {\n    tokens[match[1]] = match[2];\n  }\n\n  return tokens;\n}\n\nconst isValidHeaderName = (str) => /^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(str.trim());\n\nfunction matchHeaderValue(context, value, header, filter, isHeaderNameFilter) {\n  if (utils.isFunction(filter)) {\n    return filter.call(this, value, header);\n  }\n\n  if (isHeaderNameFilter) {\n    value = header;\n  }\n\n  if (!utils.isString(value)) return;\n\n  if (utils.isString(filter)) {\n    return value.indexOf(filter) !== -1;\n  }\n\n  if (utils.isRegExp(filter)) {\n    return filter.test(value);\n  }\n}\n\nfunction formatHeader(header) {\n  return header.trim()\n    .toLowerCase().replace(/([a-z\\d])(\\w*)/g, (w, char, str) => {\n      return char.toUpperCase() + str;\n    });\n}\n\nfunction buildAccessors(obj, header) {\n  const accessorName = utils.toCamelCase(' ' + header);\n\n  ['get', 'set', 'has'].forEach(methodName => {\n    Object.defineProperty(obj, methodName + accessorName, {\n      value: function(arg1, arg2, arg3) {\n        return this[methodName].call(this, header, arg1, arg2, arg3);\n      },\n      configurable: true\n    });\n  });\n}\n\nclass AxiosHeaders {\n  constructor(headers) {\n    headers && this.set(headers);\n  }\n\n  set(header, valueOrRewrite, rewrite) {\n    const self = this;\n\n    function setHeader(_value, _header, _rewrite) {\n      const lHeader = normalizeHeader(_header);\n\n      if (!lHeader) {\n        throw new Error('header name must be a non-empty string');\n      }\n\n      const key = utils.findKey(self, lHeader);\n\n      if(!key || self[key] === undefined || _rewrite === true || (_rewrite === undefined && self[key] !== false)) {\n        self[key || _header] = normalizeValue(_value);\n      }\n    }\n\n    const setHeaders = (headers, _rewrite) =>\n      utils.forEach(headers, (_value, _header) => setHeader(_value, _header, _rewrite));\n\n    if (utils.isPlainObject(header) || header instanceof this.constructor) {\n      setHeaders(header, valueOrRewrite)\n    } else if(utils.isString(header) && (header = header.trim()) && !isValidHeaderName(header)) {\n      setHeaders(parseHeaders(header), valueOrRewrite);\n    } else if (utils.isObject(header) && utils.isIterable(header)) {\n      let obj = {}, dest, key;\n      for (const entry of header) {\n        if (!utils.isArray(entry)) {\n          throw TypeError('Object iterator must return a key-value pair');\n        }\n\n        obj[key = entry[0]] = (dest = obj[key]) ?\n          (utils.isArray(dest) ? [...dest, entry[1]] : [dest, entry[1]]) : entry[1];\n      }\n\n      setHeaders(obj, valueOrRewrite)\n    } else {\n      header != null && setHeader(valueOrRewrite, header, rewrite);\n    }\n\n    return this;\n  }\n\n  get(header, parser) {\n    header = normalizeHeader(header);\n\n    if (header) {\n      const key = utils.findKey(this, header);\n\n      if (key) {\n        const value = this[key];\n\n        if (!parser) {\n          return value;\n        }\n\n        if (parser === true) {\n          return parseTokens(value);\n        }\n\n        if (utils.isFunction(parser)) {\n          return parser.call(this, value, key);\n        }\n\n        if (utils.isRegExp(parser)) {\n          return parser.exec(value);\n        }\n\n        throw new TypeError('parser must be boolean|regexp|function');\n      }\n    }\n  }\n\n  has(header, matcher) {\n    header = normalizeHeader(header);\n\n    if (header) {\n      const key = utils.findKey(this, header);\n\n      return !!(key && this[key] !== undefined && (!matcher || matchHeaderValue(this, this[key], key, matcher)));\n    }\n\n    return false;\n  }\n\n  delete(header, matcher) {\n    const self = this;\n    let deleted = false;\n\n    function deleteHeader(_header) {\n      _header = normalizeHeader(_header);\n\n      if (_header) {\n        const key = utils.findKey(self, _header);\n\n        if (key && (!matcher || matchHeaderValue(self, self[key], key, matcher))) {\n          delete self[key];\n\n          deleted = true;\n        }\n      }\n    }\n\n    if (utils.isArray(header)) {\n      header.forEach(deleteHeader);\n    } else {\n      deleteHeader(header);\n    }\n\n    return deleted;\n  }\n\n  clear(matcher) {\n    const keys = Object.keys(this);\n    let i = keys.length;\n    let deleted = false;\n\n    while (i--) {\n      const key = keys[i];\n      if(!matcher || matchHeaderValue(this, this[key], key, matcher, true)) {\n        delete this[key];\n        deleted = true;\n      }\n    }\n\n    return deleted;\n  }\n\n  normalize(format) {\n    const self = this;\n    const headers = {};\n\n    utils.forEach(this, (value, header) => {\n      const key = utils.findKey(headers, header);\n\n      if (key) {\n        self[key] = normalizeValue(value);\n        delete self[header];\n        return;\n      }\n\n      const normalized = format ? formatHeader(header) : String(header).trim();\n\n      if (normalized !== header) {\n        delete self[header];\n      }\n\n      self[normalized] = normalizeValue(value);\n\n      headers[normalized] = true;\n    });\n\n    return this;\n  }\n\n  concat(...targets) {\n    return this.constructor.concat(this, ...targets);\n  }\n\n  toJSON(asStrings) {\n    const obj = Object.create(null);\n\n    utils.forEach(this, (value, header) => {\n      value != null && value !== false && (obj[header] = asStrings && utils.isArray(value) ? value.join(', ') : value);\n    });\n\n    return obj;\n  }\n\n  [Symbol.iterator]() {\n    return Object.entries(this.toJSON())[Symbol.iterator]();\n  }\n\n  toString() {\n    return Object.entries(this.toJSON()).map(([header, value]) => header + ': ' + value).join('\\n');\n  }\n\n  getSetCookie() {\n    return this.get(\"set-cookie\") || [];\n  }\n\n  get [Symbol.toStringTag]() {\n    return 'AxiosHeaders';\n  }\n\n  static from(thing) {\n    return thing instanceof this ? thing : new this(thing);\n  }\n\n  static concat(first, ...targets) {\n    const computed = new this(first);\n\n    targets.forEach((target) => computed.set(target));\n\n    return computed;\n  }\n\n  static accessor(header) {\n    const internals = this[$internals] = (this[$internals] = {\n      accessors: {}\n    });\n\n    const accessors = internals.accessors;\n    const prototype = this.prototype;\n\n    function defineAccessor(_header) {\n      const lHeader = normalizeHeader(_header);\n\n      if (!accessors[lHeader]) {\n        buildAccessors(prototype, _header);\n        accessors[lHeader] = true;\n      }\n    }\n\n    utils.isArray(header) ? header.forEach(defineAccessor) : defineAccessor(header);\n\n    return this;\n  }\n}\n\nAxiosHeaders.accessor(['Content-Type', 'Content-Length', 'Accept', 'Accept-Encoding', 'User-Agent', 'Authorization']);\n\n// reserved names hotfix\nutils.reduceDescriptors(AxiosHeaders.prototype, ({value}, key) => {\n  let mapped = key[0].toUpperCase() + key.slice(1); // map `set` => `Set`\n  return {\n    get: () => value,\n    set(headerValue) {\n      this[mapped] = headerValue;\n    }\n  }\n});\n\nutils.freezeMethods(AxiosHeaders);\n\nexport default AxiosHeaders;\n","'use strict';\n\nimport utils from './../utils.js';\nimport defaults from '../defaults/index.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\n\n/**\n * Transform the data for a request or a response\n *\n * @param {Array|Function} fns A single function or Array of functions\n * @param {?Object} response The response object\n *\n * @returns {*} The resulting transformed data\n */\nexport default function transformData(fns, response) {\n  const config = this || defaults;\n  const context = response || config;\n  const headers = AxiosHeaders.from(context.headers);\n  let data = context.data;\n\n  utils.forEach(fns, function transform(fn) {\n    data = fn.call(config, data, headers.normalize(), response ? response.status : undefined);\n  });\n\n  headers.normalize();\n\n  return data;\n}\n","'use strict';\n\nexport default function isCancel(value) {\n  return !!(value && value.__CANCEL__);\n}\n","'use strict';\n\nimport AxiosError from '../core/AxiosError.js';\nimport utils from '../utils.js';\n\n/**\n * A `CanceledError` is an object that is thrown when an operation is canceled.\n *\n * @param {string=} message The message.\n * @param {Object=} config The config.\n * @param {Object=} request The request.\n *\n * @returns {CanceledError} The created error.\n */\nfunction CanceledError(message, config, request) {\n  // eslint-disable-next-line no-eq-null,eqeqeq\n  AxiosError.call(this, message == null ? 'canceled' : message, AxiosError.ERR_CANCELED, config, request);\n  this.name = 'CanceledError';\n}\n\nutils.inherits(CanceledError, AxiosError, {\n  __CANCEL__: true\n});\n\nexport default CanceledError;\n","'use strict';\n\nimport AxiosError from './AxiosError.js';\n\n/**\n * Resolve or reject a Promise based on response status.\n *\n * @param {Function} resolve A function that resolves the promise.\n * @param {Function} reject A function that rejects the promise.\n * @param {object} response The response.\n *\n * @returns {object} The response.\n */\nexport default function settle(resolve, reject, response) {\n  const validateStatus = response.config.validateStatus;\n  if (!response.status || !validateStatus || validateStatus(response.status)) {\n    resolve(response);\n  } else {\n    reject(new AxiosError(\n      'Request failed with status code ' + response.status,\n      [AxiosError.ERR_BAD_REQUEST, AxiosError.ERR_BAD_RESPONSE][Math.floor(response.status / 100) - 4],\n      response.config,\n      response.request,\n      response\n    ));\n  }\n}\n","'use strict';\n\nexport default function parseProtocol(url) {\n  const match = /^([-+\\w]{1,25})(:?\\/\\/|:)/.exec(url);\n  return match && match[1] || '';\n}\n","'use strict';\n\n/**\n * Calculate data maxRate\n * @param {Number} [samplesCount= 10]\n * @param {Number} [min= 1000]\n * @returns {Function}\n */\nfunction speedometer(samplesCount, min) {\n  samplesCount = samplesCount || 10;\n  const bytes = new Array(samplesCount);\n  const timestamps = new Array(samplesCount);\n  let head = 0;\n  let tail = 0;\n  let firstSampleTS;\n\n  min = min !== undefined ? min : 1000;\n\n  return function push(chunkLength) {\n    const now = Date.now();\n\n    const startedAt = timestamps[tail];\n\n    if (!firstSampleTS) {\n      firstSampleTS = now;\n    }\n\n    bytes[head] = chunkLength;\n    timestamps[head] = now;\n\n    let i = tail;\n    let bytesCount = 0;\n\n    while (i !== head) {\n      bytesCount += bytes[i++];\n      i = i % samplesCount;\n    }\n\n    head = (head + 1) % samplesCount;\n\n    if (head === tail) {\n      tail = (tail + 1) % samplesCount;\n    }\n\n    if (now - firstSampleTS < min) {\n      return;\n    }\n\n    const passed = startedAt && now - startedAt;\n\n    return passed ? Math.round(bytesCount * 1000 / passed) : undefined;\n  };\n}\n\nexport default speedometer;\n","/**\n * Throttle decorator\n * @param {Function} fn\n * @param {Number} freq\n * @return {Function}\n */\nfunction throttle(fn, freq) {\n  let timestamp = 0;\n  let threshold = 1000 / freq;\n  let lastArgs;\n  let timer;\n\n  const invoke = (args, now = Date.now()) => {\n    timestamp = now;\n    lastArgs = null;\n    if (timer) {\n      clearTimeout(timer);\n      timer = null;\n    }\n    fn.apply(null, args);\n  }\n\n  const throttled = (...args) => {\n    const now = Date.now();\n    const passed = now - timestamp;\n    if ( passed >= threshold) {\n      invoke(args, now);\n    } else {\n      lastArgs = args;\n      if (!timer) {\n        timer = setTimeout(() => {\n          timer = null;\n          invoke(lastArgs)\n        }, threshold - passed);\n      }\n    }\n  }\n\n  const flush = () => lastArgs && invoke(lastArgs);\n\n  return [throttled, flush];\n}\n\nexport default throttle;\n","import speedometer from \"./speedometer.js\";\nimport throttle from \"./throttle.js\";\nimport utils from \"../utils.js\";\n\nexport const progressEventReducer = (listener, isDownloadStream, freq = 3) => {\n  let bytesNotified = 0;\n  const _speedometer = speedometer(50, 250);\n\n  return throttle(e => {\n    const loaded = e.loaded;\n    const total = e.lengthComputable ? e.total : undefined;\n    const progressBytes = loaded - bytesNotified;\n    const rate = _speedometer(progressBytes);\n    const inRange = loaded <= total;\n\n    bytesNotified = loaded;\n\n    const data = {\n      loaded,\n      total,\n      progress: total ? (loaded / total) : undefined,\n      bytes: progressBytes,\n      rate: rate ? rate : undefined,\n      estimated: rate && total && inRange ? (total - loaded) / rate : undefined,\n      event: e,\n      lengthComputable: total != null,\n      [isDownloadStream ? 'download' : 'upload']: true\n    };\n\n    listener(data);\n  }, freq);\n}\n\nexport const progressEventDecorator = (total, throttled) => {\n  const lengthComputable = total != null;\n\n  return [(loaded) => throttled[0]({\n    lengthComputable,\n    total,\n    loaded\n  }), throttled[1]];\n}\n\nexport const asyncDecorator = (fn) => (...args) => utils.asap(() => fn(...args));\n","import platform from '../platform/index.js';\n\nexport default platform.hasStandardBrowserEnv ? ((origin, isMSIE) => (url) => {\n  url = new URL(url, platform.origin);\n\n  return (\n    origin.protocol === url.protocol &&\n    origin.host === url.host &&\n    (isMSIE || origin.port === url.port)\n  );\n})(\n  new URL(platform.origin),\n  platform.navigator && /(msie|trident)/i.test(platform.navigator.userAgent)\n) : () => true;\n","import utils from './../utils.js';\nimport platform from '../platform/index.js';\n\nexport default platform.hasStandardBrowserEnv ?\n\n  // Standard browser envs support document.cookie\n  {\n    write(name, value, expires, path, domain, secure) {\n      const cookie = [name + '=' + encodeURIComponent(value)];\n\n      utils.isNumber(expires) && cookie.push('expires=' + new Date(expires).toGMTString());\n\n      utils.isString(path) && cookie.push('path=' + path);\n\n      utils.isString(domain) && cookie.push('domain=' + domain);\n\n      secure === true && cookie.push('secure');\n\n      document.cookie = cookie.join('; ');\n    },\n\n    read(name) {\n      const match = document.cookie.match(new RegExp('(^|;\\\\s*)(' + name + ')=([^;]*)'));\n      return (match ? decodeURIComponent(match[3]) : null);\n    },\n\n    remove(name) {\n      this.write(name, '', Date.now() - 86400000);\n    }\n  }\n\n  :\n\n  // Non-standard browser env (web workers, react-native) lack needed support.\n  {\n    write() {},\n    read() {\n      return null;\n    },\n    remove() {}\n  };\n\n","'use strict';\n\n/**\n * Determines whether the specified URL is absolute\n *\n * @param {string} url The URL to test\n *\n * @returns {boolean} True if the specified URL is absolute, otherwise false\n */\nexport default function isAbsoluteURL(url) {\n  // A URL is considered absolute if it begins with \"<scheme>://\" or \"//\" (protocol-relative URL).\n  // RFC 3986 defines scheme name as a sequence of characters beginning with a letter and followed\n  // by any combination of letters, digits, plus, period, or hyphen.\n  return /^([a-z][a-z\\d+\\-.]*:)?\\/\\//i.test(url);\n}\n","'use strict';\n\n/**\n * Creates a new URL by combining the specified URLs\n *\n * @param {string} baseURL The base URL\n * @param {string} relativeURL The relative URL\n *\n * @returns {string} The combined URL\n */\nexport default function combineURLs(baseURL, relativeURL) {\n  return relativeURL\n    ? baseURL.replace(/\\/?\\/$/, '') + '/' + relativeURL.replace(/^\\/+/, '')\n    : baseURL;\n}\n","'use strict';\n\nimport isAbsoluteURL from '../helpers/isAbsoluteURL.js';\nimport combineURLs from '../helpers/combineURLs.js';\n\n/**\n * Creates a new URL by combining the baseURL with the requestedURL,\n * only when the requestedURL is not already an absolute URL.\n * If the requestURL is absolute, this function returns the requestedURL untouched.\n *\n * @param {string} baseURL The base URL\n * @param {string} requestedURL Absolute or relative URL to combine\n *\n * @returns {string} The combined full path\n */\nexport default function buildFullPath(baseURL, requestedURL, allowAbsoluteUrls) {\n  let isRelativeUrl = !isAbsoluteURL(requestedURL);\n  if (baseURL && (isRelativeUrl || allowAbsoluteUrls == false)) {\n    return combineURLs(baseURL, requestedURL);\n  }\n  return requestedURL;\n}\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosHeaders from \"./AxiosHeaders.js\";\n\nconst headersToObject = (thing) => thing instanceof AxiosHeaders ? { ...thing } : thing;\n\n/**\n * Config-specific merge-function which creates a new config-object\n * by merging two configuration objects together.\n *\n * @param {Object} config1\n * @param {Object} config2\n *\n * @returns {Object} New object resulting from merging config2 to config1\n */\nexport default function mergeConfig(config1, config2) {\n  // eslint-disable-next-line no-param-reassign\n  config2 = config2 || {};\n  const config = {};\n\n  function getMergedValue(target, source, prop, caseless) {\n    if (utils.isPlainObject(target) && utils.isPlainObject(source)) {\n      return utils.merge.call({caseless}, target, source);\n    } else if (utils.isPlainObject(source)) {\n      return utils.merge({}, source);\n    } else if (utils.isArray(source)) {\n      return source.slice();\n    }\n    return source;\n  }\n\n  // eslint-disable-next-line consistent-return\n  function mergeDeepProperties(a, b, prop , caseless) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(a, b, prop , caseless);\n    } else if (!utils.isUndefined(a)) {\n      return getMergedValue(undefined, a, prop , caseless);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function valueFromConfig2(a, b) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(undefined, b);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function defaultToConfig2(a, b) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(undefined, b);\n    } else if (!utils.isUndefined(a)) {\n      return getMergedValue(undefined, a);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function mergeDirectKeys(a, b, prop) {\n    if (prop in config2) {\n      return getMergedValue(a, b);\n    } else if (prop in config1) {\n      return getMergedValue(undefined, a);\n    }\n  }\n\n  const mergeMap = {\n    url: valueFromConfig2,\n    method: valueFromConfig2,\n    data: valueFromConfig2,\n    baseURL: defaultToConfig2,\n    transformRequest: defaultToConfig2,\n    transformResponse: defaultToConfig2,\n    paramsSerializer: defaultToConfig2,\n    timeout: defaultToConfig2,\n    timeoutMessage: defaultToConfig2,\n    withCredentials: defaultToConfig2,\n    withXSRFToken: defaultToConfig2,\n    adapter: defaultToConfig2,\n    responseType: defaultToConfig2,\n    xsrfCookieName: defaultToConfig2,\n    xsrfHeaderName: defaultToConfig2,\n    onUploadProgress: defaultToConfig2,\n    onDownloadProgress: defaultToConfig2,\n    decompress: defaultToConfig2,\n    maxContentLength: defaultToConfig2,\n    maxBodyLength: defaultToConfig2,\n    beforeRedirect: defaultToConfig2,\n    transport: defaultToConfig2,\n    httpAgent: defaultToConfig2,\n    httpsAgent: defaultToConfig2,\n    cancelToken: defaultToConfig2,\n    socketPath: defaultToConfig2,\n    responseEncoding: defaultToConfig2,\n    validateStatus: mergeDirectKeys,\n    headers: (a, b , prop) => mergeDeepProperties(headersToObject(a), headersToObject(b),prop, true)\n  };\n\n  utils.forEach(Object.keys(Object.assign({}, config1, config2)), function computeConfigValue(prop) {\n    const merge = mergeMap[prop] || mergeDeepProperties;\n    const configValue = merge(config1[prop], config2[prop], prop);\n    (utils.isUndefined(configValue) && merge !== mergeDirectKeys) || (config[prop] = configValue);\n  });\n\n  return config;\n}\n","import platform from \"../platform/index.js\";\nimport utils from \"../utils.js\";\nimport isURLSameOrigin from \"./isURLSameOrigin.js\";\nimport cookies from \"./cookies.js\";\nimport buildFullPath from \"../core/buildFullPath.js\";\nimport mergeConfig from \"../core/mergeConfig.js\";\nimport AxiosHeaders from \"../core/AxiosHeaders.js\";\nimport buildURL from \"./buildURL.js\";\n\nexport default (config) => {\n  const newConfig = mergeConfig({}, config);\n\n  let {data, withXSRFToken, xsrfHeaderName, xsrfCookieName, headers, auth} = newConfig;\n\n  newConfig.headers = headers = AxiosHeaders.from(headers);\n\n  newConfig.url = buildURL(buildFullPath(newConfig.baseURL, newConfig.url, newConfig.allowAbsoluteUrls), config.params, config.paramsSerializer);\n\n  // HTTP basic authentication\n  if (auth) {\n    headers.set('Authorization', 'Basic ' +\n      btoa((auth.username || '') + ':' + (auth.password ? unescape(encodeURIComponent(auth.password)) : ''))\n    );\n  }\n\n  let contentType;\n\n  if (utils.isFormData(data)) {\n    if (platform.hasStandardBrowserEnv || platform.hasStandardBrowserWebWorkerEnv) {\n      headers.setContentType(undefined); // Let the browser set it\n    } else if ((contentType = headers.getContentType()) !== false) {\n      // fix semicolon duplication issue for ReactNative FormData implementation\n      const [type, ...tokens] = contentType ? contentType.split(';').map(token => token.trim()).filter(Boolean) : [];\n      headers.setContentType([type || 'multipart/form-data', ...tokens].join('; '));\n    }\n  }\n\n  // Add xsrf header\n  // This is only done if running in a standard browser environment.\n  // Specifically not if we're in a web worker, or react-native.\n\n  if (platform.hasStandardBrowserEnv) {\n    withXSRFToken && utils.isFunction(withXSRFToken) && (withXSRFToken = withXSRFToken(newConfig));\n\n    if (withXSRFToken || (withXSRFToken !== false && isURLSameOrigin(newConfig.url))) {\n      // Add xsrf header\n      const xsrfValue = xsrfHeaderName && xsrfCookieName && cookies.read(xsrfCookieName);\n\n      if (xsrfValue) {\n        headers.set(xsrfHeaderName, xsrfValue);\n      }\n    }\n  }\n\n  return newConfig;\n}\n\n","import utils from './../utils.js';\nimport settle from './../core/settle.js';\nimport transitionalDefaults from '../defaults/transitional.js';\nimport AxiosError from '../core/AxiosError.js';\nimport CanceledError from '../cancel/CanceledError.js';\nimport parseProtocol from '../helpers/parseProtocol.js';\nimport platform from '../platform/index.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\nimport {progressEventReducer} from '../helpers/progressEventReducer.js';\nimport resolveConfig from \"../helpers/resolveConfig.js\";\n\nconst isXHRAdapterSupported = typeof XMLHttpRequest !== 'undefined';\n\nexport default isXHRAdapterSupported && function (config) {\n  return new Promise(function dispatchXhrRequest(resolve, reject) {\n    const _config = resolveConfig(config);\n    let requestData = _config.data;\n    const requestHeaders = AxiosHeaders.from(_config.headers).normalize();\n    let {responseType, onUploadProgress, onDownloadProgress} = _config;\n    let onCanceled;\n    let uploadThrottled, downloadThrottled;\n    let flushUpload, flushDownload;\n\n    function done() {\n      flushUpload && flushUpload(); // flush events\n      flushDownload && flushDownload(); // flush events\n\n      _config.cancelToken && _config.cancelToken.unsubscribe(onCanceled);\n\n      _config.signal && _config.signal.removeEventListener('abort', onCanceled);\n    }\n\n    let request = new XMLHttpRequest();\n\n    request.open(_config.method.toUpperCase(), _config.url, true);\n\n    // Set the request timeout in MS\n    request.timeout = _config.timeout;\n\n    function onloadend() {\n      if (!request) {\n        return;\n      }\n      // Prepare the response\n      const responseHeaders = AxiosHeaders.from(\n        'getAllResponseHeaders' in request && request.getAllResponseHeaders()\n      );\n      const responseData = !responseType || responseType === 'text' || responseType === 'json' ?\n        request.responseText : request.response;\n      const response = {\n        data: responseData,\n        status: request.status,\n        statusText: request.statusText,\n        headers: responseHeaders,\n        config,\n        request\n      };\n\n      settle(function _resolve(value) {\n        resolve(value);\n        done();\n      }, function _reject(err) {\n        reject(err);\n        done();\n      }, response);\n\n      // Clean up request\n      request = null;\n    }\n\n    if ('onloadend' in request) {\n      // Use onloadend if available\n      request.onloadend = onloadend;\n    } else {\n      // Listen for ready state to emulate onloadend\n      request.onreadystatechange = function handleLoad() {\n        if (!request || request.readyState !== 4) {\n          return;\n        }\n\n        // The request errored out and we didn't get a response, this will be\n        // handled by onerror instead\n        // With one exception: request that using file: protocol, most browsers\n        // will return status as 0 even though it's a successful request\n        if (request.status === 0 && !(request.responseURL && request.responseURL.indexOf('file:') === 0)) {\n          return;\n        }\n        // readystate handler is calling before onerror or ontimeout handlers,\n        // so we should call onloadend on the next 'tick'\n        setTimeout(onloadend);\n      };\n    }\n\n    // Handle browser request cancellation (as opposed to a manual cancellation)\n    request.onabort = function handleAbort() {\n      if (!request) {\n        return;\n      }\n\n      reject(new AxiosError('Request aborted', AxiosError.ECONNABORTED, config, request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle low level network errors\n    request.onerror = function handleError() {\n      // Real errors are hidden from us by the browser\n      // onerror should only fire if it's a network error\n      reject(new AxiosError('Network Error', AxiosError.ERR_NETWORK, config, request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle timeout\n    request.ontimeout = function handleTimeout() {\n      let timeoutErrorMessage = _config.timeout ? 'timeout of ' + _config.timeout + 'ms exceeded' : 'timeout exceeded';\n      const transitional = _config.transitional || transitionalDefaults;\n      if (_config.timeoutErrorMessage) {\n        timeoutErrorMessage = _config.timeoutErrorMessage;\n      }\n      reject(new AxiosError(\n        timeoutErrorMessage,\n        transitional.clarifyTimeoutError ? AxiosError.ETIMEDOUT : AxiosError.ECONNABORTED,\n        config,\n        request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Remove Content-Type if data is undefined\n    requestData === undefined && requestHeaders.setContentType(null);\n\n    // Add headers to the request\n    if ('setRequestHeader' in request) {\n      utils.forEach(requestHeaders.toJSON(), function setRequestHeader(val, key) {\n        request.setRequestHeader(key, val);\n      });\n    }\n\n    // Add withCredentials to request if needed\n    if (!utils.isUndefined(_config.withCredentials)) {\n      request.withCredentials = !!_config.withCredentials;\n    }\n\n    // Add responseType to request if needed\n    if (responseType && responseType !== 'json') {\n      request.responseType = _config.responseType;\n    }\n\n    // Handle progress if needed\n    if (onDownloadProgress) {\n      ([downloadThrottled, flushDownload] = progressEventReducer(onDownloadProgress, true));\n      request.addEventListener('progress', downloadThrottled);\n    }\n\n    // Not all browsers support upload events\n    if (onUploadProgress && request.upload) {\n      ([uploadThrottled, flushUpload] = progressEventReducer(onUploadProgress));\n\n      request.upload.addEventListener('progress', uploadThrottled);\n\n      request.upload.addEventListener('loadend', flushUpload);\n    }\n\n    if (_config.cancelToken || _config.signal) {\n      // Handle cancellation\n      // eslint-disable-next-line func-names\n      onCanceled = cancel => {\n        if (!request) {\n          return;\n        }\n        reject(!cancel || cancel.type ? new CanceledError(null, config, request) : cancel);\n        request.abort();\n        request = null;\n      };\n\n      _config.cancelToken && _config.cancelToken.subscribe(onCanceled);\n      if (_config.signal) {\n        _config.signal.aborted ? onCanceled() : _config.signal.addEventListener('abort', onCanceled);\n      }\n    }\n\n    const protocol = parseProtocol(_config.url);\n\n    if (protocol && platform.protocols.indexOf(protocol) === -1) {\n      reject(new AxiosError('Unsupported protocol ' + protocol + ':', AxiosError.ERR_BAD_REQUEST, config));\n      return;\n    }\n\n\n    // Send the request\n    request.send(requestData || null);\n  });\n}\n","import CanceledError from \"../cancel/CanceledError.js\";\nimport AxiosError from \"../core/AxiosError.js\";\nimport utils from '../utils.js';\n\nconst composeSignals = (signals, timeout) => {\n  const {length} = (signals = signals ? signals.filter(Boolean) : []);\n\n  if (timeout || length) {\n    let controller = new AbortController();\n\n    let aborted;\n\n    const onabort = function (reason) {\n      if (!aborted) {\n        aborted = true;\n        unsubscribe();\n        const err = reason instanceof Error ? reason : this.reason;\n        controller.abort(err instanceof AxiosError ? err : new CanceledError(err instanceof Error ? err.message : err));\n      }\n    }\n\n    let timer = timeout && setTimeout(() => {\n      timer = null;\n      onabort(new AxiosError(`timeout ${timeout} of ms exceeded`, AxiosError.ETIMEDOUT))\n    }, timeout)\n\n    const unsubscribe = () => {\n      if (signals) {\n        timer && clearTimeout(timer);\n        timer = null;\n        signals.forEach(signal => {\n          signal.unsubscribe ? signal.unsubscribe(onabort) : signal.removeEventListener('abort', onabort);\n        });\n        signals = null;\n      }\n    }\n\n    signals.forEach((signal) => signal.addEventListener('abort', onabort));\n\n    const {signal} = controller;\n\n    signal.unsubscribe = () => utils.asap(unsubscribe);\n\n    return signal;\n  }\n}\n\nexport default composeSignals;\n","\nexport const streamChunk = function* (chunk, chunkSize) {\n  let len = chunk.byteLength;\n\n  if (!chunkSize || len < chunkSize) {\n    yield chunk;\n    return;\n  }\n\n  let pos = 0;\n  let end;\n\n  while (pos < len) {\n    end = pos + chunkSize;\n    yield chunk.slice(pos, end);\n    pos = end;\n  }\n}\n\nexport const readBytes = async function* (iterable, chunkSize) {\n  for await (const chunk of readStream(iterable)) {\n    yield* streamChunk(chunk, chunkSize);\n  }\n}\n\nconst readStream = async function* (stream) {\n  if (stream[Symbol.asyncIterator]) {\n    yield* stream;\n    return;\n  }\n\n  const reader = stream.getReader();\n  try {\n    for (;;) {\n      const {done, value} = await reader.read();\n      if (done) {\n        break;\n      }\n      yield value;\n    }\n  } finally {\n    await reader.cancel();\n  }\n}\n\nexport const trackStream = (stream, chunkSize, onProgress, onFinish) => {\n  const iterator = readBytes(stream, chunkSize);\n\n  let bytes = 0;\n  let done;\n  let _onFinish = (e) => {\n    if (!done) {\n      done = true;\n      onFinish && onFinish(e);\n    }\n  }\n\n  return new ReadableStream({\n    async pull(controller) {\n      try {\n        const {done, value} = await iterator.next();\n\n        if (done) {\n         _onFinish();\n          controller.close();\n          return;\n        }\n\n        let len = value.byteLength;\n        if (onProgress) {\n          let loadedBytes = bytes += len;\n          onProgress(loadedBytes);\n        }\n        controller.enqueue(new Uint8Array(value));\n      } catch (err) {\n        _onFinish(err);\n        throw err;\n      }\n    },\n    cancel(reason) {\n      _onFinish(reason);\n      return iterator.return();\n    }\n  }, {\n    highWaterMark: 2\n  })\n}\n","import platform from \"../platform/index.js\";\nimport utils from \"../utils.js\";\nimport AxiosError from \"../core/AxiosError.js\";\nimport composeSignals from \"../helpers/composeSignals.js\";\nimport {trackStream} from \"../helpers/trackStream.js\";\nimport AxiosHeaders from \"../core/AxiosHeaders.js\";\nimport {progressEventReducer, progressEventDecorator, asyncDecorator} from \"../helpers/progressEventReducer.js\";\nimport resolveConfig from \"../helpers/resolveConfig.js\";\nimport settle from \"../core/settle.js\";\n\nconst isFetchSupported = typeof fetch === 'function' && typeof Request === 'function' && typeof Response === 'function';\nconst isReadableStreamSupported = isFetchSupported && typeof ReadableStream === 'function';\n\n// used only inside the fetch adapter\nconst encodeText = isFetchSupported && (typeof TextEncoder === 'function' ?\n    ((encoder) => (str) => encoder.encode(str))(new TextEncoder()) :\n    async (str) => new Uint8Array(await new Response(str).arrayBuffer())\n);\n\nconst test = (fn, ...args) => {\n  try {\n    return !!fn(...args);\n  } catch (e) {\n    return false\n  }\n}\n\nconst supportsRequestStream = isReadableStreamSupported && test(() => {\n  let duplexAccessed = false;\n\n  const hasContentType = new Request(platform.origin, {\n    body: new ReadableStream(),\n    method: 'POST',\n    get duplex() {\n      duplexAccessed = true;\n      return 'half';\n    },\n  }).headers.has('Content-Type');\n\n  return duplexAccessed && !hasContentType;\n});\n\nconst DEFAULT_CHUNK_SIZE = 64 * 1024;\n\nconst supportsResponseStream = isReadableStreamSupported &&\n  test(() => utils.isReadableStream(new Response('').body));\n\n\nconst resolvers = {\n  stream: supportsResponseStream && ((res) => res.body)\n};\n\nisFetchSupported && (((res) => {\n  ['text', 'arrayBuffer', 'blob', 'formData', 'stream'].forEach(type => {\n    !resolvers[type] && (resolvers[type] = utils.isFunction(res[type]) ? (res) => res[type]() :\n      (_, config) => {\n        throw new AxiosError(`Response type '${type}' is not supported`, AxiosError.ERR_NOT_SUPPORT, config);\n      })\n  });\n})(new Response));\n\nconst getBodyLength = async (body) => {\n  if (body == null) {\n    return 0;\n  }\n\n  if(utils.isBlob(body)) {\n    return body.size;\n  }\n\n  if(utils.isSpecCompliantForm(body)) {\n    const _request = new Request(platform.origin, {\n      method: 'POST',\n      body,\n    });\n    return (await _request.arrayBuffer()).byteLength;\n  }\n\n  if(utils.isArrayBufferView(body) || utils.isArrayBuffer(body)) {\n    return body.byteLength;\n  }\n\n  if(utils.isURLSearchParams(body)) {\n    body = body + '';\n  }\n\n  if(utils.isString(body)) {\n    return (await encodeText(body)).byteLength;\n  }\n}\n\nconst resolveBodyLength = async (headers, body) => {\n  const length = utils.toFiniteNumber(headers.getContentLength());\n\n  return length == null ? getBodyLength(body) : length;\n}\n\nexport default isFetchSupported && (async (config) => {\n  let {\n    url,\n    method,\n    data,\n    signal,\n    cancelToken,\n    timeout,\n    onDownloadProgress,\n    onUploadProgress,\n    responseType,\n    headers,\n    withCredentials = 'same-origin',\n    fetchOptions\n  } = resolveConfig(config);\n\n  responseType = responseType ? (responseType + '').toLowerCase() : 'text';\n\n  let composedSignal = composeSignals([signal, cancelToken && cancelToken.toAbortSignal()], timeout);\n\n  let request;\n\n  const unsubscribe = composedSignal && composedSignal.unsubscribe && (() => {\n      composedSignal.unsubscribe();\n  });\n\n  let requestContentLength;\n\n  try {\n    if (\n      onUploadProgress && supportsRequestStream && method !== 'get' && method !== 'head' &&\n      (requestContentLength = await resolveBodyLength(headers, data)) !== 0\n    ) {\n      let _request = new Request(url, {\n        method: 'POST',\n        body: data,\n        duplex: \"half\"\n      });\n\n      let contentTypeHeader;\n\n      if (utils.isFormData(data) && (contentTypeHeader = _request.headers.get('content-type'))) {\n        headers.setContentType(contentTypeHeader)\n      }\n\n      if (_request.body) {\n        const [onProgress, flush] = progressEventDecorator(\n          requestContentLength,\n          progressEventReducer(asyncDecorator(onUploadProgress))\n        );\n\n        data = trackStream(_request.body, DEFAULT_CHUNK_SIZE, onProgress, flush);\n      }\n    }\n\n    if (!utils.isString(withCredentials)) {\n      withCredentials = withCredentials ? 'include' : 'omit';\n    }\n\n    // Cloudflare Workers throws when credentials are defined\n    // see https://github.com/cloudflare/workerd/issues/902\n    const isCredentialsSupported = \"credentials\" in Request.prototype;\n    request = new Request(url, {\n      ...fetchOptions,\n      signal: composedSignal,\n      method: method.toUpperCase(),\n      headers: headers.normalize().toJSON(),\n      body: data,\n      duplex: \"half\",\n      credentials: isCredentialsSupported ? withCredentials : undefined\n    });\n\n    let response = await fetch(request);\n\n    const isStreamResponse = supportsResponseStream && (responseType === 'stream' || responseType === 'response');\n\n    if (supportsResponseStream && (onDownloadProgress || (isStreamResponse && unsubscribe))) {\n      const options = {};\n\n      ['status', 'statusText', 'headers'].forEach(prop => {\n        options[prop] = response[prop];\n      });\n\n      const responseContentLength = utils.toFiniteNumber(response.headers.get('content-length'));\n\n      const [onProgress, flush] = onDownloadProgress && progressEventDecorator(\n        responseContentLength,\n        progressEventReducer(asyncDecorator(onDownloadProgress), true)\n      ) || [];\n\n      response = new Response(\n        trackStream(response.body, DEFAULT_CHUNK_SIZE, onProgress, () => {\n          flush && flush();\n          unsubscribe && unsubscribe();\n        }),\n        options\n      );\n    }\n\n    responseType = responseType || 'text';\n\n    let responseData = await resolvers[utils.findKey(resolvers, responseType) || 'text'](response, config);\n\n    !isStreamResponse && unsubscribe && unsubscribe();\n\n    return await new Promise((resolve, reject) => {\n      settle(resolve, reject, {\n        data: responseData,\n        headers: AxiosHeaders.from(response.headers),\n        status: response.status,\n        statusText: response.statusText,\n        config,\n        request\n      })\n    })\n  } catch (err) {\n    unsubscribe && unsubscribe();\n\n    if (err && err.name === 'TypeError' && /Load failed|fetch/i.test(err.message)) {\n      throw Object.assign(\n        new AxiosError('Network Error', AxiosError.ERR_NETWORK, config, request),\n        {\n          cause: err.cause || err\n        }\n      )\n    }\n\n    throw AxiosError.from(err, err && err.code, config, request);\n  }\n});\n\n\n","import utils from '../utils.js';\nimport httpAdapter from './http.js';\nimport xhrAdapter from './xhr.js';\nimport fetchAdapter from './fetch.js';\nimport AxiosError from \"../core/AxiosError.js\";\n\nconst knownAdapters = {\n  http: httpAdapter,\n  xhr: xhrAdapter,\n  fetch: fetchAdapter\n}\n\nutils.forEach(knownAdapters, (fn, value) => {\n  if (fn) {\n    try {\n      Object.defineProperty(fn, 'name', {value});\n    } catch (e) {\n      // eslint-disable-next-line no-empty\n    }\n    Object.defineProperty(fn, 'adapterName', {value});\n  }\n});\n\nconst renderReason = (reason) => `- ${reason}`;\n\nconst isResolvedHandle = (adapter) => utils.isFunction(adapter) || adapter === null || adapter === false;\n\nexport default {\n  getAdapter: (adapters) => {\n    adapters = utils.isArray(adapters) ? adapters : [adapters];\n\n    const {length} = adapters;\n    let nameOrAdapter;\n    let adapter;\n\n    const rejectedReasons = {};\n\n    for (let i = 0; i < length; i++) {\n      nameOrAdapter = adapters[i];\n      let id;\n\n      adapter = nameOrAdapter;\n\n      if (!isResolvedHandle(nameOrAdapter)) {\n        adapter = knownAdapters[(id = String(nameOrAdapter)).toLowerCase()];\n\n        if (adapter === undefined) {\n          throw new AxiosError(`Unknown adapter '${id}'`);\n        }\n      }\n\n      if (adapter) {\n        break;\n      }\n\n      rejectedReasons[id || '#' + i] = adapter;\n    }\n\n    if (!adapter) {\n\n      const reasons = Object.entries(rejectedReasons)\n        .map(([id, state]) => `adapter ${id} ` +\n          (state === false ? 'is not supported by the environment' : 'is not available in the build')\n        );\n\n      let s = length ?\n        (reasons.length > 1 ? 'since :\\n' + reasons.map(renderReason).join('\\n') : ' ' + renderReason(reasons[0])) :\n        'as no adapter specified';\n\n      throw new AxiosError(\n        `There is no suitable adapter to dispatch the request ` + s,\n        'ERR_NOT_SUPPORT'\n      );\n    }\n\n    return adapter;\n  },\n  adapters: knownAdapters\n}\n","'use strict';\n\nimport transformData from './transformData.js';\nimport isCancel from '../cancel/isCancel.js';\nimport defaults from '../defaults/index.js';\nimport CanceledError from '../cancel/CanceledError.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\nimport adapters from \"../adapters/adapters.js\";\n\n/**\n * Throws a `CanceledError` if cancellation has been requested.\n *\n * @param {Object} config The config that is to be used for the request\n *\n * @returns {void}\n */\nfunction throwIfCancellationRequested(config) {\n  if (config.cancelToken) {\n    config.cancelToken.throwIfRequested();\n  }\n\n  if (config.signal && config.signal.aborted) {\n    throw new CanceledError(null, config);\n  }\n}\n\n/**\n * Dispatch a request to the server using the configured adapter.\n *\n * @param {object} config The config that is to be used for the request\n *\n * @returns {Promise} The Promise to be fulfilled\n */\nexport default function dispatchRequest(config) {\n  throwIfCancellationRequested(config);\n\n  config.headers = AxiosHeaders.from(config.headers);\n\n  // Transform request data\n  config.data = transformData.call(\n    config,\n    config.transformRequest\n  );\n\n  if (['post', 'put', 'patch'].indexOf(config.method) !== -1) {\n    config.headers.setContentType('application/x-www-form-urlencoded', false);\n  }\n\n  const adapter = adapters.getAdapter(config.adapter || defaults.adapter);\n\n  return adapter(config).then(function onAdapterResolution(response) {\n    throwIfCancellationRequested(config);\n\n    // Transform response data\n    response.data = transformData.call(\n      config,\n      config.transformResponse,\n      response\n    );\n\n    response.headers = AxiosHeaders.from(response.headers);\n\n    return response;\n  }, function onAdapterRejection(reason) {\n    if (!isCancel(reason)) {\n      throwIfCancellationRequested(config);\n\n      // Transform response data\n      if (reason && reason.response) {\n        reason.response.data = transformData.call(\n          config,\n          config.transformResponse,\n          reason.response\n        );\n        reason.response.headers = AxiosHeaders.from(reason.response.headers);\n      }\n    }\n\n    return Promise.reject(reason);\n  });\n}\n","export const VERSION = \"1.9.0\";","'use strict';\n\nimport {VERSION} from '../env/data.js';\nimport AxiosError from '../core/AxiosError.js';\n\nconst validators = {};\n\n// eslint-disable-next-line func-names\n['object', 'boolean', 'number', 'function', 'string', 'symbol'].forEach((type, i) => {\n  validators[type] = function validator(thing) {\n    return typeof thing === type || 'a' + (i < 1 ? 'n ' : ' ') + type;\n  };\n});\n\nconst deprecatedWarnings = {};\n\n/**\n * Transitional option validator\n *\n * @param {function|boolean?} validator - set to false if the transitional option has been removed\n * @param {string?} version - deprecated version / removed since version\n * @param {string?} message - some message with additional info\n *\n * @returns {function}\n */\nvalidators.transitional = function transitional(validator, version, message) {\n  function formatMessage(opt, desc) {\n    return '[Axios v' + VERSION + '] Transitional option \\'' + opt + '\\'' + desc + (message ? '. ' + message : '');\n  }\n\n  // eslint-disable-next-line func-names\n  return (value, opt, opts) => {\n    if (validator === false) {\n      throw new AxiosError(\n        formatMessage(opt, ' has been removed' + (version ? ' in ' + version : '')),\n        AxiosError.ERR_DEPRECATED\n      );\n    }\n\n    if (version && !deprecatedWarnings[opt]) {\n      deprecatedWarnings[opt] = true;\n      // eslint-disable-next-line no-console\n      console.warn(\n        formatMessage(\n          opt,\n          ' has been deprecated since v' + version + ' and will be removed in the near future'\n        )\n      );\n    }\n\n    return validator ? validator(value, opt, opts) : true;\n  };\n};\n\nvalidators.spelling = function spelling(correctSpelling) {\n  return (value, opt) => {\n    // eslint-disable-next-line no-console\n    console.warn(`${opt} is likely a misspelling of ${correctSpelling}`);\n    return true;\n  }\n};\n\n/**\n * Assert object's properties type\n *\n * @param {object} options\n * @param {object} schema\n * @param {boolean?} allowUnknown\n *\n * @returns {object}\n */\n\nfunction assertOptions(options, schema, allowUnknown) {\n  if (typeof options !== 'object') {\n    throw new AxiosError('options must be an object', AxiosError.ERR_BAD_OPTION_VALUE);\n  }\n  const keys = Object.keys(options);\n  let i = keys.length;\n  while (i-- > 0) {\n    const opt = keys[i];\n    const validator = schema[opt];\n    if (validator) {\n      const value = options[opt];\n      const result = value === undefined || validator(value, opt, options);\n      if (result !== true) {\n        throw new AxiosError('option ' + opt + ' must be ' + result, AxiosError.ERR_BAD_OPTION_VALUE);\n      }\n      continue;\n    }\n    if (allowUnknown !== true) {\n      throw new AxiosError('Unknown option ' + opt, AxiosError.ERR_BAD_OPTION);\n    }\n  }\n}\n\nexport default {\n  assertOptions,\n  validators\n};\n","'use strict';\n\nimport utils from './../utils.js';\nimport buildURL from '../helpers/buildURL.js';\nimport InterceptorManager from './InterceptorManager.js';\nimport dispatchRequest from './dispatchRequest.js';\nimport mergeConfig from './mergeConfig.js';\nimport buildFullPath from './buildFullPath.js';\nimport validator from '../helpers/validator.js';\nimport AxiosHeaders from './AxiosHeaders.js';\n\nconst validators = validator.validators;\n\n/**\n * Create a new instance of Axios\n *\n * @param {Object} instanceConfig The default config for the instance\n *\n * @return {Axios} A new instance of Axios\n */\nclass Axios {\n  constructor(instanceConfig) {\n    this.defaults = instanceConfig || {};\n    this.interceptors = {\n      request: new InterceptorManager(),\n      response: new InterceptorManager()\n    };\n  }\n\n  /**\n   * Dispatch a request\n   *\n   * @param {String|Object} configOrUrl The config specific for this request (merged with this.defaults)\n   * @param {?Object} config\n   *\n   * @returns {Promise} The Promise to be fulfilled\n   */\n  async request(configOrUrl, config) {\n    try {\n      return await this._request(configOrUrl, config);\n    } catch (err) {\n      if (err instanceof Error) {\n        let dummy = {};\n\n        Error.captureStackTrace ? Error.captureStackTrace(dummy) : (dummy = new Error());\n\n        // slice off the Error: ... line\n        const stack = dummy.stack ? dummy.stack.replace(/^.+\\n/, '') : '';\n        try {\n          if (!err.stack) {\n            err.stack = stack;\n            // match without the 2 top stack lines\n          } else if (stack && !String(err.stack).endsWith(stack.replace(/^.+\\n.+\\n/, ''))) {\n            err.stack += '\\n' + stack\n          }\n        } catch (e) {\n          // ignore the case where \"stack\" is an un-writable property\n        }\n      }\n\n      throw err;\n    }\n  }\n\n  _request(configOrUrl, config) {\n    /*eslint no-param-reassign:0*/\n    // Allow for axios('example/url'[, config]) a la fetch API\n    if (typeof configOrUrl === 'string') {\n      config = config || {};\n      config.url = configOrUrl;\n    } else {\n      config = configOrUrl || {};\n    }\n\n    config = mergeConfig(this.defaults, config);\n\n    const {transitional, paramsSerializer, headers} = config;\n\n    if (transitional !== undefined) {\n      validator.assertOptions(transitional, {\n        silentJSONParsing: validators.transitional(validators.boolean),\n        forcedJSONParsing: validators.transitional(validators.boolean),\n        clarifyTimeoutError: validators.transitional(validators.boolean)\n      }, false);\n    }\n\n    if (paramsSerializer != null) {\n      if (utils.isFunction(paramsSerializer)) {\n        config.paramsSerializer = {\n          serialize: paramsSerializer\n        }\n      } else {\n        validator.assertOptions(paramsSerializer, {\n          encode: validators.function,\n          serialize: validators.function\n        }, true);\n      }\n    }\n\n    // Set config.allowAbsoluteUrls\n    if (config.allowAbsoluteUrls !== undefined) {\n      // do nothing\n    } else if (this.defaults.allowAbsoluteUrls !== undefined) {\n      config.allowAbsoluteUrls = this.defaults.allowAbsoluteUrls;\n    } else {\n      config.allowAbsoluteUrls = true;\n    }\n\n    validator.assertOptions(config, {\n      baseUrl: validators.spelling('baseURL'),\n      withXsrfToken: validators.spelling('withXSRFToken')\n    }, true);\n\n    // Set config.method\n    config.method = (config.method || this.defaults.method || 'get').toLowerCase();\n\n    // Flatten headers\n    let contextHeaders = headers && utils.merge(\n      headers.common,\n      headers[config.method]\n    );\n\n    headers && utils.forEach(\n      ['delete', 'get', 'head', 'post', 'put', 'patch', 'common'],\n      (method) => {\n        delete headers[method];\n      }\n    );\n\n    config.headers = AxiosHeaders.concat(contextHeaders, headers);\n\n    // filter out skipped interceptors\n    const requestInterceptorChain = [];\n    let synchronousRequestInterceptors = true;\n    this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) {\n      if (typeof interceptor.runWhen === 'function' && interceptor.runWhen(config) === false) {\n        return;\n      }\n\n      synchronousRequestInterceptors = synchronousRequestInterceptors && interceptor.synchronous;\n\n      requestInterceptorChain.unshift(interceptor.fulfilled, interceptor.rejected);\n    });\n\n    const responseInterceptorChain = [];\n    this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) {\n      responseInterceptorChain.push(interceptor.fulfilled, interceptor.rejected);\n    });\n\n    let promise;\n    let i = 0;\n    let len;\n\n    if (!synchronousRequestInterceptors) {\n      const chain = [dispatchRequest.bind(this), undefined];\n      chain.unshift.apply(chain, requestInterceptorChain);\n      chain.push.apply(chain, responseInterceptorChain);\n      len = chain.length;\n\n      promise = Promise.resolve(config);\n\n      while (i < len) {\n        promise = promise.then(chain[i++], chain[i++]);\n      }\n\n      return promise;\n    }\n\n    len = requestInterceptorChain.length;\n\n    let newConfig = config;\n\n    i = 0;\n\n    while (i < len) {\n      const onFulfilled = requestInterceptorChain[i++];\n      const onRejected = requestInterceptorChain[i++];\n      try {\n        newConfig = onFulfilled(newConfig);\n      } catch (error) {\n        onRejected.call(this, error);\n        break;\n      }\n    }\n\n    try {\n      promise = dispatchRequest.call(this, newConfig);\n    } catch (error) {\n      return Promise.reject(error);\n    }\n\n    i = 0;\n    len = responseInterceptorChain.length;\n\n    while (i < len) {\n      promise = promise.then(responseInterceptorChain[i++], responseInterceptorChain[i++]);\n    }\n\n    return promise;\n  }\n\n  getUri(config) {\n    config = mergeConfig(this.defaults, config);\n    const fullPath = buildFullPath(config.baseURL, config.url, config.allowAbsoluteUrls);\n    return buildURL(fullPath, config.params, config.paramsSerializer);\n  }\n}\n\n// Provide aliases for supported request methods\nutils.forEach(['delete', 'get', 'head', 'options'], function forEachMethodNoData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, config) {\n    return this.request(mergeConfig(config || {}, {\n      method,\n      url,\n      data: (config || {}).data\n    }));\n  };\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  /*eslint func-names:0*/\n\n  function generateHTTPMethod(isForm) {\n    return function httpMethod(url, data, config) {\n      return this.request(mergeConfig(config || {}, {\n        method,\n        headers: isForm ? {\n          'Content-Type': 'multipart/form-data'\n        } : {},\n        url,\n        data\n      }));\n    };\n  }\n\n  Axios.prototype[method] = generateHTTPMethod();\n\n  Axios.prototype[method + 'Form'] = generateHTTPMethod(true);\n});\n\nexport default Axios;\n","'use strict';\n\nimport CanceledError from './CanceledError.js';\n\n/**\n * A `CancelToken` is an object that can be used to request cancellation of an operation.\n *\n * @param {Function} executor The executor function.\n *\n * @returns {CancelToken}\n */\nclass CancelToken {\n  constructor(executor) {\n    if (typeof executor !== 'function') {\n      throw new TypeError('executor must be a function.');\n    }\n\n    let resolvePromise;\n\n    this.promise = new Promise(function promiseExecutor(resolve) {\n      resolvePromise = resolve;\n    });\n\n    const token = this;\n\n    // eslint-disable-next-line func-names\n    this.promise.then(cancel => {\n      if (!token._listeners) return;\n\n      let i = token._listeners.length;\n\n      while (i-- > 0) {\n        token._listeners[i](cancel);\n      }\n      token._listeners = null;\n    });\n\n    // eslint-disable-next-line func-names\n    this.promise.then = onfulfilled => {\n      let _resolve;\n      // eslint-disable-next-line func-names\n      const promise = new Promise(resolve => {\n        token.subscribe(resolve);\n        _resolve = resolve;\n      }).then(onfulfilled);\n\n      promise.cancel = function reject() {\n        token.unsubscribe(_resolve);\n      };\n\n      return promise;\n    };\n\n    executor(function cancel(message, config, request) {\n      if (token.reason) {\n        // Cancellation has already been requested\n        return;\n      }\n\n      token.reason = new CanceledError(message, config, request);\n      resolvePromise(token.reason);\n    });\n  }\n\n  /**\n   * Throws a `CanceledError` if cancellation has been requested.\n   */\n  throwIfRequested() {\n    if (this.reason) {\n      throw this.reason;\n    }\n  }\n\n  /**\n   * Subscribe to the cancel signal\n   */\n\n  subscribe(listener) {\n    if (this.reason) {\n      listener(this.reason);\n      return;\n    }\n\n    if (this._listeners) {\n      this._listeners.push(listener);\n    } else {\n      this._listeners = [listener];\n    }\n  }\n\n  /**\n   * Unsubscribe from the cancel signal\n   */\n\n  unsubscribe(listener) {\n    if (!this._listeners) {\n      return;\n    }\n    const index = this._listeners.indexOf(listener);\n    if (index !== -1) {\n      this._listeners.splice(index, 1);\n    }\n  }\n\n  toAbortSignal() {\n    const controller = new AbortController();\n\n    const abort = (err) => {\n      controller.abort(err);\n    };\n\n    this.subscribe(abort);\n\n    controller.signal.unsubscribe = () => this.unsubscribe(abort);\n\n    return controller.signal;\n  }\n\n  /**\n   * Returns an object that contains a new `CancelToken` and a function that, when called,\n   * cancels the `CancelToken`.\n   */\n  static source() {\n    let cancel;\n    const token = new CancelToken(function executor(c) {\n      cancel = c;\n    });\n    return {\n      token,\n      cancel\n    };\n  }\n}\n\nexport default CancelToken;\n","'use strict';\n\n/**\n * Syntactic sugar for invoking a function and expanding an array for arguments.\n *\n * Common use case would be to use `Function.prototype.apply`.\n *\n *  ```js\n *  function f(x, y, z) {}\n *  var args = [1, 2, 3];\n *  f.apply(null, args);\n *  ```\n *\n * With `spread` this example can be re-written.\n *\n *  ```js\n *  spread(function(x, y, z) {})([1, 2, 3]);\n *  ```\n *\n * @param {Function} callback\n *\n * @returns {Function}\n */\nexport default function spread(callback) {\n  return function wrap(arr) {\n    return callback.apply(null, arr);\n  };\n}\n","'use strict';\n\nimport utils from './../utils.js';\n\n/**\n * Determines whether the payload is an error thrown by Axios\n *\n * @param {*} payload The value to test\n *\n * @returns {boolean} True if the payload is an error thrown by Axios, otherwise false\n */\nexport default function isAxiosError(payload) {\n  return utils.isObject(payload) && (payload.isAxiosError === true);\n}\n","const HttpStatusCode = {\n  Continue: 100,\n  SwitchingProtocols: 101,\n  Processing: 102,\n  EarlyHints: 103,\n  Ok: 200,\n  Created: 201,\n  Accepted: 202,\n  NonAuthoritativeInformation: 203,\n  NoContent: 204,\n  ResetContent: 205,\n  PartialContent: 206,\n  MultiStatus: 207,\n  AlreadyReported: 208,\n  ImUsed: 226,\n  MultipleChoices: 300,\n  MovedPermanently: 301,\n  Found: 302,\n  SeeOther: 303,\n  NotModified: 304,\n  UseProxy: 305,\n  Unused: 306,\n  TemporaryRedirect: 307,\n  PermanentRedirect: 308,\n  BadRequest: 400,\n  Unauthorized: 401,\n  PaymentRequired: 402,\n  Forbidden: 403,\n  NotFound: 404,\n  MethodNotAllowed: 405,\n  NotAcceptable: 406,\n  ProxyAuthenticationRequired: 407,\n  RequestTimeout: 408,\n  Conflict: 409,\n  Gone: 410,\n  LengthRequired: 411,\n  PreconditionFailed: 412,\n  PayloadTooLarge: 413,\n  UriTooLong: 414,\n  UnsupportedMediaType: 415,\n  RangeNotSatisfiable: 416,\n  ExpectationFailed: 417,\n  ImATeapot: 418,\n  MisdirectedRequest: 421,\n  UnprocessableEntity: 422,\n  Locked: 423,\n  FailedDependency: 424,\n  TooEarly: 425,\n  UpgradeRequired: 426,\n  PreconditionRequired: 428,\n  TooManyRequests: 429,\n  RequestHeaderFieldsTooLarge: 431,\n  UnavailableForLegalReasons: 451,\n  InternalServerError: 500,\n  NotImplemented: 501,\n  BadGateway: 502,\n  ServiceUnavailable: 503,\n  GatewayTimeout: 504,\n  HttpVersionNotSupported: 505,\n  VariantAlsoNegotiates: 506,\n  InsufficientStorage: 507,\n  LoopDetected: 508,\n  NotExtended: 510,\n  NetworkAuthenticationRequired: 511,\n};\n\nObject.entries(HttpStatusCode).forEach(([key, value]) => {\n  HttpStatusCode[value] = key;\n});\n\nexport default HttpStatusCode;\n","'use strict';\n\nimport utils from './utils.js';\nimport bind from './helpers/bind.js';\nimport Axios from './core/Axios.js';\nimport mergeConfig from './core/mergeConfig.js';\nimport defaults from './defaults/index.js';\nimport formDataToJSON from './helpers/formDataToJSON.js';\nimport CanceledError from './cancel/CanceledError.js';\nimport CancelToken from './cancel/CancelToken.js';\nimport isCancel from './cancel/isCancel.js';\nimport {VERSION} from './env/data.js';\nimport toFormData from './helpers/toFormData.js';\nimport AxiosError from './core/AxiosError.js';\nimport spread from './helpers/spread.js';\nimport isAxiosError from './helpers/isAxiosError.js';\nimport AxiosHeaders from \"./core/AxiosHeaders.js\";\nimport adapters from './adapters/adapters.js';\nimport HttpStatusCode from './helpers/HttpStatusCode.js';\n\n/**\n * Create an instance of Axios\n *\n * @param {Object} defaultConfig The default config for the instance\n *\n * @returns {Axios} A new instance of Axios\n */\nfunction createInstance(defaultConfig) {\n  const context = new Axios(defaultConfig);\n  const instance = bind(Axios.prototype.request, context);\n\n  // Copy axios.prototype to instance\n  utils.extend(instance, Axios.prototype, context, {allOwnKeys: true});\n\n  // Copy context to instance\n  utils.extend(instance, context, null, {allOwnKeys: true});\n\n  // Factory for creating new instances\n  instance.create = function create(instanceConfig) {\n    return createInstance(mergeConfig(defaultConfig, instanceConfig));\n  };\n\n  return instance;\n}\n\n// Create the default instance to be exported\nconst axios = createInstance(defaults);\n\n// Expose Axios class to allow class inheritance\naxios.Axios = Axios;\n\n// Expose Cancel & CancelToken\naxios.CanceledError = CanceledError;\naxios.CancelToken = CancelToken;\naxios.isCancel = isCancel;\naxios.VERSION = VERSION;\naxios.toFormData = toFormData;\n\n// Expose AxiosError class\naxios.AxiosError = AxiosError;\n\n// alias for CanceledError for backward compatibility\naxios.Cancel = axios.CanceledError;\n\n// Expose all/spread\naxios.all = function all(promises) {\n  return Promise.all(promises);\n};\n\naxios.spread = spread;\n\n// Expose isAxiosError\naxios.isAxiosError = isAxiosError;\n\n// Expose mergeConfig\naxios.mergeConfig = mergeConfig;\n\naxios.AxiosHeaders = AxiosHeaders;\n\naxios.formToJSON = thing => formDataToJSON(utils.isHTMLForm(thing) ? new FormData(thing) : thing);\n\naxios.getAdapter = adapters.getAdapter;\n\naxios.HttpStatusCode = HttpStatusCode;\n\naxios.default = axios;\n\n// this module should only have a default export\nexport default axios\n","import axios from './lib/axios.js';\n\n// This module is intended to unwrap Axios default export as named.\n// Keep top-level export same with static properties\n// so that it can keep same with es module or cjs\nconst {\n  Axios,\n  AxiosError,\n  CanceledError,\n  isCancel,\n  CancelToken,\n  VERSION,\n  all,\n  Cancel,\n  isAxiosError,\n  spread,\n  toFormData,\n  AxiosHeaders,\n  HttpStatusCode,\n  formToJSON,\n  getAdapter,\n  mergeConfig\n} = axios;\n\nexport {\n  axios as default,\n  Axios,\n  AxiosError,\n  CanceledError,\n  isCancel,\n  CancelToken,\n  VERSION,\n  all,\n  Cancel,\n  isAxiosError,\n  spread,\n  toFormData,\n  AxiosHeaders,\n  HttpStatusCode,\n  formToJSON,\n  getAdapter,\n  mergeConfig\n}\n","import type { AxiosResponse } from 'axios'\nimport axios from 'axios'\n\nexport interface ModelOption {\n  value: string\n  label: string\n}\n\nexport interface AvailableModelsResponse {\n  options: ModelOption[]\n  total: number\n}\n\nexport class ConfigApiService {\n  /**\n   * Get available model list\n   */\n  public static async getAvailableModels(): Promise<AvailableModelsResponse> {\n    try {\n      const response: AxiosResponse<AvailableModelsResponse> = await axios({\n        url: '/api/models/available-models',\n        method: 'GET',\n        baseURL: '' // Override the default /api/v1 baseURL\n      })\n      return response.data\n    } catch (error) {\n      console.error('Failed to fetch available models:', error)\n      return { options: [], total: 0 }\n    }\n  }\n} \n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"assigned-tools\">\n    <div class=\"section-header\">\n      <span>{{ title }} ({{ filteredSelectedToolIds.length }})</span>\n      <button class=\"action-btn small\" @click=\"$emit('add-tools')\" v-if=\"showAddButton\">\n        <Icon icon=\"carbon:add\" />\n        {{ addButtonText }}\n      </button>\n    </div>\n\n    <div class=\"tools-grid\" :class=\"{ 'grid-layout': useGridLayout }\">\n      <div v-for=\"toolId in filteredSelectedToolIds\" :key=\"toolId\" class=\"tool-item assigned\">\n        <div class=\"tool-info\">\n          <span class=\"tool-name\">{{ getToolDisplayNameWithGroup(toolId) }}</span>\n          <span class=\"tool-desc\">{{ getToolDescription(toolId) }}</span>\n        </div>\n      </div>\n\n      <div v-if=\"filteredSelectedToolIds.length === 0\" class=\"no-tools\">\n        <Icon icon=\"carbon:tool-box\" />\n        <span>{{ emptyText }}</span>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { Icon } from '@iconify/vue'\nimport { computed, watch } from 'vue'\n\n// Props\ninterface Props {\n  title: string\n  selectedToolIds: string[]\n  availableTools: Array<{\n    key: string\n    name: string\n    description: string\n    enabled: boolean\n    serviceGroup: string\n    selectable: boolean\n  }>\n  addButtonText?: string\n  emptyText?: string\n  showAddButton?: boolean\n  useGridLayout?: boolean\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  addButtonText: 'Add/Remove Tools',\n  emptyText: 'No tools assigned',\n  showAddButton: true,\n  useGridLayout: false,\n})\n\n// Emits\nconst emit = defineEmits<{\n  'add-tools': []\n  'tools-filtered': [filteredToolIds: string[]]\n}>()\n\n// Computed property to filter out tools that are not in availableTools\nconst filteredSelectedToolIds = computed(() => {\n  if (!Array.isArray(props.selectedToolIds)) {\n    return []\n  }\n  return props.selectedToolIds.filter(toolId => props.availableTools.some(tool => tool.key === toolId))\n})\n\n// Watch for changes in filtered tools and emit event\nwatch(\n  filteredSelectedToolIds,\n  newFilteredTools => {\n    // Only emit if there's a difference (some tools were filtered out)\n    const selectedLength = props.selectedToolIds.length\n    if (newFilteredTools.length !== selectedLength) {\n      emit('tools-filtered', newFilteredTools)\n    }\n  },\n  { immediate: true }\n)\n\n// Methods\nconst getToolDisplayNameWithGroup = (toolId: string): string => {\n  const tool = props.availableTools.find(t => t.key === toolId)\n  if (!tool) return toolId\n\n  const group = tool.serviceGroup || 'Ungrouped'\n  return `${group}.${tool.name}`\n}\n\nconst getToolDescription = (toolId: string): string => {\n  const tool = props.availableTools.find(t => t.key === toolId)\n  return tool ? tool.description : ''\n}\n</script>\n\n<style scoped>\n.assigned-tools {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.section-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 8px;\n}\n\n.section-header span {\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.action-btn {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 10px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  color: #fff;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  font-size: 14px;\n}\n\n.action-btn:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.1);\n  border-color: rgba(255, 255, 255, 0.2);\n}\n\n.action-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.action-btn.small {\n  padding: 6px 10px;\n  font-size: 11px;\n}\n\n.tools-grid {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.tools-grid.grid-layout {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));\n  gap: 12px;\n  max-height: 200px;\n  overflow-y: auto;\n}\n\n.tool-item {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 12px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  transition: all 0.3s ease;\n}\n\n.tools-grid.grid-layout .tool-item {\n  padding: 12px;\n  justify-content: flex-start;\n}\n\n.tool-item:hover {\n  background: rgba(255, 255, 255, 0.08);\n  border-color: rgba(255, 255, 255, 0.2);\n}\n\n.tool-item.assigned {\n  border-color: rgba(102, 126, 234, 0.3);\n  background: rgba(102, 126, 234, 0.1);\n}\n\n.tool-info {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n  flex: 1;\n}\n\n.tool-name {\n  display: block;\n  font-weight: 500;\n  margin-bottom: 4px;\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 14px;\n}\n\n.tool-desc {\n  font-size: 12px;\n  color: rgba(255, 255, 255, 0.6);\n  line-height: 1.3;\n}\n\n.no-tools {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n  padding: 40px;\n  color: rgba(255, 255, 255, 0.4);\n  font-style: italic;\n}\n\n.tools-grid.grid-layout .no-tools {\n  padding: 16px;\n  font-size: 12px;\n  grid-column: 1 / -1;\n}\n\n.no-tools svg {\n  width: 20px;\n  height: 20px;\n  opacity: 0.5;\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <Modal\n    v-model=\"visible\"\n    :title=\"$t('toolSelection.title')\"\n    @confirm=\"handleConfirm\"\n    @update:model-value=\"handleCancel\"\n  >\n    <div class=\"tool-selection-content\">\n      <!-- Search and Sort -->\n      <div class=\"tool-controls\">\n        <div class=\"search-container\">\n          <input\n            v-model=\"searchQuery\"\n            type=\"text\"\n            class=\"search-input\"\n            :placeholder=\"$t('toolSelection.searchPlaceholder')\"\n          />\n        </div>\n        <div class=\"sort-container\">\n          <select v-model=\"sortBy\" class=\"sort-select\">\n            <option value=\"group\">{{ $t('toolSelection.sortByGroup') }}</option>\n            <option value=\"name\">{{ $t('toolSelection.sortByName') }}</option>\n            <option value=\"enabled\">{{ $t('toolSelection.sortByStatus') }}</option>\n          </select>\n        </div>\n      </div>\n\n      <!-- Tool Statistics -->\n      <div class=\"tool-summary\">\n        <span class=\"summary-text\">\n          {{\n            $t('toolSelection.summary', {\n              groups: groupedTools.size,\n              tools: totalTools,\n              selected: selectedTools.length,\n            })\n          }}\n        </span>\n      </div>\n\n      <!-- Tool Group List -->\n      <div class=\"tool-groups\" v-if=\"groupedTools.size > 0\">\n        <div v-for=\"[groupName, tools] in groupedTools\" :key=\"groupName\" class=\"tool-group\">\n          <!-- Group Header -->\n          <div\n            class=\"tool-group-header\"\n            :class=\"{ collapsed: collapsedGroups.has(groupName) }\"\n            @click=\"toggleGroupCollapse(groupName)\"\n          >\n            <div class=\"group-title-area\">\n              <Icon\n                :icon=\"\n                  collapsedGroups.has(groupName) ? 'carbon:chevron-right' : 'carbon:chevron-down'\n                \"\n                class=\"collapse-icon\"\n              />\n              <Icon icon=\"carbon:folder\" class=\"group-icon\" />\n              <span class=\"group-name\">{{ groupName }}</span>\n              <span class=\"group-count\">\n                ({{ getSelectedToolsInGroup(tools).length }}/{{ tools.length }})\n              </span>\n            </div>\n            <div class=\"group-actions\" @click.stop>\n              <label class=\"group-enable-all\">\n                <input\n                  type=\"checkbox\"\n                  class=\"group-enable-checkbox\"\n                  :checked=\"isGroupFullySelected(tools)\"\n                  @change=\"toggleGroupSelection(tools, $event)\"\n                  :data-group=\"groupName\"\n                />\n                <span class=\"enable-label\">{{ $t('toolSelection.enableAll') }}</span>\n              </label>\n            </div>\n          </div>\n\n          <!-- Group Content -->\n          <div class=\"tool-group-content\" :class=\"{ collapsed: collapsedGroups.has(groupName) }\">\n            <div v-for=\"tool in tools\" :key=\"tool.key\" class=\"tool-selection-item\">\n              <div class=\"tool-info\">\n                <div class=\"tool-selection-name\">{{ tool.name }}</div>\n                <div v-if=\"tool.description\" class=\"tool-selection-desc\">\n                  {{ tool.description }}\n                </div>\n              </div>\n              <div class=\"tool-actions\">\n                <label class=\"tool-enable-switch\" @click.stop>\n                  <input\n                    type=\"checkbox\"\n                    class=\"tool-enable-checkbox\"\n                    :checked=\"isToolSelected(tool.key)\"\n                    @change=\"toggleToolSelection(tool.key, $event)\"\n                  />\n                  <span class=\"tool-enable-slider\"></span>\n                </label>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Empty State -->\n      <div v-else class=\"empty-state\">\n        <Icon icon=\"carbon:tools\" class=\"empty-icon\" />\n        <p>{{ $t('toolSelection.noToolsFound') }}</p>\n      </div>\n    </div>\n  </Modal>\n</template>\n\n<script setup lang=\"ts\">\nimport type { Tool } from '@/types/tool'\nimport { Icon } from '@iconify/vue'\nimport { computed, nextTick, ref, watch } from 'vue'\nimport Modal from '../modal/index.vue'\n\ninterface Props {\n  modelValue: boolean\n  tools: Tool[]\n  selectedToolIds: string[]\n}\n\ninterface Emits {\n  (e: 'update:modelValue', value: boolean): void\n  (e: 'confirm', selectedToolIds: string[]): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n\n// Reactive state\nconst visible = computed({\n  get: () => props.modelValue,\n  set: value => emit('update:modelValue', value),\n})\n\nconst searchQuery = ref('')\nconst sortBy = ref<'group' | 'name' | 'enabled'>('group')\nconst collapsedGroups = ref(new Set<string>())\nconst selectedTools = ref<string[]>([])\n\n// Set group checkbox indeterminate state\nconst updateGroupCheckboxState = (groupName: string, tools: Tool[]) => {\n  const checkbox = document.querySelector(\n    `input[data-group=\"${groupName}\"]`\n  ) as HTMLInputElement | null\n  if (checkbox) {\n    checkbox.indeterminate = isGroupPartiallySelected(tools)\n  }\n}\n\n// Initialize the selected tools\nwatch(\n  () => props.selectedToolIds,\n  newIds => {\n    selectedTools.value = [...newIds]\n  },\n  { immediate: true }\n)\n\n// Filtered and sorted tools\nconst filteredTools = computed(() => {\n  let filtered = props.tools.filter(tool => tool.key) // Filter out invalid tools\n\n  // Filter out non-selectable tools\n  filtered = filtered.filter(tool => tool.selectable === true)\n\n  // Search filter\n  if (searchQuery.value) {\n    const query = searchQuery.value.toLowerCase()\n    filtered = filtered.filter(\n      tool =>\n        tool.name.toLowerCase().includes(query) ||\n        tool.description.toLowerCase().includes(query) ||\n        tool.serviceGroup.toLowerCase().includes(query)\n    )\n  }\n\n  // Sorting\n  switch (sortBy.value) {\n    case 'name':\n      filtered = [...filtered].sort((a, b) => a.name.localeCompare(b.name))\n      break\n    case 'enabled':\n      filtered = [...filtered].sort((a, b) => {\n        const aSelected = selectedTools.value.includes(a.key)\n        const bSelected = selectedTools.value.includes(b.key)\n        if (aSelected && !bSelected) return -1\n        if (!aSelected && bSelected) return 1\n        return a.name.localeCompare(b.name)\n      })\n      break\n    case 'group':\n    default:\n      filtered = [...filtered].sort((a, b) => {\n        const groupA = a.serviceGroup || 'Ungrouped'\n        const groupB = b.serviceGroup || 'Ungrouped'\n        if (groupA !== groupB) {\n          return groupA.localeCompare(groupB)\n        }\n        return a.name.localeCompare(b.name)\n      })\n      break\n  }\n\n  return filtered\n})\n\n// Tools grouped by service group\nconst groupedTools = computed(() => {\n  const groups = new Map<string, Tool[]>()\n\n  filteredTools.value.forEach(tool => {\n    const groupName = tool.serviceGroup || 'Ungrouped'\n    if (!groups.has(groupName)) {\n      groups.set(groupName, [])\n    }\n    groups.get(groupName)!.push(tool)\n  })\n\n  // Sort the groups\n  return new Map([...groups.entries()].sort())\n})\n\n// Total number of tools\nconst totalTools = computed(() => filteredTools.value.length)\n\n// Watch for changes in the selected state and update the indeterminate state of group checkboxes\nwatch(\n  [selectedTools, groupedTools],\n  () => {\n    nextTick(() => {\n      for (const [groupName, tools] of groupedTools.value) {\n        updateGroupCheckboxState(groupName, tools)\n      }\n    })\n  },\n  { flush: 'post', deep: false }\n)\n\n// Tool selection logic\nconst isToolSelected = (toolKey: string) => {\n  return selectedTools.value.includes(toolKey)\n}\n\nconst toggleToolSelection = (toolKey: string, event: Event) => {\n  event.stopPropagation()\n  const target = event.target as HTMLInputElement\n  const isChecked = target.checked\n\n  // Prevent undefined toolKey\n  if (!toolKey) {\n    console.error('toolKey is undefined, cannot proceed')\n    return\n  }\n\n  if (isChecked) {\n    // Add the tool to the selected list\n    if (!selectedTools.value.includes(toolKey)) {\n      selectedTools.value = [...selectedTools.value, toolKey]\n    }\n  } else {\n    // Remove the tool from the selected list\n    selectedTools.value = selectedTools.value.filter(id => id !== toolKey)\n  }\n}\n\n// Group selection logic\nconst getSelectedToolsInGroup = (tools: Tool[]) => {\n  return tools.filter(tool => selectedTools.value.includes(tool.key))\n}\n\nconst isGroupFullySelected = (tools: Tool[]) => {\n  return tools.length > 0 && tools.every(tool => selectedTools.value.includes(tool.key))\n}\n\nconst isGroupPartiallySelected = (tools: Tool[]) => {\n  const selectedCount = getSelectedToolsInGroup(tools).length\n  return selectedCount > 0 && selectedCount < tools.length\n}\n\nconst toggleGroupSelection = (tools: Tool[], event: Event) => {\n  event.stopPropagation()\n  const target = event.target as HTMLInputElement\n  const isChecked = target.checked\n  const toolKeys = tools.map(tool => tool.key)\n\n  if (isChecked) {\n    // Select all tools in the group - Use a new array to avoid reference issues\n    const newSelected = [...selectedTools.value]\n    toolKeys.forEach(key => {\n      if (!newSelected.includes(key)) {\n        newSelected.push(key)\n      }\n    })\n    selectedTools.value = newSelected\n  } else {\n    // Deselect all tools in the group - Create a new array\n    selectedTools.value = selectedTools.value.filter(id => !toolKeys.includes(id))\n  }\n}\n\n// Group collapse logic\nconst toggleGroupCollapse = (groupName: string) => {\n  if (collapsedGroups.value.has(groupName)) {\n    collapsedGroups.value.delete(groupName)\n  } else {\n    collapsedGroups.value.add(groupName)\n  }\n}\n\n// Dialog event handling\nconst handleConfirm = () => {\n  emit('confirm', [...selectedTools.value])\n  emit('update:modelValue', false)\n}\n\nconst handleCancel = () => {\n  // Translate to English and follow frontend terminology\n  selectedTools.value = [...props.selectedToolIds]\n  emit('update:modelValue', false)\n}\n\n// When the modal opens, expand the first group by default and collapse the others\nwatch(visible, newVisible => {\n  if (newVisible) {\n    collapsedGroups.value.clear()\n    const groupNames = Array.from(groupedTools.value.keys())\n    if (groupNames.length > 1) {\n      // Collapse all groups except the first one by default\n      groupNames.slice(1).forEach(name => {\n        collapsedGroups.value.add(name)\n      })\n    }\n  }\n})\n</script>\n\n<style scoped>\n.tool-selection-content {\n  min-height: 400px;\n  max-height: 600px;\n  overflow-y: auto;\n}\n\n.tool-controls {\n  display: flex;\n  gap: 12px;\n  margin-bottom: 16px;\n  padding: 12px;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.search-container {\n  flex: 1;\n}\n\n.search-input {\n  width: 100%;\n  padding: 8px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 14px;\n  transition: all 0.3s;\n}\n\n.search-input:focus {\n  outline: none;\n  border-color: rgba(102, 126, 234, 0.5);\n  background: rgba(255, 255, 255, 0.1);\n}\n\n.search-input::placeholder {\n  color: rgba(255, 255, 255, 0.5);\n}\n\n.sort-container {\n  min-width: 140px;\n}\n\n.sort-select {\n  width: 100%;\n  padding: 8px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 14px;\n  cursor: pointer;\n}\n\n.tool-summary {\n  margin-bottom: 16px;\n  padding: 8px 0;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.summary-text {\n  color: rgba(255, 255, 255, 0.7);\n  font-size: 13px;\n}\n\n.tool-group {\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  overflow: hidden;\n  margin-bottom: 8px;\n}\n\n.tool-group-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  cursor: pointer;\n  transition: all 0.3s;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.tool-group-header:hover {\n  background: rgba(255, 255, 255, 0.08);\n}\n\n.tool-group-header.collapsed {\n  border-bottom: none;\n}\n\n.group-title-area {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex: 1;\n}\n\n.collapse-icon {\n  color: rgba(255, 255, 255, 0.6);\n  transition: transform 0.3s;\n}\n\n.group-icon {\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.group-name {\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.group-count {\n  color: rgba(255, 255, 255, 0.6);\n  font-size: 13px;\n}\n\n.group-actions {\n  display: flex;\n  align-items: center;\n}\n\n.group-enable-all {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  cursor: pointer;\n  color: rgba(255, 255, 255, 0.8);\n  font-size: 13px;\n}\n\n.group-enable-checkbox {\n  cursor: pointer;\n}\n\n.tool-group-content {\n  max-height: 300px;\n  overflow-y: auto;\n  transition: all 0.3s;\n}\n\n.tool-group-content.collapsed {\n  max-height: 0;\n  overflow: hidden;\n}\n\n.tool-selection-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px 16px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.05);\n  transition: background-color 0.3s;\n}\n\n.tool-selection-item:hover {\n  background: rgba(255, 255, 255, 0.03);\n}\n\n.tool-selection-item:last-child {\n  border-bottom: none;\n}\n\n.tool-info {\n  flex: 1;\n}\n\n.tool-selection-name {\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n  margin-bottom: 4px;\n}\n\n.tool-selection-desc {\n  color: rgba(255, 255, 255, 0.6);\n  font-size: 13px;\n  line-height: 1.4;\n}\n\n.tool-actions {\n  margin-left: 12px;\n}\n\n.tool-enable-switch {\n  position: relative;\n  display: inline-block;\n  width: 44px;\n  height: 24px;\n  cursor: pointer;\n}\n\n.tool-enable-checkbox {\n  opacity: 0;\n  width: 0;\n  height: 0;\n}\n\n.tool-enable-slider {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(255, 255, 255, 0.2);\n  border-radius: 24px;\n  transition: all 0.3s;\n}\n\n.tool-enable-slider:before {\n  position: absolute;\n  content: '';\n  height: 18px;\n  width: 18px;\n  left: 3px;\n  bottom: 3px;\n  background: white;\n  border-radius: 50%;\n  transition: all 0.3s;\n}\n\n.tool-enable-checkbox:checked + .tool-enable-slider {\n  background: rgba(102, 126, 234, 0.8);\n}\n\n.tool-enable-checkbox:checked + .tool-enable-slider:before {\n  transform: translateX(20px);\n}\n\n.empty-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 60px 20px;\n  color: rgba(255, 255, 255, 0.5);\n}\n\n.empty-icon {\n  font-size: 48px;\n  margin-bottom: 16px;\n  opacity: 0.6;\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"config-section\">\n    <div class=\"section-header\">\n      <Icon icon=\"carbon:code\" width=\"16\" />\n      <span>{{ $t('sidebar.dynamicAgentPlan') }}</span>\n    </div>\n    <!-- Error Display -->\n    <div v-if=\"planTypeError\" class=\"error-section\">\n      <div class=\"error-message\">\n        <Icon icon=\"carbon:warning\" width=\"16\" />\n        <div class=\"error-content\">\n          <div class=\"error-title\">{{ $t('sidebar.planTypeError') }}</div>\n          <div class=\"error-description\">{{ planTypeError }}</div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Visual JSON Editor -->\n    <div v-else class=\"visual-editor\">\n      <!-- Plan Basic Info -->\n      <div class=\"plan-basic-info\">\n        <div class=\"form-row\">\n          <label class=\"form-label\">{{ $t('sidebar.title') }}</label>\n          <input\n            v-model=\"displayData.title\"\n            type=\"text\"\n            class=\"form-input\"\n            :class=\"{ error: titleError }\"\n            :placeholder=\"$t('sidebar.titlePlaceholder')\"\n          />\n          <!-- Inline validation message for title -->\n          <div v-if=\"titleError\" class=\"field-error-message\">\n            <Icon icon=\"carbon:warning\" width=\"12\" />\n            {{ titleError }}\n          </div>\n        </div>\n\n        <!-- Plan Template ID (Read-only) -->\n        <div class=\"form-row\">\n          <label class=\"form-label\">{{ $t('sidebar.planTemplateId') }}</label>\n          <input\n            :value=\"currentPlanTemplateId\"\n            type=\"text\"\n            class=\"form-input readonly-input\"\n            readonly\n            :placeholder=\"$t('sidebar.planTemplateIdPlaceholder')\"\n          />\n        </div>\n      </div>\n\n      <!-- Steps Editor -->\n      <div class=\"steps-section\">\n        <div class=\"steps-header\">\n          <label class=\"form-label\">{{ $t('sidebar.tasks') }}</label>\n          <div class=\"steps-actions\">\n            <button @click=\"addStep\" class=\"btn btn-xs\" :title=\"$t('sidebar.addStep')\">\n              <Icon icon=\"carbon:add\" width=\"12\" />\n            </button>\n          </div>\n        </div>\n\n        <div class=\"steps-container\">\n          <div v-for=\"(step, index) in displayData.steps\" :key=\"index\" class=\"step-item\">\n            <div class=\"step-header\">\n              <span class=\"step-number\">{{ $t('sidebar.subtask') }} {{ index + 1 }}</span>\n              <div class=\"step-actions\">\n                <button\n                  @click=\"moveStepUp(index)\"\n                  :disabled=\"index === 0\"\n                  class=\"btn btn-xs\"\n                  :title=\"$t('sidebar.moveUp')\"\n                >\n                  <Icon icon=\"carbon:chevron-up\" width=\"12\" />\n                </button>\n                <button\n                  @click=\"moveStepDown(index)\"\n                  :disabled=\"index === displayData.steps.length - 1\"\n                  class=\"btn btn-xs\"\n                  :title=\"$t('sidebar.moveDown')\"\n                >\n                  <Icon icon=\"carbon:chevron-down\" width=\"12\" />\n                </button>\n                <button\n                  @click=\"removeStep(index)\"\n                  class=\"btn btn-xs btn-danger\"\n                  :title=\"$t('sidebar.removeStep')\"\n                >\n                  <Icon icon=\"carbon:trash-can\" width=\"12\" />\n                </button>\n              </div>\n            </div>\n\n            <div class=\"step-content\">\n              <!-- Step Requirement -->\n              <div class=\"form-row\">\n                <label class=\"form-label\">{{ $t('sidebar.stepRequirement') }}</label>\n                <textarea\n                  v-model=\"step.stepRequirement\"\n                  class=\"form-textarea auto-resize\"\n                  :placeholder=\"$t('sidebar.stepRequirementPlaceholder')\"\n                  rows=\"4\"\n                  @input=\"autoResizeTextarea($event)\"\n                ></textarea>\n              </div>\n\n              <!-- Terminate Columns -->\n              <div class=\"form-row\">\n                <label class=\"form-label\">{{ $t('sidebar.terminateColumns') }}</label>\n\n                <textarea\n                  v-model=\"step.terminateColumns\"\n                  class=\"form-textarea auto-resize\"\n                  :placeholder=\"$t('sidebar.terminateColumnsPlaceholder')\"\n                  rows=\"4\"\n                  @input=\"autoResizeTextarea($event)\"\n                ></textarea>\n\n                <!-- Preview Section -->\n                <div\n                  v-if=\"step.terminateColumns && step.terminateColumns.trim()\"\n                  class=\"preview-section\"\n                >\n                  <div class=\"preview-label\">{{ $t('sidebar.preview') }}:</div>\n                  <div class=\"preview-content\">\n                    <div class=\"preview-text\">\n                      {{ $t('sidebar.systemWillReturnListWithTableHeaderFormat') }}:\n                      <span class=\"preview-table-header\">{{\n                        formatTableHeader(step.terminateColumns)\n                      }}</span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <!-- Model Name -->\n              <div class=\"form-row\">\n                <label class=\"form-label\">{{ $t('sidebar.modelName') }}</label>\n                <div class=\"model-selector-wrapper\">\n                  <div\n                    class=\"model-selector\"\n                    :class=\"{\n                      'is-open': isModelDropdownOpenForStep(index),\n                      'is-disabled': isLoadingModels,\n                    }\"\n                  >\n                    <!-- Input field with dropdown arrow -->\n                    <div class=\"model-input-wrapper\">\n                      <input\n                        :value=\"getModelDisplayValue(index)\"\n                        type=\"text\"\n                        class=\"form-input model-search-input\"\n                        :placeholder=\"getModelPlaceholder(index)\"\n                        :disabled=\"isLoadingModels\"\n                        @click.stop=\"openModelDropdown(index)\"\n                        @focus=\"openModelDropdown(index)\"\n                        @input=\"handleModelSearchInput($event, index)\"\n                        @keydown.escape=\"closeModelDropdown(index)\"\n                        @keydown.enter.prevent=\"selectFirstFilteredModel(index)\"\n                        @keydown.down.prevent=\"navigateModelDown(index)\"\n                        @keydown.up.prevent=\"navigateModelUp(index)\"\n                      />\n                      <Icon\n                        icon=\"carbon:chevron-down\"\n                        width=\"14\"\n                        class=\"dropdown-arrow\"\n                        :class=\"{ 'is-open': isModelDropdownOpenForStep(index) }\"\n                        @click.stop=\"toggleModelDropdown(index)\"\n                      />\n                    </div>\n\n                    <!-- Dropdown list -->\n                    <div\n                      v-if=\"isModelDropdownOpenForStep(index)\"\n                      class=\"model-dropdown\"\n                      @click.stop\n                    >\n                      <!-- Loading state -->\n                      <div v-if=\"isLoadingModels\" class=\"dropdown-item disabled\">\n                        {{ $t('sidebar.loading') }}\n                      </div>\n\n                      <!-- Error state -->\n                      <div v-else-if=\"modelsLoadError\" class=\"dropdown-item disabled error\">\n                        {{ $t('sidebar.modelLoadError') }}\n                      </div>\n\n                      <!-- No models found -->\n                      <div\n                        v-else-if=\"getFilteredModelsForStep(index).length === 0\"\n                        class=\"dropdown-item disabled\"\n                      >\n                        {{ $t('sidebar.noModelsFound') }}\n                      </div>\n\n                      <!-- Model options -->\n                      <div\n                        v-for=\"(model, idx) in getFilteredModelsForStep(index)\"\n                        :key=\"model.value\"\n                        class=\"dropdown-item\"\n                        :class=\"{\n                          'is-selected': step.modelName === model.value,\n                          'is-highlighted': getHighlightedIndex(index) === idx,\n                        }\"\n                        @click=\"selectModelForStep(model.value, index)\"\n                        @mouseenter=\"setHighlightedIndex(index, idx)\"\n                      >\n                        {{ model.value }}\n                        <Icon\n                          v-if=\"step.modelName === model.value\"\n                          icon=\"carbon:checkmark\"\n                          width=\"12\"\n                          class=\"check-icon\"\n                        />\n                      </div>\n\n                      <!-- Default empty option -->\n                      <div\n                        class=\"dropdown-item\"\n                        :class=\"{\n                          'is-selected': !step.modelName,\n                          'is-highlighted': getHighlightedIndex(index) === -1,\n                        }\"\n                        @click=\"selectModelForStep('', index)\"\n                        @mouseenter=\"setHighlightedIndex(index, -1)\"\n                      >\n                        {{ $t('sidebar.noModelSelected') }}\n                        <Icon\n                          v-if=\"!step.modelName\"\n                          icon=\"carbon:checkmark\"\n                          width=\"12\"\n                          class=\"check-icon\"\n                        />\n                      </div>\n                    </div>\n                  </div>\n\n                  <!-- Error refresh button -->\n                  <button\n                    v-if=\"modelsLoadError\"\n                    @click=\"loadAvailableModels\"\n                    class=\"btn btn-sm btn-danger\"\n                    :title=\"$t('sidebar.retryLoadModels')\"\n                  >\n                    <Icon icon=\"carbon:warning\" width=\"14\" />\n                    {{ $t('sidebar.retry') }}\n                  </button>\n                </div>\n\n                <!-- Error message -->\n                <div v-if=\"modelsLoadError\" class=\"error-message\">\n                  <Icon icon=\"carbon:warning\" width=\"12\" />\n                  {{ modelsLoadError }}\n                </div>\n              </div>\n\n              <!-- Tool Selection -->\n              <div class=\"form-row\">\n                <AssignedTools\n                  :title=\"$t('sidebar.selectedTools')\"\n                  :selected-tool-ids=\"step.selectedToolKeys\"\n                  :available-tools=\"sidebarStore.availableTools\"\n                  :add-button-text=\"$t('sidebar.addRemoveTools')\"\n                  :empty-text=\"$t('sidebar.noTools')\"\n                  :use-grid-layout=\"true\"\n                  @add-tools=\"showToolSelectionModal(index)\"\n                  @tools-filtered=\"\n                    (filteredTools: string[]) => handleToolsFiltered(index, filteredTools)\n                  \"\n                />\n              </div>\n            </div>\n          </div>\n\n          <!-- Empty State -->\n          <div v-if=\"displayData.steps.length === 0\" class=\"empty-steps\">\n            <Icon icon=\"carbon:add-alt\" width=\"32\" class=\"empty-icon\" />\n            <p>{{ $t('sidebar.noSteps') }}</p>\n            <button @click=\"addStep\" class=\"btn btn-primary\">\n              <Icon icon=\"carbon:add\" width=\"14\" />\n              {{ $t('sidebar.addFirstStep') }}\n            </button>\n          </div>\n        </div>\n      </div>\n\n      <!-- JSON Preview (Optional) -->\n      <div class=\"json-preview\" v-if=\"showJsonPreview\">\n        <div class=\"preview-header\">\n          <label class=\"form-label\">{{ $t('sidebar.jsonPreview') }}</label>\n          <button @click=\"closeJsonPreview\" class=\"btn btn-xs\">\n            <Icon icon=\"carbon:close\" width=\"12\" />\n          </button>\n        </div>\n        <pre class=\"json-code\">{{ formattedJsonOutput }}</pre>\n      </div>\n\n      <!-- Toggle JSON Preview -->\n      <div class=\"editor-footer\">\n        <button @click=\"toggleJsonPreview\" class=\"btn btn-sm btn-secondary\">\n          <Icon icon=\"carbon:code\" width=\"14\" />\n          {{ showJsonPreview ? $t('sidebar.hideJson') : $t('sidebar.showJson') }}\n        </button>\n        <div class=\"section-actions\">\n          <button\n            class=\"btn btn-sm\"\n            @click=\"handleCopyPlan\"\n            :disabled=\"isGenerating || isExecuting\"\n            :title=\"$t('sidebar.copyPlan')\"\n          >\n            <Icon icon=\"carbon:copy\" width=\"14\" />\n            {{ $t('sidebar.copyPlan') }}\n          </button>\n          <button\n            class=\"btn btn-sm\"\n            @click=\"handleRollback\"\n            :disabled=\"!(canRollback ?? false)\"\n            :title=\"$t('sidebar.rollback')\"\n          >\n            <Icon icon=\"carbon:undo\" width=\"14\" />\n          </button>\n          <button\n            class=\"btn btn-sm\"\n            @click=\"handleRestore\"\n            :disabled=\"!(canRestore ?? false)\"\n            :title=\"$t('sidebar.restore')\"\n          >\n            <Icon icon=\"carbon:redo\" width=\"14\" />\n          </button>\n          <button\n            class=\"btn btn-primary\"\n            @click=\"handleSave\"\n            :disabled=\"isGenerating || isExecuting\"\n          >\n            <Icon icon=\"carbon:save\" width=\"14\" />\n            Save\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <!-- Tool Selection Modal -->\n    <ToolSelectionModal\n      v-model=\"showToolModal\"\n      :tools=\"sidebarStore.availableTools\"\n      :selected-tool-ids=\"\n        currentStepIndex >= 0 ? displayData.steps[currentStepIndex]?.selectedToolKeys || [] : []\n      \"\n      @confirm=\"handleToolSelectionConfirm\"\n    />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ConfigApiService, type ModelOption } from '@/api/config-api-service'\nimport AssignedTools from '@/components/shared/AssignedTools.vue'\nimport ToolSelectionModal from '@/components/tool-selection-modal/ToolSelectionModal.vue'\nimport { sidebarStore } from '@/stores/sidebar'\nimport { Icon } from '@iconify/vue'\nimport { onMounted, onUnmounted, ref, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { useJsonEditor, type JsonEditorProps } from './json-editor-logic'\n\nconst { t } = useI18n()\n\n// Define props interface specific to JsonEditorV2\ninterface JsonEditorV2Props {\n  // eslint-disable-next-line vue/no-unused-properties\n  jsonContent: string\n  canRollback: boolean\n  canRestore: boolean\n  isGenerating: boolean\n  isExecuting: boolean\n  currentPlanTemplateId: string\n}\n\n// Props\nconst props = withDefaults(defineProps<JsonEditorV2Props>(), {\n  currentPlanTemplateId: '',\n})\n\n// Emits\nconst emit = defineEmits<{\n  rollback: []\n  restore: []\n  save: []\n  'copy-plan': []\n  'update:jsonContent': [value: string]\n}>()\n\n// Create compatible props object for useJsonEditor\nconst compatibleProps: JsonEditorProps = {\n  ...props,\n  hiddenFields: [],\n}\n\nconst {\n  showJsonPreview,\n  displayData,\n  formattedJsonOutput,\n  addStep,\n  removeStep,\n  moveStepUp,\n  moveStepDown,\n  handleRollback,\n  handleRestore,\n  handleSave,\n  toggleJsonPreview,\n  closeJsonPreview,\n} = useJsonEditor(compatibleProps, emit)\n\n// Error state\nconst planTypeError = ref<string | null>(null)\nconst titleError = ref<string>('')\n\n// Model selection state\nconst availableModels = ref<ModelOption[]>([])\nconst isLoadingModels = ref(false)\nconst modelsLoadError = ref<string>('')\n\n// Per-step state for dropdown (stepIndex -> state)\nconst modelSearchFilters = ref<Map<number, string>>(new Map())\nconst openDropdownSteps = ref<Set<number>>(new Set())\nconst highlightedIndices = ref<Map<number, number>>(new Map())\n\n// Get search filter for a specific step\nconst getSearchFilter = (stepIndex: number): string => {\n  return modelSearchFilters.value.get(stepIndex) ?? ''\n}\n\n// Set search filter for a specific step\nconst setSearchFilter = (stepIndex: number, value: string) => {\n  modelSearchFilters.value.set(stepIndex, value)\n}\n\n// Filtered models based on search for a specific step\nconst getFilteredModelsForStep = (stepIndex: number) => {\n  const filter = getSearchFilter(stepIndex)\n  if (!filter.trim()) {\n    return availableModels.value\n  }\n  const searchTerm = filter.toLowerCase().trim()\n  return availableModels.value.filter(\n    model =>\n      model.value.toLowerCase().includes(searchTerm) ||\n      model.label.toLowerCase().includes(searchTerm)\n  )\n}\n\n// Get display value for a specific step\nconst getModelDisplayValue = (stepIndex: number): string => {\n  const step = displayData.steps[stepIndex]\n  const filter = getSearchFilter(stepIndex)\n  if (openDropdownSteps.value.has(stepIndex) && filter !== '') {\n    return filter\n  }\n  return step.modelName ?? ''\n}\n\n// Get placeholder text based on selected model\nconst getModelPlaceholder = (stepIndex: number) => {\n  if (isLoadingModels.value) {\n    return ''\n  }\n  if (modelsLoadError.value) {\n    return ''\n  }\n  const step = displayData.steps[stepIndex]\n  if (step.modelName) {\n    return ''\n  }\n  return (t('sidebar.modelNameDescription') as string) || ''\n}\n\n// Check if dropdown is open for a specific step\nconst isModelDropdownOpenForStep = (stepIndex: number): boolean => {\n  return openDropdownSteps.value.has(stepIndex)\n}\n\n// Model dropdown functions\nconst openModelDropdown = (stepIndex: number) => {\n  if (!isLoadingModels.value) {\n    openDropdownSteps.value.add(stepIndex)\n  }\n}\n\nconst closeModelDropdown = (stepIndex: number) => {\n  openDropdownSteps.value.delete(stepIndex)\n  highlightedIndices.value.set(stepIndex, -1)\n  // Reset search filter to selected model name\n  const step = displayData.steps[stepIndex]\n  setSearchFilter(stepIndex, step.modelName ?? '')\n}\n\nconst toggleModelDropdown = (stepIndex: number) => {\n  if (isModelDropdownOpenForStep(stepIndex)) {\n    closeModelDropdown(stepIndex)\n  } else {\n    openModelDropdown(stepIndex)\n  }\n}\n\nconst selectModelForStep = (modelName: string, stepIndex: number) => {\n  const step = displayData.steps[stepIndex]\n  step.modelName = modelName\n  setSearchFilter(stepIndex, modelName)\n  closeModelDropdown(stepIndex)\n}\n\n// Handle search input\nconst handleModelSearchInput = (event: Event, stepIndex: number) => {\n  const target = event.target as HTMLInputElement\n  setSearchFilter(stepIndex, target.value)\n  openModelDropdown(stepIndex)\n}\n\n// Get highlighted index for a step\nconst getHighlightedIndex = (stepIndex: number): number => {\n  return highlightedIndices.value.get(stepIndex) ?? -1\n}\n\n// Set highlighted index for a step\nconst setHighlightedIndex = (stepIndex: number, index: number) => {\n  highlightedIndices.value.set(stepIndex, index)\n}\n\n// Keyboard navigation\nconst selectFirstFilteredModel = (stepIndex: number) => {\n  const highlightedIndex = getHighlightedIndex(stepIndex)\n  const filtered = getFilteredModelsForStep(stepIndex)\n\n  // If a specific item is highlighted, select it\n  if (highlightedIndex >= 0 && highlightedIndex < filtered.length) {\n    selectModelForStep(filtered[highlightedIndex].value, stepIndex)\n  } else if (highlightedIndex === -1) {\n    // Select empty option\n    selectModelForStep('', stepIndex)\n  } else if (filtered.length > 0) {\n    // Fallback to first item\n    selectModelForStep(filtered[0].value, stepIndex)\n  } else {\n    const step = displayData.steps[stepIndex]\n    if (!step.modelName) {\n      selectModelForStep('', stepIndex)\n    }\n  }\n}\n\nconst navigateModelDown = (stepIndex: number) => {\n  if (!isModelDropdownOpenForStep(stepIndex)) {\n    openModelDropdown(stepIndex)\n    setHighlightedIndex(stepIndex, 0)\n    return\n  }\n  const filtered = getFilteredModelsForStep(stepIndex)\n  const totalItems = filtered.length + 1 // +1 for \"no model selected\" option\n  const currentIndex = getHighlightedIndex(stepIndex)\n  const newIndex = Math.min(currentIndex + 1, totalItems - 1)\n  setHighlightedIndex(stepIndex, newIndex)\n}\n\nconst navigateModelUp = (stepIndex: number) => {\n  if (!isModelDropdownOpenForStep(stepIndex)) {\n    openModelDropdown(stepIndex)\n    const filtered = getFilteredModelsForStep(stepIndex)\n    setHighlightedIndex(stepIndex, filtered.length)\n    return\n  }\n  const currentIndex = getHighlightedIndex(stepIndex)\n  const newIndex = Math.max(currentIndex - 1, -1)\n  setHighlightedIndex(stepIndex, newIndex)\n}\n\n// Click outside to close dropdown\nconst handleClickOutside = (event: MouseEvent) => {\n  const target = event.target as HTMLElement\n  // Check if click is inside any model selector\n  const modelSelector = target.closest('.model-selector')\n  if (!modelSelector) {\n    // Close all open dropdowns\n    openDropdownSteps.value.clear()\n  }\n}\n\n// Initialize search filters when steps change\nwatch(\n  () => displayData.steps,\n  newSteps => {\n    newSteps.forEach((step, index) => {\n      if (!modelSearchFilters.value.has(index)) {\n        setSearchFilter(index, step.modelName ?? '')\n      }\n    })\n  },\n  { deep: true, immediate: true }\n)\n\n// Tool selection state - use sidebar store's availableTools\nconst showToolModal = ref(false)\nconst currentStepIndex = ref<number>(-1)\n\n// Load available models\nconst loadAvailableModels = async () => {\n  if (isLoadingModels.value) return\n\n  isLoadingModels.value = true\n  modelsLoadError.value = ''\n\n  try {\n    const response = await ConfigApiService.getAvailableModels()\n    availableModels.value = response.options\n  } catch (error) {\n    console.error('Failed to load models:', error)\n    modelsLoadError.value = error instanceof Error ? error.message : 'Failed to load models'\n    availableModels.value = []\n  } finally {\n    isLoadingModels.value = false\n  }\n}\n\n// Available tools are now loaded from sidebar store\n\n// Tool selection functions\nconst showToolSelectionModal = (stepIndex: number) => {\n  currentStepIndex.value = stepIndex\n  showToolModal.value = true\n  console.log('[JsonEditorV2] Available tools from store:', sidebarStore.availableTools)\n}\n\nconst handleToolSelectionConfirm = (selectedToolIds: string[]) => {\n  if (currentStepIndex.value >= 0 && currentStepIndex.value < displayData.steps.length) {\n    // Update the specific step's selected tool keys\n    displayData.steps[currentStepIndex.value].selectedToolKeys = [...selectedToolIds]\n  }\n  showToolModal.value = false\n  currentStepIndex.value = -1\n}\n\nconst handleToolsFiltered = (stepIndex: number, filteredTools: string[]) => {\n  if (stepIndex >= 0 && stepIndex < displayData.steps.length) {\n    // Update the step's selected tool keys with filtered tools\n    displayData.steps[stepIndex].selectedToolKeys = [...filteredTools]\n  }\n}\n\n// Copy plan function\nconst handleCopyPlan = () => {\n  emit('copy-plan')\n}\n\n// Initialize parsedData with default structure\nconst initializeParsedData = () => {\n  try {\n    // Clear any previous errors\n    planTypeError.value = null\n\n    // Initialize with default structure if not exists\n    if (!displayData.title) {\n      displayData.title = ''\n    }\n    displayData.directResponse = false // Always false for dynamic agent planning\n  } catch (error) {\n    const errorMessage = `Failed to initialize JsonEditorV2: ${error instanceof Error ? error.message : 'Unknown error'}`\n    planTypeError.value = errorMessage\n    console.error(errorMessage, error)\n  }\n}\n\n// Watch for parsedData changes to validate structure\nwatch(\n  () => displayData,\n  newData => {\n    try {\n      // Soft validation for title - show warning but don't block the form\n      if (!newData.title.trim()) {\n        titleError.value = 'Title is required field'\n      } else {\n        titleError.value = ''\n      }\n\n      // Clear any structural errors\n      planTypeError.value = null\n    } catch (error) {\n      planTypeError.value = `Invalid data structure: ${error instanceof Error ? error.message : 'Unknown error'}`\n      titleError.value = ''\n    }\n  },\n  { immediate: true, deep: true }\n)\n\n// Watch for props changes\nwatch(\n  () => props.jsonContent,\n  (newContent, oldContent) => {\n    console.log(\n      '[JsonEditorV2] Props watch triggered - jsonContent changed from',\n      oldContent,\n      'to',\n      newContent\n    )\n    if (newContent && newContent !== oldContent) {\n      console.log('[JsonEditorV2] Force parsing new jsonContent:', newContent)\n      try {\n        const parsed = JSON.parse(newContent)\n        console.log('[JsonEditorV2] Parsed new jsonContent:', parsed)\n        Object.assign(displayData, {\n          title: parsed.title || '',\n          steps: parsed.steps || [],\n          directResponse: false,\n          planTemplateId: parsed.planTemplateId || props.currentPlanTemplateId || '',\n          planType: parsed.planType || 'dynamic_agent',\n        })\n        console.log('[JsonEditorV2] Updated displayData with new content:', displayData)\n      } catch (error) {\n        console.warn('[JsonEditorV2] Failed to parse new jsonContent:', error)\n      }\n    }\n  },\n  { immediate: true }\n)\n\n// Initialize on mount\nonMounted(() => {\n  console.log('[JsonEditorV2] Component mounted with jsonContent:', props.jsonContent)\n  console.log(\n    '[JsonEditorV2] Component mounted with currentPlanTemplateId:',\n    props.currentPlanTemplateId\n  )\n  console.log('[JsonEditorV2] Component mounted with displayData:', displayData)\n\n  // Force parse the current jsonContent to ensure it's processed\n  if (props.jsonContent) {\n    console.log('[JsonEditorV2] Force parsing jsonContent on mount:', props.jsonContent)\n    // Call parseJsonToVisual directly to ensure it's processed\n    try {\n      const parsed = JSON.parse(props.jsonContent)\n      console.log('[JsonEditorV2] Parsed jsonContent on mount:', parsed)\n      Object.assign(displayData, {\n        title: parsed.title || '',\n        steps: parsed.steps || [],\n        directResponse: false,\n        planTemplateId: parsed.planTemplateId || props.currentPlanTemplateId || '',\n        planType: parsed.planType || 'dynamic_agent',\n      })\n      console.log('[JsonEditorV2] Updated displayData on mount:', displayData)\n    } catch (error) {\n      console.warn('[JsonEditorV2] Failed to parse jsonContent on mount:', error)\n    }\n  }\n\n  initializeParsedData()\n  loadAvailableModels()\n\n  // Add click outside listener\n  document.addEventListener('click', handleClickOutside)\n})\n\nonUnmounted(() => {\n  // Remove click outside listener\n  document.removeEventListener('click', handleClickOutside)\n})\n\nconst autoResizeTextarea = (event: Event) => {\n  const textarea = event.target as HTMLTextAreaElement\n\n  textarea.style.height = 'auto'\n\n  const lineHeight = 20\n  const lines = Math.ceil(textarea.scrollHeight / lineHeight)\n\n  const minRows = 4\n  const maxRows = 12\n  const targetRows = Math.max(minRows, Math.min(maxRows, lines))\n\n  const newHeight = targetRows * lineHeight\n  textarea.style.height = `${newHeight}px`\n  textarea.rows = targetRows\n\n  if (lines > maxRows) {\n    textarea.style.overflowY = 'auto'\n  } else {\n    textarea.style.overflowY = 'hidden'\n  }\n}\n\n// Format table header preview\nconst formatTableHeader = (terminateColumns: string): string => {\n  if (!terminateColumns.trim()) {\n    return ''\n  }\n\n  // Split by comma and clean up each column name\n  const columns = terminateColumns\n    .split(',')\n    .map(col => col.trim())\n    .filter(col => col.length > 0)\n\n  if (columns.length === 0) {\n    return ''\n  }\n\n  // Format as |col1|col2|col3|\n  return `|${columns.join('|')}|`\n}\n</script>\n\n<style scoped>\n.config-section {\n  margin-bottom: 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n  padding: 12px;\n}\n\n.section-header {\n  display: flex;\n  align-items: center;\n  margin-bottom: 12px;\n  color: #667eea;\n  font-size: 13px;\n  font-weight: 600;\n  gap: 8px;\n}\n\n.section-actions {\n  margin-left: auto;\n  display: flex;\n  gap: 6px;\n}\n\n/* Error Section Styles */\n.error-section {\n  margin-bottom: 16px;\n  background: rgba(239, 68, 68, 0.1);\n  border: 1px solid rgba(239, 68, 68, 0.3);\n  border-radius: 8px;\n  padding: 16px;\n}\n\n.error-message {\n  display: flex;\n  align-items: flex-start;\n  gap: 12px;\n  color: #ef4444;\n}\n\n.error-content {\n  flex: 1;\n}\n\n.error-title {\n  font-weight: 600;\n  font-size: 14px;\n  margin-bottom: 4px;\n}\n\n.error-description {\n  font-size: 12px;\n  color: rgba(239, 68, 68, 0.8);\n  line-height: 1.4;\n}\n\n/* Visual Editor Styles */\n.visual-editor {\n  background: rgba(0, 0, 0, 0.2);\n  border-radius: 8px;\n  padding: 16px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.plan-basic-info {\n  margin-bottom: 20px;\n  padding-bottom: 16px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.form-row {\n  margin-bottom: 12px;\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.form-label {\n  font-size: 10px;\n  font-weight: 600;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.form-input,\n.form-select,\n.form-textarea {\n  padding: 8px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(0, 0, 0, 0.3);\n  color: white;\n  font-size: 11px;\n  font-family: inherit;\n  transition: all 0.2s ease;\n}\n\n.form-input:focus,\n.form-select:focus,\n.form-textarea:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n}\n\n/* Error state for form inputs */\n.form-input.error,\n.form-select.error,\n.form-textarea.error {\n  border-color: #ef4444;\n  box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.2);\n}\n\n/* Field error message */\n.field-error-message {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  font-size: 10px;\n  color: #ef4444;\n  margin-top: 4px;\n  padding: 4px 8px;\n  background: rgba(239, 68, 68, 0.1);\n  border-radius: 4px;\n  border: 1px solid rgba(239, 68, 68, 0.2);\n}\n\n.readonly-input {\n  background: rgba(255, 255, 255, 0.02);\n  border: 1px solid rgba(255, 255, 255, 0.05);\n  color: rgba(255, 255, 255, 0.6);\n  cursor: not-allowed;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  font-size: 12px;\n}\n\n.readonly-input:focus {\n  border-color: rgba(255, 255, 255, 0.05);\n  box-shadow: none;\n}\n\n.form-textarea {\n  resize: vertical;\n  min-height: 80px;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  line-height: 1.4;\n}\n\n.form-textarea.auto-resize {\n  resize: none;\n  transition: height 0.2s ease;\n  overflow-y: auto;\n  max-height: 240px;\n}\n\n/* Model Selector Styles */\n.model-selector-wrapper {\n  display: flex;\n  gap: 8px;\n  align-items: flex-start;\n}\n\n.model-selector {\n  position: relative;\n  flex: 1;\n}\n\n.model-input-wrapper {\n  position: relative;\n  display: flex;\n  align-items: center;\n}\n\n.model-search-input {\n  flex: 1;\n  padding-right: 32px;\n}\n\n.dropdown-arrow {\n  position: absolute;\n  right: 12px;\n  color: rgba(255, 255, 255, 0.5);\n  pointer-events: none;\n  transition: transform 0.2s ease;\n}\n\n.dropdown-arrow.is-open {\n  transform: rotate(180deg);\n}\n\n.model-dropdown {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  right: 0;\n  margin-top: 4px;\n  background: rgba(0, 0, 0, 0.95);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  max-height: 200px;\n  overflow-y: auto;\n  z-index: 1000;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n}\n\n.dropdown-item {\n  padding: 8px 12px;\n  font-size: 11px;\n  color: rgba(255, 255, 255, 0.9);\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  transition: all 0.2s ease;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.05);\n}\n\n.dropdown-item:last-child {\n  border-bottom: none;\n}\n\n.dropdown-item:hover,\n.dropdown-item.is-highlighted {\n  background: rgba(102, 126, 234, 0.2);\n  color: white;\n}\n\n.dropdown-item.is-selected {\n  background: rgba(102, 126, 234, 0.15);\n  color: #667eea;\n  font-weight: 500;\n}\n\n.dropdown-item.disabled {\n  color: rgba(255, 255, 255, 0.5);\n  cursor: not-allowed;\n  font-style: italic;\n}\n\n.dropdown-item.disabled.error {\n  color: #ef4444;\n}\n\n.check-icon {\n  color: #667eea;\n  margin-left: 8px;\n}\n\n.model-selector.is-disabled .model-search-input {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.tool-keys-display {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n  min-height: 32px;\n  padding: 8px;\n  background: rgba(0, 0, 0, 0.3);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n}\n\n.tool-key-item {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n}\n\n.tool-key-input {\n  flex: 1;\n  font-size: 10px;\n}\n\n.remove-tool-key-btn {\n  width: 20px;\n  height: 20px;\n  background: transparent;\n  border: none;\n  border-radius: 2px;\n  color: rgba(255, 255, 255, 0.6);\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s ease;\n}\n\n.remove-tool-key-btn:hover {\n  background: rgba(239, 68, 68, 0.2);\n  color: #ef4444;\n}\n\n.no-tool-keys {\n  color: rgba(255, 255, 255, 0.5);\n  font-size: 10px;\n  font-style: italic;\n  text-align: center;\n  padding: 8px;\n}\n\n.btn-add-tool-key {\n  background: linear-gradient(135deg, #10b981 0%, #059669 100%);\n  color: white;\n  align-self: flex-start;\n}\n\n.btn-add-tool-key:hover:not(:disabled) {\n  background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);\n  box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);\n}\n\n/* Steps Section */\n.steps-section {\n  margin-bottom: 20px;\n}\n\n.steps-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 16px;\n}\n\n.steps-actions {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.agent-count-badge {\n  font-size: 10px;\n  color: rgba(255, 255, 255, 0.6);\n  background: rgba(255, 255, 255, 0.1);\n  padding: 2px 6px;\n  border-radius: 4px;\n}\n\n.error-badge {\n  font-size: 10px;\n  color: #ef4444;\n  background: rgba(239, 68, 68, 0.1);\n  padding: 2px 6px;\n  border-radius: 4px;\n  border: 1px solid rgba(239, 68, 68, 0.2);\n  display: flex;\n  align-items: center;\n  gap: 2px;\n}\n\n.error-message {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  font-size: 10px;\n  color: #ef4444;\n  margin-top: 4px;\n  padding: 4px 8px;\n  background: rgba(239, 68, 68, 0.1);\n  border-radius: 4px;\n  border: 1px solid rgba(239, 68, 68, 0.2);\n}\n\n.steps-container {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.step-item {\n  background: rgba(0, 0, 0, 0.3);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  overflow: hidden;\n}\n\n.step-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 9px 16px;\n  background: rgba(102, 126, 234, 0.1);\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.step-number {\n  font-weight: 600;\n  color: #667eea;\n  font-size: 11px;\n  min-width: 20px;\n}\n\n.step-actions {\n  display: flex;\n  gap: 4px;\n}\n\n.step-content {\n  padding: 16px;\n}\n\n.agent-selector {\n  display: flex;\n  gap: 8px;\n  align-items: center;\n}\n\n.agent-select {\n  flex: 1;\n}\n\n.btn-add-step {\n  padding: 6px 8px;\n  min-width: auto;\n}\n\n/* Empty State */\n.empty-steps {\n  text-align: center;\n  padding: 40px 20px;\n  color: rgba(255, 255, 255, 0.6);\n}\n\n.empty-icon {\n  color: rgba(255, 255, 255, 0.3);\n  margin-bottom: 12px;\n}\n\n/* JSON Preview */\n.json-preview {\n  margin-bottom: 16px;\n  background: rgba(0, 0, 0, 0.4);\n  border-radius: 6px;\n  overflow: hidden;\n}\n\n.preview-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 8px 12px;\n  background: rgba(255, 255, 255, 0.05);\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.json-code {\n  padding: 12px;\n  margin: 0;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  font-size: 10px;\n  color: rgba(255, 255, 255, 0.8);\n  background: transparent;\n  overflow-x: auto;\n  white-space: pre-wrap;\n  word-break: break-word;\n}\n\n.editor-footer {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding-top: 12px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n/* Button Styles */\n.btn {\n  padding: 6px 12px;\n  border: none;\n  border-radius: 4px;\n  font-size: 12px;\n  font-weight: 500;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 6px;\n  transition: all 0.2s ease;\n  background: rgba(255, 255, 255, 0.1);\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.btn:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.2);\n  color: white;\n  transform: translateY(-1px);\n}\n\n.btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n  transform: none !important;\n  box-shadow: none !important;\n}\n\n.btn-sm {\n  padding: 4px 8px;\n  font-size: 11px;\n}\n\n.btn-xs {\n  padding: 2px 4px;\n  font-size: 10px;\n  min-width: auto;\n}\n\n.btn-primary {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: white;\n}\n\n.btn-primary:hover:not(:disabled) {\n  background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);\n  box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);\n}\n\n.btn-secondary {\n  background: rgba(255, 255, 255, 0.05);\n  color: rgba(255, 255, 255, 0.7);\n}\n\n.btn-danger {\n  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);\n  color: white;\n}\n\n.btn-danger:hover:not(:disabled) {\n  background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);\n  box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);\n}\n\n/* Preview Section Styles */\n.preview-section {\n  margin-top: 8px;\n  padding: 8px 12px;\n  background: rgba(102, 126, 234, 0.1);\n  border: 1px solid rgba(102, 126, 234, 0.2);\n  border-radius: 6px;\n  font-size: 10px;\n}\n\n.preview-label {\n  font-weight: 600;\n  color: #667eea;\n  margin-bottom: 4px;\n  font-size: 9px;\n}\n\n.preview-content {\n  color: white;\n}\n\n.preview-text {\n  line-height: 1.4;\n  color: white;\n}\n\n.preview-table-header {\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  background: rgba(0, 0, 0, 0.3);\n  padding: 2px 6px;\n  border-radius: 3px;\n  color: #ef4444;\n  font-weight: 600;\n  border: 1px solid rgba(239, 68, 68, 0.3);\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div\n    class=\"sidebar-wrapper\"\n    :class=\"{ 'sidebar-wrapper-collapsed': sidebarStore.isCollapsed }\"\n    :style=\"{ width: sidebarWidth + '%' }\"\n  >\n    <div class=\"sidebar-content\">\n      <div class=\"sidebar-content-header\">\n        <div class=\"sidebar-content-title\">{{ $t('sidebar.title') }}</div>\n      </div>\n\n      <!-- Tab Switcher -->\n      <div class=\"tab-switcher\">\n        <button\n          class=\"tab-button\"\n          :class=\"{ active: sidebarStore.currentTab === 'list' }\"\n          @click=\"sidebarStore.switchToTab('list')\"\n        >\n          <Icon icon=\"carbon:list\" width=\"16\" />\n          {{ $t('sidebar.templateList') }}\n        </button>\n        <button\n          class=\"tab-button\"\n          :class=\"{ active: sidebarStore.currentTab === 'config' }\"\n          @click=\"sidebarStore.switchToTab('config')\"\n          :disabled=\"!sidebarStore.selectedTemplate\"\n        >\n          <Icon icon=\"carbon:settings\" width=\"16\" />\n          {{ $t('sidebar.configuration') }}\n        </button>\n      </div>\n\n      <!-- List Tab Content -->\n      <div v-if=\"sidebarStore.currentTab === 'list'\" class=\"tab-content\">\n        <div class=\"new-task-section\">\n          <button\n            class=\"new-task-btn\"\n            @click=\"() => sidebarStore.createNewTemplate(sidebarStore.planType)\"\n          >\n            <Icon icon=\"carbon:add\" width=\"16\" />\n            {{ $t('sidebar.newPlan') }}\n            <span class=\"shortcut\"> K</span>\n          </button>\n        </div>\n\n        <div class=\"sidebar-content-list\">\n          <!-- Loading state -->\n          <div v-if=\"sidebarStore.isLoading\" class=\"loading-state\">\n            <Icon icon=\"carbon:circle-dash\" width=\"20\" class=\"spinning\" />\n            <span>{{ $t('sidebar.loading') }}</span>\n          </div>\n\n          <!-- Error state -->\n          <div v-else-if=\"sidebarStore.errorMessage\" class=\"error-state\">\n            <Icon icon=\"carbon:warning\" width=\"20\" />\n            <span>{{ sidebarStore.errorMessage }}</span>\n            <button @click=\"sidebarStore.loadPlanTemplateList\" class=\"retry-btn\">\n              {{ $t('sidebar.retry') }}\n            </button>\n          </div>\n\n          <!-- Empty state -->\n          <div v-else-if=\"sidebarStore.planTemplateList.length === 0\" class=\"empty-state\">\n            <Icon icon=\"carbon:document\" width=\"32\" />\n            <span>{{ $t('sidebar.noTemplates') }}</span>\n          </div>\n\n          <!-- Plan template list -->\n          <div\n            v-else\n            v-for=\"template in sidebarStore.sortedTemplates\"\n            :key=\"template.id\"\n            class=\"sidebar-content-list-item\"\n            :class=\"{\n              'sidebar-content-list-item-active':\n                template.id === sidebarStore.currentPlanTemplateId,\n            }\"\n            @click=\"sidebarStore.selectTemplate(template)\"\n          >\n            <div class=\"task-icon\">\n              <Icon icon=\"carbon:document\" width=\"20\" />\n            </div>\n            <div class=\"task-details\">\n              <div class=\"task-title\">{{ template.title || $t('sidebar.unnamedPlan') }}</div>\n              <div class=\"task-preview\">\n                {{ getTaskPreviewText(template) }}\n              </div>\n            </div>\n            <div class=\"task-time\">\n              {{\n                getRelativeTimeString(\n                  sidebarStore.parseDateTime(template.updateTime || template.createTime)\n                )\n              }}\n            </div>\n            <div class=\"task-actions\">\n              <button\n                class=\"delete-task-btn\"\n                :title=\"$t('sidebar.deleteTemplate')\"\n                @click.stop=\"sidebarStore.deleteTemplate(template)\"\n              >\n                <Icon icon=\"carbon:close\" width=\"16\" />\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Config Tab Content -->\n      <div v-else-if=\"sidebarStore.currentTab === 'config'\" class=\"tab-content config-tab\">\n        <div v-if=\"sidebarStore.selectedTemplate\" class=\"config-container\">\n          <!-- Template Info Header -->\n          <div class=\"template-info-header\">\n            <div class=\"template-info\">\n              <h3>{{ sidebarStore.selectedTemplate.title || $t('sidebar.unnamedPlan') }}</h3>\n              <span class=\"template-id\">ID: {{ sidebarStore.selectedTemplate.id }}</span>\n            </div>\n            <button class=\"back-to-list-btn\" @click=\"sidebarStore.switchToTab('list')\">\n              <Icon icon=\"carbon:arrow-left\" width=\"16\" />\n            </button>\n          </div>\n\n          <!-- Section 2: JSON Editor (Conditional based on plan type) -->\n          <!-- Use JsonEditorV2 for dynamic_agent type -->\n          <JsonEditorV2\n            v-if=\"sidebarStore.planType === 'dynamic_agent'\"\n            :key=\"sidebarStore.currentPlanTemplateId || 'default'\"\n            :json-content=\"sidebarStore.jsonContent\"\n            :can-rollback=\"sidebarStore.canRollback\"\n            :can-restore=\"sidebarStore.canRestore\"\n            :is-generating=\"sidebarStore.isGenerating\"\n            :is-executing=\"sidebarStore.isExecuting\"\n            :current-plan-template-id=\"sidebarStore.currentPlanTemplateId || ''\"\n            @rollback=\"handleRollback\"\n            @restore=\"handleRestore\"\n            @save=\"handleSaveTemplate\"\n            @copy-plan=\"handleCopyPlan\"\n            @update:json-content=\"(value: string) => (sidebarStore.jsonContent = value)\"\n          />\n\n          <!-- Use JsonEditor for simple or other types -->\n          <JsonEditor\n            v-else\n            :key=\"'simple-' + (sidebarStore.currentPlanTemplateId || 'default')\"\n            :json-content=\"sidebarStore.jsonContent\"\n            :can-rollback=\"sidebarStore.canRollback\"\n            :can-restore=\"sidebarStore.canRestore\"\n            :is-generating=\"sidebarStore.isGenerating\"\n            :is-executing=\"sidebarStore.isExecuting\"\n            :current-plan-template-id=\"sidebarStore.currentPlanTemplateId || ''\"\n            @rollback=\"handleRollback\"\n            @restore=\"handleRestore\"\n            @save=\"handleSaveTemplate\"\n            @update:json-content=\"(value: string) => (sidebarStore.jsonContent = value)\"\n          />\n\n          <!-- Section 3: Execution Controller -->\n          <ExecutionController\n            ref=\"executionControllerRef\"\n            :current-plan-template-id=\"sidebarStore.currentPlanTemplateId || ''\"\n            :is-executing=\"sidebarStore.isExecuting\"\n            :is-generating=\"sidebarStore.isGenerating\"\n            :show-publish-button=\"showPublishButton\"\n            :tool-info=\"currentToolInfo\"\n            @execute-plan=\"handleExecutePlan\"\n            @publish-mcp-service=\"handlePublishMcpService\"\n            @clear-params=\"handleClearExecutionParams\"\n            @update-execution-params=\"handleUpdateExecutionParams\"\n          />\n        </div>\n      </div>\n    </div>\n\n    <!-- Sidebar Resizer -->\n    <div\n      class=\"sidebar-resizer\"\n      @mousedown=\"startResize\"\n      @dblclick=\"resetSidebarWidth\"\n      :title=\"$t('sidebar.resizeHint')\"\n    >\n      <div class=\"resizer-line\"></div>\n    </div>\n  </div>\n\n  <!-- Publish MCP Service Modal -->\n  <PublishServiceModal\n    ref=\"publishMcpModalRef\"\n    v-model=\"showPublishMcpModal\"\n    :plan-template-id=\"sidebarStore.currentPlanTemplateId || ''\"\n    :plan-description=\"sidebarStore.selectedTemplate?.description || ''\"\n    @published=\"handleMcpServicePublished\"\n  />\n\n  <!-- Copy Plan Modal -->\n  <div v-if=\"showCopyPlanModal\" class=\"modal-overlay\" @click=\"closeCopyPlanModal\">\n    <div class=\"modal-content\" @click.stop>\n      <div class=\"modal-header\">\n        <h3>{{ $t('sidebar.copyPlan') }}</h3>\n        <button class=\"close-btn\" @click=\"closeCopyPlanModal\">\n          <Icon icon=\"carbon:close\" width=\"16\" />\n        </button>\n      </div>\n      <div class=\"modal-body\">\n        <div class=\"form-row\">\n          <label class=\"form-label\">{{ $t('sidebar.newPlanTitle') }}</label>\n          <input\n            v-model=\"newPlanTitle\"\n            type=\"text\"\n            class=\"form-input\"\n            :placeholder=\"$t('sidebar.enterNewPlanTitle')\"\n            @keyup.enter=\"confirmCopyPlan\"\n          />\n        </div>\n      </div>\n      <div class=\"modal-footer\">\n        <button class=\"btn btn-secondary\" @click=\"closeCopyPlanModal\">\n          {{ $t('common.cancel') }}\n        </button>\n        <button\n          class=\"btn btn-primary\"\n          @click=\"confirmCopyPlan\"\n          :disabled=\"!newPlanTitle.trim() || isCopyingPlan\"\n        >\n          <Icon v-if=\"isCopyingPlan\" icon=\"carbon:loading\" width=\"16\" class=\"spinning\" />\n          {{ isCopyingPlan ? $t('sidebar.copying') : $t('sidebar.copyPlan') }}\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport type { CoordinatorToolConfig, CoordinatorToolVO } from '@/api/coordinator-tool-api-service'\nimport { CoordinatorToolApiService } from '@/api/coordinator-tool-api-service'\nimport PublishServiceModal from '@/components/publish-service-modal/PublishServiceModal.vue'\nimport { useToast } from '@/plugins/useToast'\nimport { sidebarStore } from '@/stores/sidebar'\nimport type { PlanExecutionRequestPayload } from '@/types/plan-execution'\nimport type { PlanTemplate } from '@/types/plan-template'\nimport { Icon } from '@iconify/vue'\nimport { computed, nextTick, onMounted, onUnmounted, ref, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport ExecutionController from './ExecutionController.vue'\nimport JsonEditor from './JsonEditor.vue'\nimport JsonEditorV2 from './JsonEditorV2.vue'\n\nconst { t } = useI18n()\nconst toast = useToast()\n\n// Sidebar width management\nconst sidebarWidth = ref(80) // Default width percentage\nconst isResizing = ref(false)\nconst startX = ref(0)\nconst startWidth = ref(0)\n\n// Component refs\nconst executionControllerRef = ref<InstanceType<typeof ExecutionController> | null>(null)\n\n// Tool information state\nconst currentToolInfo = ref<CoordinatorToolVO>({\n  toolName: '',\n  toolDescription: '',\n  planTemplateId: '',\n  inputSchema: '[]',\n  enableHttpService: false,\n  enableMcpService: false,\n  enableInternalToolcall: false,\n  serviceGroup: '',\n})\n\n// Store tool information for all templates\nconst templateToolInfo = ref<Record<string, CoordinatorToolVO>>({})\nconst publishMcpModalRef = ref<InstanceType<typeof PublishServiceModal> | null>(null)\n\n// CoordinatorTool configuration\nconst coordinatorToolConfig = ref<CoordinatorToolConfig>({\n  enabled: true,\n  success: true,\n})\n\n// Computed property: whether to show publish MCP service button\nconst showPublishButton = computed(() => {\n  return coordinatorToolConfig.value.enabled\n})\n\n// Watch for changes in currentPlanTemplateId and jsonContent\nwatch(\n  () => sidebarStore.currentPlanTemplateId,\n  (newId, oldId) => {\n    console.log('[Sidebar] currentPlanTemplateId changed from', oldId, 'to', newId)\n  }\n)\n\nwatch(\n  () => sidebarStore.jsonContent,\n  (newContent, oldContent) => {\n    console.log('[Sidebar] jsonContent changed from', oldContent, 'to', newContent)\n  }\n)\n\n// Load CoordinatorTool configuration\nconst loadCoordinatorToolConfig = async () => {\n  try {\n    const config = await CoordinatorToolApiService.getCoordinatorToolConfig()\n    coordinatorToolConfig.value = config\n  } catch (error) {\n    console.error('Failed to load CoordinatorTool configuration:', error)\n    // Use default configuration\n    coordinatorToolConfig.value = {\n      enabled: true,\n      success: false,\n      message: error instanceof Error ? error.message : 'Unknown error',\n    }\n  }\n}\n\n// Use pinia store\n// Use TS object-implemented sidebarStore\n// Use sidebarStore instance directly, no pinia needed\n\n// Emits - Keep some events for communication with external components\nconst emit = defineEmits<{\n  planExecutionRequested: [payload: PlanExecutionRequestPayload]\n}>()\n\nconst handleSaveTemplate = async () => {\n  try {\n    const saveResult = await sidebarStore.saveTemplate()\n\n    if (saveResult?.duplicate) {\n      toast.success(\n        t('sidebar.saveCompleted', {\n          message: saveResult.message,\n          versionCount: saveResult.versionCount,\n        })\n      )\n    } else if (saveResult?.saved) {\n      toast.success(\n        t('sidebar.saveSuccess', {\n          message: saveResult.message,\n          versionCount: saveResult.versionCount,\n        })\n      )\n      // Refresh parameter requirements after successful save\n      refreshParameterRequirements()\n    } else if (saveResult?.message) {\n      toast.success(t('sidebar.saveStatus', { message: saveResult.message }))\n    }\n  } catch (error: any) {\n    console.error('Failed to save plan modifications:', error)\n    toast.error(error.message || t('sidebar.saveFailed'))\n  }\n}\n\n// Method to refresh parameter requirements\nconst refreshParameterRequirements = async () => {\n  // Add a delay to ensure the backend has processed the new template and committed the transaction\n  await new Promise(resolve => setTimeout(resolve, 1000))\n\n  console.log(\n    '[Sidebar]  Refreshing parameter requirements for templateId:',\n    sidebarStore.currentPlanTemplateId\n  )\n\n  // Use nextTick to ensure all reactive updates are complete\n  await nextTick()\n\n  // Get ExecutionController component through ref and call its refresh method\n  if (executionControllerRef.value) {\n    console.log('[Sidebar]  Calling ExecutionController.loadParameterRequirements()')\n    executionControllerRef.value.loadParameterRequirements()\n\n    // Add a retry mechanism in case the first call fails due to timing\n    setTimeout(() => {\n      if (executionControllerRef.value) {\n        console.log(\n          '[Sidebar]  Retry: Calling ExecutionController.loadParameterRequirements() again'\n        )\n        executionControllerRef.value.loadParameterRequirements()\n      }\n    }, 2000) // Increased delay to 2 seconds for database transaction commit\n  } else {\n    console.warn('[Sidebar]  ExecutionController ref not available')\n  }\n\n  // Refresh parameter requirements in PublishMcpServiceModal\n  if (publishMcpModalRef.value) {\n    console.log('[Sidebar]  Calling PublishMcpServiceModal.loadParameterRequirements()')\n    publishMcpModalRef.value.loadParameterRequirements()\n  } else {\n    console.warn('[Sidebar]  PublishMcpServiceModal ref not available')\n  }\n}\n\n// Version control handlers\nconst handleRollback = () => {\n  try {\n    if (typeof sidebarStore.rollbackVersion === 'function') {\n      sidebarStore.rollbackVersion()\n    } else {\n      console.warn('rollbackVersion method is not available')\n    }\n  } catch (error) {\n    console.error('Error during rollback operation:', error)\n    toast.error(t('sidebar.rollbackFailed') || 'Rollback failed')\n  }\n}\n\nconst handleRestore = () => {\n  try {\n    if (typeof sidebarStore.restoreVersion === 'function') {\n      sidebarStore.restoreVersion()\n    } else {\n      console.warn('restoreVersion method is not available')\n    }\n  } catch (error) {\n    console.error('Error during restore operation:', error)\n    toast.error(t('sidebar.restoreFailed') || 'Restore failed')\n  }\n}\n\nconst handleExecutePlan = async (payload: PlanExecutionRequestPayload) => {\n  console.log(\n    '[Sidebar]  handleExecutePlan called with payload:',\n    JSON.stringify(payload, null, 2)\n  )\n  console.log('[Sidebar]  Current sidebarStore state:', {\n    currentPlanTemplateId: sidebarStore.currentPlanTemplateId,\n    selectedTemplate: sidebarStore.selectedTemplate?.id,\n    jsonContent: sidebarStore.jsonContent.substring(0, 100) + '...',\n  })\n\n  try {\n    const planData = sidebarStore.preparePlanExecution()\n    console.log('[Sidebar]  Prepared plan data:', JSON.stringify(planData, null, 2))\n\n    if (!planData) {\n      console.log('[Sidebar]  No plan data available, returning')\n      return\n    }\n\n    // Always use the prepared plan data (which includes planTemplateId)\n    // Add replacement parameters to plan data if provided\n    const finalPlanData = {\n      ...planData,\n      uploadedFiles: payload.uploadedFiles,\n      uploadKey: payload.uploadKey,\n    }\n\n    if (payload.replacementParams && Object.keys(payload.replacementParams).length > 0) {\n      console.log('[Sidebar]  Processing replacement parameters:', payload.replacementParams)\n      finalPlanData.replacementParams = payload.replacementParams\n    }\n\n    console.log('[Sidebar]  Final plan data:', JSON.stringify(finalPlanData, null, 2))\n\n    // Use the prepared plan data for the payload\n    const finalPayload: PlanExecutionRequestPayload = {\n      ...payload,\n      title: finalPlanData.title,\n      planData: finalPlanData.planData,\n      params: finalPlanData.params,\n      uploadedFiles: finalPlanData.uploadedFiles,\n      uploadKey: finalPlanData.uploadKey,\n    }\n\n    console.log(\n      '[Sidebar]  Emitting planExecutionRequested with final payload:',\n      JSON.stringify(finalPayload, null, 2)\n    )\n    emit('planExecutionRequested', finalPayload)\n\n    console.log('[Sidebar]  Event emitted successfully')\n  } catch (error: any) {\n    console.error('[Sidebar]  Error executing plan:', error)\n    toast.error(t('sidebar.executeFailed') + ': ' + error.message)\n  } finally {\n    console.log('[Sidebar]  Cleaning up after execution')\n    sidebarStore.finishPlanExecution()\n    // Clear execution parameters after successful execution\n    sidebarStore.clearExecutionParams()\n    // Also clear ExecutionController parameters\n    if (executionControllerRef.value) {\n      console.log('[Sidebar]  Calling ExecutionController.clearExecutionParams')\n      executionControllerRef.value.clearExecutionParams()\n    }\n    console.log('[Sidebar]  Cleanup completed')\n  }\n}\n\n// MCP service publishing related state\nconst showPublishMcpModal = ref(false)\n\n// Copy plan related state\nconst showCopyPlanModal = ref(false)\nconst newPlanTitle = ref('')\nconst isCopyingPlan = ref(false)\n\nconst handlePublishMcpService = () => {\n  console.log('[Sidebar] Publish MCP service button clicked')\n  console.log('[Sidebar] currentPlanTemplateId:', sidebarStore.currentPlanTemplateId)\n\n  if (!sidebarStore.currentPlanTemplateId) {\n    console.log('[Sidebar] No plan template selected, showing warning')\n    toast.error(t('mcpService.selectPlanTemplateFirst'))\n    return\n  }\n\n  console.log('[Sidebar] Opening publish MCP service modal')\n  showPublishMcpModal.value = true\n}\n\nconst handleMcpServicePublished = async (tool: CoordinatorToolVO | null) => {\n  if (tool === null) {\n    console.log('MCP service deleted successfully')\n    toast.success(t('mcpService.deleteSuccess'))\n    // Reset tool information\n    currentToolInfo.value = {\n      toolName: '',\n      toolDescription: '',\n      planTemplateId: '',\n      inputSchema: '[]',\n      enableHttpService: false,\n      enableMcpService: false,\n      enableInternalToolcall: false,\n      serviceGroup: '',\n    }\n  } else {\n    console.log('MCP service published successfully:', tool)\n    toast.success(t('mcpService.publishSuccess'))\n    // Update tool information\n    currentToolInfo.value = {\n      ...tool,\n      toolName: tool.toolName,\n      serviceGroup: tool.serviceGroup ?? '',\n    }\n  }\n\n  // Reload available tools to include the newly published service\n  console.log('[Sidebar]  Reloading available tools after service publish/delete')\n  await sidebarStore.loadAvailableTools()\n\n  // Reload tool info for all templates to update the task preview\n  await loadAllTemplateToolInfo()\n}\n\n// Execution Controller event handlers\nconst handleClearExecutionParams = () => {\n  sidebarStore.clearExecutionParams()\n}\n\nconst handleUpdateExecutionParams = (params: string) => {\n  sidebarStore.executionParams = params\n}\n\n// Copy plan handler functions\nconst handleCopyPlan = () => {\n  console.log('[Sidebar] Copy plan clicked')\n\n  if (!sidebarStore.selectedTemplate) {\n    console.log('[Sidebar] No template selected, cannot copy')\n    toast.error(t('sidebar.selectPlanFirst'))\n    return\n  }\n\n  newPlanTitle.value = (sidebarStore.selectedTemplate.title ?? t('sidebar.unnamedPlan')) + ' (copy)'\n  console.log('[Sidebar] Opening copy plan modal')\n  showCopyPlanModal.value = true\n}\n\nconst closeCopyPlanModal = () => {\n  showCopyPlanModal.value = false\n  newPlanTitle.value = ''\n  isCopyingPlan.value = false\n}\n\nconst confirmCopyPlan = async () => {\n  if (!newPlanTitle.value.trim()) {\n    toast.error(t('sidebar.titleRequired'))\n    return\n  }\n\n  if (!sidebarStore.selectedTemplate || !sidebarStore.jsonContent) {\n    toast.error(t('sidebar.noPlanToCopy'))\n    return\n  }\n\n  isCopyingPlan.value = true\n\n  try {\n    const currentPlan = JSON.parse(sidebarStore.jsonContent)\n    const newPlan = {\n      ...currentPlan,\n      title: newPlanTitle.value.trim(),\n      planTemplateId: '', // New plan should not have the same template ID\n    }\n\n    const { PlanActApiService } = await import('@/api/plan-act-api-service')\n    const result = await PlanActApiService.savePlanTemplate('', JSON.stringify(newPlan))\n\n    if (result.saved) {\n      toast.success(t('sidebar.copyPlanSuccess', { title: newPlanTitle.value.trim() }))\n      await sidebarStore.loadPlanTemplateList()\n      closeCopyPlanModal()\n    } else {\n      toast.error(t('sidebar.copyPlanFailed', { message: result.message || 'Unknown error' }))\n    }\n  } catch (error: any) {\n    console.error('[Sidebar] Error copying plan:', error)\n    toast.error(t('sidebar.copyPlanFailed', { message: error.message || 'Unknown error' }))\n  } finally {\n    isCopyingPlan.value = false\n  }\n}\n\n// Load tool information when plan template changes\nconst loadToolInfo = async (planTemplateId: string | null) => {\n  if (!planTemplateId) {\n    currentToolInfo.value = {\n      toolName: '',\n      toolDescription: '',\n      planTemplateId: '',\n      inputSchema: '[]',\n      enableHttpService: false,\n      enableMcpService: false,\n      enableInternalToolcall: false,\n      serviceGroup: '',\n    }\n    return\n  }\n\n  try {\n    const toolData = await CoordinatorToolApiService.getCoordinatorToolByTemplate(planTemplateId)\n    if (toolData) {\n      currentToolInfo.value = {\n        ...toolData,\n        toolName: toolData.toolName,\n        serviceGroup: toolData.serviceGroup ?? '',\n      }\n    } else {\n      // No tool found or not published, don't show any call examples\n      currentToolInfo.value = {\n        toolName: '',\n        toolDescription: '',\n        planTemplateId: planTemplateId,\n        inputSchema: '[]',\n        enableHttpService: false,\n        enableMcpService: false,\n        enableInternalToolcall: false,\n        serviceGroup: '',\n      }\n    }\n  } catch (error) {\n    console.error('Failed to load tool information:', error)\n    currentToolInfo.value = {\n      toolName: '',\n      toolDescription: '',\n      planTemplateId: planTemplateId,\n      inputSchema: '[]',\n      enableHttpService: false,\n      enableMcpService: false,\n      enableInternalToolcall: false,\n      serviceGroup: '',\n    }\n  }\n}\n\n// Utility functions\nconst getRelativeTimeString = (date: Date): string => {\n  // Check if date is valid\n  if (isNaN(date.getTime())) {\n    console.warn('Invalid date received:', date)\n    return t('time.unknown')\n  }\n\n  const now = new Date()\n  const diffMs = now.getTime() - date.getTime()\n  const diffMinutes = Math.floor(diffMs / 60000)\n  const diffHours = Math.floor(diffMs / 3600000)\n  const diffDays = Math.floor(diffMs / 86400000)\n\n  if (diffMinutes < 1) return t('time.now')\n  if (diffMinutes < 60) return t('time.minuteAgo', { count: diffMinutes })\n  if (diffHours < 24) return t('time.hourAgo', { count: diffHours })\n  if (diffDays < 30) return t('time.dayAgo', { count: diffDays })\n\n  return date.toLocaleDateString('zh-CN')\n}\n\n// Get task preview text - show tool name if published, otherwise empty\nconst getTaskPreviewText = (template: PlanTemplate): string => {\n  const toolInfo = templateToolInfo.value[template.id]\n  if (toolInfo?.toolName) {\n    return `${t('sidebar.publishedTool')}: ${toolInfo.toolName}`\n  }\n  return '' // Return empty string when no tools are published\n}\n\n// Load tool information for all templates\nconst loadAllTemplateToolInfo = async () => {\n  for (const template of sidebarStore.planTemplateList) {\n    try {\n      const toolData = await CoordinatorToolApiService.getCoordinatorToolByTemplate(template.id)\n      if (toolData?.toolName) {\n        templateToolInfo.value[template.id] = toolData\n      }\n    } catch (error) {\n      // Silently ignore errors for templates without published tools\n      console.debug(`No tool found for template ${template.id}:`, error)\n    }\n  }\n}\n\n// Sidebar resize methods\nconst startResize = (e: MouseEvent) => {\n  isResizing.value = true\n  startX.value = e.clientX\n  startWidth.value = sidebarWidth.value\n\n  document.addEventListener('mousemove', handleMouseMove)\n  document.addEventListener('mouseup', handleMouseUp)\n  document.body.style.cursor = 'col-resize'\n  document.body.style.userSelect = 'none'\n\n  e.preventDefault()\n}\n\nconst handleMouseMove = (e: MouseEvent) => {\n  if (!isResizing.value) return\n\n  const containerWidth = window.innerWidth\n  const deltaX = e.clientX - startX.value\n  const deltaPercent = (deltaX / containerWidth) * 100\n\n  let newWidth = startWidth.value + deltaPercent\n\n  // Limit sidebar width between 15% and 100%\n  newWidth = Math.max(15, Math.min(100, newWidth))\n\n  sidebarWidth.value = newWidth\n}\n\nconst handleMouseUp = () => {\n  isResizing.value = false\n  document.removeEventListener('mousemove', handleMouseMove)\n  document.removeEventListener('mouseup', handleMouseUp)\n  document.body.style.cursor = ''\n  document.body.style.userSelect = ''\n\n  // Save to localStorage\n  localStorage.setItem('sidebarWidth', sidebarWidth.value.toString())\n}\n\nconst resetSidebarWidth = () => {\n  sidebarWidth.value = 80\n  localStorage.setItem('sidebarWidth', '80')\n}\n\n// Watch for plan template changes to load tool information\nwatch(\n  () => sidebarStore.currentPlanTemplateId,\n  newPlanTemplateId => {\n    loadToolInfo(newPlanTemplateId)\n  },\n  { immediate: true }\n)\n\n// Lifecycle\nonMounted(async () => {\n  await sidebarStore.loadPlanTemplateList()\n  await loadAllTemplateToolInfo() // Load tool info after templates are loaded\n  loadCoordinatorToolConfig()\n  sidebarStore.loadAvailableTools() // Load available tools on sidebar mount\n\n  // Restore sidebar width from localStorage\n  const savedWidth = localStorage.getItem('sidebarWidth')\n  if (savedWidth) {\n    sidebarWidth.value = parseFloat(savedWidth)\n  }\n})\n\nonUnmounted(() => {\n  // Clean up event listeners\n  document.removeEventListener('mousemove', handleMouseMove)\n  document.removeEventListener('mouseup', handleMouseUp)\n})\n\n// Expose methods for parent component to call\ndefineExpose({\n  loadPlanTemplateList: sidebarStore.loadPlanTemplateList,\n  toggleSidebar: sidebarStore.toggleSidebar,\n  currentPlanTemplateId: sidebarStore.currentPlanTemplateId,\n})\n</script>\n\n<style scoped>\n.sidebar-wrapper {\n  position: relative;\n  height: 100vh;\n  background: rgba(255, 255, 255, 0.05);\n  border-right: 1px solid rgba(255, 255, 255, 0.1);\n  transition: width 0.1s ease;\n  overflow: hidden;\n  display: flex;\n}\n.sidebar-wrapper-collapsed {\n  border-right: none;\n  width: 0 !important;\n  /* transform: translateX(-100%); */\n\n  .sidebar-content,\n  .sidebar-resizer {\n    opacity: 0;\n    pointer-events: none;\n  }\n}\n\n.sidebar-content {\n  height: 100%;\n  width: 100%;\n  padding: 12px 0 12px 12px;\n  display: flex;\n  flex-direction: column;\n  transition: all 0.3s ease-in-out;\n  flex: 1;\n\n  .sidebar-content-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 16px;\n    overflow: hidden;\n\n    .sidebar-content-title {\n      font-size: 20px;\n      font-weight: 600;\n\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      -webkit-background-clip: text;\n      -webkit-text-fill-color: transparent;\n      background-clip: text;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n    }\n  }\n\n  .tab-switcher {\n    display: flex;\n    margin-bottom: 16px;\n    padding-right: 12px;\n    background: rgba(255, 255, 255, 0.05);\n    border-radius: 8px;\n    padding: 4px;\n\n    .tab-button {\n      flex: 1;\n      padding: 8px 12px;\n      background: transparent;\n      border: none;\n      border-radius: 6px;\n      color: rgba(255, 255, 255, 0.7);\n      font-size: 12px;\n      font-weight: 500;\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      gap: 6px;\n      transition: all 0.2s ease;\n\n      &:hover:not(:disabled) {\n        background: rgba(255, 255, 255, 0.1);\n        color: rgba(255, 255, 255, 0.9);\n      }\n\n      &.active {\n        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n        color: white;\n        box-shadow: 0 2px 4px rgba(102, 126, 234, 0.3);\n      }\n\n      &:disabled {\n        opacity: 0.5;\n        cursor: not-allowed;\n      }\n    }\n  }\n\n  .tab-content {\n    display: flex;\n    flex-direction: column;\n    flex: 1;\n    min-height: 0;\n  }\n\n  .config-tab {\n    .config-container {\n      display: flex;\n      flex-direction: column;\n      height: 100%;\n      overflow-y: auto;\n      padding-right: 12px;\n\n      .template-info-header {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        margin-bottom: 16px;\n        padding: 12px;\n        background: rgba(255, 255, 255, 0.05);\n        border-radius: 8px;\n\n        .template-info {\n          flex: 1;\n          min-width: 0;\n\n          h3 {\n            margin: 0 0 4px 0;\n            font-size: 14px;\n            font-weight: 600;\n            color: white;\n            overflow: hidden;\n            text-overflow: ellipsis;\n            white-space: nowrap;\n          }\n\n          .template-id {\n            font-size: 11px;\n            color: rgba(255, 255, 255, 0.5);\n          }\n        }\n\n        .back-to-list-btn {\n          width: 28px;\n          height: 28px;\n          background: transparent;\n          border: none;\n          border-radius: 4px;\n          color: rgba(255, 255, 255, 0.7);\n          cursor: pointer;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          transition: all 0.2s ease;\n\n          &:hover {\n            background: rgba(255, 255, 255, 0.1);\n            color: white;\n          }\n        }\n      }\n\n      .json-editor {\n        width: 100%;\n        background: rgba(0, 0, 0, 0.3);\n        border: 1px solid rgba(255, 255, 255, 0.2);\n        border-radius: 6px;\n        color: white;\n        font-size: 12px;\n        font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n        padding: 8px;\n        resize: vertical;\n        min-height: 100px;\n\n        &:focus {\n          outline: none;\n          border-color: #667eea;\n          box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n        }\n\n        &::placeholder {\n          color: rgba(255, 255, 255, 0.4);\n        }\n      }\n\n      .json-editor {\n        min-height: 200px;\n        font-size: 11px;\n        line-height: 1.5;\n        white-space: pre-wrap;\n        overflow-wrap: break-word;\n        word-break: break-word;\n        tab-size: 2;\n        font-variant-ligatures: none;\n      }\n    }\n  }\n}\n\n.new-task-section {\n  margin-bottom: 16px;\n  padding-right: 12px;\n\n  .new-task-btn {\n    width: 100%;\n    padding: 12px 16px;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    border: none;\n    border-radius: 8px;\n    color: white;\n    font-size: 14px;\n    font-weight: 500;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 8px;\n    transition: all 0.2s ease;\n\n    &:hover {\n      transform: translateY(-1px);\n      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);\n    }\n\n    .shortcut {\n      font-size: 12px;\n      opacity: 0.8;\n      margin-left: auto;\n    }\n  }\n}\n\n.sidebar-content-list {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  overflow-y: auto;\n  padding-right: 12px;\n\n  .loading-state,\n  .error-state,\n  .empty-state {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    padding: 32px 16px;\n    color: rgba(255, 255, 255, 0.6);\n    font-size: 14px;\n    text-align: center;\n    gap: 12px;\n\n    .spinning {\n      animation: spin 1s linear infinite;\n    }\n\n    .retry-btn {\n      padding: 8px 16px;\n      background: rgba(255, 255, 255, 0.1);\n      border: 1px solid rgba(255, 255, 255, 0.2);\n      border-radius: 4px;\n      color: white;\n      cursor: pointer;\n      font-size: 12px;\n      transition: background-color 0.2s ease;\n\n      &:hover {\n        background: rgba(255, 255, 255, 0.2);\n      }\n    }\n  }\n\n  .sidebar-content-list-item {\n    display: flex;\n    align-items: flex-start;\n    padding: 12px;\n    margin-bottom: 8px;\n    background: rgba(255, 255, 255, 0.05);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 8px;\n    cursor: pointer;\n    transition: all 0.2s ease;\n    position: relative;\n\n    &:hover {\n      background: rgba(255, 255, 255, 0.1);\n      border-color: rgba(255, 255, 255, 0.2);\n      transform: translateY(-1px);\n    }\n\n    &.sidebar-content-list-item-active {\n      border: 2px solid #667eea;\n      background: rgba(102, 126, 234, 0.1);\n    }\n\n    .task-icon {\n      margin-right: 12px;\n      color: #667eea;\n      flex-shrink: 0;\n      margin-top: 2px;\n    }\n\n    .task-details {\n      flex: 1;\n      min-width: 0;\n\n      .task-title {\n        font-size: 14px;\n        font-weight: 600;\n        color: white;\n        margin-bottom: 4px;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n      }\n\n      .task-preview {\n        font-size: 12px;\n        color: rgba(255, 255, 255, 0.7);\n        line-height: 1.4;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        white-space: nowrap;\n      }\n    }\n\n    .task-time {\n      font-size: 11px;\n      color: rgba(255, 255, 255, 0.5);\n      margin-left: 8px;\n      flex-shrink: 0;\n      position: absolute;\n      top: 12px;\n      right: 40px;\n    }\n\n    .task-actions {\n      display: flex;\n      align-items: center;\n      margin-left: 8px;\n      flex-shrink: 0;\n\n      .delete-task-btn {\n        width: 24px;\n        height: 24px;\n        background: transparent;\n        border: none;\n        border-radius: 4px;\n        color: rgba(255, 255, 255, 0.5);\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        transition: all 0.2s ease;\n        position: absolute;\n        top: 12px;\n        right: 12px;\n\n        &:hover {\n          background: rgba(255, 0, 0, 0.2);\n          color: #ff6b6b;\n        }\n      }\n    }\n  }\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n/* Sidebar Resizer Styles */\n.sidebar-resizer {\n  width: 6px;\n  height: 100vh;\n  background: #1a1a1a;\n  cursor: col-resize;\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: background-color 0.2s ease;\n  flex-shrink: 0;\n\n  &:hover {\n    background: #2a2a2a;\n\n    .resizer-line {\n      background: #4a90e2;\n      width: 2px;\n    }\n  }\n\n  &:active {\n    background: #3a3a3a;\n  }\n}\n\n.resizer-line {\n  width: 1px;\n  height: 40px;\n  background: #3a3a3a;\n  border-radius: 1px;\n  transition: all 0.2s ease;\n}\n\n/* Copy Plan Modal Styles */\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n\n.modal-content {\n  background: #1a1a1a;\n  border-radius: 8px;\n  padding: 0;\n  min-width: 400px;\n  max-width: 500px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);\n}\n\n.modal-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 16px 20px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.modal-header h3 {\n  margin: 0;\n  color: white;\n  font-size: 16px;\n  font-weight: 600;\n}\n\n.close-btn {\n  background: transparent;\n  border: none;\n  color: rgba(255, 255, 255, 0.7);\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 4px;\n  transition: all 0.2s ease;\n}\n\n.close-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n  color: white;\n}\n\n.modal-body {\n  padding: 20px;\n}\n\n.modal-footer {\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  padding: 16px 20px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.form-row {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.form-label {\n  font-size: 14px;\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.form-input {\n  padding: 10px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(0, 0, 0, 0.3);\n  color: white;\n  font-size: 13px;\n  transition: all 0.2s ease;\n}\n\n.form-input:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n}\n\n.btn {\n  padding: 8px 16px;\n  border: none;\n  border-radius: 6px;\n  font-size: 14px;\n  font-weight: 500;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n  transition: all 0.2s ease;\n}\n\n.btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.btn-secondary {\n  background: rgba(255, 255, 255, 0.1);\n  color: white;\n}\n\n.btn-secondary:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.2);\n}\n\n.btn-primary {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: white;\n}\n\n.btn-primary:hover:not(:disabled) {\n  background: linear-gradient(135deg, #5566dd 0%, #653b91 100%);\n  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);\n}\n\n.spinning {\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n</style>\n","<!--\n  /*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n-->\n\n<template>\n  <div class=\"direct-page\">\n    <div class=\"direct-chat\">\n      <Sidebar ref=\"sidebarRef\" @planExecutionRequested=\"handlePlanExecutionRequested\" />\n      <!-- Left Panel - Chat -->\n      <div class=\"left-panel\" :style=\"{ width: computedLeftPanelWidth + '%' }\">\n        <div class=\"chat-header\">\n          <button class=\"back-button\" @click=\"goBack\">\n            <Icon icon=\"carbon:arrow-left\" />\n          </button>\n          <h2>{{ $t('conversation') }}</h2>\n          <div class=\"header-actions\">\n            <LanguageSwitcher />\n            <button class=\"config-button\" @click=\"newChat\" :title=\"$t('memory.newChat')\">\n              <Icon icon=\"carbon:add\" width=\"20\" />\n            </button>\n            <button class=\"config-button\" @click=\"handleConfig\" :title=\"$t('direct.configuration')\">\n              <Icon icon=\"carbon:settings-adjust\" width=\"20\" />\n            </button>\n            <button\n              class=\"cron-task-btn\"\n              @click=\"memoryStore.toggleSidebar()\"\n              :title=\"$t('memory.selectMemory')\"\n            >\n              <Icon icon=\"carbon:calendar\" width=\"20\" />\n            </button>\n          </div>\n        </div>\n\n        <!-- Chat Container -->\n        <div class=\"chat-content\">\n          <ChatContainer\n            ref=\"chatRef\"\n            mode=\"direct\"\n            :initial-prompt=\"prompt || ''\"\n            @step-selected=\"handleStepSelected\"\n            @sub-plan-step-selected=\"handleSubPlanStepSelected\"\n          />\n        </div>\n\n        <!-- Input Area -->\n        <InputArea\n          :key=\"$i18n.locale\"\n          ref=\"inputRef\"\n          :disabled=\"isLoading\"\n          :placeholder=\"isLoading ? t('input.waiting') : t('input.placeholder')\"\n          :initial-value=\"prompt\"\n          @send=\"handleSendMessage\"\n          @clear=\"handleInputClear\"\n          @focus=\"handleInputFocus\"\n          @update-state=\"handleInputUpdateState\"\n          @plan-mode-clicked=\"handlePlanModeClicked\"\n        />\n      </div>\n\n      <!-- Resizer -->\n      <div\n        class=\"panel-resizer\"\n        @mousedown=\"startResize\"\n        @dblclick=\"resetPanelSize\"\n        :title=\"$t('direct.panelResizeHint')\"\n      >\n        <div class=\"resizer-line\"></div>\n      </div>\n\n      <!-- Right Panel - Preview -->\n      <RightPanel\n        ref=\"rightPanelRef\"\n        :style=\"{ width: 100 - leftPanelWidth + '%' }\"\n        :current-root-plan-id=\"currentRootPlanId\"\n      />\n    </div>\n\n    <!-- Memory Modal -->\n    <Memory @memory-selected=\"memorySelected\" />\n\n    <!-- Message toast component -->\n    <div v-if=\"message.show\" class=\"message-toast\" :class=\"message.type\">\n      <div class=\"message-content\">\n        <span>{{ message.text }}</span>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { CommonApiService } from '@/api/common-api-service'\nimport { PlanActApiService } from '@/api/plan-act-api-service'\nimport ChatContainer from '@/components/chat/ChatContainer.vue'\nimport InputArea from '@/components/input/InputArea.vue'\nimport LanguageSwitcher from '@/components/language-switcher/LanguageSwitcher.vue'\nimport Memory from '@/components/memory/Memory.vue'\nimport RightPanel from '@/components/right-panel/RightPanel.vue'\nimport Sidebar from '@/components/sidebar/Sidebar.vue'\nimport { useMessage } from '@/composables/useMessage'\nimport type { InputMessage } from '@/stores/memory'\nimport { memoryStore } from '@/stores/memory'\nimport { sidebarStore } from '@/stores/sidebar'\nimport { useTaskStore } from '@/stores/task'\nimport type { PlanExecutionRequestPayload } from '@/types/plan-execution'\nimport { planExecutionManager } from '@/utils/plan-execution-manager'\nimport { Icon } from '@iconify/vue'\nimport { computed, nextTick, onMounted, onUnmounted, ref, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { useRoute, useRouter } from 'vue-router'\nconst route = useRoute()\nconst router = useRouter()\nconst taskStore = useTaskStore()\nconst { t } = useI18n()\nconst { message } = useMessage()\n\nconst prompt = ref<string>('')\nconst inputOnlyContent = ref<string>('')\nconst rightPanelRef = ref()\nconst chatRef = ref()\nconst inputRef = ref()\nconst sidebarRef = ref()\nconst isExecutingPlan = ref(false)\nconst isLoading = ref(false)\nconst currentRootPlanId = ref<string | null>(null)\n\n// Related to panel width\nconst leftPanelWidth = ref(50) // Left panel width percentage\nconst isResizing = ref(false)\nconst startX = ref(0)\nconst startLeftWidth = ref(0)\n\n// Computed left panel width that adjusts based on sidebar width\nconst computedLeftPanelWidth = computed(() => {\n  if (sidebarStore.isCollapsed) {\n    return leftPanelWidth.value\n  }\n\n  // When sidebar is expanded, calculate available width for left panel\n  // Get sidebar width from the sidebar component if available\n  let sidebarWidth = 26 // Default sidebar width\n\n  // Try to get actual sidebar width from the sidebar component\n  if (sidebarRef.value && sidebarRef.value.sidebarWidth !== undefined) {\n    sidebarWidth = sidebarRef.value.sidebarWidth\n  }\n\n  // Calculate maximum available width for left panel\n  // Total width is 100%, so left panel max = 100% - sidebar width\n  const maxAvailableWidth = 100 - sidebarWidth\n\n  // Ensure left panel width doesn't exceed available space\n  // Also maintain minimum width of 20%\n  return Math.max(20, Math.min(maxAvailableWidth, leftPanelWidth.value))\n})\n\nonMounted(() => {\n  console.log('[Direct] onMounted called')\n  console.log('[Direct] taskStore.currentTask:', taskStore.currentTask)\n  console.log('[Direct] taskStore.hasUnprocessedTask():', taskStore.hasUnprocessedTask())\n\n  // Register event callbacks to planExecutionManager\n  planExecutionManager.setEventCallbacks({\n    onPlanUpdate: (rootPlanId: string) => {\n      console.log('[Direct] Plan update event received for rootPlanId:', rootPlanId)\n\n      if (!shouldProcessEventForCurrentPlan(rootPlanId)) {\n        return\n      }\n\n      console.log('[Direct] Processing plan update for current rootPlanId:', rootPlanId)\n\n      // Call chat component's handlePlanUpdate method\n      if (chatRef.value && typeof chatRef.value.handlePlanUpdate === 'function') {\n        console.log('[Direct] Calling chatRef.handlePlanUpdate with rootPlanId:', rootPlanId)\n        chatRef.value.handlePlanUpdate(rootPlanId)\n      } else {\n        console.warn('[Direct] chatRef.handlePlanUpdate method not available')\n      }\n\n      // Call right panel component's updateDisplayedPlanProgress method\n      if (\n        rightPanelRef.value &&\n        typeof rightPanelRef.value.updateDisplayedPlanProgress === 'function'\n      ) {\n        console.log(\n          '[Direct] Calling rightPanelRef.updateDisplayedPlanProgress with rootPlanId:',\n          rootPlanId\n        )\n        rightPanelRef.value.updateDisplayedPlanProgress(rootPlanId)\n      } else {\n        console.warn('[Direct] rightPanelRef.updateDisplayedPlanProgress method not available')\n      }\n    },\n\n    onPlanCompleted: (rootPlanId: string) => {\n      console.log('[Direct] Plan completed event received for rootPlanId:', rootPlanId)\n\n      if (!shouldProcessEventForCurrentPlan(rootPlanId)) {\n        return\n      }\n\n      console.log('[Direct] Processing plan completion for current rootPlanId:', rootPlanId)\n\n      // Call chat component's handlePlanCompleted method\n      if (chatRef.value && typeof chatRef.value.handlePlanCompleted === 'function') {\n        const planDetails = planExecutionManager.getCachedPlanRecord(rootPlanId)\n\n        // Retrieved plan details from cache for processing\n        if (planDetails && planDetails.completed) {\n          if (planDetails.summary && planDetails.summary.trim().length > 0) {\n            console.log(\n              '[Direct]  Plan details are valid and complete from polling cache, updating UI'\n            )\n            chatRef.value.handlePlanCompleted(planDetails)\n          } else {\n            console.warn(\n              '[Direct]  Plan completed but summary is empty, still proceeding with available data'\n            )\n            chatRef.value.handlePlanCompleted(planDetails)\n          }\n        } else {\n          console.warn('[Direct]  Plan details incomplete in cache, attempting API fallback')\n          // Fallback: try getting it from the API (maybe it has been deleted)\n          CommonApiService.getDetails(rootPlanId)\n            .then(freshDetails => {\n              console.log('[Direct]  Got fresh details from API:', freshDetails)\n              if (freshDetails && freshDetails.completed) {\n                console.log('[Direct] Fresh details from API are valid, updating UI')\n                planExecutionManager.setCachedPlanRecord(rootPlanId, freshDetails)\n                chatRef.value.handlePlanCompleted(freshDetails)\n              } else {\n                console.warn('[Direct]  API details also incomplete, using best available data')\n                chatRef.value.handlePlanCompleted(planDetails ?? { planId: rootPlanId })\n              }\n            })\n            .catch(error => {\n              console.error(\n                '[Direct] API call failed (likely record deleted), using cached data:',\n                error\n              )\n              chatRef.value.handlePlanCompleted(planDetails ?? { planId: rootPlanId })\n            })\n        }\n      } else {\n        console.warn('[Direct] chatRef.handlePlanCompleted method not available')\n      }\n\n      // Clear current root plan ID when plan is completed\n      currentRootPlanId.value = null\n      console.log('[Direct]  Cleared currentRootPlanId after plan completion')\n\n      //Clear sessionPlanId to ensure that subsequent file uploads use the new planId\n      if (inputRef.value && typeof inputRef.value.resetSession === 'function') {\n        console.log('[Direct]  Calling inputRef.resetSession to clear sessionPlanId')\n        inputRef.value.resetSession()\n      }\n    },\n\n    onDialogRoundStart: (rootPlanId: string) => {\n      console.log('[Direct] Dialog round start event received for rootPlanId:', rootPlanId)\n\n      // Set current root plan ID when dialog starts\n      currentRootPlanId.value = rootPlanId\n      console.log('[Direct] Set currentRootPlanId to:', rootPlanId)\n\n      // Call chat component's handleDialogRoundStart method (without query parameter)\n      if (chatRef.value && typeof chatRef.value.handleDialogRoundStart === 'function') {\n        console.log('[Direct] Calling chatRef.handleDialogRoundStart with planId:', rootPlanId)\n        chatRef.value.handleDialogRoundStart(rootPlanId)\n      } else {\n        console.warn('[Direct] chatRef.handleDialogRoundStart method not available')\n      }\n    },\n\n    onChatInputClear: () => {\n      console.log('[Direct] Chat input clear event received')\n      handleInputClear()\n    },\n\n    onChatInputUpdateState: (rootPlanId: string) => {\n      console.log('[Direct] Chat input update state event received for rootPlanId:', rootPlanId)\n\n      if (!shouldProcessEventForCurrentPlan(rootPlanId, true)) {\n        return\n      }\n\n      const uiState = planExecutionManager.getCachedUIState(rootPlanId)\n      if (uiState) {\n        handleInputUpdateState(uiState.enabled, uiState.placeholder)\n      }\n    },\n\n    onPlanError: (message: string) => {\n      // No right panel notification needed, uncomment if needed\n      // showMessage(`${t('planTemplate.executionFailed')}: ${message}`, 'error')\n      chatRef.value.handlePlanError(message)\n    },\n  })\n\n  console.log('[Direct] Event callbacks registered to planExecutionManager')\n\n  // Initialize sidebar data\n  sidebarStore.loadPlanTemplateList()\n\n  // Check if there is a task in the store\n  if (taskStore.hasUnprocessedTask() && taskStore.currentTask) {\n    const taskContent = taskStore.currentTask.prompt\n    console.log('[Direct] Found unprocessed task from store:', taskContent)\n\n    // Check if task content is not empty before processing\n    if (taskContent.trim()) {\n      // Mark the task as processed to prevent duplicate responses\n      taskStore.markTaskAsProcessed()\n\n      // Execute task directly without showing content in input box\n      nextTick(async () => {\n        try {\n          console.log('[Direct] Calling handleChatSendMessage with taskContent:', taskContent)\n          await handleChatSendMessage({\n            input: taskContent,\n          })\n        } catch (error) {\n          console.warn('[Direct] handleChatSendMessage failed, falling back to prompt:', error)\n          prompt.value = taskContent\n        }\n      })\n    } else {\n      // Task has empty content, just mark it as processed and don't execute\n      console.log('[Direct] Task has empty content, marking as processed without execution')\n      taskStore.markTaskAsProcessed()\n    }\n  } else {\n    // Check if there is a task to input (for pre-filling input without executing)\n    const taskToInput = taskStore.getAndClearTaskToInput()\n    if (taskToInput) {\n      inputOnlyContent.value = taskToInput\n      console.log('[Direct] Setting inputOnlyContent for input only:', inputOnlyContent.value)\n      // Don't set prompt.value since this is just for input pre-filling\n    } else {\n      // Degrade to URL parameters (backward compatibility)\n      prompt.value = (route.query.prompt as string) || ''\n      console.log('[Direct] Received task from URL:', prompt.value)\n      console.log('[Direct] No unprocessed task in store')\n    }\n  }\n\n  // Restore panel width from localStorage\n  const savedWidth = localStorage.getItem('directPanelWidth')\n  if (savedWidth) {\n    leftPanelWidth.value = parseFloat(savedWidth)\n  }\n\n  console.log('[Direct] Final prompt value:', prompt.value)\n\n  // Set input content if there's inputOnlyContent (after component is mounted)\n  if (inputOnlyContent.value) {\n    nextTick(() => {\n      if (inputRef.value && typeof inputRef.value.setInputValue === 'function') {\n        inputRef.value.setInputValue(inputOnlyContent.value)\n        console.log('[Direct] Set input value:', inputOnlyContent.value)\n        inputOnlyContent.value = '' // Clear after setting\n      }\n    })\n  }\n\n  // Listen for plan-execution-requested events on window\n  window.addEventListener('plan-execution-requested', ((event: CustomEvent) => {\n    console.log('[DirectView] Received plan-execution-requested event:', event.detail)\n    handlePlanExecutionRequested(event.detail)\n  }) as EventListener)\n\n  // No longer need to check pending plans in sessionStorage\n  // Because emitPlanExecutionRequested in task.ts already sends events directly\n})\n\n// Listen for changes in the store's task (only handle unprocessed tasks)\nwatch(\n  () => taskStore.currentTask,\n  newTask => {\n    console.log('[Direct] Watch taskStore.currentTask triggered, newTask:', newTask)\n    if (newTask && !newTask.processed && newTask.prompt.trim()) {\n      const taskContent = newTask.prompt\n      taskStore.markTaskAsProcessed()\n      console.log('[Direct] Received new task from store:', taskContent)\n\n      // Execute task directly without showing content in input box\n      nextTick(async () => {\n        try {\n          console.log(\n            '[Direct] Directly executing new task via handleChatSendMessage:',\n            taskContent\n          )\n          await handleChatSendMessage({ input: taskContent })\n        } catch (error) {\n          console.warn('[Direct] handleChatSendMessage failed for new task:', error)\n        }\n      })\n    } else {\n      console.log('[Direct] Task is null, already processed, or has empty prompt - ignoring')\n    }\n  },\n  { immediate: false }\n)\n\n// Listen for changes in prompt value, only for logging purposes\nwatch(\n  () => prompt.value,\n  (newPrompt, oldPrompt) => {\n    console.log('[Direct] prompt value changed from:', oldPrompt, 'to:', newPrompt)\n    // Prompt is now only used for input field initial value, no automatic execution\n  },\n  { immediate: false }\n)\n\n// Listen for changes in taskToInput (for handling cron task template setting)\nwatch(\n  () => taskStore.taskToInput,\n  newTaskToInput => {\n    console.log('[Direct] Watch taskStore.taskToInput triggered, newTaskToInput:', newTaskToInput)\n    if (newTaskToInput.trim()) {\n      console.log('[Direct] Setting input value from taskToInput:', newTaskToInput)\n      nextTick(() => {\n        if (inputRef.value && typeof inputRef.value.setInputValue === 'function') {\n          inputRef.value.setInputValue(newTaskToInput.trim())\n          console.log('[Direct] Input value set from taskToInput watch:', newTaskToInput.trim())\n          // Clear the taskToInput after setting\n          taskStore.getAndClearTaskToInput()\n        }\n      })\n    }\n  },\n  { immediate: false }\n)\n\nonUnmounted(() => {\n  console.log('[Direct] onUnmounted called, cleaning up resources')\n\n  // Clear current root plan ID\n  currentRootPlanId.value = null\n\n  // Clean up plan execution manager resources\n  planExecutionManager.cleanup()\n\n  // Remove event listeners\n  document.removeEventListener('mousemove', handleMouseMove)\n  document.removeEventListener('mouseup', handleMouseUp)\n  window.removeEventListener('plan-execution-requested', ((event: CustomEvent) => {\n    handlePlanExecutionRequested(event.detail)\n  }) as EventListener)\n})\n\n// Methods related to panel size adjustment\nconst startResize = (e: MouseEvent) => {\n  isResizing.value = true\n  startX.value = e.clientX\n  startLeftWidth.value = leftPanelWidth.value\n\n  document.addEventListener('mousemove', handleMouseMove)\n  document.addEventListener('mouseup', handleMouseUp)\n  document.body.style.cursor = 'col-resize'\n  document.body.style.userSelect = 'none'\n\n  e.preventDefault()\n}\n\nconst handleMouseMove = (e: MouseEvent) => {\n  if (!isResizing.value) return\n\n  const containerWidth = window.innerWidth\n  const deltaX = e.clientX - startX.value\n  const deltaPercent = (deltaX / containerWidth) * 100\n\n  let newWidth = startLeftWidth.value + deltaPercent\n\n  // Limit panel width between 20% and 80%\n  newWidth = Math.max(20, Math.min(80, newWidth))\n\n  leftPanelWidth.value = newWidth\n}\n\nconst handleMouseUp = () => {\n  isResizing.value = false\n  document.removeEventListener('mousemove', handleMouseMove)\n  document.removeEventListener('mouseup', handleMouseUp)\n  document.body.style.cursor = ''\n  document.body.style.userSelect = ''\n\n  // Save to localStorage\n  localStorage.setItem('directPanelWidth', leftPanelWidth.value.toString())\n}\n\nconst resetPanelSize = () => {\n  leftPanelWidth.value = 50\n  localStorage.setItem('directPanelWidth', '50')\n}\n\n// Helper function to check if the event should be processed for the current plan\nconst shouldProcessEventForCurrentPlan = (\n  rootPlanId: string,\n  allowSpecialIds: boolean = false\n): boolean => {\n  // If no current plan is set, allow all events (initial state)\n  if (!currentRootPlanId.value) {\n    return true\n  }\n\n  // Check if this event is for the current active plan\n  if (rootPlanId === currentRootPlanId.value) {\n    return true\n  }\n\n  // Allow special IDs for UI state updates (error handling, etc.)\n  if (allowSpecialIds && (rootPlanId === 'ui-state' || rootPlanId === 'error')) {\n    return true\n  }\n\n  // Otherwise, ignore the event\n  console.log(\n    '[Direct] Ignoring event for non-current rootPlanId:',\n    rootPlanId,\n    'current:',\n    currentRootPlanId.value\n  )\n  return false\n}\n\n// Handle message sending from ChatContainer via event\nconst handleChatSendMessage = async (query: InputMessage) => {\n  let assistantMessage: any = null\n\n  try {\n    console.log('[DirectView] Processing send-message event:', query)\n\n    // Validate input - don't send empty requests to backend\n    if (!query.input.trim()) {\n      console.warn('[DirectView] Empty input detected, skipping backend request')\n      return\n    }\n\n    // Add user message to UI\n    const userMessage = chatRef.value?.addMessage('user', query.input)\n    if ((query as any).attachments && userMessage) {\n      chatRef.value?.updateMessage(userMessage.id, { attachments: (query as any).attachments })\n    }\n\n    // Add assistant thinking message\n    assistantMessage = chatRef.value?.addMessage('assistant', '', {\n      thinking: t('chat.thinkingProcessing'),\n    })\n\n    if (assistantMessage) {\n      chatRef.value?.startStreaming(assistantMessage.id)\n    }\n\n    // Import and call DirectApiService to send message to backend\n    const { DirectApiService } = await import('@/api/direct-api-service')\n\n    // Check if a specific tool is selected (toolName and replacementParams in query)\n    const queryAny = query as any\n    let response: any\n\n    if (queryAny.toolName && queryAny.replacementParams) {\n      // Execute selected tool\n      console.log(\n        '[DirectView] Calling DirectApiService.executeByToolName with tool:',\n        queryAny.toolName\n      )\n      response = await DirectApiService.executeByToolName(\n        queryAny.toolName,\n        queryAny.replacementParams,\n        query.uploadedFiles,\n        query.uploadKey\n      )\n    } else {\n      // Use default plan template\n      console.log('[DirectView] Calling DirectApiService.sendMessageWithDefaultPlan')\n      response = await DirectApiService.sendMessageWithDefaultPlan(query)\n    }\n\n    console.log('[DirectView] API response received:', response)\n\n    // Handle the response\n    if (response.planId && assistantMessage) {\n      // Plan mode: Update message with plan execution info\n      chatRef.value?.updateMessage(assistantMessage.id, {\n        thinking: t('chat.planningExecution'),\n        planExecution: {\n          currentPlanId: response.planId,\n          rootPlanId: response.planId,\n          status: 'running',\n        },\n      })\n\n      // Set current root plan ID for the new plan execution\n      currentRootPlanId.value = response.planId\n      console.log('[DirectView] Set currentRootPlanId to:', response.planId)\n\n      // Start polling for plan updates\n      planExecutionManager.handlePlanExecutionRequested(response.planId, query.input)\n      console.log('[DirectView] Started polling for plan execution updates')\n    } else if (assistantMessage) {\n      // Direct mode: Show the response\n      chatRef.value?.updateMessage(assistantMessage.id, {\n        content: response.message || response.result || 'No response received from backend',\n      })\n      chatRef.value?.stopStreaming(assistantMessage.id)\n    }\n  } catch (error: any) {\n    console.error('[DirectView] Send message failed:', error)\n\n    // Show error message\n    chatRef.value?.addMessage('assistant', `Error: ${error?.message || 'Failed to send message'}`)\n    if (assistantMessage) {\n      chatRef.value?.stopStreaming(assistantMessage.id)\n    }\n  }\n}\n\n// Event handler for input area send button\nconst handleSendMessage = async (message: InputMessage) => {\n  console.log('[DirectView] Send message from input:', JSON.stringify(message))\n\n  // Directly handle the message sending\n  await handleChatSendMessage(message)\n}\n\nconst handleInputClear = () => {\n  console.log('[DirectView] Input cleared')\n  if (inputRef.value && typeof inputRef.value.clear === 'function') {\n    inputRef.value.clear()\n  }\n}\n\nconst handleInputFocus = () => {\n  console.log('[DirectView] Input focused')\n}\n\nconst handleInputUpdateState = (enabled: boolean, placeholder?: string) => {\n  console.log('[DirectView] Input state updated:', enabled, placeholder)\n  isLoading.value = !enabled\n}\n\nconst handleStepSelected = (stepId: string) => {\n  console.log('[DirectView] Step selected:', stepId)\n\n  // Forward step selection to right panel\n  if (rightPanelRef.value && typeof rightPanelRef.value.handleStepSelected === 'function') {\n    console.log('[DirectView] Forwarding step selection to right panel:', stepId)\n    rightPanelRef.value.handleStepSelected(stepId)\n  } else {\n    console.warn('[DirectView] rightPanelRef.handleStepSelected method not available')\n  }\n}\n\nconst handleSubPlanStepSelected = (\n  parentPlanId: string,\n  subPlanId: string,\n  stepIndex: number,\n  subStepIndex: number\n) => {\n  console.log('[DirectView] Sub plan step selected:', {\n    parentPlanId,\n    subPlanId,\n    stepIndex,\n    subStepIndex,\n  })\n\n  // Forward sub plan step selection to right panel\n  if (rightPanelRef.value && typeof rightPanelRef.value.handleSubPlanStepSelected === 'function') {\n    console.log('[DirectView] Forwarding sub plan step selection to right panel:', {\n      parentPlanId,\n      subPlanId,\n      stepIndex,\n      subStepIndex,\n    })\n    rightPanelRef.value.handleSubPlanStepSelected(parentPlanId, subPlanId, stepIndex, subStepIndex)\n  } else {\n    console.warn('[DirectView] rightPanelRef.handleSubPlanStepSelected method not available')\n  }\n}\n\nconst handlePlanModeClicked = () => {\n  console.log('[DirectView] Plan mode button clicked')\n  // Toggle sidebar display state\n  sidebarStore.toggleSidebar()\n  console.log('[DirectView] Sidebar toggled, isCollapsed:', sidebarStore.isCollapsed)\n}\n\nconst goBack = () => {\n  router.push('/home')\n}\n\nconst handleConfig = () => {\n  router.push('/configs')\n}\n\nconst handlePlanExecutionRequested = async (payload: PlanExecutionRequestPayload) => {\n  console.log('[DirectView] Plan execution requested:', payload)\n\n  // Prevent duplicate execution\n  if (isExecutingPlan.value) {\n    console.log('[DirectView] Plan execution already in progress, ignoring request')\n    return\n  }\n\n  isExecutingPlan.value = true\n\n  // Mark whether user message has been added\n  let userMessageAdded = false\n  let assistantMessage: any = null\n\n  // Add user and assistant messages using the same pattern as handleChatSendMessage\n  try {\n    console.log('[DirectView] Adding messages for plan execution:', payload.title)\n\n    // Add user message\n    chatRef.value?.addMessage('user', payload.title)\n    userMessageAdded = true\n\n    // Add assistant message to show system feedback\n    assistantMessage = chatRef.value?.addMessage('assistant', '', {\n      thinking: t('chat.planningExecution'),\n    })\n\n    if (assistantMessage) {\n      chatRef.value?.startStreaming(assistantMessage.id)\n      console.log('[DirectView] Added assistant message for plan execution:', assistantMessage.id)\n    }\n  } catch (messageError) {\n    console.warn('[DirectView] Failed to add messages:', messageError)\n  }\n  try {\n    // Get the plan template ID\n    const planTemplateId = payload.planData.planTemplateId\n\n    if (!planTemplateId) {\n      throw new Error(t('direct.planTemplateIdNotFound'))\n    }\n\n    console.log(\n      '[Direct] Executing plan with templateId:',\n      planTemplateId,\n      'params:',\n      payload.params\n    )\n\n    // Call real API to execute plan\n    console.log('[Direct] About to call PlanActApiService.executePlan')\n\n    // Get uploaded files from InputArea component\n    const uploadedFiles = payload.uploadedFiles ?? []\n    const uploadKey = payload.uploadKey ?? undefined\n\n    console.log('[Direct]  DEBUG - InputArea uploadedFiles:', uploadedFiles)\n    console.log('[Direct]  DEBUG - InputArea uploadKey:', uploadKey)\n    console.log('[Direct] Executing with uploaded files:', uploadedFiles.length)\n    console.log('[Direct] Executing with replacement params:', payload.replacementParams)\n\n    let response\n    if (payload.params?.trim()) {\n      console.log('[Direct] Calling executePlan with rawParam:', payload.params.trim())\n      response = await PlanActApiService.executePlan(\n        planTemplateId,\n        payload.params.trim(),\n        uploadedFiles,\n        payload.replacementParams,\n        uploadKey\n      )\n    } else {\n      console.log('[Direct] Calling executePlan without rawParam')\n      response = await PlanActApiService.executePlan(\n        planTemplateId,\n        undefined,\n        uploadedFiles,\n        payload.replacementParams,\n        uploadKey\n      )\n    }\n\n    console.log('[Direct] Plan execution API response:', response)\n\n    // Use the returned planId to start the plan execution process\n    if (response.planId && assistantMessage) {\n      console.log('[Direct] Got planId from response:', response.planId, 'starting plan execution')\n\n      // Update assistant message with plan execution info\n      chatRef.value?.updateMessage(assistantMessage.id, {\n        thinking: t('chat.planningExecution'),\n        planExecution: {\n          currentPlanId: response.planId,\n          rootPlanId: response.planId,\n          status: 'running',\n        },\n      })\n\n      // Set current root plan ID for the new plan execution\n      currentRootPlanId.value = response.planId\n      console.log('[Direct] Set currentRootPlanId to:', response.planId)\n\n      // Use planExecutionManager to handle plan execution\n      console.log('[Direct] Delegating plan execution to planExecutionManager')\n      planExecutionManager.handlePlanExecutionRequested(response.planId, payload.title)\n    } else {\n      console.error('[Direct] No planId in response:', response)\n      throw new Error(t('direct.executionFailedNoPlanId'))\n    }\n  } catch (error: any) {\n    console.error('[Direct] Plan execution failed:', error)\n    console.error('[Direct] Error details:', { message: error.message, stack: error.stack })\n\n    // Clear current root plan ID on error\n    currentRootPlanId.value = null\n\n    // Handle error messages using consistent pattern\n    try {\n      console.log('[Direct] Adding error messages to chat')\n\n      // Only add user message if it hasn't been added before\n      if (!userMessageAdded) {\n        chatRef.value?.addMessage('user', payload.title)\n      }\n\n      // Update assistant message with error or add new error message\n      if (assistantMessage) {\n        chatRef.value?.updateMessage(assistantMessage.id, {\n          content: `${t('direct.executionFailed')}: ${error.message || t('common.unknownError')}`,\n          thinking: undefined,\n        })\n        chatRef.value?.stopStreaming(assistantMessage.id)\n      } else {\n        chatRef.value?.addMessage(\n          'assistant',\n          `${t('direct.executionFailed')}: ${error.message || t('common.unknownError')}`\n        )\n      }\n    } catch (errorHandlingError) {\n      console.error('[Direct] Failed to add error messages:', errorHandlingError)\n      // Note: This would need toast import if used in this context\n      alert(`${t('direct.executionFailed')}: ${error.message || t('common.unknownError')}`)\n    }\n  } finally {\n    console.log('[Direct] Plan execution finished, resetting isExecutingPlan flag')\n    isExecutingPlan.value = false\n  }\n}\n\nconst memorySelected = () => {\n  chatRef.value.showMemory()\n}\n\nconst newChat = () => {\n  memoryStore.clearMemoryId()\n  chatRef.value.newChat()\n}\n</script>\n\n<style lang=\"less\" scoped>\n.direct-page {\n  width: 100%;\n  display: flex;\n  position: relative;\n}\n\n.direct-chat {\n  height: 100vh;\n  width: 100%;\n  background: #0a0a0a;\n  display: flex;\n}\n\n.left-panel {\n  position: relative;\n  border-right: none; /* Remove the original border, which will be provided by the resizer */\n  display: flex;\n  flex-direction: column;\n  height: 100vh; /* Use fixed height */\n  overflow: hidden; /* Prevent panel itself overflow */\n  transition: width 0.1s ease; /* Smooth transition */\n}\n\n.panel-resizer {\n  width: 6px;\n  height: 100vh;\n  background: #1a1a1a;\n  cursor: col-resize;\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: background-color 0.2s ease;\n  flex-shrink: 0;\n\n  &:hover {\n    background: #2a2a2a;\n\n    .resizer-line {\n      background: #4a90e2;\n      width: 2px;\n    }\n  }\n\n  &:active {\n    background: #3a3a3a;\n  }\n}\n\n.resizer-line {\n  width: 1px;\n  height: 40px;\n  background: #3a3a3a;\n  border-radius: 1px;\n  transition: all 0.2s ease;\n}\n\n/* Adjust right panel styles */\n:deep(.right-panel) {\n  transition: width 0.1s ease;\n}\n\n.chat-header {\n  padding: 20px 24px;\n  border-bottom: 1px solid #1a1a1a;\n  display: flex;\n  align-items: center;\n  gap: 16px;\n  background: rgba(255, 255, 255, 0.02);\n  flex-shrink: 0; /* Ensure the header will not be compressed */\n  position: sticky; /* Fix the header at the top */\n  top: 0;\n  z-index: 100;\n\n  h2 {\n    flex: 1;\n    margin: 0;\n    font-size: 18px;\n    font-weight: 600;\n    color: #ffffff;\n  }\n}\n\n.chat-content {\n  flex: 1; /* Occupy remaining space */\n  display: flex;\n  flex-direction: column;\n  min-height: 0; /* Allow shrink */\n  overflow: hidden; /* Prevent overflow */\n}\n\n.header-actions {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n.back-button {\n  padding: 8px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: #ffffff;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  font-size: 14px;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.1);\n    border-color: rgba(255, 255, 255, 0.2);\n  }\n}\n\n.config-button {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 32px;\n  height: 32px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: #ffffff;\n  cursor: pointer;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.1);\n    border-color: rgba(255, 255, 255, 0.2);\n  }\n}\n\n.cron-task-btn {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 32px;\n  height: 32px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: #ffffff;\n  cursor: pointer;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.1);\n    border-color: rgba(255, 255, 255, 0.2);\n  }\n}\n\n.loading-prompt {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: #888888;\n  font-size: 16px;\n  padding: 50px;\n}\n\n/* Message toast styles */\n.message-toast {\n  position: fixed;\n  top: 80px;\n  right: 24px;\n  z-index: 9999;\n  min-width: 320px;\n  max-width: 480px;\n  padding: 16px 20px;\n  border-radius: 8px;\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  animation: slideInRight 0.3s ease-out;\n  font-size: 14px;\n  font-weight: 500;\n}\n\n.message-toast.error {\n  color: #fff2f0;\n  background-color: #ff4d4f;\n}\n\n.message-content {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex: 1;\n  word-break: break-all;\n}\n\n.message-content i {\n  font-size: 16px;\n}\n</style>\n"],"file":"assets/index-DvuWySBz.js"}