{"version":3,"mappings":"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","names":["useTaskStore","defineStore","currentTask","ref","taskToInput","hasVisitedHome","prompt","newTask","task","result","stored","payload","planId","DirectApiService","__vitePreload","directApiService","error","SidebarStore","tab","sidebarStore","reactive","PlanTemplateApiService","response","errorData","errorMessage","err","data","planTemplateId","MemoryStore","savedConversationId","memoryId","conversationId","messages","memoryStore","query","LlmCheckService","requestBody","requestSource","toolName","replacementParams","uploadedFiles","uploadKey","errorText","PlanActApiService","rawParam","usePlanTemplateConfig","config","isLoading","isUserUpdating","needsFullRefresh","planVersions","currentVersionIndex","planTemplateList","selectedTemplate","currentPlanTemplateId","getTitle","getPlanType","getServiceGroup","setTitle","title","setSteps","steps","setPlanType","planType","setPlanTemplateId","setServiceGroup","serviceGroup","setToolConfig","toolConfig","setToolDescription","toolDescription","setEnableInternalToolcall","enable","setEnableHttpService","setInputSchema","inputSchema","getConfig","setConfig","newConfig","updatedConfig","step","reset","generateJsonString","jsonConfig","fromJsonString","jsonString","parsed","canRollback","computed","canRestore","rollbackVersion","versionContent","restoreVersion","updateVersionsAfterSave","content","load","loadedConfig","versionsResponse","versionError","save","templateIndex","t","validate","errors","parseDateTime","dateValue","getAllCoordinatorToolsFromTemplates","tools","template","inputSchemaJson","tool","getCoordinatorToolConfig","withUpdateGuard","callback","singletonInstance","usePlanTemplateConfigSingleton","TemplateStore","savedMethod","saved","groupName","key","currentState","method","configVOs","message","emptyTemplate","i18n","storeInstance","templateConfigRef","templateStore","sortedTemplatesComputed","templates","a","b","timeA","titleA","titleB","groups","ungrouped","sortedGroups","templatesInGroup","sorted","groupedTemplatesComputed"],"ignoreList":[],"sources":["../../src/stores/task.ts","../../src/stores/sidebar.ts","../../src/api/plan-template-with-tool-api-service.ts","../../src/stores/memory.ts","../../src/api/direct-api-service.ts","../../src/api/plan-act-api-service.ts","../../src/composables/usePlanTemplateConfig.ts","../../src/stores/templateStore.ts"],"sourcesContent":["/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { defineStore } from 'pinia'\nimport { ref } from 'vue'\n\nexport interface TaskPayload {\n  prompt: string\n  timestamp: number\n  processed?: boolean\n  planId?: string\n  isRunning?: boolean\n}\n\nexport const useTaskStore = defineStore('task', () => {\n  const currentTask = ref<TaskPayload | null>(null)\n  const taskToInput = ref<string>('')\n  const hasVisitedHome = ref(false)\n\n  // Set new task\n  const setTask = (prompt: string) => {\n    console.log('[TaskStore] setTask called with prompt:', prompt)\n\n    // Don't create tasks with empty prompts\n    if (!prompt.trim()) {\n      console.warn('[TaskStore] Empty prompt provided, not creating task')\n      return\n    }\n\n    const newTask = {\n      prompt,\n      timestamp: Date.now(),\n      processed: false,\n    }\n    currentTask.value = newTask\n    console.log('[TaskStore] Task set, currentTask.value:', currentTask.value)\n  }\n\n  // Set task to input (for pre-filling input without executing)\n  const setTaskToInput = (prompt: string) => {\n    console.log('[TaskStore] setTaskToInput called with prompt:', prompt)\n    taskToInput.value = prompt\n    console.log('[TaskStore] Task to input set:', taskToInput.value)\n  }\n\n  // Get and clear task to input\n  const getAndClearTaskToInput = () => {\n    const task = taskToInput.value\n    taskToInput.value = ''\n    console.log('[TaskStore] getAndClearTaskToInput returning:', task)\n    return task\n  }\n\n  // Mark task as processed\n  const markTaskAsProcessed = () => {\n    console.log('[TaskStore] markTaskAsProcessed called, current task:', currentTask.value)\n    if (currentTask.value) {\n      currentTask.value.processed = true\n      console.log('[TaskStore] Task marked as processed:', currentTask.value)\n    } else {\n      console.log('[TaskStore] No current task to mark as processed')\n    }\n  }\n\n  // Clear task\n  const clearTask = () => {\n    currentTask.value = null\n  }\n\n  // Check if there are unprocessed tasks\n  const hasUnprocessedTask = () => {\n    const result = currentTask.value && !currentTask.value.processed\n    console.log(\n      '[TaskStore] hasUnprocessedTask check - currentTask:',\n      currentTask.value,\n      'result:',\n      result\n    )\n    return result\n  }\n\n  // Set that home page has been visited\n  const markHomeVisited = () => {\n    hasVisitedHome.value = true\n    // Save to localStorage\n    localStorage.setItem('hasVisitedHome', 'true')\n  }\n\n  // Check if home page has been visited\n  const checkHomeVisited = () => {\n    const stored = localStorage.getItem('hasVisitedHome')\n    hasVisitedHome.value = stored === 'true'\n    return hasVisitedHome.value\n  }\n\n  // Reset visit status (for debugging or reset)\n  const resetHomeVisited = () => {\n    hasVisitedHome.value = false\n    localStorage.removeItem('hasVisitedHome')\n  }\n\n  // Emit plan execution requested event\n  const emitPlanExecutionRequested = (payload: {\n    title: string\n    planData: unknown\n    params?: string\n  }) => {\n    console.log('[TaskStore] emitPlanExecutionRequested called with payload:', payload)\n\n    // User is on direct page, send event directly\n    window.dispatchEvent(new CustomEvent('plan-execution-requested', { detail: payload }))\n  }\n\n  // Set task as running with plan ID\n  const setTaskRunning = (planId: string) => {\n    console.log('[TaskStore] setTaskRunning called with planId:', planId)\n    // Create a task if none exists, or update existing one\n    if (!currentTask.value) {\n      // Create a new task for running state\n      currentTask.value = {\n        prompt: '', // Empty prompt since this is just for tracking running state\n        timestamp: Date.now(),\n        processed: false,\n        planId: planId,\n        isRunning: true,\n      }\n      console.log('[TaskStore] Created new task for running state:', currentTask.value)\n    } else {\n      currentTask.value.planId = planId\n      currentTask.value.isRunning = true\n      console.log('[TaskStore] Updated existing task:', currentTask.value)\n    }\n  }\n\n  // Stop current running task\n  const stopCurrentTask = async () => {\n    console.log('[TaskStore] stopCurrentTask called')\n    if (currentTask.value && currentTask.value.isRunning && currentTask.value.planId) {\n      try {\n        const { DirectApiService } = await import('@/api/direct-api-service')\n        await DirectApiService.stopTask(currentTask.value.planId)\n        console.log('[TaskStore] Task stopped successfully')\n\n        // Mark task as no longer running\n        currentTask.value.isRunning = false\n        return true\n      } catch (error) {\n        console.error('[TaskStore] Failed to stop task:', error)\n        return false\n      }\n    }\n    return false\n  }\n\n  // Check if there's a running task\n  const hasRunningTask = () => {\n    const result = currentTask.value && currentTask.value.isRunning\n    console.log('[TaskStore] hasRunningTask check - result:', result)\n    return result\n  }\n\n  return {\n    currentTask,\n    taskToInput,\n    hasVisitedHome,\n    setTask,\n    setTaskToInput,\n    getAndClearTaskToInput,\n    markTaskAsProcessed,\n    clearTask,\n    hasUnprocessedTask,\n    markHomeVisited,\n    checkHomeVisited,\n    resetHomeVisited,\n    emitPlanExecutionRequested,\n    setTaskRunning,\n    stopCurrentTask,\n    hasRunningTask,\n  }\n})\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { reactive } from 'vue'\n\ntype TabType = 'list' | 'config'\n\nexport class SidebarStore {\n  // Basic state (sidebar UI state only)\n  isCollapsed = false\n  currentTab: TabType = 'list'\n\n  // Actions\n  toggleSidebar() {\n    this.isCollapsed = !this.isCollapsed\n  }\n\n  switchToTab(tab: TabType) {\n    this.currentTab = tab\n  }\n}\n\nexport const sidebarStore = reactive(new SidebarStore())\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type {\n  CreateOrUpdatePlanTemplateWithToolResponse,\n  PlanTemplateConfigVO,\n} from '../types/plan-template'\n\n/**\n * Plan template API service class\n * Provides plan template-related functionality\n */\nexport class PlanTemplateApiService {\n  /**\n   * Handle HTTP response\n   */\n  private static async handleResponse(response: Response) {\n    if (!response.ok) {\n      try {\n        const errorData = await response.json()\n        // Create error with errorCode if available\n        // Backend returns \"error\" field, but we use \"message\" for consistency\n        const errorMessage =\n          errorData.error || errorData.message || `API request failed: ${response.status}`\n        const error = new Error(errorMessage) as Error & {\n          errorCode?: string\n        }\n        if (errorData.errorCode) {\n          error.errorCode = errorData.errorCode\n        }\n        throw error\n      } catch (err) {\n        if (err instanceof Error) {\n          throw err\n        }\n        throw new Error(`API request failed: ${response.status} ${response.statusText}`)\n      }\n    }\n    return response\n  }\n\n  /**\n   * Create or update plan template and register as coordinator tool\n   * This method combines the functionality of both \"Save Plan Template\" and\n   * \"Register Plan Templates as Toolcalls\" by using PlanTemplateConfigVO\n   */\n  static async createOrUpdatePlanTemplateWithTool(\n    data: PlanTemplateConfigVO\n  ): Promise<CreateOrUpdatePlanTemplateWithToolResponse> {\n    try {\n      const response = await fetch('/api/plan-template/create-or-update-with-tool', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(data),\n      })\n      const result = await this.handleResponse(response)\n      return await result.json()\n    } catch (error) {\n      console.error('Failed to create or update plan template with tool:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Get plan template configuration VO by plan template ID\n   */\n  static async getPlanTemplateConfigVO(planTemplateId: string): Promise<PlanTemplateConfigVO> {\n    try {\n      const response = await fetch(`/api/plan-template/${planTemplateId}/config`)\n      const result = await this.handleResponse(response)\n      return await result.json()\n    } catch (error) {\n      console.error('Failed to get plan template config VO:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Get all plan template configuration VOs\n   */\n  static async getAllPlanTemplateConfigVOs(): Promise<PlanTemplateConfigVO[]> {\n    try {\n      const response = await fetch('/api/plan-template/list-config')\n      const result = await this.handleResponse(response)\n      return await result.json()\n    } catch (error) {\n      console.error('Failed to get all plan template config VOs:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Delete plan template\n   */\n  static async deletePlanTemplate(planTemplateId: string): Promise<unknown> {\n    try {\n      const response = await fetch('/api/plan-template/delete', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ planId: planTemplateId }),\n      })\n      const result = await this.handleResponse(response)\n      return await result.json()\n    } catch (error) {\n      console.error('Failed to delete plan template:', error)\n      throw error\n    }\n  }\n}\n","/*\n * Copyright 2024-2026 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { reactive } from 'vue'\n\nexport interface MemoryEmits {\n  (e: 'memory-selected'): void\n}\n\nexport class MemoryStore {\n  // Basic state\n  isCollapsed = false\n  selectMemoryId = ''\n  conversationId: string | null = null\n  loadMessages = () => {}\n  intervalId: number | undefined = undefined\n\n  // LocalStorage key for persisting conversationId\n  private readonly CONVERSATION_ID_KEY = 'currentConversationId'\n\n  constructor() {\n    // Load conversation ID from localStorage on initialization\n    this.loadConversationIdFromStorage()\n  }\n\n  /**\n   * Load conversation ID from localStorage\n   */\n  private loadConversationIdFromStorage() {\n    try {\n      const savedConversationId = localStorage.getItem(this.CONVERSATION_ID_KEY)\n      if (savedConversationId) {\n        this.conversationId = savedConversationId\n        console.log('[MemoryStore] Restored conversationId from localStorage:', savedConversationId)\n      }\n    } catch (error) {\n      console.warn('[MemoryStore] Failed to load conversationId from localStorage:', error)\n    }\n  }\n\n  /**\n   * Save conversation ID to localStorage\n   */\n  private saveConversationIdToStorage() {\n    try {\n      if (this.conversationId) {\n        localStorage.setItem(this.CONVERSATION_ID_KEY, this.conversationId)\n        console.log('[MemoryStore] Saved conversationId to localStorage:', this.conversationId)\n      } else {\n        localStorage.removeItem(this.CONVERSATION_ID_KEY)\n        console.log('[MemoryStore] Removed conversationId from localStorage')\n      }\n    } catch (error) {\n      console.warn('[MemoryStore] Failed to save conversationId to localStorage:', error)\n    }\n  }\n\n  toggleSidebar() {\n    this.isCollapsed = !this.isCollapsed\n    if (this.isCollapsed) {\n      this.loadMessages()\n      this.intervalId = window.setInterval(() => {\n        this.loadMessages()\n      }, 3000)\n    } else {\n      clearInterval(this.intervalId)\n    }\n  }\n\n  selectMemory(memoryId: string) {\n    this.toggleSidebar()\n    this.selectMemoryId = memoryId\n  }\n\n  setMemory(memoryId: string) {\n    this.selectMemoryId = memoryId\n  }\n\n  defaultMemoryId() {\n    this.selectMemoryId = this.generateRandomId()\n  }\n\n  clearMemoryId() {\n    this.selectMemoryId = ''\n  }\n\n  setConversationId(conversationId: string | null) {\n    this.conversationId = conversationId\n    // Persist to localStorage whenever conversationId changes\n    this.saveConversationIdToStorage()\n  }\n\n  clearConversationId() {\n    this.conversationId = null\n    // Clear from localStorage\n    this.saveConversationIdToStorage()\n  }\n\n  /**\n   * Get the current conversation ID (from memory or localStorage)\n   */\n  getConversationId(): string | null {\n    return this.conversationId\n  }\n\n  generateRandomId(): string {\n    return Math.random().toString(36).substring(2, 10)\n  }\n\n  setLoadMessages(messages: () => void) {\n    this.loadMessages = messages\n  }\n}\n\nexport const memoryStore = reactive(new MemoryStore())\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { InputMessage } from '@/types/message-dialog'\nimport { memoryStore } from '@/stores/memory'\nimport { LlmCheckService } from '@/utils/llm-check'\n\nexport class DirectApiService {\n  private static readonly BASE_URL = '/api/executor'\n\n  // Send task directly (direct execution mode)\n  public static async sendMessage(query: InputMessage): Promise<unknown> {\n    return LlmCheckService.withLlmCheck(async () => {\n      // Add requestSource to distinguish from HTTP requests\n      const requestBody = {\n        ...query,\n        requestSource: 'VUE_DIALOG',\n      }\n\n      const response = await fetch(`${this.BASE_URL}/execute`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(requestBody),\n      })\n      if (!response.ok) throw new Error(`API request failed: ${response.status}`)\n      return await response.json()\n    })\n  }\n\n  // Send task using executeByToolNameAsync with default plan template\n  public static async sendMessageWithDefaultPlan(\n    query: InputMessage,\n    requestSource: 'VUE_DIALOG' | 'VUE_SIDEBAR' = 'VUE_DIALOG'\n  ): Promise<unknown> {\n    // Use default plan template ID as toolName\n    const toolName = 'default-plan-id-001000222'\n\n    // Create replacement parameters with user input\n    const replacementParams = {\n      userRequirement: query.input,\n    }\n\n    // Note: conversationId will be included from memoryStore in executeByToolName\n    return this.executeByToolName(\n      toolName,\n      replacementParams,\n      query.uploadedFiles,\n      query.uploadKey,\n      requestSource\n    )\n  }\n\n  // Unified method to execute by tool name (replaces both sendMessageWithDefaultPlan and PlanActApiService.executePlan)\n  public static async executeByToolName(\n    toolName: string,\n    replacementParams?: Record<string, string>,\n    uploadedFiles?: string[],\n    uploadKey?: string,\n    requestSource: 'VUE_DIALOG' | 'VUE_SIDEBAR' = 'VUE_DIALOG'\n  ): Promise<unknown> {\n    return LlmCheckService.withLlmCheck(async () => {\n      console.log('[DirectApiService] executeByToolName called with:', {\n        toolName,\n        replacementParams,\n        uploadedFiles,\n        uploadKey,\n        requestSource,\n      })\n\n      const requestBody: Record<string, unknown> = {\n        toolName: toolName,\n        requestSource: requestSource,\n      }\n\n      // Include conversationId from memoryStore if available\n      if (memoryStore.conversationId) {\n        requestBody.conversationId = memoryStore.conversationId\n        console.log(\n          '[DirectApiService] Including conversationId from memoryStore:',\n          memoryStore.conversationId\n        )\n      }\n\n      // Include replacement parameters if present\n      if (replacementParams && Object.keys(replacementParams).length > 0) {\n        requestBody.replacementParams = replacementParams\n        console.log('[DirectApiService] Including replacement params:', replacementParams)\n      }\n\n      // Include uploaded files if present\n      if (uploadedFiles && uploadedFiles.length > 0) {\n        requestBody.uploadedFiles = uploadedFiles\n        console.log('[DirectApiService] Including uploaded files:', uploadedFiles.length)\n      }\n\n      // Include uploadKey if present\n      if (uploadKey) {\n        requestBody.uploadKey = uploadKey\n        console.log('[DirectApiService] Including uploadKey:', uploadKey)\n      }\n\n      console.log(\n        '[DirectApiService] Making request to:',\n        `${this.BASE_URL}/executeByToolNameAsync`\n      )\n      console.log('[DirectApiService] Request body:', requestBody)\n\n      const response = await fetch(`${this.BASE_URL}/executeByToolNameAsync`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(requestBody),\n      })\n\n      console.log('[DirectApiService] Response status:', response.status, response.ok)\n\n      if (!response.ok) {\n        const errorText = await response.text()\n        console.error('[DirectApiService] Request failed:', errorText)\n        throw new Error(`Failed to execute: ${response.status}`)\n      }\n\n      const result = await response.json()\n      console.log('[DirectApiService] executeByToolName response:', result)\n      return result\n    })\n  }\n\n  // Stop a running task by plan ID\n  public static async stopTask(planId: string): Promise<unknown> {\n    return LlmCheckService.withLlmCheck(async () => {\n      console.log('[DirectApiService] Stopping task for planId:', planId)\n\n      const response = await fetch(`${this.BASE_URL}/stopTask/${planId}`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n      })\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}))\n        throw new Error(errorData.error || `Failed to stop task: ${response.status}`)\n      }\n\n      return await response.json()\n    })\n  }\n}\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Plan-related API wrapper (TypeScript version for Vue projects)\n\nimport { DirectApiService } from '@/api/direct-api-service'\nimport { LlmCheckService } from '@/utils/llm-check'\n\nexport class PlanActApiService {\n  private static readonly PLAN_TEMPLATE_URL = '/api/plan-template'\n\n  // Execute generated plan using LynxeController.executeByToolNameAsync\n  public static async executePlan(\n    planTemplateId: string,\n    rawParam?: string,\n    uploadedFiles?: string[],\n    replacementParams?: Record<string, string>,\n    uploadKey?: string,\n    requestSource: 'VUE_DIALOG' | 'VUE_SIDEBAR' = 'VUE_SIDEBAR'\n  ): Promise<unknown> {\n    return LlmCheckService.withLlmCheck(async () => {\n      console.log('[PlanActApiService] executePlan called with:', {\n        planTemplateId,\n        rawParam,\n        uploadedFiles,\n        replacementParams,\n        uploadKey,\n        requestSource,\n      })\n\n      // Add rawParam to replacementParams if provided (backend expects it in replacementParams)\n      if (rawParam) {\n        if (!replacementParams) {\n          replacementParams = {}\n        }\n        replacementParams['userRequirement'] = rawParam\n        console.log('[PlanActApiService] Added rawParam to replacementParams:', rawParam)\n      }\n\n      // Use the unified DirectApiService method (default to VUE_SIDEBAR for plan execution)\n      return await DirectApiService.executeByToolName(\n        planTemplateId,\n        replacementParams,\n        uploadedFiles,\n        uploadKey,\n        requestSource\n      )\n    })\n  }\n\n  // Get all versions of plan\n  public static async getPlanVersions(planId: string): Promise<unknown> {\n    const response = await fetch(`${this.PLAN_TEMPLATE_URL}/versions`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ planId }),\n    })\n    if (!response.ok) throw new Error(`Failed to get plan versions: ${response.status}`)\n    return await response.json()\n  }\n\n  // Get all plan template list\n  public static async getAllPlanTemplates(): Promise<unknown> {\n    const response = await fetch(`${this.PLAN_TEMPLATE_URL}/list`)\n    if (!response.ok) throw new Error(`Failed to get plan template list: ${response.status}`)\n    return await response.json()\n  }\n}\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { PlanActApiService } from '@/api/plan-act-api-service'\nimport { PlanTemplateApiService } from '@/api/plan-template-with-tool-api-service'\nimport type {\n  InputSchemaParam,\n  PlanTemplateConfigVO,\n  StepConfig,\n  ToolConfigVO,\n} from '@/types/plan-template'\nimport { computed, reactive, ref } from 'vue'\n\n/**\n * Composable for managing PlanTemplateConfigVO\n * Provides getter and setter methods for all properties\n */\nexport function usePlanTemplateConfig() {\n  // Reactive state for PlanTemplateConfigVO\n  const config = reactive<PlanTemplateConfigVO>({\n    title: '',\n    steps: [],\n    directResponse: false,\n    planType: 'dynamic_agent',\n    planTemplateId: '',\n    readOnly: false,\n    serviceGroup: '',\n  })\n\n  // Loading state\n  const isLoading = ref(false)\n  const error = ref<string | null>(null)\n\n  // Flag to prevent watchers from syncing when user is updating individual properties\n  const isUserUpdating = ref(false)\n\n  // Flag to indicate that a full refresh is needed (for load, setConfig, fromJsonString, reset, version control)\n  const needsFullRefresh = ref(false)\n\n  // Version control state\n  const planVersions = ref<string[]>([])\n  const currentVersionIndex = ref(-1)\n\n  // Template list and selection state\n  const planTemplateList = ref<PlanTemplateConfigVO[]>([])\n  const selectedTemplate = ref<PlanTemplateConfigVO | null>(null)\n  const currentPlanTemplateId = ref<string | null>(null)\n\n  // Getters\n  const getTitle = () => config.title\n  const getPlanType = () => config.planType || 'dynamic_agent'\n  const getServiceGroup = () => config.serviceGroup || ''\n\n  // Setters\n  const setTitle = (title: string) => {\n    config.title = title\n  }\n\n  const setSteps = (steps: StepConfig[]) => {\n    config.steps = steps || []\n  }\n\n  const setPlanType = (planType: string) => {\n    config.planType = planType\n  }\n\n  const setPlanTemplateId = (planTemplateId: string) => {\n    config.planTemplateId = planTemplateId\n  }\n\n  const setServiceGroup = (serviceGroup: string) => {\n    config.serviceGroup = serviceGroup\n  }\n\n  const setToolConfig = (toolConfig: ToolConfigVO | undefined) => {\n    if (toolConfig === undefined) {\n      delete config.toolConfig\n    } else {\n      config.toolConfig = toolConfig\n    }\n  }\n\n  // ToolConfig getters (no getters are used, only setters)\n\n  // ToolConfig setters\n  const setToolDescription = (toolDescription: string) => {\n    if (!config.toolConfig) {\n      config.toolConfig = {}\n    }\n    config.toolConfig.toolDescription = toolDescription\n  }\n\n  const setEnableInternalToolcall = (enable: boolean) => {\n    if (!config.toolConfig) {\n      config.toolConfig = {}\n    }\n    config.toolConfig.enableInternalToolcall = enable\n  }\n\n  const setEnableHttpService = (enable: boolean) => {\n    if (!config.toolConfig) {\n      config.toolConfig = {}\n    }\n    config.toolConfig.enableHttpService = enable\n  }\n\n  const setInputSchema = (inputSchema: InputSchemaParam[]) => {\n    if (!config.toolConfig) {\n      config.toolConfig = {}\n    }\n    config.toolConfig.inputSchema = inputSchema || []\n  }\n\n  // Get full config\n  const getConfig = (): PlanTemplateConfigVO => {\n    return { ...config }\n  }\n\n  // Set full config\n  const setConfig = (newConfig: PlanTemplateConfigVO) => {\n    needsFullRefresh.value = true\n    const updatedConfig: PlanTemplateConfigVO = {\n      title: newConfig.title || '',\n      // Deep copy steps to preserve all properties including selectedToolKeys\n      // Convert null selectedToolKeys to empty array for consistency\n      steps: (newConfig.steps || []).map(step => ({\n        ...step,\n        selectedToolKeys: step.selectedToolKeys ?? [],\n      })),\n      directResponse: newConfig.directResponse || false,\n      planType: newConfig.planType || 'dynamic_agent',\n      planTemplateId: newConfig.planTemplateId || '',\n      readOnly: newConfig.readOnly || false,\n      serviceGroup: newConfig.serviceGroup || '',\n    }\n    if (newConfig.toolConfig) {\n      updatedConfig.toolConfig = { ...newConfig.toolConfig }\n    }\n    Object.assign(config, updatedConfig)\n    // Reset flag after reactivity update\n    setTimeout(() => {\n      needsFullRefresh.value = false\n    }, 0)\n  }\n\n  // Reset to default\n  const reset = () => {\n    needsFullRefresh.value = true\n    Object.assign(config, {\n      title: '',\n      steps: [],\n      directResponse: false,\n      planType: 'dynamic_agent',\n      planTemplateId: '',\n      readOnly: false,\n      serviceGroup: '',\n    })\n    // Remove toolConfig if it exists\n    if ('toolConfig' in config) {\n      delete config.toolConfig\n    }\n    planVersions.value = []\n    currentVersionIndex.value = -1\n    error.value = null\n    // Reset flag after reactivity update\n    setTimeout(() => {\n      needsFullRefresh.value = false\n    }, 0)\n  }\n\n  // Dynamically generate JSON from current config state (not cached, regenerated each time)\n  const generateJsonString = (): string => {\n    // Generate fresh JSON from current config state\n    // Ensure selectedToolKeys is always an array (not null) in the output\n    const jsonConfig: PlanTemplateConfigVO = {\n      title: config.title || '',\n      steps: (config.steps || []).map(step => ({\n        ...step,\n        // Ensure selectedToolKeys is always an array, not null\n        selectedToolKeys: step.selectedToolKeys ?? [],\n      })),\n      directResponse: config.directResponse || false,\n      planType: config.planType || 'dynamic_agent',\n      planTemplateId: config.planTemplateId || '',\n      readOnly: config.readOnly || false,\n      serviceGroup: config.serviceGroup || '',\n    }\n    // Include toolConfig if it exists\n    if (config.toolConfig) {\n      jsonConfig.toolConfig = { ...config.toolConfig }\n    }\n    return JSON.stringify(jsonConfig, null, 2)\n  }\n\n  // Load config from JSON string\n  const fromJsonString = (jsonString: string) => {\n    try {\n      const parsed = JSON.parse(jsonString)\n      setConfig(parsed)\n      return true\n    } catch (err) {\n      error.value = err instanceof Error ? err.message : 'Invalid JSON format'\n      return false\n    }\n  }\n\n  // Version control methods\n  const canRollback = computed(() => {\n    return planVersions.value.length > 1 && currentVersionIndex.value > 0\n  })\n\n  const canRestore = computed(() => {\n    return (\n      planVersions.value.length > 1 && currentVersionIndex.value < planVersions.value.length - 1\n    )\n  })\n\n  const rollbackVersion = () => {\n    if (canRollback.value && currentVersionIndex.value > 0) {\n      currentVersionIndex.value--\n      const versionContent = planVersions.value[currentVersionIndex.value] || ''\n      fromJsonString(versionContent)\n    }\n  }\n\n  const restoreVersion = () => {\n    if (canRestore.value && currentVersionIndex.value < planVersions.value.length - 1) {\n      currentVersionIndex.value++\n      const versionContent = planVersions.value[currentVersionIndex.value] || ''\n      fromJsonString(versionContent)\n    }\n  }\n\n  // Update versions after save\n  const updateVersionsAfterSave = (content: string) => {\n    if (currentVersionIndex.value < planVersions.value.length - 1) {\n      planVersions.value = planVersions.value.slice(0, currentVersionIndex.value + 1)\n    }\n    planVersions.value.push(content)\n    currentVersionIndex.value = planVersions.value.length - 1\n  }\n\n  // Load from API\n  const load = async (planTemplateId: string) => {\n    if (!planTemplateId) {\n      error.value = 'Plan template ID is required'\n      return false\n    }\n\n    try {\n      isLoading.value = true\n      error.value = null\n\n      // Load config from API\n      const loadedConfig = await PlanTemplateApiService.getPlanTemplateConfigVO(planTemplateId)\n      setConfig(loadedConfig)\n\n      // Load versions for version control\n      try {\n        const versionsResponse = await PlanActApiService.getPlanVersions(planTemplateId)\n        planVersions.value = (versionsResponse as { versions?: string[] }).versions || []\n        if (planVersions.value.length > 0) {\n          currentVersionIndex.value = planVersions.value.length - 1\n        } else {\n          currentVersionIndex.value = -1\n        }\n      } catch (versionError) {\n        console.warn('Failed to load plan versions:', versionError)\n        planVersions.value = []\n        currentVersionIndex.value = -1\n      }\n\n      return true\n    } catch (err) {\n      error.value = err instanceof Error ? err.message : 'Failed to load plan template config'\n      console.error('Failed to load plan template config:', err)\n      return false\n    } finally {\n      isLoading.value = false\n    }\n  }\n\n  // Save to API\n  const save = async (): Promise<boolean> => {\n    if (!config.planTemplateId) {\n      error.value = 'Plan template ID is required'\n      return false\n    }\n\n    try {\n      isLoading.value = true\n      error.value = null\n\n      const result = await PlanTemplateApiService.createOrUpdatePlanTemplateWithTool(getConfig())\n\n      if (result.success) {\n        // Reload the template to get updated data from backend\n        const planTemplateId = config.planTemplateId\n        if (planTemplateId) {\n          await load(planTemplateId)\n\n          // Update selectedTemplate if it matches the saved template\n          if (selectedTemplate.value?.planTemplateId === planTemplateId) {\n            const loadedConfig = getConfig()\n            selectedTemplate.value = {\n              ...selectedTemplate.value,\n              ...loadedConfig,\n            }\n          }\n\n          // Update planTemplateList if the template exists in the list\n          const templateIndex = planTemplateList.value.findIndex(\n            t => t.planTemplateId === planTemplateId\n          )\n          if (templateIndex >= 0) {\n            const loadedConfig = getConfig()\n            planTemplateList.value[templateIndex] = {\n              ...planTemplateList.value[templateIndex],\n              ...loadedConfig,\n            }\n          }\n        }\n      }\n\n      return result.success\n    } catch (err) {\n      error.value = err instanceof Error ? err.message : 'Failed to save plan template config'\n      console.error('Failed to save plan template config:', err)\n      return false\n    } finally {\n      isLoading.value = false\n    }\n  }\n\n  // Validation\n  const validate = (): { isValid: boolean; errors: string[] } => {\n    const errors: string[] = []\n\n    if (!config.planTemplateId?.trim()) {\n      errors.push('Plan template ID is required')\n    }\n\n    if (!config.title?.trim()) {\n      errors.push('Title is required')\n    }\n\n    if (!config.steps || config.steps.length === 0) {\n      errors.push('At least one step is required')\n    }\n\n    return {\n      isValid: errors.length === 0,\n      errors,\n    }\n  }\n\n  // Computed properties (isValid and hasToolConfig are not used)\n\n  // Utility function to parse date from different formats\n  const parseDateTime = (dateValue: unknown): Date => {\n    if (!dateValue) {\n      return new Date()\n    }\n\n    // If array format [year, month, day, hour, minute, second, nanosecond]\n    if (Array.isArray(dateValue) && dateValue.length >= 6) {\n      // JavaScript Date constructor months start from 0, so subtract 1\n      return new Date(\n        dateValue[0],\n        dateValue[1] - 1,\n        dateValue[2],\n        dateValue[3],\n        dateValue[4],\n        dateValue[5],\n        Math.floor(dateValue[6] / 1000000)\n      )\n    }\n\n    // If string format, parse directly\n    if (typeof dateValue === 'string') {\n      return new Date(dateValue)\n    }\n\n    // Return current time for other cases\n    return new Date()\n  }\n\n  // Action handlers (handleRollback, handleRestore, handleSave are not used)\n\n  /**\n   * Get all coordinator tools from planTemplateList\n   * Filters templates that have toolConfig with enableInternalToolcall enabled\n   * @returns Array of coordinator tools with tool configuration data\n   */\n  const getAllCoordinatorToolsFromTemplates = () => {\n    const tools: Array<{\n      toolName: string\n      toolDescription: string\n      planTemplateId: string\n      inputSchema: string\n      enableInternalToolcall: boolean\n      enableHttpService: boolean\n      enableMcpService: boolean\n      serviceGroup?: string\n    }> = []\n\n    for (const template of planTemplateList.value) {\n      // Only include templates with toolConfig\n      if (!template.toolConfig) {\n        continue\n      }\n\n      const toolConfig = template.toolConfig\n\n      // Only include tools with enableInternalToolcall enabled\n      if (!toolConfig.enableInternalToolcall) {\n        continue\n      }\n\n      // Convert inputSchema array to JSON string\n      let inputSchemaJson = '[]'\n      if (toolConfig.inputSchema && Array.isArray(toolConfig.inputSchema)) {\n        inputSchemaJson = JSON.stringify(toolConfig.inputSchema)\n      }\n\n      const tool: {\n        toolName: string\n        toolDescription: string\n        planTemplateId: string\n        inputSchema: string\n        enableInternalToolcall: boolean\n        enableHttpService: boolean\n        enableMcpService: boolean\n        serviceGroup?: string\n      } = {\n        toolName: template.title || '',\n        toolDescription: toolConfig.toolDescription || '',\n        planTemplateId: template.planTemplateId || '',\n        inputSchema: inputSchemaJson,\n        enableInternalToolcall: toolConfig.enableInternalToolcall ?? true,\n        enableHttpService: toolConfig.enableHttpService ?? false,\n        enableMcpService: toolConfig.enableMcpService ?? false,\n      }\n\n      if (template.serviceGroup) {\n        tool.serviceGroup = template.serviceGroup\n      }\n\n      tools.push(tool)\n    }\n\n    return tools\n  }\n\n  /**\n   * Get coordinator tool configuration status\n   * Determines if coordinator tools are enabled based on planTemplateList\n   * @returns boolean indicating if coordinator tools are enabled\n   */\n  const getCoordinatorToolConfig = (): boolean => {\n    // Check if there are any templates with toolConfig\n    return planTemplateList.value.some(template => template.toolConfig !== undefined)\n  }\n\n  // Helper method to wrap updates with guard flag\n  const withUpdateGuard = <T>(callback: () => T): T => {\n    isUserUpdating.value = true\n    try {\n      return callback()\n    } finally {\n      // Use setTimeout to ensure the flag is reset after reactivity updates\n      setTimeout(() => {\n        isUserUpdating.value = false\n      }, 0)\n    }\n  }\n\n  // Wrapped setters that prevent watcher syncing\n  const setStepsWithGuard = (steps: StepConfig[]) => {\n    return withUpdateGuard(() => {\n      setSteps(steps)\n    })\n  }\n\n  const setToolConfigWithGuard = (toolConfig: ToolConfigVO | undefined) => {\n    return withUpdateGuard(() => {\n      setToolConfig(toolConfig)\n    })\n  }\n\n  const setToolDescriptionWithGuard = (toolDescription: string) => {\n    return withUpdateGuard(() => {\n      setToolDescription(toolDescription)\n    })\n  }\n\n  const setEnableInternalToolcallWithGuard = (enable: boolean) => {\n    return withUpdateGuard(() => {\n      setEnableInternalToolcall(enable)\n    })\n  }\n\n  const setEnableHttpServiceWithGuard = (enable: boolean) => {\n    return withUpdateGuard(() => {\n      setEnableHttpService(enable)\n    })\n  }\n\n  const setInputSchemaWithGuard = (inputSchema: InputSchemaParam[]) => {\n    return withUpdateGuard(() => {\n      setInputSchema(inputSchema)\n    })\n  }\n\n  return {\n    // State\n    config,\n    isLoading,\n    error,\n    isUserUpdating,\n    needsFullRefresh,\n    planVersions,\n    currentVersionIndex,\n    planTemplateList,\n    selectedTemplate,\n    currentPlanTemplateId,\n\n    // Getters\n    getTitle,\n    getPlanType,\n    getServiceGroup,\n    getConfig,\n\n    // Setters\n    setTitle,\n    setSteps,\n    setPlanType,\n    setPlanTemplateId,\n    setServiceGroup,\n    setToolConfig,\n    setToolDescription,\n    setEnableInternalToolcall,\n    setEnableHttpService,\n    setInputSchema,\n    setConfig,\n\n    // Guarded setters (prevent watcher syncing)\n    setStepsWithGuard,\n    setToolConfigWithGuard,\n    setToolDescriptionWithGuard,\n    setEnableInternalToolcallWithGuard,\n    setEnableHttpServiceWithGuard,\n    setInputSchemaWithGuard,\n    withUpdateGuard,\n\n    // Actions\n    reset,\n    load,\n    save,\n    validate,\n    generateJsonString,\n    fromJsonString,\n    rollbackVersion,\n    restoreVersion,\n    updateVersionsAfterSave,\n\n    // Computed\n    canRollback,\n    canRestore,\n\n    // Utility functions\n    parseDateTime,\n\n    // Coordinator tools methods\n    getAllCoordinatorToolsFromTemplates,\n    getCoordinatorToolConfig,\n  }\n}\n\n// Singleton instance for global use\nlet singletonInstance: ReturnType<typeof usePlanTemplateConfig> | null = null\n\n/**\n * Get or create singleton instance of usePlanTemplateConfig\n */\nexport function usePlanTemplateConfigSingleton() {\n  if (!singletonInstance) {\n    singletonInstance = usePlanTemplateConfig()\n  }\n  return singletonInstance\n}\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { PlanTemplateApiService } from '@/api/plan-template-with-tool-api-service'\nimport { i18n } from '@/base/i18n'\nimport { usePlanTemplateConfigSingleton } from '@/composables/usePlanTemplateConfig'\nimport type { PlanTemplateConfigVO } from '@/types/plan-template'\nimport { computed, reactive } from 'vue'\n\nexport class TemplateStore {\n  // Loading and error state\n  isLoading = false\n  errorMessage = ''\n  // Track task requirement modifications\n  hasTaskRequirementModified = false\n\n  // Organization method: 'by_time' | 'by_abc' | 'by_group_time' | 'by_group_abc'\n  organizationMethod: 'by_time' | 'by_abc' | 'by_group_time' | 'by_group_abc' = 'by_time'\n\n  // Template service group mapping (templateId -> serviceGroup)\n  templateServiceGroups: Map<string, string> = new Map()\n\n  // Group collapse state (groupName -> isCollapsed)\n  // Using plain object instead of Map for Vue reactivity\n  groupCollapseState: Record<string, boolean> = {}\n\n  constructor() {\n    // Load organization method from localStorage\n    const savedMethod = localStorage.getItem('sidebarOrganizationMethod')\n    if (\n      savedMethod &&\n      ['by_time', 'by_abc', 'by_group_time', 'by_group_abc'].includes(savedMethod)\n    ) {\n      this.organizationMethod = savedMethod as\n        | 'by_time'\n        | 'by_abc'\n        | 'by_group_time'\n        | 'by_group_abc'\n    }\n    // Load group collapse state from localStorage\n    this.loadGroupCollapseState()\n  }\n\n  // Load group collapse state from localStorage\n  loadGroupCollapseState() {\n    try {\n      const saved = localStorage.getItem('sidebarGroupCollapseState')\n      if (saved) {\n        const parsed = JSON.parse(saved)\n        this.groupCollapseState = parsed || {}\n      }\n    } catch (error) {\n      console.warn('[TemplateStore] Failed to load group collapse state:', error)\n    }\n  }\n\n  // Save group collapse state to localStorage\n  saveGroupCollapseState() {\n    try {\n      localStorage.setItem('sidebarGroupCollapseState', JSON.stringify(this.groupCollapseState))\n    } catch (error) {\n      console.warn('[TemplateStore] Failed to save group collapse state:', error)\n    }\n  }\n\n  // Toggle group collapse state\n  toggleGroupCollapse(groupName: string | null) {\n    // Convert null to string key for object property access\n    const key = groupName ?? 'null'\n    const currentState = this.groupCollapseState[key] ?? false\n    this.groupCollapseState[key] = !currentState\n    this.saveGroupCollapseState()\n  }\n\n  // Check if group is collapsed\n  isGroupCollapsed(groupName: string | null): boolean {\n    // Convert null to string key for object property access\n    const key = groupName ?? 'null'\n    return this.groupCollapseState[key] ?? false\n  }\n\n  // Helper function to parse date from different formats\n  parseDateTime(dateValue: unknown): Date {\n    if (!dateValue) {\n      return new Date()\n    }\n\n    // If array format [year, month, day, hour, minute, second, nanosecond]\n    if (Array.isArray(dateValue) && dateValue.length >= 6) {\n      // JavaScript Date constructor months start from 0, so subtract 1\n      return new Date(\n        dateValue[0],\n        dateValue[1] - 1,\n        dateValue[2],\n        dateValue[3],\n        dateValue[4],\n        dateValue[5],\n        Math.floor(dateValue[6] / 1000000)\n      )\n    }\n\n    // If string format, parse directly\n    if (typeof dateValue === 'string') {\n      return new Date(dateValue)\n    }\n\n    // Return current time for other cases\n    return new Date()\n  }\n\n  // Reference to template config for accessing planTemplateList\n  private templateConfig = usePlanTemplateConfigSingleton()\n\n  // Set organization method\n  setOrganizationMethod(method: 'by_time' | 'by_abc' | 'by_group_time' | 'by_group_abc') {\n    this.organizationMethod = method\n    localStorage.setItem('sidebarOrganizationMethod', method)\n  }\n\n  // Actions\n  async loadPlanTemplateList() {\n    this.isLoading = true\n    this.errorMessage = ''\n    try {\n      console.log('[TemplateStore] Starting to load plan template list...')\n      const configVOs = await PlanTemplateApiService.getAllPlanTemplateConfigVOs()\n\n      // Use PlanTemplateConfigVO directly\n      this.templateConfig.planTemplateList.value = configVOs\n\n      // Build service group mapping\n      this.templateServiceGroups.clear()\n      for (const config of this.templateConfig.planTemplateList.value) {\n        const planTemplateId = config.planTemplateId\n        if (planTemplateId) {\n          const serviceGroup = config.serviceGroup || ''\n          if (serviceGroup) {\n            this.templateServiceGroups.set(planTemplateId, serviceGroup)\n          }\n        }\n      }\n\n      console.log(\n        `[TemplateStore] Successfully loaded ${this.templateConfig.planTemplateList.value.length} plan templates`\n      )\n    } catch (error: unknown) {\n      console.error('[TemplateStore] Failed to load plan template list:', error)\n      this.templateConfig.planTemplateList.value = []\n      const message = error instanceof Error ? error.message : 'Unknown error'\n      this.errorMessage = `Load failed: ${message}`\n    } finally {\n      this.isLoading = false\n    }\n  }\n\n  async selectTemplate(template: PlanTemplateConfigVO) {\n    this.templateConfig.currentPlanTemplateId.value = template.planTemplateId || null\n    this.templateConfig.selectedTemplate.value = template\n    // Reset modification flag when loading new template\n    this.hasTaskRequirementModified = false\n\n    console.log(`[TemplateStore] Selected plan template: ${template.planTemplateId}`)\n  }\n\n  async createNewTemplate(planType: string) {\n    const emptyTemplate: PlanTemplateConfigVO = {\n      planTemplateId: `new-${Date.now()}`,\n      title: i18n.global.t('sidebar.newTemplateName'),\n      planType: planType,\n      createTime: new Date().toISOString(),\n      updateTime: new Date().toISOString(),\n    }\n    this.templateConfig.selectedTemplate.value = emptyTemplate\n    this.templateConfig.currentPlanTemplateId.value = null\n\n    // Reset modification flag for new template\n    this.hasTaskRequirementModified = false\n\n    console.log('[TemplateStore] Created new empty plan template')\n  }\n\n  async deleteTemplate(template: PlanTemplateConfigVO) {\n    const planTemplateId = template.planTemplateId\n    if (!planTemplateId) {\n      console.warn('[TemplateStore] deleteTemplate: Invalid template object or ID')\n      return\n    }\n    try {\n      await PlanTemplateApiService.deletePlanTemplate(planTemplateId)\n      if (this.templateConfig.currentPlanTemplateId.value === planTemplateId) {\n        this.clearSelection()\n      }\n      await this.loadPlanTemplateList()\n      console.log(`[TemplateStore] Plan template ${planTemplateId} has been deleted`)\n    } catch (error: unknown) {\n      console.error('Failed to delete plan template:', error)\n      await this.loadPlanTemplateList()\n      throw error\n    }\n  }\n\n  clearSelection() {\n    this.templateConfig.currentPlanTemplateId.value = null\n    this.templateConfig.selectedTemplate.value = null\n    this.hasTaskRequirementModified = false\n  }\n}\n\n// Create store instance\nconst storeInstance = new TemplateStore()\n\n// Get template config singleton for computed properties\nconst templateConfigRef = usePlanTemplateConfigSingleton()\n\n// Create reactive store first\nexport const templateStore = reactive({\n  // State properties\n  isLoading: storeInstance.isLoading,\n  errorMessage: storeInstance.errorMessage,\n  hasTaskRequirementModified: storeInstance.hasTaskRequirementModified,\n  organizationMethod: storeInstance.organizationMethod,\n  templateServiceGroups: storeInstance.templateServiceGroups,\n  groupCollapseState: storeInstance.groupCollapseState,\n\n  // Methods\n  loadGroupCollapseState: () => storeInstance.loadGroupCollapseState(),\n  saveGroupCollapseState: () => storeInstance.saveGroupCollapseState(),\n  toggleGroupCollapse: (groupName: string | null) => {\n    storeInstance.toggleGroupCollapse(groupName)\n    // Update reactive object - Vue can track object property changes directly\n    const key = groupName ?? 'null'\n    templateStore.groupCollapseState[key] = storeInstance.groupCollapseState[key]\n    // Force reactivity by creating new object reference\n    templateStore.groupCollapseState = { ...templateStore.groupCollapseState }\n  },\n  isGroupCollapsed: (groupName: string | null) => storeInstance.isGroupCollapsed(groupName),\n  parseDateTime: (dateValue: unknown) => storeInstance.parseDateTime(dateValue),\n  setOrganizationMethod: (method: 'by_time' | 'by_abc' | 'by_group_time' | 'by_group_abc') => {\n    storeInstance.setOrganizationMethod(method)\n    templateStore.organizationMethod = method\n  },\n  loadPlanTemplateList: async () => {\n    await storeInstance.loadPlanTemplateList()\n    // Update reactive properties after loading\n    templateStore.isLoading = storeInstance.isLoading\n    templateStore.errorMessage = storeInstance.errorMessage\n    templateStore.templateServiceGroups = storeInstance.templateServiceGroups\n  },\n  selectTemplate: (template: PlanTemplateConfigVO) => storeInstance.selectTemplate(template),\n  createNewTemplate: (planType: string) => storeInstance.createNewTemplate(planType),\n  deleteTemplate: (template: PlanTemplateConfigVO) => storeInstance.deleteTemplate(template),\n  clearSelection: () => storeInstance.clearSelection(),\n})\n\n// Create computed properties for reactive template lists\n// These must be defined after templateStore to access reactive properties\nconst sortedTemplatesComputed = computed(() => {\n  const templates = [...templateConfigRef.planTemplateList.value]\n\n  switch (templateStore.organizationMethod) {\n    case 'by_time':\n      return templates.sort((a, b) => {\n        const timeA = templateStore.parseDateTime(a.updateTime ?? a.createTime)\n        const timeB = templateStore.parseDateTime(b.updateTime ?? b.createTime)\n        return timeB.getTime() - timeA.getTime()\n      })\n    case 'by_abc':\n      return templates.sort((a, b) => {\n        const titleA = (a.title ?? '').toLowerCase()\n        const titleB = (b.title ?? '').toLowerCase()\n        return titleA.localeCompare(titleB)\n      })\n    case 'by_group_time':\n    case 'by_group_abc': {\n      const groups = new Map<string, PlanTemplateConfigVO[]>()\n      const ungrouped: PlanTemplateConfigVO[] = []\n\n      templates.forEach(template => {\n        const planTemplateId = template.planTemplateId || ''\n        const serviceGroup = templateStore.templateServiceGroups.get(planTemplateId) ?? ''\n        if (!serviceGroup || serviceGroup === 'default' || serviceGroup === '') {\n          ungrouped.push(template)\n        } else {\n          if (!groups.has(serviceGroup)) {\n            groups.set(serviceGroup, [])\n          }\n          groups.get(serviceGroup)!.push(template)\n        }\n      })\n\n      const sortedGroups = new Map<string, PlanTemplateConfigVO[]>()\n      groups.forEach((templatesInGroup, groupName) => {\n        const sorted = [...templatesInGroup]\n        if (templateStore.organizationMethod === 'by_group_time') {\n          sorted.sort((a, b) => {\n            const timeA = templateStore.parseDateTime(a.updateTime ?? a.createTime)\n            const timeB = templateStore.parseDateTime(b.updateTime ?? b.createTime)\n            return timeB.getTime() - timeA.getTime()\n          })\n        } else {\n          sorted.sort((a, b) => {\n            const titleA = (a.title ?? '').toLowerCase()\n            const titleB = (b.title ?? '').toLowerCase()\n            return titleA.localeCompare(titleB)\n          })\n        }\n        sortedGroups.set(groupName, sorted)\n      })\n\n      if (templateStore.organizationMethod === 'by_group_time') {\n        ungrouped.sort((a, b) => {\n          const timeA = templateStore.parseDateTime(a.updateTime ?? a.createTime)\n          const timeB = templateStore.parseDateTime(b.updateTime ?? b.createTime)\n          return timeB.getTime() - timeA.getTime()\n        })\n      } else {\n        ungrouped.sort((a, b) => {\n          const titleA = (a.title ?? '').toLowerCase()\n          const titleB = (b.title ?? '').toLowerCase()\n          return titleA.localeCompare(titleB)\n        })\n      }\n\n      const result: PlanTemplateConfigVO[] = []\n      result.push(...ungrouped)\n      const sortedGroupNames = Array.from(sortedGroups.keys()).sort()\n      sortedGroupNames.forEach(groupName => {\n        result.push(...sortedGroups.get(groupName)!)\n      })\n      return result\n    }\n    default:\n      return templates.sort((a, b) => {\n        const timeA = templateStore.parseDateTime(a.updateTime || a.createTime || '')\n        const timeB = templateStore.parseDateTime(b.updateTime || b.createTime || '')\n        return timeB.getTime() - timeA.getTime()\n      })\n  }\n})\n\nconst groupedTemplatesComputed = computed(() => {\n  if (\n    templateStore.organizationMethod !== 'by_group_time' &&\n    templateStore.organizationMethod !== 'by_group_abc'\n  ) {\n    return new Map([[null, sortedTemplatesComputed.value]])\n  }\n\n  const groups = new Map<string | null, PlanTemplateConfigVO[]>()\n  const ungrouped: PlanTemplateConfigVO[] = []\n  const sorted = sortedTemplatesComputed.value\n\n  sorted.forEach(template => {\n    const planTemplateId = template.planTemplateId || ''\n    const serviceGroup = templateStore.templateServiceGroups.get(planTemplateId) ?? ''\n    if (!serviceGroup || serviceGroup === 'default' || serviceGroup === '') {\n      ungrouped.push(template)\n    } else {\n      if (!groups.has(serviceGroup)) {\n        groups.set(serviceGroup, [])\n      }\n      groups.get(serviceGroup)!.push(template)\n    }\n  })\n\n  const result = new Map<string | null, PlanTemplateConfigVO[]>()\n  if (ungrouped.length > 0) {\n    result.set(null, ungrouped)\n  }\n  const sortedGroupNames = Array.from(groups.keys()).sort()\n  sortedGroupNames.forEach(groupName => {\n    result.set(groupName, groups.get(groupName)!)\n  })\n\n  return result\n})\n\n// Add computed properties to reactive store using Object.defineProperty\nObject.defineProperty(templateStore, 'sortedTemplates', {\n  get: () => sortedTemplatesComputed.value,\n  enumerable: true,\n  configurable: true,\n})\n\nObject.defineProperty(templateStore, 'groupedTemplates', {\n  get: () => groupedTemplatesComputed.value,\n  enumerable: true,\n  configurable: true,\n})\n\n// Type augmentation to include computed properties\nexport interface TemplateStoreWithComputed {\n  sortedTemplates: PlanTemplateConfigVO[]\n  groupedTemplates: Map<string | null, PlanTemplateConfigVO[]>\n}\n\n// Type assertion to help TypeScript understand the computed properties\nexport type TemplateStoreType = typeof templateStore & TemplateStoreWithComputed\n"],"file":"templateStore-BAIqgfnz.js"}